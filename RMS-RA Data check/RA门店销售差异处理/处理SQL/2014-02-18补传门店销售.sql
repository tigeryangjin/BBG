--RMS下运行
TRUNCATE TABLE RA_RMS.BBG_XTERN_RDWT;
--2014年2月18日差异处理
--插入临时表
CREATE TABLE  RA_RMS.BBG_XTERN_RDWT_20140218 AS
SELECT * FROM RA_RMS.BBG_XTERN_RDWT_HIST T WHERE T.BUSINESS_DT='20140218' ;

--
INSERT INTO RA_RMS.BBG_XTERN_RDWT
SELECT * FROM RA_RMS.BBG_XTERN_RDWT_20140218 T ;

TRUNCATE TABLE RA_RMS.C_LOAD_DATES;

  DELETE W_RTL_SLS_TRX_IT_LC_DY_F T WHERE T.DT_WID = '120140218000';
  COMMIT;
  DELETE W_RTL_SLS_CL_DY_CUR_A T WHERE T.DT_WID = '120140218000';
  COMMIT;
  DELETE W_RTL_SLS_CL_LC_DY_A T WHERE T.DT_WID = '120140218000';
  COMMIT;
  DELETE W_RTL_SLS_CL_LC_DY_CUR_A T WHERE T.DT_WID = '120140218000';
  COMMIT;
  DELETE W_RTL_SLS_DP_DY_CUR_A T WHERE T.DT_WID = '120140218000';
  COMMIT;
  DELETE W_RTL_SLS_DP_LC_DY_A T WHERE T.DT_WID = '120140218000';
  COMMIT;
  DELETE W_RTL_SLS_DP_LC_DY_CUR_A T WHERE T.DT_WID = '120140218000';
  COMMIT;
  DELETE W_RTL_SLS_IT_DY_A T WHERE T.DT_WID = '120140218000';
  COMMIT;
  DELETE W_RTL_SLS_IT_DY_SN_A T WHERE T.DT_WID = '120140218000';
  COMMIT;
  DELETE W_RTL_SLS_IT_LC_DY_A T WHERE T.DT_WID = '120140218000'; --此表数据量很大，需要分批删除。
  COMMIT;
  DELETE W_RTL_SLS_IT_LC_DY_SN_A T WHERE T.DT_WID = '120140218000';
  COMMIT;
  DELETE W_RTL_SLS_LC_DY_A T WHERE T.DT_WID = '120140218000';
  COMMIT;
  DELETE W_RTL_SLS_SC_DY_A T WHERE T.DT_WID = '120140218000';
  COMMIT;
  DELETE W_RTL_SLS_SC_DY_CUR_A T WHERE T.DT_WID = '120140218000';
  COMMIT;
  DELETE W_RTL_SLS_SC_LC_DY_A T WHERE T.DT_WID = '120140218000';
  COMMIT;
  DELETE W_RTL_SLS_SC_LC_DY_CUR_A T WHERE T.DT_WID = '120140218000';
  COMMIT;
  DELETE W_RTL_SLS_CUST_IT_LC_DY_F T WHERE T.DT_WID = '120140218000';
  COMMIT;

--修改视图日期条件
RA_RMS.BBG_RA_ITEM_LOC_SOH_V;

--检查W_RTL_SLS_TRX_IT_LC_DY_FS
SELECT * FROM W_RTL_SLS_TRX_IT_LC_DY_FS;

TRUNCATE TABLE RADM.C_LOAD_DATES;
--检查W_RTL_SLS_TRX_IT_LC_DY_F
SELECT * FROM RABATCHER.W_RTL_SLS_TRX_IT_LC_DY_TMP;




SELECT * FROM W_RTL_SLS_TRX_IT_LC_DY_FS;

TRUNCATE TABLE RADM.C_LOAD_DATES;
------------------------------------------------------------------------------------------------------

DELETE W_RTL_SLS_CL_DY_CUR_A T WHERE T.DT_WID='120131203000' ;
COMMIT;
DELETE W_RTL_SLS_CL_LC_DY_A T WHERE T.DT_WID='120131203000' ;
COMMIT;
DELETE W_RTL_SLS_CL_LC_DY_CUR_A T WHERE T.DT_WID='120131203000' ;
COMMIT;
DELETE W_RTL_SLS_DP_DY_CUR_A T WHERE T.DT_WID='120131203000' ;
COMMIT;
DELETE W_RTL_SLS_DP_LC_DY_A T WHERE T.DT_WID='120131203000' ;
COMMIT;
DELETE W_RTL_SLS_DP_LC_DY_CUR_A T WHERE T.DT_WID='120131203000' ;
COMMIT;
DELETE W_RTL_SLS_IT_DY_A T WHERE T.DT_WID='120131203000' ;
COMMIT;
DELETE W_RTL_SLS_IT_DY_SN_A T WHERE T.DT_WID='120131203000' ;
COMMIT;
DELETE W_RTL_SLS_IT_LC_DY_A T WHERE T.DT_WID='120131203000' ;--此表数据量很大，需要分批删除。
COMMIT;
DELETE W_RTL_SLS_IT_LC_DY_SN_A T WHERE T.DT_WID='120131203000' ;
COMMIT;
DELETE W_RTL_SLS_LC_DY_A T WHERE T.DT_WID='120131203000' ;
COMMIT;
DELETE W_RTL_SLS_SC_DY_A T WHERE T.DT_WID='120131203000' ;--
COMMIT;
DELETE W_RTL_SLS_SC_DY_CUR_A T WHERE T.DT_WID='120131203000' ;--
COMMIT;
DELETE W_RTL_SLS_SC_LC_DY_A T WHERE T.DT_WID='120131203000' ;--
COMMIT;
DELETE W_RTL_SLS_SC_LC_DY_CUR_A T WHERE T.DT_WID='120131203000' ;--
COMMIT;
DELETE W_RTL_SLS_CUST_IT_LC_DY_F T WHERE T.DT_WID='120131203000';
COMMIT;
