--1.confirm the missing item
--139211.2400070072496
SELECT *
  FROM BBG_RA_SLS_TRX_JL_V@RA_JL A
 WHERE A.DAY_DT = DATE '2016-10-23'
   AND NOT EXISTS (SELECT 1
          FROM (SELECT /*+PARALLEL(16)*/
                DISTINCT E.ORG_NUM, D.PROD_NUM PROD_IT_NUM
                  FROM RADM.W_RTL_SLS_TRX_IT_LC_DY_F C,
                       RADM.W_PRODUCT_D              D,
                       RADM.W_INT_ORG_D              E
                 WHERE C.PROD_WID = D.ROW_WID
                   AND C.ORG_WID = E.ROW_WID
                   AND C.DT_WID = 120161023000
                   AND C.BBG_SERVICE_SATISFACTION = 3.5) B
         WHERE A.PROD_IT_NUM = B.PROD_IT_NUM
           AND A.ORG_NUM = B.ORG_NUM);
					 
					 
--2.SIL
--2.1.ITEM_LOC_DIM
CALL bbg_jl_item_loc_new_proc(new_loc => 139122);

SELECT * FROM RADM.BBG_RA_ITEM_LOC_DS;

--2.2.SALES SIL
TRUNCATE TABLE RADM.C_LOAD_DATES;

TRUNCATE TABLE RADM.W_RTL_SLS_TRX_IT_LC_DY_FS_BAK;

INSERT INTO RADM.W_RTL_SLS_TRX_IT_LC_DY_FS_BAK
SELECT * FROM RADM.W_RTL_SLS_TRX_IT_LC_DY_FS;
COMMIT;

TRUNCATE TABLE RADM.W_RTL_SLS_TRX_IT_LC_DY_FS;

INSERT INTO RADM.W_RTL_SLS_TRX_IT_LC_DY_FS
SELECT * FROM RADM.W_RTL_SLS_TRX_IT_LC_DY_FS_BAK T WHERE T.ORG_NUM=139122 AND T.PROD_IT_NUM='2400070072496';
COMMIT;

--3.SALES PLP
SELECT * FROM RABATCHER.W_RTL_SLS_TRX_IT_LC_DY_TMP;

--4.SUPP SALES SIL
TRUNCATE TABLE RADM.BBG_RA_SLS_IT_LC_DY_FS_BAK;

INSERT INTO RADM.BBG_RA_SLS_IT_LC_DY_FS_BAK
SELECT * FROM RADM.BBG_RA_SLS_IT_LC_DY_FS;
COMMIT;

TRUNCATE TABLE RADM.BBG_RA_SLS_IT_LC_DY_FS;

INSERT INTO RADM.BBG_RA_SLS_IT_LC_DY_FS
SELECT * FROM RADM.BBG_RA_SLS_IT_LC_DY_FS_BAK T WHERE T.ORG_NUM=139122 AND T.PROD_IT_NUM='2400070072496';
COMMIT;

