--从RADM.W_RTL_SLS_TRX_IT_LC_DY_F插入数据到RABATCHER.W_RTL_SLS_TRX_IT_LC_DY_TMP
--1.先从RADM.W_RTL_SLS_TRX_IT_LC_DY_F取数到RADM.W_RTL_SLS_TRX_IT_LC_DY_F_BAK
TRUNCATE TABLE RADM.W_RTL_SLS_TRX_IT_LC_DY_F_BAK;
--TRUNCATE TABLE RABATCHER.W_RTL_SLS_TRX_IT_LC_DY_TMP;
INSERT INTO RADM.W_RTL_SLS_TRX_IT_LC_DY_F_BAK
  select * from W_RTL_SLS_TRX_IT_LC_DY_F t WHERE T.DT_WID = 120160318000;
COMMIT;
--2.插入数据到RABATCHER.W_RTL_SLS_TRX_IT_LC_DY_TMP
TRUNCATE TABLE RABATCHER.W_RTL_SLS_TRX_IT_LC_DY_TMP;
  INSERT INTO RABATCHER.W_RTL_SLS_TRX_IT_LC_DY_TMP T
    (ORG_WID,
     ORG_LC_WID,
     ORG_DS_WID,
     ORG_RG_WID,
     ORG_AR_WID,
     ORG_CH_WID,
     ORG_NUM,
     ORG_DS_NUM,
     ORG_RG_NUM,
     ORG_AR_NUM,
     ORG_CH_NUM,
     ORG_SCD1_WID,
     PROD_SCD1_WID,
     PROD_IT_WID,
     PROD_SC_WID,
     PROD_CL_WID,
     PROD_DP_WID,
     PROD_GP_WID,
     PROD_DV_WID,
     PROD_IT_NUM,
     PROD_SC_NUM,
     PROD_CL_NUM,
     PROD_DP_NUM,
     PROD_GP_NUM,
     PROD_DV_NUM,
     SLS_TRX_ID,
     VOUCHER_ID,
     RTL_TYPE_WID,
     RTL_TYPE_CODE,
     DT_WID,
     DAY_DT,
     MIN_WID,
     MIN_NUM,
     WK_WID,
     WK_NUM,
     PR_WID,
     PR_NUM,
     QT_WID,
     QT_NUM,
     EMPLOYEE_WID,
     SLS_QTY,
     SLS_AMT_LCL,
     SLS_PROFIT_AMT_LCL,
     SLS_MANUAL_MKDN_AMT_LCL,
     SLS_MANUAL_MKUP_AMT_LCL,
     SLS_TAX_AMT_LCL,
     SLS_EMP_DISC_AMT_LCL,
     SLS_MANUAL_COUNT,
     SLS_SCAN_COUNT,
     RET_QTY,
     RET_AMT_LCL,
     RET_PROFIT_AMT_LCL,
     RET_MANUAL_MKDN_AMT_LCL,
     RET_MANUAL_MKUP_AMT_LCL,
     RET_TAX_AMT_LCL,
     RET_EMP_DISC_AMT_LCL,
     RET_MANUAL_COUNT,
     RET_SCAN_COUNT,
     DOC_CURR_CODE,
     LOC_CURR_CODE,
     LOC_EXCHANGE_RATE,
     GLOBAL1_EXCHANGE_RATE,
     GLOBAL2_EXCHANGE_RATE,
     GLOBAL3_EXCHANGE_RATE,
     CREATED_BY_ID,
     CHANGED_BY_ID,
     AUX1_CHANGED_ON_DT,
     AUX2_CHANGED_ON_DT,
     AUX3_CHANGED_ON_DT,
     AUX4_CHANGED_ON_DT,
     DELETE_FLG,
     DATASOURCE_NUM_ID,
     TENANT_ID,
     X_CUSTOM,
     ETL_THREAD_VAL,
     BBG_ITEM_LOC_WID,
     BBG_RETAIL_TYPE_ID,
     BBG_RETAIL_TYPE_WID,
     BBG_SERVICE_SATISFACTION,
     SRC_REF_NO1,
     SRC_REF_NO2,
     SRC_REF_NO3,
     SRC_REF_NO6,
     SRC_REF_NO7,
     SRC_REF_NO8,
     BBG_REFERENCE_DO1,
     BBG_REFERENCE_DO2,
     BBG_REFERENCE_DO3,
     BBG_REFERENCE_DO4,
     BBG_REFERENCE_DO5,
     BBG_REFERENCE_FO1,
     BBG_REFERENCE_FO2,
     BBG_REFERENCE_FO3,
     BBG_REFERENCE_FO4,
     BBG_REFERENCE_FO5,
     BBG_REFERENCE_FO6,
     BBG_REFERENCE_FO7,
     BBG_REFERENCE_FO8,
     BBG_REFERENCE_FO9,
     BBG_REFERENCE_FO10,
     CREATED_ON_DT,
     CHANGED_ON_DT)
    SELECT /*+PARALLEL(16)*/
     W_INT_ORG_D_RTL_TMP.ORG_WID,
     --W_INT_ORG_DH_RTL_TMP.ORG_LC_WID,
     (SELECT LC.ROW_WID
        FROM RADM.W_INT_ORG_DH LC
       WHERE LC.LEVEL_NAME = 'LOCATION'
         AND LC.ORG_HIER9_NUM = W_INT_ORG_DH.ORG_HIER9_NUM
         AND TO_DATE(SUBSTR(TRX.DT_WID, 2, 8), 'YYYYMMDD') BETWEEN
             LC.EFFECTIVE_FROM_DT AND LC.EFFECTIVE_TO_DT) ORG_LC_WID,
     --W_INT_ORG_DH_RTL_TMP.ORG_DS_WID,
     (SELECT DS.ROW_WID
        FROM RADM.W_INT_ORG_DH DS
       WHERE DS.LEVEL_NAME = 'DISTRICT'
         AND DS.ORG_HIER10_NUM = W_INT_ORG_DH.ORG_HIER10_NUM
         AND TO_DATE(SUBSTR(TRX.DT_WID, 2, 8), 'YYYYMMDD') BETWEEN
             DS.EFFECTIVE_FROM_DT AND DS.EFFECTIVE_TO_DT) ORG_DS_WID,
     --W_INT_ORG_DH_RTL_TMP.ORG_RG_WID,
     (SELECT RG.ROW_WID
        FROM RADM.W_INT_ORG_DH RG
       WHERE RG.LEVEL_NAME = 'REGION'
         AND RG.ORG_HIER11_NUM = W_INT_ORG_DH.ORG_HIER11_NUM
         AND TO_DATE(SUBSTR(TRX.DT_WID, 2, 8), 'YYYYMMDD') BETWEEN
             RG.EFFECTIVE_FROM_DT AND RG.EFFECTIVE_TO_DT) ORG_RG_WID,
     --W_INT_ORG_DH_RTL_TMP.ORG_AR_WID,
     (SELECT AR.ROW_WID
        FROM RADM.W_INT_ORG_DH AR
       WHERE AR.LEVEL_NAME = 'AREA'
         AND AR.ORG_HIER12_NUM = W_INT_ORG_DH.ORG_HIER12_NUM
         AND TO_DATE(SUBSTR(TRX.DT_WID, 2, 8), 'YYYYMMDD') BETWEEN
             AR.EFFECTIVE_FROM_DT AND AR.EFFECTIVE_TO_DT) ORG_AR_WID,
     --W_INT_ORG_DH_RTL_TMP.ORG_CH_WID
     (SELECT CH.ROW_WID
        FROM RADM.W_INT_ORG_DH CH
       WHERE CH.LEVEL_NAME = 'CHAIN'
         AND CH.ORG_HIER13_NUM = W_INT_ORG_DH.ORG_HIER13_NUM
         AND TO_DATE(SUBSTR(TRX.DT_WID, 2, 8), 'YYYYMMDD') BETWEEN
             CH.EFFECTIVE_FROM_DT AND CH.EFFECTIVE_TO_DT) ORG_CH_WID,
     W_INT_ORG_DH.ORG_HIER9_NUM,
     W_INT_ORG_DH.ORG_HIER10_NUM,
     W_INT_ORG_DH.ORG_HIER11_NUM,
     W_INT_ORG_DH.ORG_HIER12_NUM,
     W_INT_ORG_DH.ORG_HIER13_NUM,
     W_INT_ORG_DH.SCD1_WID,
     W_PRODUCT_D_RTL_TMP.PROD_SCD1_WID,
     W_PRODUCT_D_RTL_TMP.PROD_IT_WID,
     W_PRODUCT_D_RTL_TMP.PROD_SC_WID,
     W_PRODUCT_D_RTL_TMP.PROD_CL_WID,
     W_PRODUCT_D_RTL_TMP.PROD_DP_WID,
     W_PRODUCT_D_RTL_TMP.PROD_GP_WID,
     W_PRODUCT_D_RTL_TMP.PROD_DV_WID,
     W_PRODUCT_D_RTL_TMP.PROD_IT_NUM,
     W_PRODUCT_D_RTL_TMP.PROD_SC_NUM,
     W_PRODUCT_D_RTL_TMP.PROD_CL_NUM,
     W_PRODUCT_D_RTL_TMP.PROD_DP_NUM,
     W_PRODUCT_D_RTL_TMP.PROD_GP_NUM,
     W_PRODUCT_D_RTL_TMP.PROD_DV_NUM,
     TRX.SLS_TRX_ID,
     TRX.VOUCHER_ID,
     W_XACT_TYPE_D.ROW_WID,
     W_XACT_TYPE_D.W_XACT_TYPE_CODE,
     W_MCAL_DAY_D.ROW_WID,
     W_MCAL_DAY_D.MCAL_DAY_DT,
     TRX.MIN_WID,
     TRX.MIN_WID,
     W_MCAL_WEEK_D.ROW_WID,
     W_MCAL_WEEK_D.MCAL_YEAR || W_MCAL_WEEK_D.MCAL_WEEK,
     W_MCAL_DAY_D.MCAL_PERIOD_WID,
     W_MCAL_DAY_D.MCAL_YEAR || W_MCAL_DAY_D.MCAL_PERIOD,
     W_MCAL_DAY_D.MCAL_QTR_WID,
     W_MCAL_DAY_D.MCAL_YEAR || W_MCAL_DAY_D.MCAL_QTR,
     1,
     TRX.SLS_QTY,
     TRX.SLS_AMT_LCL,
     TRX.SLS_PROFIT_AMT_LCL,
     TRX.SLS_MANUAL_MKDN_AMT_LCL,
     TRX.SLS_MANUAL_MKUP_AMT_LCL,
     TRX.SLS_TAX_AMT_LCL,
     TRX.SLS_EMP_DISC_AMT_LCL,
     TRX.SLS_MANUAL_COUNT,
     TRX.SLS_SCAN_COUNT,
     TRX.RET_QTY,
     TRX.RET_AMT_LCL,
     TRX.RET_PROFIT_AMT_LCL,
     TRX.RET_MANUAL_MKDN_AMT_LCL,
     TRX.RET_MANUAL_MKUP_AMT_LCL,
     TRX.RET_TAX_AMT_LCL,
     TRX.RET_EMP_DISC_AMT_LCL,
     TRX.RET_MANUAL_COUNT,
     TRX.RET_SCAN_COUNT,
     TRX.DOC_CURR_CODE,
     TRX.LOC_CURR_CODE,
     NULL,
     NULL,
     NULL,
     NULL,
     TRX.CREATED_BY_WID,
     TRX.CHANGED_BY_WID,
     TRX.AUX1_CHANGED_ON_DT,
     TRX.AUX2_CHANGED_ON_DT,
     TRX.AUX3_CHANGED_ON_DT,
     TRX.AUX4_CHANGED_ON_DT,
     TRX.DELETE_FLG,
     TRX.DATASOURCE_NUM_ID,
     TRX.TENANT_ID,
     TRX.X_CUSTOM,
     RESTART_LOC.THREAD_VAL,
     TRX.BBG_ITEM_LOC_WID,
     BBG_RA_RETAIL_TYPE_D.RETAIL_TYPE_ID,
     TRX.BBG_RETAIL_TYPE_WID,
     TRX.BBG_SERVICE_SATISFACTION,
     TRX.SRC_REF_NO1,
     TRX.SRC_REF_NO2,
     TRX.SRC_REF_NO3,
     TRX.SRC_REF_NO6,
     TRX.SRC_REF_NO7,
     TRX.SRC_REF_NO8,
     TRX.BBG_REFERENCE_DO1,
     TRX.BBG_REFERENCE_DO2,
     TRX.BBG_REFERENCE_DO3,
     TRX.BBG_REFERENCE_DO4,
     TRX.BBG_REFERENCE_DO5,
     TRX.BBG_REFERENCE_FO1,
     TRX.BBG_REFERENCE_FO2,
     TRX.BBG_REFERENCE_FO3,
     TRX.BBG_REFERENCE_FO4,
     TRX.BBG_REFERENCE_FO5,
     TRX.BBG_REFERENCE_FO6,
     TRX.BBG_REFERENCE_FO7,
     TRX.BBG_REFERENCE_FO8,
     TRX.BBG_REFERENCE_FO9,
     TRX.BBG_REFERENCE_FO10,
     SYSDATE,
     SYSDATE
      FROM RADM.W_INT_ORG_DH                   W_INT_ORG_DH,
           RABATCHER.W_PRODUCT_D_RTL_TMP       W_PRODUCT_D_RTL_TMP,
           RADM.W_MCAL_WEEK_D                  W_MCAL_WEEK_D,
           RADM.W_MCAL_DAY_D                   W_MCAL_DAY_D,
           RABATCHER.W_INT_ORG_D_RTL_TMP       W_INT_ORG_D_RTL_TMP,
           RADM.BBG_RA_RETAIL_TYPE_D           BBG_RA_RETAIL_TYPE_D,
           RADM.W_RTL_SLS_TRX_IT_LC_DY_F_BAK   TRX,
           RA_RMS.RA_RESTART_LOC@RA_RMS_DBLINK RESTART_LOC,
           RADM.W_XACT_TYPE_D                  W_XACT_TYPE_D
     WHERE BBG_RA_RETAIL_TYPE_D.ROW_WID = TRX.BBG_RETAIL_TYPE_WID
       AND RESTART_LOC.SCENARIO_NAME =
           'SDE_BBG_RETAIL_SALESTRANSACTIONFACT'
       AND RESTART_LOC.DRIVER_VALUE = W_INT_ORG_D_RTL_TMP.ORG_NUM
       AND W_INT_ORG_D_RTL_TMP.ORG_WID = TRX.ORG_WID
       AND W_MCAL_DAY_D.ROW_WID = TRX.DT_WID
       AND TRX.DT_WID BETWEEN
           '1' || TO_CHAR(W_MCAL_WEEK_D.MCAL_WEEK_START_DT, 'YYYYMMDD') ||
           '000' AND
           '1' || TO_CHAR(W_MCAL_WEEK_D.MCAL_WEEK_END_DT, 'YYYYMMDD') ||
           '000'
       AND W_XACT_TYPE_D.DATASOURCE_NUM_ID = TRX.DATASOURCE_NUM_ID
       AND W_XACT_TYPE_D.W_XACT_CAT_CODE = 'RETAIL_TRAN_TYPE'
       AND W_XACT_TYPE_D.ROW_WID = TRX.RTL_TYPE_WID
       AND W_PRODUCT_D_RTL_TMP.PROD_IT_WID = TRX.PROD_WID
       AND W_INT_ORG_DH.ROW_WID = TRX.ORG_DH_WID;
COMMIT;

--3.从RABATCHER.W_RTL_SLS_TRX_IT_LC_DY_TMP插入数据到RABATCHER.W_RTL_SLS_IT_LC_DY_TMP
TRUNCATE TABLE RABATCHER.W_RTL_SLS_IT_LC_DY_TMP;
insert into RABATCHER.W_RTL_SLS_IT_LC_DY_TMP T
  (ORG_WID,
   ORG_SCD1_WID,
   PROD_IT_WID,
   PROD_SCD1_WID,
   VOUCHER_FLG,
   RTL_TYPE_WID,
   EMPLOYEE_WID,
   ORG_LC_WID,
   ORG_DS_WID,
   ORG_RG_WID,
   ORG_AR_WID,
   ORG_CH_WID,
   PROD_DV_WID,
   PROD_GP_WID,
   PROD_DP_WID,
   PROD_CL_WID,
   PROD_SC_WID,
   DT_WID,
   WK_WID,
   PR_WID,
   QT_WID,
   DAY_DT,
   WK_NUM,
   PR_NUM,
   QT_NUM,
   ORG_NUM,
   ORG_DS_NUM,
   ORG_RG_NUM,
   ORG_AR_NUM,
   ORG_CH_NUM,
   PROD_IT_NUM,
   PROD_SC_NUM,
   PROD_CL_NUM,
   PROD_DP_NUM,
   PROD_GP_NUM,
   PROD_DV_NUM,
   RTL_TYPE_CODE,
   SLS_QTY,
   SLS_AMT_LCL,
   SLS_PROFIT_AMT_LCL,
   SLS_MANUAL_MKDN_AMT_LCL,
   SLS_MANUAL_MKUP_AMT_LCL,
   SLS_TAX_AMT_LCL,
   SLS_EMP_DISC_AMT_LCL,
   SLS_MANUAL_COUNT,
   SLS_SCAN_COUNT,
   RET_QTY,
   RET_AMT_LCL,
   RET_PROFIT_AMT_LCL,
   RET_MANUAL_MKDN_AMT_LCL,
   RET_MANUAL_MKUP_AMT_LCL,
   RET_TAX_AMT_LCL,
   RET_EMP_DISC_AMT_LCL,
   RET_MANUAL_COUNT,
   RET_SCAN_COUNT,
   SLS_TRX_COUNT,
   RET_TRX_COUNT,
   AUX1_CHANGED_ON_DT,
   AUX2_CHANGED_ON_DT,
   AUX3_CHANGED_ON_DT,
   AUX4_CHANGED_ON_DT,
   CHANGED_BY_ID,
   CHANGED_ON_DT,
   CREATED_BY_ID,
   CREATED_ON_DT,
   DATASOURCE_NUM_ID,
   DELETE_FLG,
   DOC_CURR_CODE,
   GLOBAL1_EXCHANGE_RATE,
   GLOBAL2_EXCHANGE_RATE,
   GLOBAL3_EXCHANGE_RATE,
   LOC_CURR_CODE,
   LOC_EXCHANGE_RATE,
   TENANT_ID,
   X_CUSTOM,
   BBG_ITEM_LOC_WID,
   BBG_RETAIL_TYPE_WID,
   BBG_CUSTOMER_COUNT,
   BBG_SERVICE_SATISFACTION,
   BBG_REFERENCE_DO1,
   BBG_REFERENCE_DO2,
   BBG_REFERENCE_DO3,
   BBG_REFERENCE_DO4,
   BBG_REFERENCE_DO5,
   BBG_REFERENCE_FO1,
   BBG_REFERENCE_FO2,
   BBG_REFERENCE_FO3,
   BBG_REFERENCE_FO4,
   BBG_REFERENCE_FO5,
   BBG_REFERENCE_FO6,
   BBG_REFERENCE_FO7,
   BBG_REFERENCE_FO8,
   BBG_REFERENCE_FO9,
   BBG_REFERENCE_FO10,
   BBG_RETAIL_TYPE_ID,
   VIP_SLS_QTY,
   VIP_SLS_AMT_LCL,
   VIP_SLS_PROFIT_AMT_LCL,
   VIP_SLS_MANUAL_MKDN_AMT_LCL,
   VIP_SLS_MANUAL_MKUP_AMT_LCL,
   VIP_SLS_TAX_AMT_LCL,
   VIP_SLS_EMP_DISC_AMT_LCL,
   VIP_SLS_MANUAL_COUNT,
   VIP_SLS_SCAN_COUNT,
   VIP_RET_QTY,
   VIP_RET_AMT_LCL,
   VIP_RET_PROFIT_AMT_LCL,
   VIP_RET_MANUAL_MKDN_AMT_LCL,
   VIP_RET_MANUAL_MKUP_AMT_LCL,
   VIP_RET_TAX_AMT_LCL,
   VIP_RET_EMP_DISC_AMT_LCL,
   VIP_RET_MANUAL_COUNT,
   VIP_RET_SCAN_COUNT,
   VIP_SLS_TRX_COUNT,
   VIP_RET_TRX_COUNT
   
   )
  select W_RTL_SLS_TRX_IT_LC_DY_TMP.ORG_WID,
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.ORG_SCD1_WID),
         W_RTL_SLS_TRX_IT_LC_DY_TMP.PROD_IT_WID,
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.PROD_SCD1_WID),
         (CASE
           WHEN SUM((CASE
                      WHEN W_RTL_SLS_TRX_IT_LC_DY_TMP.VOUCHER_ID = '-1' THEN
                       -1
                      ELSE
                       0
                    END)) <= 0 THEN
            'N'
           ELSE
            'Y'
         END),
         W_RTL_SLS_TRX_IT_LC_DY_TMP.RTL_TYPE_WID,
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.EMPLOYEE_WID),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.ORG_LC_WID),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.ORG_DS_WID),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.ORG_RG_WID),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.ORG_AR_WID),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.ORG_CH_WID),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.PROD_DV_WID),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.PROD_GP_WID),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.PROD_DP_WID),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.PROD_CL_WID),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.PROD_SC_WID),
         W_RTL_SLS_TRX_IT_LC_DY_TMP.DT_WID,
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.WK_WID),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.PR_WID),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.QT_WID),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.DAY_DT),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.WK_NUM),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.PR_NUM),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.QT_NUM),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.ORG_NUM),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.ORG_DS_NUM),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.ORG_RG_NUM),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.ORG_AR_NUM),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.ORG_CH_NUM),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.PROD_IT_NUM),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.PROD_SC_NUM),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.PROD_CL_NUM),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.PROD_DP_NUM),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.PROD_GP_NUM),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.PROD_DV_NUM),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.RTL_TYPE_CODE),
         SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_QTY),
         SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_AMT_LCL),
         SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_PROFIT_AMT_LCL),
         SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_MANUAL_MKDN_AMT_LCL),
         SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_MANUAL_MKUP_AMT_LCL),
         SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_TAX_AMT_LCL),
         SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_EMP_DISC_AMT_LCL),
         SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_MANUAL_COUNT),
         SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_SCAN_COUNT),
         SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.RET_QTY),
         SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.RET_AMT_LCL),
         SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.RET_PROFIT_AMT_LCL),
         SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.RET_MANUAL_MKDN_AMT_LCL),
         SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.RET_MANUAL_MKUP_AMT_LCL),
         SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.RET_TAX_AMT_LCL),
         SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.RET_EMP_DISC_AMT_LCL),
         SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.RET_MANUAL_COUNT),
         SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.RET_SCAN_COUNT),
         COUNT(DISTINCT((CASE
                          WHEN (W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_MANUAL_COUNT > 0 AND
                               W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_SCAN_COUNT > 0) THEN
                           W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_TRX_ID
                          ELSE
                           NULL
                        END))),
         COUNT(DISTINCT((CASE
                          WHEN (W_RTL_SLS_TRX_IT_LC_DY_TMP.RET_MANUAL_COUNT > 0 AND
                               W_RTL_SLS_TRX_IT_LC_DY_TMP.RET_SCAN_COUNT > 0) THEN
                           W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_TRX_ID
                          ELSE
                           NULL
                        END))),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.AUX1_CHANGED_ON_DT),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.AUX2_CHANGED_ON_DT),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.AUX3_CHANGED_ON_DT),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.AUX4_CHANGED_ON_DT),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.CHANGED_BY_ID),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.CHANGED_ON_DT),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.CREATED_BY_ID),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.CREATED_ON_DT),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.DATASOURCE_NUM_ID),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.DELETE_FLG),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.DOC_CURR_CODE),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.GLOBAL1_EXCHANGE_RATE),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.GLOBAL2_EXCHANGE_RATE),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.GLOBAL3_EXCHANGE_RATE),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.LOC_CURR_CODE),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.LOC_EXCHANGE_RATE),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.TENANT_ID),
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.X_CUSTOM),
         W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_ITEM_LOC_WID,
         W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_RETAIL_TYPE_WID,
         count(distinct W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_TRX_ID),
         avg(W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_SERVICE_SATISFACTION),
         W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_DO1,
         W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_DO2,
         W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_DO3,
         W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_DO4,
         W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_DO5,
         SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO1),
         SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO2),
         W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO3,
         W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO4,
         W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO5,
         W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO6,
         W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO7,
         W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO8,
         W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO9,
         W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO10,
         MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_RETAIL_TYPE_ID),
         SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.VIP_SLS_QTY),
         SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.VIP_SLS_AMT_LCL),
         SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.VIP_SLS_PROFIT_AMT_LCL),
         SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.VIP_SLS_MANUAL_MKDN_AMT_LCL),
         SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.VIP_SLS_MANUAL_MKUP_AMT_LCL),
         SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.VIP_SLS_TAX_AMT_LCL),
         SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.VIP_SLS_EMP_DISC_AMT_LCL),
         SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.VIP_SLS_MANUAL_COUNT),
         SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.VIP_SLS_SCAN_COUNT),
         SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.VIP_RET_QTY),
         SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.VIP_RET_AMT_LCL),
         SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.VIP_RET_PROFIT_AMT_LCL),
         SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.VIP_RET_MANUAL_MKDN_AMT_LCL),
         SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.VIP_RET_MANUAL_MKUP_AMT_LCL),
         SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.VIP_RET_TAX_AMT_LCL),
         SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.VIP_RET_EMP_DISC_AMT_LCL),
         SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.VIP_RET_MANUAL_COUNT),
         SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.VIP_RET_SCAN_COUNT),
         COUNT(DISTINCT((CASE
                          WHEN (W_RTL_SLS_TRX_IT_LC_DY_TMP.VIP_SLS_MANUAL_COUNT > 0 AND
                               W_RTL_SLS_TRX_IT_LC_DY_TMP.VIP_SLS_SCAN_COUNT > 0) THEN
                           W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_TRX_ID
                          ELSE
                           NULL
                        END))),
         COUNT(DISTINCT((CASE
                          WHEN (W_RTL_SLS_TRX_IT_LC_DY_TMP.VIP_RET_MANUAL_COUNT > 0 AND
                               W_RTL_SLS_TRX_IT_LC_DY_TMP.VIP_RET_SCAN_COUNT > 0) THEN
                           W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_TRX_ID
                          ELSE
                           NULL
                        END)))
  
    from RABATCHER.W_RTL_SLS_TRX_IT_LC_DY_TMP W_RTL_SLS_TRX_IT_LC_DY_TMP
   where (1 = 1)
  
   Group By W_RTL_SLS_TRX_IT_LC_DY_TMP.ORG_WID,
            W_RTL_SLS_TRX_IT_LC_DY_TMP.PROD_IT_WID,
            W_RTL_SLS_TRX_IT_LC_DY_TMP.RTL_TYPE_WID,
            W_RTL_SLS_TRX_IT_LC_DY_TMP.DT_WID,
            W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_ITEM_LOC_WID,
            W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_RETAIL_TYPE_WID,
            W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_DO1,
            W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_DO2,
            W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_DO3,
            W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_DO4,
            W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_DO5,
            W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO3,
            W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO4,
            W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO5,
            W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO6,
            W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO7,
            W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO8,
            W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO9,
            W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO10;
COMMIT;

--4.从RABATCHER.W_RTL_SLS_IT_LC_DY_TMP插入数据到RABATCHER.W_RTL_SLS_SC_LC_DY_TMP
TRUNCATE TABLE RABATCHER.W_RTL_SLS_SC_LC_DY_TMP;
insert into RABATCHER.W_RTL_SLS_SC_LC_DY_TMP T
  (ORG_WID,
   ORG_SCD1_WID,
   VOUCHER_FLG,
   RTL_TYPE_WID,
   EMPLOYEE_WID,
   ORG_LC_WID,
   ORG_DS_WID,
   ORG_RG_WID,
   ORG_AR_WID,
   ORG_CH_WID,
   PROD_DV_WID,
   PROD_GP_WID,
   PROD_DP_WID,
   PROD_CL_WID,
   PROD_SC_WID,
   DT_WID,
   WK_WID,
   PR_WID,
   QT_WID,
   DAY_DT,
   WK_NUM,
   PR_NUM,
   QT_NUM,
   ORG_NUM,
   ORG_DS_NUM,
   ORG_RG_NUM,
   ORG_AR_NUM,
   ORG_CH_NUM,
   PROD_IT_NUM,
   PROD_SC_NUM,
   PROD_CL_NUM,
   PROD_DP_NUM,
   PROD_GP_NUM,
   PROD_DV_NUM,
   RTL_TYPE_CODE,
   SLS_QTY,
   SLS_AMT_LCL,
   SLS_PROFIT_AMT_LCL,
   SLS_MANUAL_MKDN_AMT_LCL,
   SLS_MANUAL_MKUP_AMT_LCL,
   SLS_TAX_AMT_LCL,
   SLS_EMP_DISC_AMT_LCL,
   SLS_MANUAL_COUNT,
   SLS_SCAN_COUNT,
   RET_QTY,
   RET_AMT_LCL,
   RET_PROFIT_AMT_LCL,
   RET_MANUAL_MKDN_AMT_LCL,
   RET_MANUAL_MKUP_AMT_LCL,
   RET_TAX_AMT_LCL,
   RET_EMP_DISC_AMT_LCL,
   RET_MANUAL_COUNT,
   RET_SCAN_COUNT,
   SLS_TRX_COUNT,
   RET_TRX_COUNT,
   AUX1_CHANGED_ON_DT,
   AUX2_CHANGED_ON_DT,
   AUX3_CHANGED_ON_DT,
   AUX4_CHANGED_ON_DT,
   CHANGED_BY_ID,
   CHANGED_ON_DT,
   CREATED_BY_ID,
   CREATED_ON_DT,
   DATASOURCE_NUM_ID,
   DELETE_FLG,
   DOC_CURR_CODE,
   GLOBAL1_EXCHANGE_RATE,
   GLOBAL2_EXCHANGE_RATE,
   GLOBAL3_EXCHANGE_RATE,
   LOC_CURR_CODE,
   LOC_EXCHANGE_RATE,
   TENANT_ID,
   X_CUSTOM,
   BBG_RETAIL_TYPE_WID,
   BBG_CUSTOMER_COUNT,
   BBG_SERVICE_SATISFACTION,
   BBG_REFERENCE_DO1,
   BBG_REFERENCE_DO2,
   BBG_REFERENCE_DO3,
   BBG_REFERENCE_DO4,
   BBG_REFERENCE_DO5,
   BBG_REFERENCE_FO1,
   BBG_REFERENCE_FO2,
   BBG_REFERENCE_FO3,
   BBG_REFERENCE_FO4,
   BBG_REFERENCE_FO5,
   BBG_REFERENCE_FO6,
   BBG_REFERENCE_FO7,
   BBG_REFERENCE_FO8,
   BBG_REFERENCE_FO9,
   BBG_REFERENCE_FO10,
   VIP_SLS_QTY,
   VIP_SLS_AMT_LCL,
   VIP_SLS_PROFIT_AMT_LCL,
   VIP_SLS_MANUAL_MKDN_AMT_LCL,
   VIP_SLS_MANUAL_MKUP_AMT_LCL,
   VIP_SLS_TAX_AMT_LCL,
   VIP_SLS_EMP_DISC_AMT_LCL,
   VIP_SLS_MANUAL_COUNT,
   VIP_SLS_SCAN_COUNT,
   VIP_RET_QTY,
   VIP_RET_AMT_LCL,
   VIP_RET_PROFIT_AMT_LCL,
   VIP_RET_MANUAL_MKDN_AMT_LCL,
   VIP_RET_MANUAL_MKUP_AMT_LCL,
   VIP_RET_TAX_AMT_LCL,
   VIP_RET_EMP_DISC_AMT_LCL,
   VIP_RET_MANUAL_COUNT,
   VIP_RET_SCAN_COUNT,
   VIP_SLS_TRX_COUNT,
   VIP_RET_TRX_COUNT
   )
  select DISTINCT W_RTL_SLS_IT_LC_DY_TMP.ORG_WID,
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.ORG_SCD1_WID),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.VOUCHER_FLG),
                  W_RTL_SLS_IT_LC_DY_TMP.RTL_TYPE_WID,
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.EMPLOYEE_WID),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.ORG_LC_WID),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.ORG_DS_WID),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.ORG_RG_WID),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.ORG_AR_WID),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.ORG_CH_WID),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.PROD_DV_WID),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.PROD_GP_WID),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.PROD_DP_WID),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.PROD_CL_WID),
                  W_RTL_SLS_IT_LC_DY_TMP.PROD_SC_WID,
                  W_RTL_SLS_IT_LC_DY_TMP.DT_WID,
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.WK_WID),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.PR_WID),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.QT_WID),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.DAY_DT),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.WK_NUM),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.PR_NUM),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.QT_NUM),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.ORG_NUM),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.ORG_DS_NUM),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.ORG_RG_NUM),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.ORG_AR_NUM),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.ORG_CH_NUM),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.PROD_IT_NUM),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.PROD_SC_NUM),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.PROD_CL_NUM),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.PROD_DP_NUM),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.PROD_GP_NUM),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.PROD_DV_NUM),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.RTL_TYPE_CODE),
                  SUM(W_RTL_SLS_IT_LC_DY_TMP.SLS_QTY),
                  SUM(W_RTL_SLS_IT_LC_DY_TMP.SLS_AMT_LCL),
                  SUM(W_RTL_SLS_IT_LC_DY_TMP.SLS_PROFIT_AMT_LCL),
                  SUM(W_RTL_SLS_IT_LC_DY_TMP.SLS_MANUAL_MKDN_AMT_LCL),
                  SUM(W_RTL_SLS_IT_LC_DY_TMP.SLS_MANUAL_MKUP_AMT_LCL),
                  SUM(W_RTL_SLS_IT_LC_DY_TMP.SLS_TAX_AMT_LCL),
                  SUM(W_RTL_SLS_IT_LC_DY_TMP.SLS_EMP_DISC_AMT_LCL),
                  SUM(W_RTL_SLS_IT_LC_DY_TMP.SLS_MANUAL_COUNT),
                  SUM(W_RTL_SLS_IT_LC_DY_TMP.SLS_SCAN_COUNT),
                  SUM(W_RTL_SLS_IT_LC_DY_TMP.RET_QTY),
                  SUM(W_RTL_SLS_IT_LC_DY_TMP.RET_AMT_LCL),
                  SUM(W_RTL_SLS_IT_LC_DY_TMP.RET_PROFIT_AMT_LCL),
                  SUM(W_RTL_SLS_IT_LC_DY_TMP.RET_MANUAL_MKDN_AMT_LCL),
                  SUM(W_RTL_SLS_IT_LC_DY_TMP.RET_MANUAL_MKUP_AMT_LCL),
                  SUM(W_RTL_SLS_IT_LC_DY_TMP.RET_TAX_AMT_LCL),
                  SUM(W_RTL_SLS_IT_LC_DY_TMP.RET_EMP_DISC_AMT_LCL),
                  SUM(W_RTL_SLS_IT_LC_DY_TMP.RET_MANUAL_COUNT),
                  SUM(W_RTL_SLS_IT_LC_DY_TMP.RET_SCAN_COUNT),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.SLS_TRX_COUNT),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.RET_TRX_COUNT),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.AUX1_CHANGED_ON_DT),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.AUX2_CHANGED_ON_DT),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.AUX3_CHANGED_ON_DT),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.AUX4_CHANGED_ON_DT),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.CHANGED_BY_ID),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.CHANGED_ON_DT),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.CREATED_BY_ID),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.CREATED_ON_DT),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.DATASOURCE_NUM_ID),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.DELETE_FLG),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.DOC_CURR_CODE),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.GLOBAL1_EXCHANGE_RATE),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.GLOBAL2_EXCHANGE_RATE),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.GLOBAL3_EXCHANGE_RATE),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.LOC_CURR_CODE),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.LOC_EXCHANGE_RATE),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.TENANT_ID),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.X_CUSTOM),
                  W_RTL_SLS_IT_LC_DY_TMP.BBG_RETAIL_TYPE_WID,
                  sum(W_RTL_SLS_IT_LC_DY_TMP.BBG_CUSTOMER_COUNT),
                  avg(W_RTL_SLS_IT_LC_DY_TMP.BBG_SERVICE_SATISFACTION),
                  W_RTL_SLS_IT_LC_DY_TMP.BBG_REFERENCE_DO1,
                  W_RTL_SLS_IT_LC_DY_TMP.BBG_REFERENCE_DO2,
                  W_RTL_SLS_IT_LC_DY_TMP.BBG_REFERENCE_DO3,
                  W_RTL_SLS_IT_LC_DY_TMP.BBG_REFERENCE_DO4,
                  W_RTL_SLS_IT_LC_DY_TMP.BBG_REFERENCE_DO5,
                  SUM(W_RTL_SLS_IT_LC_DY_TMP.BBG_REFERENCE_FO1),
                  SUM(W_RTL_SLS_IT_LC_DY_TMP.BBG_REFERENCE_FO2),
                  W_RTL_SLS_IT_LC_DY_TMP.BBG_REFERENCE_FO3,
                  W_RTL_SLS_IT_LC_DY_TMP.BBG_REFERENCE_FO4,
                  W_RTL_SLS_IT_LC_DY_TMP.BBG_REFERENCE_FO5,
                  W_RTL_SLS_IT_LC_DY_TMP.BBG_REFERENCE_FO6,
                  W_RTL_SLS_IT_LC_DY_TMP.BBG_REFERENCE_FO7,
                  W_RTL_SLS_IT_LC_DY_TMP.BBG_REFERENCE_FO8,
                  W_RTL_SLS_IT_LC_DY_TMP.BBG_REFERENCE_FO9,
                  W_RTL_SLS_IT_LC_DY_TMP.BBG_REFERENCE_FO10,
                  SUM(W_RTL_SLS_IT_LC_DY_TMP.VIP_SLS_QTY),
                  SUM(W_RTL_SLS_IT_LC_DY_TMP.VIP_SLS_AMT_LCL),
                  SUM(W_RTL_SLS_IT_LC_DY_TMP.VIP_SLS_PROFIT_AMT_LCL),
                  SUM(W_RTL_SLS_IT_LC_DY_TMP.VIP_SLS_MANUAL_MKDN_AMT_LCL),
                  SUM(W_RTL_SLS_IT_LC_DY_TMP.VIP_SLS_MANUAL_MKUP_AMT_LCL),
                  SUM(W_RTL_SLS_IT_LC_DY_TMP.VIP_SLS_TAX_AMT_LCL),
                  SUM(W_RTL_SLS_IT_LC_DY_TMP.VIP_SLS_EMP_DISC_AMT_LCL),
                  SUM(W_RTL_SLS_IT_LC_DY_TMP.VIP_SLS_MANUAL_COUNT),
                  SUM(W_RTL_SLS_IT_LC_DY_TMP.VIP_SLS_SCAN_COUNT),
                  SUM(W_RTL_SLS_IT_LC_DY_TMP.VIP_RET_QTY),
                  SUM(W_RTL_SLS_IT_LC_DY_TMP.VIP_RET_AMT_LCL),
                  SUM(W_RTL_SLS_IT_LC_DY_TMP.VIP_RET_PROFIT_AMT_LCL),
                  SUM(W_RTL_SLS_IT_LC_DY_TMP.VIP_RET_MANUAL_MKDN_AMT_LCL),
                  SUM(W_RTL_SLS_IT_LC_DY_TMP.VIP_RET_MANUAL_MKUP_AMT_LCL),
                  SUM(W_RTL_SLS_IT_LC_DY_TMP.VIP_RET_TAX_AMT_LCL),
                  SUM(W_RTL_SLS_IT_LC_DY_TMP.VIP_RET_EMP_DISC_AMT_LCL),
                  SUM(W_RTL_SLS_IT_LC_DY_TMP.VIP_RET_MANUAL_COUNT),
                  SUM(W_RTL_SLS_IT_LC_DY_TMP.VIP_RET_SCAN_COUNT),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.VIP_SLS_TRX_COUNT),
                  MAX(W_RTL_SLS_IT_LC_DY_TMP.VIP_RET_TRX_COUNT)
    from RABATCHER.W_RTL_SLS_IT_LC_DY_TMP W_RTL_SLS_IT_LC_DY_TMP
   where (1 = 1)
   Group By W_RTL_SLS_IT_LC_DY_TMP.ORG_WID,
            W_RTL_SLS_IT_LC_DY_TMP.RTL_TYPE_WID,
            W_RTL_SLS_IT_LC_DY_TMP.PROD_SC_WID,
            W_RTL_SLS_IT_LC_DY_TMP.DT_WID,
            W_RTL_SLS_IT_LC_DY_TMP.BBG_RETAIL_TYPE_WID,
            W_RTL_SLS_IT_LC_DY_TMP.BBG_REFERENCE_DO1,
            W_RTL_SLS_IT_LC_DY_TMP.BBG_REFERENCE_DO2,
            W_RTL_SLS_IT_LC_DY_TMP.BBG_REFERENCE_DO3,
            W_RTL_SLS_IT_LC_DY_TMP.BBG_REFERENCE_DO4,
            W_RTL_SLS_IT_LC_DY_TMP.BBG_REFERENCE_DO5,
            W_RTL_SLS_IT_LC_DY_TMP.BBG_REFERENCE_FO3,
            W_RTL_SLS_IT_LC_DY_TMP.BBG_REFERENCE_FO4,
            W_RTL_SLS_IT_LC_DY_TMP.BBG_REFERENCE_FO5,
            W_RTL_SLS_IT_LC_DY_TMP.BBG_REFERENCE_FO6,
            W_RTL_SLS_IT_LC_DY_TMP.BBG_REFERENCE_FO7,
            W_RTL_SLS_IT_LC_DY_TMP.BBG_REFERENCE_FO8,
            W_RTL_SLS_IT_LC_DY_TMP.BBG_REFERENCE_FO9,
            W_RTL_SLS_IT_LC_DY_TMP.BBG_REFERENCE_FO10;
						COMMIT;
						
						
SELECT * FROM RABATCHER.W_RTL_SLS_SC_LC_DY_TMP;
SELECT * FROM RABATCHER.W_RTL_SLS_IT_LC_DY_TMP;
