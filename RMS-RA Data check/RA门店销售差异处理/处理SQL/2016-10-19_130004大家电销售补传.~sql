--1.
SELECT /*+PARALLEL(16)*/ *
  FROM RADM.W_RTL_SLS_TRX_IT_LC_DY_FS_BAK T
 WHERE T.DAY_DT = DATE '2016-10-19'
   AND NOT EXISTS
 (SELECT 1
          FROM RABATCHER.W_RTL_SLS_TRX_IT_LC_DY_TMP_BK S
         WHERE S.DAY_DT = DATE '2016-10-19'
           AND T.ORG_NUM = S.ORG_NUM
           AND T.PROD_IT_NUM = S.PROD_IT_NUM);
					 
SELECT * FROM RADM.BBG_RA_ITEM_LOC_D T WHERE T.ITEM='2400072014704' AND T.LOC='130004';
SELECT * FROM RADM.BBG_RA_ITEM_LOC_D T WHERE T.ITEM='2400072023069' AND T.LOC='130004';
SELECT * FROM RADM.BBG_RA_ITEM_LOC_D T WHERE T.ITEM='2400072023058' AND T.LOC='130004';

--2.
CALL bbg_jl_item_loc_new_proc(new_loc => 130004);
SELECT * FROM RADM.BBG_RA_ITEM_LOC_DS;
TRUNCATE TABLE RADM.C_LOAD_DATES;


--3.SIL
TRUNCATE TABLE RADM.W_RTL_SLS_TRX_IT_LC_DY_FS;
INSERT INTO RADM.W_RTL_SLS_TRX_IT_LC_DY_FS
  SELECT *
    FROM RADM.W_RTL_SLS_TRX_IT_LC_DY_FS_BAK T
   WHERE T.DAY_DT = DATE
   '2016-10-19'
     AND ((T.ORG_NUM = '130004' AND T.PROD_IT_NUM = '2400072014704') OR
         (T.ORG_NUM = '130004' AND T.PROD_IT_NUM = '2400072023069') OR
         (T.ORG_NUM = '130004' AND T.PROD_IT_NUM = '2400072023058'));
COMMIT;
TRUNCATE TABLE RADM.C_LOAD_DATES;
--4.PLP
SELECT * FROM RABATCHER.W_RTL_SLS_TRX_IT_LC_DY_TMP;
--5.SUPP SALES
SELECT *
  FROM RADM.BBG_RA_SLS_IT_LC_DY_A T
 WHERE T.DT_WID = 120161019000
   AND T.ORG_WID = 178
   AND T.PROD_WID IN (8809597, 8809594, 8809593);

TRUNCATE TABLE RADM.BBG_RA_SLS_IT_LC_DY_FS;
INSERT INTO RADM.BBG_RA_SLS_IT_LC_DY_FS
  (DAY_DT,
   PROD_IT_NUM,
   ORG_NUM,
   SUPPLIER_NUM,
   SUPP_SALES_QTY,
   SUPP_SALES_COST,
   SUPP_SALES_AMT,
   CHANGED_BY_ID,
   CHANGED_ON_DT,
   CREATED_BY_ID,
   CREATED_ON_DT,
   DATASOURCE_NUM_ID,
   DELETE_FLG,
   ETL_THREAD_VAL,
   INTEGRATION_ID,
   AUX1_CHANGED_ON_DT,
   AUX2_CHANGED_ON_DT,
   AUX3_CHANGED_ON_DT,
   AUX4_CHANGED_ON_DT,
   DOC_CURR_CODE,
   GLOBAL1_EXCHANGE_RATE,
   GLOBAL2_EXCHANGE_RATE,
   GLOBAL3_EXCHANGE_RATE,
   LOC_CURR_CODE,
   LOC_EXCHANGE_RATE,
   TENANT_ID,
   X_CUSTOM,
   BBG_REFERENCE_DO1,
   BBG_REFERENCE_DO2,
   BBG_REFERENCE_DO3,
   BBG_REFERENCE_DO4,
   BBG_REFERENCE_DO5,
   BBG_REFERENCE_FO1,
   BBG_REFERENCE_FO2,
   BBG_REFERENCE_FO3,
   BBG_REFERENCE_FO4,
   BBG_REFERENCE_FO5,
   BBG_REFERENCE_FO6,
   BBG_REFERENCE_FO7,
   BBG_REFERENCE_FO8,
   BBG_REFERENCE_FO9,
   BBG_REFERENCE_FO10)
  SELECT T.DAY_DT,
         T.PROD_IT_NUM,
         T.ORG_NUM,
         T.SUPPLIER_NUM,
         T.SUPP_SALES_QTY,
         T.SUPP_SALES_COST,
         T.SUPP_SALES_AMT,
         -1 CHANGED_BY_ID,
         SYSDATE CHANGED_ON_DT,
         -1 CREATED_BY_ID,
         SYSDATE CREATED_ON_DT,
         1 DATASOURCE_NUM_ID,
         NULL DELETE_FLG,
         (SELECT L.THREAD_VAL
            FROM RA_RMS.RA_RESTART_LOC@RA_RMS_DBLINK L
           WHERE T.ORG_NUM = L.DRIVER_VALUE
             AND L.SCENARIO_NAME = 'SDE_BBG_RA_SUPP_SALES_IT_LC_DY_FS') ETL_THREAD_VAL,
         TO_CHAR(T.DAY_DT, 'DD-MON-YY', 'NLS_DATE_LANGUAGE = American') || '~' ||
         T.PROD_IT_NUM || '~' || T.ORG_NUM || '~' || T.SUPPLIER_NUM INTEGRATION_ID,
         NULL AUX1_CHANGED_ON_DT,
         NULL AUX2_CHANGED_ON_DT,
         NULL AUX3_CHANGED_ON_DT,
         NULL AUX4_CHANGED_ON_DT,
         'CNY' DOC_CURR_CODE,
         NULL GLOBAL1_EXCHANGE_RATE,
         NULL GLOBAL2_EXCHANGE_RATE,
         NULL GLOBAL3_EXCHANGE_RATE,
         'CNY' LOC_CURR_CODE,
         NULL LOC_EXCHANGE_RATE,
         NULL TENANT_ID,
         NULL X_CUSTOM,
         (SELECT IL.BUSINESS_MODE
            FROM RADM.BBG_RA_ITEM_LOC_D IL
           WHERE IL.ITEM = T.PROD_IT_NUM
             AND IL.LOC = T.ORG_NUM
             AND T.DAY_DT BETWEEN IL.EFFECTIVE_FROM_DT AND
                 IL.EFFECTIVE_TO_DT) BBG_REFERENCE_DO1,
         'JINLI' BBG_REFERENCE_DO2,
         NULL BBG_REFERENCE_DO3,
         NULL BBG_REFERENCE_DO4,
         NULL BBG_REFERENCE_DO5,
         T.BBG_REFERENCE_FO1 BBG_REFERENCE_FO1,
         NULL BBG_REFERENCE_FO2,
         NULL BBG_REFERENCE_FO3,
         NULL BBG_REFERENCE_FO4,
         NULL BBG_REFERENCE_FO5,
         NULL BBG_REFERENCE_FO6,
         NULL BBG_REFERENCE_FO7,
         NULL BBG_REFERENCE_FO8,
         NULL BBG_REFERENCE_FO9,
         NULL BBG_REFERENCE_FO10
    FROM RADM.BBG_RA_SUPP_JL_VIEW T
   WHERE T.DAY_DT = DATE
   '2016-10-19'
     AND T.ORG_NUM = '130004'
     AND T.PROD_IT_NUM IN (2400072014704, 2400072023069, 2400072023058);
COMMIT;

--6.

--7.

--8.

--9.

