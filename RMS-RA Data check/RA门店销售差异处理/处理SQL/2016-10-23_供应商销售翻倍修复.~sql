--1.定位问题点
SELECT /*+PARALLEL(16)*/
 SUM(T.SUPP_SALES_QTY), SUM(T.SUPP_SALES_COST), SUM(T.SUPP_SALES_AMT)
  FROM RADM.BBG_RA_SUPP_SALES_IT_LC_DY_F T
 WHERE T.DT_WID = &DTWID;

SELECT /*+PARALLEL(16)*/
 SUM(T.SUPP_SALES_QTY), SUM(T.SUPP_SALES_COST), SUM(T.SUPP_SALES_AMT)
  FROM RADM.BBG_RA_SLS_SC_LC_DY_CUR_A T
 WHERE T.DT_WID = &DTWID;

SELECT /*+PARALLEL(16)*/
 SUM(T.SUPP_SALES_QTY), SUM(T.SUPP_SALES_COST), SUM(T.SUPP_SALES_AMT)
  FROM RADM.BBG_RA_SLS_SC_LC_DY_A T
 WHERE T.DT_WID = &DTWID;

SELECT /*+PARALLEL(16)*/
 SUM(T.SUPP_SALES_QTY), SUM(T.SUPP_SALES_COST), SUM(T.SUPP_SALES_AMT)
  FROM RADM.BBG_RA_SLS_SC_DY_CUR_A T
 WHERE T.DT_WID = &DTWID;

SELECT /*+PARALLEL(16)*/
 SUM(T.SUPP_SALES_QTY), SUM(T.SUPP_SALES_COST), SUM(T.SUPP_SALES_AMT)
  FROM RADM.BBG_RA_SLS_SC_DY_A T
 WHERE T.DT_WID = &DTWID;

SELECT /*+PARALLEL(16)*/
 SUM(T.SUPP_SALES_QTY), SUM(T.SUPP_SALES_COST), SUM(T.SUPP_SALES_AMT)
  FROM RADM.BBG_RA_SLS_LC_DY_A T
 WHERE T.DT_WID = &DTWID;

SELECT /*+PARALLEL(16)*/
 SUM(T.SUPP_SALES_QTY), SUM(T.SUPP_SALES_COST), SUM(T.SUPP_SALES_AMT)
  FROM RADM.BBG_RA_SLS_IT_LC_DY_SN_A T
 WHERE T.DT_WID = &DTWID;

SELECT /*+PARALLEL(16)*/
 SUM(T.SUPP_SALES_QTY), SUM(T.SUPP_SALES_COST), SUM(T.SUPP_SALES_AMT)
  FROM RADM.BBG_RA_SLS_IT_LC_DY_A T
 WHERE T.DT_WID = &DTWID;

SELECT /*+PARALLEL(16)*/
 SUM(T.SUPP_SALES_QTY), SUM(T.SUPP_SALES_COST), SUM(T.SUPP_SALES_AMT)
  FROM RADM. BBG_RA_SLS_IT_DY_SN_A T
 WHERE T.DT_WID = &DTWID;

SELECT /*+PARALLEL(16)*/
 SUM(T.SUPP_SALES_QTY), SUM(T.SUPP_SALES_COST), SUM(T.SUPP_SALES_AMT)
  FROM RADM.BBG_RA_SLS_IT_DY_A T
 WHERE T.DT_WID = &DTWID;

SELECT /*+PARALLEL(16)*/
 SUM(T.SUPP_SALES_QTY), SUM(T.SUPP_SALES_COST), SUM(T.SUPP_SALES_AMT)
  FROM RADM.BBG_RA_SLS_DP_LC_DY_CUR_A T
 WHERE T.DT_WID = &DTWID;

SELECT /*+PARALLEL(16)*/
 SUM(T.SUPP_SALES_QTY), SUM(T.SUPP_SALES_COST), SUM(T.SUPP_SALES_AMT)
  FROM RADM.BBG_RA_SLS_DP_LC_DY_A T
 WHERE T.DT_WID = &DTWID;

SELECT /*+PARALLEL(16)*/
 SUM(T.SUPP_SALES_QTY), SUM(T.SUPP_SALES_COST), SUM(T.SUPP_SALES_AMT)
  FROM RADM.BBG_RA_SLS_DP_DY_CUR_A T
 WHERE T.DT_WID = &DTWID;

SELECT /*+PARALLEL(16)*/
 SUM(T.SUPP_SALES_QTY), SUM(T.SUPP_SALES_COST), SUM(T.SUPP_SALES_AMT)
  FROM RADM. BBG_RA_SLS_CL_LC_DY_CUR_A T
 WHERE T.DT_WID = &DTWID;

SELECT /*+PARALLEL(16)*/
 SUM(T.SUPP_SALES_QTY), SUM(T.SUPP_SALES_COST), SUM(T.SUPP_SALES_AMT)
  FROM RADM.BBG_RA_SLS_CL_LC_DY_A T
 WHERE T.DT_WID = &DTWID;

SELECT /*+PARALLEL(16)*/
 SUM(T.SUPP_SALES_QTY), SUM(T.SUPP_SALES_COST), SUM(T.SUPP_SALES_AMT)
  FROM RADM.BBG_RA_SLS_CL_DY_CUR_A T
 WHERE T.DT_WID = &DTWID;

--2.BBG_RA_SLS_IT_LC_DY_A,BBG_RA_SLS_IT_DY_A,
SELECT /*+PARALLEL(16)*/
 SUM(T.SUPP_SALES_QTY),
 SUM(T.SUPP_SALES_COST),
 SUM(T.SUPP_SALES_AMT),
 SUM(T.BBG_REFERENCE_FO1)
  FROM RADM.BBG_RA_SUPP_SALES_IT_LC_DY_F T
 WHERE T.DT_WID = &DTWID;

SELECT /*+PARALLEL(16)*/
 SUM(T.SUPP_SALES_QTY),
 SUM(T.SUPP_SALES_COST),
 SUM(T.SUPP_SALES_AMT),
 SUM(T.BBG_REFERENCE_FO1)
  FROM RADM.BBG_RA_SLS_IT_LC_DY_A T
 WHERE T.DT_WID = &DTWID;

SELECT /*+PARALLEL(16)*/
 SUM(T.SUPP_SALES_QTY),
 SUM(T.SUPP_SALES_COST),
 SUM(T.SUPP_SALES_AMT),
 SUM(T.BBG_REFERENCE_FO1)
  FROM RADM.BBG_RA_SLS_IT_DY_A T
 WHERE T.DT_WID = &DTWID;

--3.
ALTER TABLE RADM.BBG_RA_SLS_IT_LC_DY_A NOLOGGING;
UPDATE /*+PARALLEL(8)*/ RADM.BBG_RA_SLS_IT_LC_DY_A T
   SET T.SUPP_SALES_QTY  = T.SUPP_SALES_QTY / 2,
       T.SUPP_SALES_COST = T.SUPP_SALES_COST / 2,
       T.SUPP_SALES_AMT  = T.SUPP_SALES_AMT / 2
 WHERE T.DT_WID = &DTWID;
ALTER TABLE RADM.BBG_RA_SLS_IT_LC_DY_A LOGGING;
COMMIT;

ALTER TABLE RADM.BBG_RA_SLS_IT_DY_A NOLOGGING;
UPDATE /*+PARALLEL(8)*/ RADM.BBG_RA_SLS_IT_DY_A T
   SET T.SUPP_SALES_QTY  = T.SUPP_SALES_QTY / 2,
       T.SUPP_SALES_COST = T.SUPP_SALES_COST / 2,
       T.SUPP_SALES_AMT  = T.SUPP_SALES_AMT / 2
 WHERE T.DT_WID = &DTWID;
ALTER TABLE RADM.BBG_RA_SLS_IT_DY_A NOLOGGING;
COMMIT;
--4.
