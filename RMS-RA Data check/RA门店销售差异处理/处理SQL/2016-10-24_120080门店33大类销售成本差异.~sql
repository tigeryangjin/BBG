--confirm difference item_loc
--2016.10.23,33_dept,120080_loc,800230985_item
--1.
SELECT *
  FROM TRAN_DATA_HISTORY T
 WHERE T.TRAN_DATE = DATE '2016-10-23'
   AND T.LOCATION = 120080
   AND T.ITEM = '800230985'
   AND T.TRAN_CODE = 3;
SELECT *
  FROM RA_RMS.BBG_RA_ITEM_LOC_SOH_V T
 WHERE T.TRAN_DATE = DATE '2016-10-23'
   AND T.LOCATION = 120080
   AND T.ITEM = '800230985';
SELECT *
  FROM RA_RMS.W_RTL_SLS_TRX_TMP T
 WHERE T.ORG_NUM = 120080
   AND T.PROD_IT_NUM = '800230985';
SELECT *
  FROM W_RTL_SLS_TRX_IT_LC_DY_FS@RMS_RA T
 WHERE T.ORG_NUM = 120080
   AND T.PROD_IT_NUM = '800230985';

--2.
SELECT *
  FROM (SELECT /*+PARALLEL(16)*/
         T.TRAN_DATE,
         T.TRAN_CODE,
         T.LOCATION,
         T.ITEM,
         SUM(T.UNITS) UNITS,
         SUM(T.TOTAL_COST) TOTAL_COST
          FROM TRAN_DATA_HISTORY T
         WHERE T.TRAN_DATE = DATE '2016-10-23'
           AND T.TRAN_CODE = 3
         GROUP BY T.TRAN_DATE, T.TRAN_CODE, T.LOCATION, T.ITEM) A
 WHERE A.UNITS < 0
   AND A.TOTAL_COST > 0;
--3.

--4.

--5.

TRUNCATE TABLE RA_RMS.C_LOAD_DATES;
