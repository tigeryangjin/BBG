--1.
DELETE RADM.BBG_RA_SLS_LC_DY_A T WHERE T.DT_WID = 120170101000;
COMMIT;
--2.
merge /*+ APPEND */
into RADM.BBG_RA_SLS_LC_DY_A T
using (Select /*+ APPEND */
        BBG_RA_SLS_LC_DY_TMP.ORG_WID ORG_WID,
        MAX(BBG_RA_SLS_LC_DY_TMP.ORG_DH_WID) ORG_DH_WID,
        MAX(BBG_RA_SLS_LC_DY_TMP.ORG_SCD1_WID) ORG_SCD1_WID,
        BBG_RA_SLS_LC_DY_TMP.DT_WID DT_WID,
        BBG_RA_SLS_LC_DY_TMP.SUPPLIER_WID SUPPLIER_WID,
        MAX(BBG_RA_SLS_LC_DY_TMP.DATASOURCE_NUM_ID) DATASOURCE_NUM_ID,
        MAX(BBG_RA_SLS_LC_DY_TMP.DELETE_FLG) DELETE_FLG,
        MAX(BBG_RA_SLS_LC_DY_TMP.DOC_CURR_CODE) DOC_CURR_CODE,
        100 ETL_PROC_WID,
        MAX(BBG_RA_SLS_LC_DY_TMP.GLOBAL1_EXCHANGE_RATE) GLOBAL1_EXCHANGE_RATE,
        MAX(BBG_RA_SLS_LC_DY_TMP.GLOBAL2_EXCHANGE_RATE) GLOBAL2_EXCHANGE_RATE,
        MAX(BBG_RA_SLS_LC_DY_TMP.GLOBAL3_EXCHANGE_RATE) GLOBAL3_EXCHANGE_RATE,
        MAX(SUBSTR(BBG_RA_SLS_LC_DY_TMP.INTEGRATION_ID,
                   INSTR(BBG_RA_SLS_LC_DY_TMP.INTEGRATION_ID, '~', 1, 1) + 1,
                   6) || '~' ||
            SUBSTR(BBG_RA_SLS_LC_DY_TMP.INTEGRATION_ID,
                   INSTR(BBG_RA_SLS_LC_DY_TMP.INTEGRATION_ID, '~', 1, 2) + 1,
                   INSTR(BBG_RA_SLS_LC_DY_TMP.INTEGRATION_ID, '~', 1, 3) + 8 - 1)) INTEGRATION_ID,
        MAX(BBG_RA_SLS_LC_DY_TMP.LOC_CURR_CODE) LOC_CURR_CODE,
        MAX(BBG_RA_SLS_LC_DY_TMP.LOC_EXCHANGE_RATE) LOC_EXCHANGE_RATE,
        MAX(BBG_RA_SLS_LC_DY_TMP.TENANT_ID) TENANT_ID,
        SYSDATE W_INSERT_DT,
        SYSDATE W_UPDATE_DT,
        MAX(BBG_RA_SLS_LC_DY_TMP.X_CUSTOM) X_CUSTOM,
        BBG_RA_SLS_LC_DY_TMP.BBG_REFERENCE_DO1 BBG_REFERENCE_DO1,
        MAX(BBG_RA_SLS_LC_DY_TMP.BBG_REFERENCE_DO2) BBG_REFERENCE_DO2,
        MAX(BBG_RA_SLS_LC_DY_TMP.BBG_REFERENCE_DO3) BBG_REFERENCE_DO3,
        MAX(BBG_RA_SLS_LC_DY_TMP.BBG_REFERENCE_DO4) BBG_REFERENCE_DO4,
        MAX(BBG_RA_SLS_LC_DY_TMP.BBG_REFERENCE_DO5) BBG_REFERENCE_DO5,
        sum(BBG_RA_SLS_LC_DY_TMP.BBG_REFERENCE_FO1) BBG_REFERENCE_FO1,
        MAX(BBG_RA_SLS_LC_DY_TMP.BBG_REFERENCE_FO2) BBG_REFERENCE_FO2,
        MAX(BBG_RA_SLS_LC_DY_TMP.BBG_REFERENCE_FO3) BBG_REFERENCE_FO3,
        MAX(BBG_RA_SLS_LC_DY_TMP.BBG_REFERENCE_FO4) BBG_REFERENCE_FO4,
        MAX(BBG_RA_SLS_LC_DY_TMP.BBG_REFERENCE_FO5) BBG_REFERENCE_FO5,
        MAX(BBG_RA_SLS_LC_DY_TMP.BBG_REFERENCE_FO6) BBG_REFERENCE_FO6,
        MAX(BBG_RA_SLS_LC_DY_TMP.BBG_REFERENCE_FO7) BBG_REFERENCE_FO7,
        MAX(BBG_RA_SLS_LC_DY_TMP.BBG_REFERENCE_FO8) BBG_REFERENCE_FO8,
        MAX(BBG_RA_SLS_LC_DY_TMP.BBG_REFERENCE_FO9) BBG_REFERENCE_FO9,
        MAX(BBG_RA_SLS_LC_DY_TMP.BBG_REFERENCE_FO10) BBG_REFERENCE_FO10,
        SUM(BBG_RA_SLS_LC_DY_TMP.SUPP_SALES_QTY) SUPP_SALES_QTY,
        SUM(BBG_RA_SLS_LC_DY_TMP.SUPP_SALES_COST) SUPP_SALES_COST,
        SUM(BBG_RA_SLS_LC_DY_TMP.SUPP_SALES_AMT) SUPP_SALES_AMT
         From RADM.BBG_RA_SLS_IT_LC_DY_A BBG_RA_SLS_LC_DY_TMP
        Where (1 = 1)
          AND BBG_RA_SLS_LC_DY_TMP.DT_WID = &DTWID
        Group By BBG_RA_SLS_LC_DY_TMP.ORG_WID,
                 BBG_RA_SLS_LC_DY_TMP.DT_WID,
                 BBG_RA_SLS_LC_DY_TMP.SUPPLIER_WID,
                 BBG_RA_SLS_LC_DY_TMP.BBG_REFERENCE_DO1
       
       ) S
on (T.ORG_WID = S.ORG_WID and T.ORG_DH_WID = S.ORG_DH_WID and T.DT_WID = S.DT_WID and T.SUPPLIER_WID = S.SUPPLIER_WID)
when matched then
  update
     set T.ORG_SCD1_WID          = S.ORG_SCD1_WID,
         T.DATASOURCE_NUM_ID     = S.DATASOURCE_NUM_ID,
         T.DELETE_FLG            = S.DELETE_FLG,
         T.DOC_CURR_CODE         = S.DOC_CURR_CODE,
         T.ETL_PROC_WID          = S.ETL_PROC_WID,
         T.GLOBAL1_EXCHANGE_RATE = S.GLOBAL1_EXCHANGE_RATE,
         T.GLOBAL2_EXCHANGE_RATE = S.GLOBAL2_EXCHANGE_RATE,
         T.GLOBAL3_EXCHANGE_RATE = S.GLOBAL3_EXCHANGE_RATE,
         T.INTEGRATION_ID        = S.INTEGRATION_ID,
         T.LOC_CURR_CODE         = S.LOC_CURR_CODE,
         T.LOC_EXCHANGE_RATE     = S.LOC_EXCHANGE_RATE,
         T.TENANT_ID             = S.TENANT_ID,
         T.W_INSERT_DT           = S.W_INSERT_DT,
         T.W_UPDATE_DT           = S.W_UPDATE_DT,
         T.X_CUSTOM              = S.X_CUSTOM,
         T.BBG_REFERENCE_DO1     = S.BBG_REFERENCE_DO1,
         T.BBG_REFERENCE_DO2     = S.BBG_REFERENCE_DO2,
         T.BBG_REFERENCE_DO3     = S.BBG_REFERENCE_DO3,
         T.BBG_REFERENCE_DO4     = S.BBG_REFERENCE_DO4,
         T.BBG_REFERENCE_DO5     = S.BBG_REFERENCE_DO5,
         T.BBG_REFERENCE_FO1     = S.BBG_REFERENCE_FO1,
         T.BBG_REFERENCE_FO2     = S.BBG_REFERENCE_FO2,
         T.BBG_REFERENCE_FO3     = S.BBG_REFERENCE_FO3,
         T.BBG_REFERENCE_FO4     = S.BBG_REFERENCE_FO4,
         T.BBG_REFERENCE_FO5     = S.BBG_REFERENCE_FO5,
         T.BBG_REFERENCE_FO6     = S.BBG_REFERENCE_FO6,
         T.BBG_REFERENCE_FO7     = S.BBG_REFERENCE_FO7,
         T.BBG_REFERENCE_FO8     = S.BBG_REFERENCE_FO8,
         T.BBG_REFERENCE_FO9     = S.BBG_REFERENCE_FO9,
         T.BBG_REFERENCE_FO10    = S.BBG_REFERENCE_FO10,
         T.SUPP_SALES_QTY        = T.SUPP_SALES_QTY,
         T.SUPP_SALES_COST       = T.SUPP_SALES_COST,
         T.SUPP_SALES_AMT        = T.SUPP_SALES_AMT
  

when not matched then
  insert
    (
     
     T.ROW_WID,
     T.ORG_WID,
     T.ORG_DH_WID,
     T.ORG_SCD1_WID,
     T.DT_WID,
     T.SUPP_SALES_QTY,
     T.SUPP_SALES_COST,
     T.SUPP_SALES_AMT,
     T.SUPPLIER_WID,
     T.DATASOURCE_NUM_ID,
     T.DELETE_FLG,
     T.DOC_CURR_CODE,
     T.ETL_PROC_WID,
     T.GLOBAL1_EXCHANGE_RATE,
     T.GLOBAL2_EXCHANGE_RATE,
     T.GLOBAL3_EXCHANGE_RATE,
     T.INTEGRATION_ID,
     T.LOC_CURR_CODE,
     T.LOC_EXCHANGE_RATE,
     T.TENANT_ID,
     T.W_INSERT_DT,
     T.W_UPDATE_DT,
     T.X_CUSTOM,
     T.BBG_REFERENCE_DO1,
     T.BBG_REFERENCE_DO2,
     T.BBG_REFERENCE_DO3,
     T.BBG_REFERENCE_DO4,
     T.BBG_REFERENCE_DO5,
     T.BBG_REFERENCE_FO1,
     T.BBG_REFERENCE_FO2,
     T.BBG_REFERENCE_FO3,
     T.BBG_REFERENCE_FO4,
     T.BBG_REFERENCE_FO5,
     T.BBG_REFERENCE_FO6,
     T.BBG_REFERENCE_FO7,
     T.BBG_REFERENCE_FO8,
     T.BBG_REFERENCE_FO9,
     T.BBG_REFERENCE_FO10
     
     )
  values
    (
     
     RADM.BBG_RA_SLS_LC_DY_A_SEQ.NEXTVAL,
     S.ORG_WID,
     S.ORG_DH_WID,
     S.ORG_SCD1_WID,
     S.DT_WID,
     S.SUPP_SALES_QTY,
     S.SUPP_SALES_COST,
     S.SUPP_SALES_AMT,
     S.SUPPLIER_WID,
     S.DATASOURCE_NUM_ID,
     S.DELETE_FLG,
     S.DOC_CURR_CODE,
     S.ETL_PROC_WID,
     S.GLOBAL1_EXCHANGE_RATE,
     S.GLOBAL2_EXCHANGE_RATE,
     S.GLOBAL3_EXCHANGE_RATE,
     S.INTEGRATION_ID,
     S.LOC_CURR_CODE,
     S.LOC_EXCHANGE_RATE,
     S.TENANT_ID,
     S.W_INSERT_DT,
     S.W_UPDATE_DT,
     S.X_CUSTOM,
     S.BBG_REFERENCE_DO1,
     S.BBG_REFERENCE_DO2,
     S.BBG_REFERENCE_DO3,
     S.BBG_REFERENCE_DO4,
     S.BBG_REFERENCE_DO5,
     S.BBG_REFERENCE_FO1,
     S.BBG_REFERENCE_FO2,
     S.BBG_REFERENCE_FO3,
     S.BBG_REFERENCE_FO4,
     S.BBG_REFERENCE_FO5,
     S.BBG_REFERENCE_FO6,
     S.BBG_REFERENCE_FO7,
     S.BBG_REFERENCE_FO8,
     S.BBG_REFERENCE_FO9,
     S.BBG_REFERENCE_FO10
     
     );
COMMIT;
--3.
UPDATE /*+PARALLEL(20)*/ RADM.BBG_RA_SLS_LC_DY_A T
   SET T.SUPP_SALES_QTY    = T.SUPP_SALES_QTY * 2,
       T.SUPP_SALES_COST   = T.SUPP_SALES_COST * 2,
       T.SUPP_SALES_AMT    = T.SUPP_SALES_AMT * 2,
       T.BBG_REFERENCE_FO1 = T.BBG_REFERENCE_FO1 * 2
 WHERE T.DT_WID = 120170102000;
COMMIT;
--4.
MERGE /*+APPEND PARALLEL(16)*/
INTO RADM.BBG_RA_SLS_LC_MN_A T
USING (SELECT /*+PARALLEL(16)*/
        ORG_WID,
        MAX(ORG_DH_WID) ORG_DH_WID,
        MAX(ORG_SCD1_WID) ORG_SCD1_WID,
        SUPPLIER_WID,
        SUBSTR(TO_CHAR(DT_WID), 2, 6) MN_WID,
        MAX(SUBSTR(INTEGRATION_ID, 1, INSTR(INTEGRATION_ID, '~', 1, 1)) ||
            SUBSTR(TO_CHAR(DT_WID), 2, 6) ||
            SUBSTR(INTEGRATION_ID,
                   INSTR(INTEGRATION_ID, '~', 1, 2),
                   LENGTH(INTEGRATION_ID))) INTEGRATION_ID,
        SUM(NVL(SUPP_SALES_QTY, 0)) SUPP_SALES_QTY,
        SUM(NVL(SUPP_SALES_COST, 0)) SUPP_SALES_COST,
        SUM(NVL(SUPP_SALES_AMT, 0)) SUPP_SALES_AMT,
        SYSDATE W_INSERT_DT,
        SYSDATE W_UPDATE_DT,
        MAX(BBG_REFERENCE_DO1) BBG_REFERENCE_DO1,
        MAX(BBG_REFERENCE_DO2) BBG_REFERENCE_DO2,
        MAX(BBG_REFERENCE_DO3) BBG_REFERENCE_DO3,
        MAX(BBG_REFERENCE_DO4) BBG_REFERENCE_DO4,
        MAX(BBG_REFERENCE_DO5) BBG_REFERENCE_DO5,
        SUM(BBG_REFERENCE_FO1) BBG_REFERENCE_FO1,
        MAX(BBG_REFERENCE_FO2) BBG_REFERENCE_FO2,
        MAX(BBG_REFERENCE_FO3) BBG_REFERENCE_FO3,
        MAX(BBG_REFERENCE_FO4) BBG_REFERENCE_FO4,
        MAX(BBG_REFERENCE_FO5) BBG_REFERENCE_FO5,
        MAX(BBG_REFERENCE_FO6) BBG_REFERENCE_FO6,
        MAX(BBG_REFERENCE_FO7) BBG_REFERENCE_FO7,
        MAX(BBG_REFERENCE_FO8) BBG_REFERENCE_FO8,
        MAX(BBG_REFERENCE_FO9) BBG_REFERENCE_FO9,
        MAX(BBG_REFERENCE_FO10) BBG_REFERENCE_FO10
         FROM RADM.BBG_RA_SLS_LC_DY_A
        WHERE DT_WID BETWEEN 120170101000 AND 120170131000 
        GROUP BY ORG_WID, SUPPLIER_WID, SUBSTR(TO_CHAR(DT_WID), 2, 6)) S
ON (T.ORG_WID = S.ORG_WID AND T.SUPPLIER_WID = S.SUPPLIER_WID AND T.MN_WID = S.MN_WID)
WHEN MATCHED THEN
  UPDATE
     SET T.SUPP_SALES_QTY     = S.SUPP_SALES_QTY,
         T.SUPP_SALES_COST    = S.SUPP_SALES_COST,
         T.SUPP_SALES_AMT     = S.SUPP_SALES_AMT,
         T.W_UPDATE_DT        = S.W_UPDATE_DT,
         T.BBG_REFERENCE_FO1  = S.BBG_REFERENCE_FO1,
         T.BBG_REFERENCE_FO2  = S.BBG_REFERENCE_FO2,
         T.BBG_REFERENCE_FO3  = S.BBG_REFERENCE_FO3,
         T.BBG_REFERENCE_FO4  = S.BBG_REFERENCE_FO4,
         T.BBG_REFERENCE_FO5  = S.BBG_REFERENCE_FO5,
         T.BBG_REFERENCE_FO6  = S.BBG_REFERENCE_FO6,
         T.BBG_REFERENCE_FO7  = S.BBG_REFERENCE_FO7,
         T.BBG_REFERENCE_FO8  = S.BBG_REFERENCE_FO8,
         T.BBG_REFERENCE_FO9  = S.BBG_REFERENCE_FO9,
         T.BBG_REFERENCE_FO10 = S.BBG_REFERENCE_FO10
WHEN NOT MATCHED THEN
  INSERT
    (T.ORG_WID,
     T.ORG_DH_WID,
     T.ORG_SCD1_WID,
     T.SUPPLIER_WID,
     T.MN_WID,
     T.INTEGRATION_ID,
     T.SUPP_SALES_QTY,
     T.SUPP_SALES_COST,
     T.SUPP_SALES_AMT,
     T.W_INSERT_DT,
     T.W_UPDATE_DT,
     T.BBG_REFERENCE_DO1,
     T.BBG_REFERENCE_DO2,
     T.BBG_REFERENCE_DO3,
     T.BBG_REFERENCE_DO4,
     T.BBG_REFERENCE_DO5,
     T.BBG_REFERENCE_FO1,
     T.BBG_REFERENCE_FO2,
     T.BBG_REFERENCE_FO3,
     T.BBG_REFERENCE_FO4,
     T.BBG_REFERENCE_FO5,
     T.BBG_REFERENCE_FO6,
     T.BBG_REFERENCE_FO7,
     T.BBG_REFERENCE_FO8,
     T.BBG_REFERENCE_FO9,
     T.BBG_REFERENCE_FO10)
  VALUES
    (S.ORG_WID,
     S.ORG_DH_WID,
     S.ORG_SCD1_WID,
     S.SUPPLIER_WID,
     S.MN_WID,
     S.INTEGRATION_ID,
     S.SUPP_SALES_QTY,
     S.SUPP_SALES_COST,
     S.SUPP_SALES_AMT,
     S.W_INSERT_DT,
     S.W_UPDATE_DT,
     S.BBG_REFERENCE_DO1,
     S.BBG_REFERENCE_DO2,
     S.BBG_REFERENCE_DO3,
     S.BBG_REFERENCE_DO4,
     S.BBG_REFERENCE_DO5,
     S.BBG_REFERENCE_FO1,
     S.BBG_REFERENCE_FO2,
     S.BBG_REFERENCE_FO3,
     S.BBG_REFERENCE_FO4,
     S.BBG_REFERENCE_FO5,
     S.BBG_REFERENCE_FO6,
     S.BBG_REFERENCE_FO7,
     S.BBG_REFERENCE_FO8,
     S.BBG_REFERENCE_FO9,
     S.BBG_REFERENCE_FO10);
COMMIT;

--6.
UPDATE /*+PARALLEL(20)*/ RADM.BBG_RA_SLS_IT_DY_A T
   SET T.SUPP_SALES_QTY    = T.SUPP_SALES_QTY / 2,
       T.SUPP_SALES_COST   = T.SUPP_SALES_COST / 2,
       T.SUPP_SALES_AMT    = T.SUPP_SALES_AMT / 2,
       T.BBG_REFERENCE_FO1 = T.BBG_REFERENCE_FO1 / 2
 WHERE T.DT_WID = 120170102000;
COMMIT;

--7.
DELETE /*+PARALLEL(24)*/
RADM.BBG_RA_SLS_IT_DY_A T
 WHERE T.DT_WID = 120170101000;
COMMIT;
MERGE /*+ APPEND */
INTO RADM.BBG_RA_SLS_IT_DY_A T
USING (SELECT T.PROD_WID,
              MAX(T.PROD_SCD1_WID) PROD_SCD1_WID,
              T.DT_WID,
              MAX(T.DATASOURCE_NUM_ID) DATASOURCE_NUM_ID,
              MAX(T.DELETE_FLG) DELETE_FLG,
              MAX(T.ETL_PROC_WID) ETL_PROC_WID,
              MAX(SUBSTR(T.INTEGRATION_ID,
                         0,
                         INSTR(T.INTEGRATION_ID, '~', 1, 1)) ||
                  SUBSTR(T.INTEGRATION_ID,
                         INSTR(T.INTEGRATION_ID, '~', 1, 2) + 1,
                         INSTR(T.INTEGRATION_ID, '~', 1, 3) + 8 - 1)) INTEGRATION_ID,
              MAX(T.INTEGRATION_ID),
              MAX(T.TENANT_ID) TENANT_ID,
              MAX(T.X_CUSTOM) X_CUSTOM,
              T.SUPPLIER_WID,
              SUM(T.SUPP_SALES_QTY) SUPP_SALES_QTY,
              SUM(T.SUPP_SALES_COST) SUPP_SALES_COST,
              SUM(T.SUPP_SALES_AMT) SUPP_SALES_AMT,
              SYSDATE W_INSERT_DT,
              SYSDATE W_UPDATE_DT,
              MAX(T.BBG_REFERENCE_DO1) BBG_REFERENCE_DO1,
              MAX(T.BBG_REFERENCE_DO2) BBG_REFERENCE_DO2,
              MAX(T.BBG_REFERENCE_DO3) BBG_REFERENCE_DO3,
              MAX(T.BBG_REFERENCE_DO4) BBG_REFERENCE_DO4,
              MAX(T.BBG_REFERENCE_DO5) BBG_REFERENCE_DO5,
              SUM(T.BBG_REFERENCE_FO1) BBG_REFERENCE_FO1,
              SUM(T.BBG_REFERENCE_FO2) BBG_REFERENCE_FO2,
              SUM(T.BBG_REFERENCE_FO3) BBG_REFERENCE_FO3,
              SUM(T.BBG_REFERENCE_FO4) BBG_REFERENCE_FO4,
              SUM(T.BBG_REFERENCE_FO5) BBG_REFERENCE_FO5,
              SUM(T.BBG_REFERENCE_FO6) BBG_REFERENCE_FO6,
              SUM(T.BBG_REFERENCE_FO7) BBG_REFERENCE_FO7,
              SUM(T.BBG_REFERENCE_FO8) BBG_REFERENCE_FO8,
              SUM(T.BBG_REFERENCE_FO9) BBG_REFERENCE_FO9,
              SUM(T.BBG_REFERENCE_FO10) BBG_REFERENCE_FO10
         FROM RADM.BBG_RA_SLS_IT_LC_DY_A T
        WHERE T.DT_WID = 120170101000
        GROUP BY T.PROD_WID, T.DT_WID, T.SUPPLIER_WID) S
ON (T.PROD_WID = S.PROD_WID AND T.DT_WID = S.DT_WID AND T.SUPPLIER_WID = S.SUPPLIER_WID)
WHEN MATCHED THEN
  UPDATE
     SET T.PROD_SCD1_WID      = S.PROD_SCD1_WID,
         T.DATASOURCE_NUM_ID  = S.DATASOURCE_NUM_ID,
         T.DELETE_FLG         = S.DELETE_FLG,
         T.ETL_PROC_WID       = S.ETL_PROC_WID,
         T.INTEGRATION_ID     = S.INTEGRATION_ID,
         T.TENANT_ID          = S.TENANT_ID,
         T.W_INSERT_DT        = S.W_INSERT_DT,
         T.W_UPDATE_DT        = S.W_UPDATE_DT,
         T.X_CUSTOM           = S.X_CUSTOM,
         T.BBG_REFERENCE_DO1  = S.BBG_REFERENCE_DO1,
         T.BBG_REFERENCE_DO2  = S.BBG_REFERENCE_DO2,
         T.BBG_REFERENCE_DO3  = S.BBG_REFERENCE_DO3,
         T.BBG_REFERENCE_DO4  = S.BBG_REFERENCE_DO4,
         T.BBG_REFERENCE_DO5  = S.BBG_REFERENCE_DO5,
         T.BBG_REFERENCE_FO1  = S.BBG_REFERENCE_FO1,
         T.BBG_REFERENCE_FO2  = S.BBG_REFERENCE_FO2,
         T.BBG_REFERENCE_FO3  = S.BBG_REFERENCE_FO3,
         T.BBG_REFERENCE_FO4  = S.BBG_REFERENCE_FO4,
         T.BBG_REFERENCE_FO5  = S.BBG_REFERENCE_FO5,
         T.BBG_REFERENCE_FO6  = S.BBG_REFERENCE_FO6,
         T.BBG_REFERENCE_FO7  = S.BBG_REFERENCE_FO7,
         T.BBG_REFERENCE_FO8  = S.BBG_REFERENCE_FO8,
         T.BBG_REFERENCE_FO9  = S.BBG_REFERENCE_FO9,
         T.BBG_REFERENCE_FO10 = S.BBG_REFERENCE_FO10,
         T.SUPP_SALES_QTY     = S.SUPP_SALES_QTY + T.SUPP_SALES_QTY,
         T.SUPP_SALES_COST    = S.SUPP_SALES_COST + T.SUPP_SALES_COST,
         T.SUPP_SALES_AMT     = S.SUPP_SALES_AMT + T.SUPP_SALES_AMT
WHEN NOT MATCHED THEN
  INSERT
    (T.ROW_WID,
     T.PROD_WID,
     T.PROD_SCD1_WID,
     T.DT_WID,
     T.DATASOURCE_NUM_ID,
     T.DELETE_FLG,
     T.ETL_PROC_WID,
     T.INTEGRATION_ID,
     T.TENANT_ID,
     T.W_INSERT_DT,
     T.W_UPDATE_DT,
     T.X_CUSTOM,
     T.SUPPLIER_WID,
     T.SUPP_SALES_QTY,
     T.SUPP_SALES_COST,
     T.SUPP_SALES_AMT,
     T.BBG_REFERENCE_DO1,
     T.BBG_REFERENCE_DO2,
     T.BBG_REFERENCE_DO3,
     T.BBG_REFERENCE_DO4,
     T.BBG_REFERENCE_DO5,
     T.BBG_REFERENCE_FO1,
     T.BBG_REFERENCE_FO2,
     T.BBG_REFERENCE_FO3,
     T.BBG_REFERENCE_FO4,
     T.BBG_REFERENCE_FO5,
     T.BBG_REFERENCE_FO6,
     T.BBG_REFERENCE_FO7,
     T.BBG_REFERENCE_FO8,
     T.BBG_REFERENCE_FO9,
     T.BBG_REFERENCE_FO10)
  VALUES
    (RADM.BBG_RA_SLS_IT_DY_A_SEQ.NEXTVAL,
     S.PROD_WID,
     S.PROD_SCD1_WID,
     S.DT_WID,
     S.DATASOURCE_NUM_ID,
     S.DELETE_FLG,
     S.ETL_PROC_WID,
     S.INTEGRATION_ID,
     S.TENANT_ID,
     S.W_INSERT_DT,
     S.W_UPDATE_DT,
     S.X_CUSTOM,
     S.SUPPLIER_WID,
     S.SUPP_SALES_QTY,
     S.SUPP_SALES_COST,
     S.SUPP_SALES_AMT,
     S.BBG_REFERENCE_DO1,
     S.BBG_REFERENCE_DO2,
     S.BBG_REFERENCE_DO3,
     S.BBG_REFERENCE_DO4,
     S.BBG_REFERENCE_DO5,
     S.BBG_REFERENCE_FO1,
     S.BBG_REFERENCE_FO2,
     S.BBG_REFERENCE_FO3,
     S.BBG_REFERENCE_FO4,
     S.BBG_REFERENCE_FO5,
     S.BBG_REFERENCE_FO6,
     S.BBG_REFERENCE_FO7,
     S.BBG_REFERENCE_FO8,
     S.BBG_REFERENCE_FO9,
     S.BBG_REFERENCE_FO10);
COMMIT;








--5.
