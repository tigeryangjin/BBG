/*
W_RTL_SUPPCM_IT_LC_DY_F-->W_RTL_SUPPCM_IT_LC_DY_FV-->W_RTL_SUPPCM_IT_LC_DY_MV

W_RTL_SUPPCM_IT_LC_DY_MV-->W_RTL_SUPPCM_IT_LC_ED_FV-->W_RTL_SUPPCM_IT_LC_ED_MV
                        -->W_RTL_SUPPCM_IT_LC_AD_FV-->W_RTL_SUPPCM_IT_LC_AD_MV
												-->W_RTL_SUPPCM_IT_LC_TD_FV-->W_RTL_SUPPCM_IT_LC_TD_MV
1.W_RTL_SUPPCM_IT_LC_AD_FV(订单审批日期)
2.W_RTL_SUPPCM_IT_LC_ED_FV(订单失效日期)
3.W_RTL_SUPPCM_IT_LC_TD_FV(订单收货日期)
*/

--1.W_RTL_SUPPCM_IT_LC_AD_FV--------------------------------------------------
CREATE OR REPLACE VIEW RADM.W_RTL_SUPPCM_IT_LC_AD_FV AS
SELECT T.ROW_WID,
         T.ORG_WID,
         T.ORG_SCD1_WID,
         T.ORG_DH_WID,
         T.PROD_WID,
         T.PROD_SCD1_WID,
         TO_NUMBER('1' || TO_CHAR(T.BBG_REFERENCE_DO3, 'YYYYMMDD') || '000') DT_WID,
         T.SUPPLIER_WID,
         T.PURCHASE_ORDER_ID,
         T.SHIPMENT_ID,
         T.ORDERED_QTY,
         T.RECEIVED_QTY,
         T.EXPECTED_QTY,
         T.PO_MET_COUNT,
         T.PO_UNDER_COUNT,
         T.PO_OVER_COUNT,
         T.PO_ABSENT_COUNT,
         T.SHIP_EARLY_COUNT,
         T.SHIP_LATE_COUNT,
         T.SHIP_ON_TIME_COUNT,
         T.DAYS_EARLY_SHIP,
         T.DAYS_LATE_SHIP,
         T.ASN_MET_COUNT,
         T.ASN_UNDER_COUNT,
         T.ASN_OVER_COUNT,
         T.DOC_CURR_CODE,
         T.LOC_CURR_CODE,
         T.LOC_EXCHANGE_RATE,
         T.GLOBAL1_EXCHANGE_RATE,
         T.GLOBAL2_EXCHANGE_RATE,
         T.GLOBAL3_EXCHANGE_RATE,
         T.CREATED_BY_WID,
         T.CHANGED_BY_WID,
         T.CREATED_ON_DT,
         T.CHANGED_ON_DT,
         T.AUX1_CHANGED_ON_DT,
         T.AUX2_CHANGED_ON_DT,
         T.AUX3_CHANGED_ON_DT,
         T.AUX4_CHANGED_ON_DT,
         T.DELETE_FLG,
         T.W_INSERT_DT,
         T.W_UPDATE_DT,
         T.DATASOURCE_NUM_ID,
         T.ETL_PROC_WID,
         T.INTEGRATION_ID,
         T.TENANT_ID,
         T.X_CUSTOM,
         T.BBG_ITEM_LOC_WID,
         T.BBG_ITEM_LOC_SUPP_WID,
				 T.BBG_REFERENCE_DO1,
				 T.BBG_REFERENCE_DO2,
				 T.BBG_REFERENCE_DO3,
				 T.BBG_REFERENCE_DO4,
				 T.BBG_REFERENCE_DO5,
				 T.BBG_REFERENCE_FO1,
				 T.BBG_REFERENCE_FO2,
				 T.BBG_REFERENCE_FO3,
				 T.BBG_REFERENCE_FO4,
				 T.BBG_REFERENCE_FO5,
				 T.BBG_REFERENCE_FO6,
				 T.BBG_REFERENCE_FO7,
				 T.BBG_REFERENCE_FO8,
				 T.BBG_REFERENCE_FO9,
				 T.BBG_REFERENCE_FO10
    FROM RADM.W_RTL_SUPPCM_IT_LC_DY_MV T;
--W_RTL_SUPPCM_IT_LC_AD_MV
CREATE MATERIALIZED VIEW RADM.W_RTL_SUPPCM_IT_LC_AD_MV AS
SELECT * 
FROM RADM.W_RTL_SUPPCM_IT_LC_AD_FV;

--2.W_RTL_SUPPCM_IT_LC_ED_FV------------------------------------------------------
CREATE OR REPLACE VIEW RADM.W_RTL_SUPPCM_IT_LC_ED_FV AS
SELECT T.ROW_WID,
         T.ORG_WID,
         T.ORG_SCD1_WID,
         T.ORG_DH_WID,
         T.PROD_WID,
         T.PROD_SCD1_WID,
         T.DT_WID,
				 T.SUPPLIER_WID,
				 T.PURCHASE_ORDER_ID,
				 T.SHIPMENT_ID,
				 T.ORDERED_QTY,
				 T.RECEIVED_QTY,
				 T.EXPECTED_QTY,
				 T.PO_MET_COUNT,
				 T.PO_UNDER_COUNT,
				 T.PO_OVER_COUNT,
				 T.PO_ABSENT_COUNT,
				 T.SHIP_EARLY_COUNT,
				 T.SHIP_LATE_COUNT,
				 T.SHIP_ON_TIME_COUNT,
				 T.DAYS_EARLY_SHIP,
				 T.DAYS_LATE_SHIP,
				 T.ASN_MET_COUNT,
				 T.ASN_UNDER_COUNT,
				 T.ASN_OVER_COUNT,
				 T.DOC_CURR_CODE,
				 T.LOC_CURR_CODE,
				 T.LOC_EXCHANGE_RATE,
				 T.GLOBAL1_EXCHANGE_RATE,
				 T.GLOBAL2_EXCHANGE_RATE,
				 T.GLOBAL3_EXCHANGE_RATE,
				 T.CREATED_BY_WID,
				 T.CHANGED_BY_WID,
				 T.CREATED_ON_DT,
				 T.CHANGED_ON_DT,
				 T.AUX1_CHANGED_ON_DT,
				 T.AUX2_CHANGED_ON_DT,
				 T.AUX3_CHANGED_ON_DT,
				 T.AUX4_CHANGED_ON_DT,
				 T.DELETE_FLG,
				 T.W_INSERT_DT,
				 T.W_UPDATE_DT,
				 T.DATASOURCE_NUM_ID,
				 T.ETL_PROC_WID,
				 T.INTEGRATION_ID,
				 T.TENANT_ID,
				 T.X_CUSTOM,
				 T.BBG_ITEM_LOC_WID,
				 T.BBG_ITEM_LOC_SUPP_WID,
				 T.BBG_REFERENCE_DO1,
				 T.BBG_REFERENCE_DO2,
				 T.BBG_REFERENCE_DO3,
				 T.BBG_REFERENCE_DO4,
				 T.BBG_REFERENCE_DO5,
				 T.BBG_REFERENCE_FO1,
				 T.BBG_REFERENCE_FO2,
				 T.BBG_REFERENCE_FO3,
				 T.BBG_REFERENCE_FO4,
				 T.BBG_REFERENCE_FO5,
				 T.BBG_REFERENCE_FO6,
				 T.BBG_REFERENCE_FO7,
				 T.BBG_REFERENCE_FO8,
				 T.BBG_REFERENCE_FO9,
				 T.BBG_REFERENCE_FO10
    FROM RADM.W_RTL_SUPPCM_IT_LC_DY_MV T;
--W_RTL_SUPPCM_IT_LC_ED_MV
CREATE MATERIALIZED VIEW RADM.W_RTL_SUPPCM_IT_LC_ED_MV AS
SELECT * 
FROM RADM.W_RTL_SUPPCM_IT_LC_ED_FV;

DROP MATERIALIZED VIEW RADM.W_RTL_SUPPCM_IT_LC_ED_MV;

--3.W_RTL_SUPPCM_IT_LC_TD_FV----------------------------------------------------
CREATE OR REPLACE VIEW RADM.W_RTL_SUPPCM_IT_LC_TD_FV AS
SELECT T.ROW_WID,
         T.ORG_WID,
         T.ORG_SCD1_WID,
         T.ORG_DH_WID,
         T.PROD_WID,
         T.PROD_SCD1_WID,
         TO_NUMBER('1' || TO_CHAR(T.BBG_REFERENCE_DO2, 'YYYYMMDD') || '000') DT_WID,
				 T.SUPPLIER_WID,
				 T.PURCHASE_ORDER_ID,
				 T.SHIPMENT_ID,
				 T.ORDERED_QTY,
				 T.RECEIVED_QTY,
				 T.EXPECTED_QTY,
				 T.PO_MET_COUNT,
				 T.PO_UNDER_COUNT,
				 T.PO_OVER_COUNT,
				 T.PO_ABSENT_COUNT,
				 T.SHIP_EARLY_COUNT,
				 T.SHIP_LATE_COUNT,
				 T.SHIP_ON_TIME_COUNT,
				 T.DAYS_EARLY_SHIP,
				 T.DAYS_LATE_SHIP,
				 T.ASN_MET_COUNT,
				 T.ASN_UNDER_COUNT,
				 T.ASN_OVER_COUNT,
				 T.DOC_CURR_CODE,
				 T.LOC_CURR_CODE,
				 T.LOC_EXCHANGE_RATE,
				 T.GLOBAL1_EXCHANGE_RATE,
				 T.GLOBAL2_EXCHANGE_RATE,
				 T.GLOBAL3_EXCHANGE_RATE,
				 T.CREATED_BY_WID,
				 T.CHANGED_BY_WID,
				 T.CREATED_ON_DT,
				 T.CHANGED_ON_DT,
				 T.AUX1_CHANGED_ON_DT,
				 T.AUX2_CHANGED_ON_DT,
				 T.AUX3_CHANGED_ON_DT,
				 T.AUX4_CHANGED_ON_DT,
				 T.DELETE_FLG,
				 T.W_INSERT_DT,
				 T.W_UPDATE_DT,
				 T.DATASOURCE_NUM_ID,
				 T.ETL_PROC_WID,
				 T.INTEGRATION_ID,
				 T.TENANT_ID,
				 T.X_CUSTOM,
				 T.BBG_ITEM_LOC_WID,
				 T.BBG_ITEM_LOC_SUPP_WID,
				 T.BBG_REFERENCE_DO1,
				 T.BBG_REFERENCE_DO2,
				 T.BBG_REFERENCE_DO3,
				 T.BBG_REFERENCE_DO4,
				 T.BBG_REFERENCE_DO5,
				 T.BBG_REFERENCE_FO1,
				 T.BBG_REFERENCE_FO2,
				 T.BBG_REFERENCE_FO3,
				 T.BBG_REFERENCE_FO4,
				 T.BBG_REFERENCE_FO5,
				 T.BBG_REFERENCE_FO6,
				 T.BBG_REFERENCE_FO7,
				 T.BBG_REFERENCE_FO8,
				 T.BBG_REFERENCE_FO9,
				 T.BBG_REFERENCE_FO10
    FROM RADM.W_RTL_SUPPCM_IT_LC_DY_MV T;
--W_RTL_SUPPCM_IT_LC_TD_MV		
CREATE MATERIALIZED VIEW RADM.W_RTL_SUPPCM_IT_LC_TD_MV AS
SELECT * 
FROM RADM.W_RTL_SUPPCM_IT_LC_TD_FV;

DROP MATERIALIZED VIEW RADM.W_RTL_SUPPCM_IT_LC_TD_MV;
