SELECT F.FOLDER_NAME, P.POP_NAME
  FROM ODI_WREP_USER.SNP_POP P, ODI_WREP_USER.SNP_FOLDER F
 WHERE P.I_FOLDER = F.I_FOLDER
   AND F.FOLDER_NAME IN
       ('BBG_SDE_Retail_SalesTransactionFact',
        'BBG_SDE_BBG_RA_SUPP_SALES_IT_LC_DY_F',
        'BBG_SIL_BBG_RA_SUPP_SALES_IT_LC_DY_F',
        'BBG_SIL_Retail_SalesTransactionFact',
        'BBG_PLP_Retail_Sales_Current_Aggregate_Fact',
        'BBG_PLP_Retail_Sales_Aggregate_Fact',
        'PLP_Retail_SUPP_Sales_Aggregate_Fact',
        'PLP_Retail_SUPP_Sales_Current_Aggregate_Fact')
 ORDER BY 1, 2;

--同一交易中的同一个商品是否存在二种不同的促销类型。
SELECT *
  FROM (SELECT T.*,
               RANK() OVER(PARTITION BY T.TRAN_SEQ_NO, T.ITEM_SEQ_NO ORDER BY T.TRAN_SEQ_NO, T.ITEM_SEQ_NO, T.RMS_PROMO_TYPE) RANK_NO
          FROM SA_TRAN_DISC T) A
 WHERE A.RANK_NO = 2
 ORDER BY A.TRAN_SEQ_NO, A.ITEM_SEQ_NO, A.RMS_PROMO_TYPE;
 
--修改字段模版
SELECT W_RTL_SLS_TRX_TMP_A.DAY_DT,
       W_RTL_SLS_TRX_TMP_A.ORG_NUM,
       W_RTL_SLS_TRX_TMP_A.SLS_TRX_ID,
       W_RTL_SLS_TRX_TMP_A.PROD_IT_NUM,
       MIN(W_RTL_SLS_TRX_TMP_A.TRX_AMT) TRX_AMT,
       SUM(W_RTL_SLS_TRX_TMP_A.DISC_AMT) DISC_AMT,
       MIN(W_RTL_SLS_TRX_TMP_A.ORIG_AMT) ORIG_AMT,
       MIN(W_RTL_SLS_TRX_TMP_A.TRX_AMT) +
       SUM(CASE
             WHEN W_RTL_SLS_TRX_TMP_A.PROMO_TYPE IN (50, 51, 52) THEN
              NVL(W_RTL_SLS_TRX_TMP_A.DISC_AMT, 0)
             ELSE
              0
           END)
  FROM RA_RMS.W_RTL_SLS_TRX_TMP_A W_RTL_SLS_TRX_TMP_A
 WHERE W_RTL_SLS_TRX_TMP_A.SLS_TRX_ID = '1575514110'
   AND W_RTL_SLS_TRX_TMP_A.IT_SEQ_NUM = 18
 GROUP BY W_RTL_SLS_TRX_TMP_A.DAY_DT,
          W_RTL_SLS_TRX_TMP_A.ORG_NUM,
          W_RTL_SLS_TRX_TMP_A.SLS_TRX_ID,
          W_RTL_SLS_TRX_TMP_A.PROD_IT_NUM;

--
SELECT *
  FROM RA_RMS.BBG_XTERN_RDWT R
 WHERE BUSINESS_DT = '20160620'
   AND R.TRANSACTION_HEADER_NO = '1575514110'
   AND R.SELLING_ITEM_ID = '800389385'
   AND LOCATION = '0000120033'
   AND R.ITEM_SEQ_NO = '18';
	 
SELECT * FROM SA_TRAN_HEAD T WHERE T.TRAN_SEQ_NO='1575514110' ;
SELECT * FROM SA_TRAN_ITEM T WHERE T.TRAN_SEQ_NO='1575514110' AND T.ITEM='800389385' AND T.ITEM_SEQ_NO=18;
SELECT * FROM SA_TRAN_DISC T WHERE T.TRAN_SEQ_NO='1575514110' AND T.ITEM_SEQ_NO=18;
SELECT * FROM RA_RMS.W_RTL_SLS_TRX_TMP_A T WHERE T.SLS_TRX_ID='1575514110' AND T.IT_SEQ_NUM=18;
SELECT * FROM RA_RMS.W_RTL_SLS_TRX_TMP T WHERE T.SLS_TRX_ID=1575514110 AND T.IT_SEQ_NUM=18;
