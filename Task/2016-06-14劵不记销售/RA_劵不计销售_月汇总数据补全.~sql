--1.W_RTL_SLS_SC_MN_A
MERGE /*+APPEND PARALLEL(16)*/
INTO RADM.W_RTL_SLS_SC_MN_A T
USING (SELECT /*+PARALLEL(16)*/
        PROD_DH_WID,
        SUBSTR(TO_CHAR(DT_WID), 2, 6) MN_WID,
        RTL_TYPE_WID,
        SUM(NVL(SLS_QTY, 0)) SLS_QTY,
        SUM(NVL(SLS_AMT_LCL, 0)) SLS_AMT_LCL,
        SUM(NVL(SLS_PROFIT_AMT_LCL, 0)) SLS_PROFIT_AMT_LCL,
        SUM(NVL(SLS_TAX_AMT_LCL, 0)) SLS_TAX_AMT_LCL,
        SUM(NVL(SLS_EMP_DISC_AMT_LCL, 0)) SLS_EMP_DISC_AMT_LCL,
        SUM(NVL(RET_QTY, 0)) RET_QTY,
        SUM(NVL(RET_AMT_LCL, 0)) RET_AMT_LCL,
        SUM(NVL(RET_PROFIT_AMT_LCL, 0)) RET_PROFIT_AMT_LCL,
        SUM(NVL(RET_TAX_AMT_LCL, 0)) RET_TAX_AMT_LCL,
        SUM(NVL(RET_EMP_DISC_AMT_LCL, 0)) RET_EMP_DISC_AMT_LCL,
        SUM(NVL(SLS_MANUAL_MKDN_AMT_LCL, 0)) SLS_MANUAL_MKDN_AMT_LCL,
        SUM(NVL(SLS_MANUAL_MKUP_AMT_LCL, 0)) SLS_MANUAL_MKUP_AMT_LCL,
        SUM(NVL(RET_MANUAL_MKDN_AMT_LCL, 0)) RET_MANUAL_MKDN_AMT_LCL,
        SUM(NVL(RET_MANUAL_MKUP_AMT_LCL, 0)) RET_MANUAL_MKUP_AMT_LCL,
        SUM(NVL(SLS_AMT, 0)) SLS_AMT,
        SUM(NVL(SLS_AMT_GLOBAL1, 0)) SLS_AMT_GLOBAL1,
        SUM(NVL(SLS_AMT_GLOBAL2, 0)) SLS_AMT_GLOBAL2,
        SUM(NVL(SLS_AMT_GLOBAL3, 0)) SLS_AMT_GLOBAL3,
        SUM(NVL(SLS_PROFIT_AMT, 0)) SLS_PROFIT_AMT,
        SUM(NVL(SLS_PROFIT_AMT_GLOBAL1, 0)) SLS_PROFIT_AMT_GLOBAL1,
        SUM(NVL(SLS_PROFIT_AMT_GLOBAL2, 0)) SLS_PROFIT_AMT_GLOBAL2,
        SUM(NVL(SLS_PROFIT_AMT_GLOBAL3, 0)) SLS_PROFIT_AMT_GLOBAL3,
        SUM(NVL(SLS_MANUAL_MKDN_AMT, 0)) SLS_MANUAL_MKDN_AMT,
        SUM(NVL(SLS_MANUAL_MKDN_AMT_GLOBAL1, 0)) SLS_MANUAL_MKDN_AMT_GLOBAL1,
        SUM(NVL(SLS_MANUAL_MKDN_AMT_GLOBAL2, 0)) SLS_MANUAL_MKDN_AMT_GLOBAL2,
        SUM(NVL(SLS_MANUAL_MKDN_AMT_GLOBAL3, 0)) SLS_MANUAL_MKDN_AMT_GLOBAL3,
        SUM(NVL(SLS_MANUAL_MKUP_AMT, 0)) SLS_MANUAL_MKUP_AMT,
        SUM(NVL(SLS_MANUAL_MKUP_AMT_GLOBAL1, 0)) SLS_MANUAL_MKUP_AMT_GLOBAL1,
        SUM(NVL(SLS_MANUAL_MKUP_AMT_GLOBAL2, 0)) SLS_MANUAL_MKUP_AMT_GLOBAL2,
        SUM(NVL(SLS_MANUAL_MKUP_AMT_GLOBAL3, 0)) SLS_MANUAL_MKUP_AMT_GLOBAL3,
        SUM(NVL(SLS_TAX_AMT, 0)) SLS_TAX_AMT,
        SUM(NVL(SLS_TAX_AMT_GLOBAL1, 0)) SLS_TAX_AMT_GLOBAL1,
        SUM(NVL(SLS_TAX_AMT_GLOBAL2, 0)) SLS_TAX_AMT_GLOBAL2,
        SUM(NVL(SLS_TAX_AMT_GLOBAL3, 0)) SLS_TAX_AMT_GLOBAL3,
        SUM(NVL(SLS_EMP_DISC_AMT, 0)) SLS_EMP_DISC_AMT,
        SUM(NVL(SLS_EMP_DISC_AMT_GLOBAL1, 0)) SLS_EMP_DISC_AMT_GLOBAL1,
        SUM(NVL(SLS_EMP_DISC_AMT_GLOBAL2, 0)) SLS_EMP_DISC_AMT_GLOBAL2,
        SUM(NVL(SLS_EMP_DISC_AMT_GLOBAL3, 0)) SLS_EMP_DISC_AMT_GLOBAL3,
        SUM(NVL(RET_AMT, 0)) RET_AMT,
        SUM(NVL(RET_AMT_GLOBAL1, 0)) RET_AMT_GLOBAL1,
        SUM(NVL(RET_AMT_GLOBAL2, 0)) RET_AMT_GLOBAL2,
        SUM(NVL(RET_AMT_GLOBAL3, 0)) RET_AMT_GLOBAL3,
        SUM(NVL(RET_PROFIT_AMT, 0)) RET_PROFIT_AMT,
        SUM(NVL(RET_PROFIT_AMT_GLOBAL1, 0)) RET_PROFIT_AMT_GLOBAL1,
        SUM(NVL(RET_PROFIT_AMT_GLOBAL2, 0)) RET_PROFIT_AMT_GLOBAL2,
        SUM(NVL(RET_PROFIT_AMT_GLOBAL3, 0)) RET_PROFIT_AMT_GLOBAL3,
        SUM(NVL(RET_MANUAL_MKDN_AMT, 0)) RET_MANUAL_MKDN_AMT,
        SUM(NVL(RET_MANUAL_MKDN_AMT_GLOBAL1, 0)) RET_MANUAL_MKDN_AMT_GLOBAL1,
        SUM(NVL(RET_MANUAL_MKDN_AMT_GLOBAL2, 0)) RET_MANUAL_MKDN_AMT_GLOBAL2,
        SUM(NVL(RET_MANUAL_MKDN_AMT_GLOBAL3, 0)) RET_MANUAL_MKDN_AMT_GLOBAL3,
        SUM(NVL(RET_MANUAL_MKUP_AMT, 0)) RET_MANUAL_MKUP_AMT,
        SUM(NVL(RET_MANUAL_MKUP_AMT_GLOBAL1, 0)) RET_MANUAL_MKUP_AMT_GLOBAL1,
        SUM(NVL(RET_MANUAL_MKUP_AMT_GLOBAL2, 0)) RET_MANUAL_MKUP_AMT_GLOBAL2,
        SUM(NVL(RET_MANUAL_MKUP_AMT_GLOBAL3, 0)) RET_MANUAL_MKUP_AMT_GLOBAL3,
        SUM(NVL(RET_TAX_AMT, 0)) RET_TAX_AMT,
        SUM(NVL(RET_TAX_AMT_GLOBAL1, 0)) RET_TAX_AMT_GLOBAL1,
        SUM(NVL(RET_TAX_AMT_GLOBAL2, 0)) RET_TAX_AMT_GLOBAL2,
        SUM(NVL(RET_TAX_AMT_GLOBAL3, 0)) RET_TAX_AMT_GLOBAL3,
        SUM(NVL(RET_EMP_DISC_AMT, 0)) RET_EMP_DISC_AMT,
        SUM(NVL(RET_EMP_DISC_AMT_GLOBAL1, 0)) RET_EMP_DISC_AMT_GLOBAL1,
        SUM(NVL(RET_EMP_DISC_AMT_GLOBAL2, 0)) RET_EMP_DISC_AMT_GLOBAL2,
        SUM(NVL(RET_EMP_DISC_AMT_GLOBAL3, 0)) RET_EMP_DISC_AMT_GLOBAL3,
        SUM(NVL(SLS_MANUAL_COUNT, 0)) SLS_MANUAL_COUNT,
        SUM(NVL(SLS_SCAN_COUNT, 0)) SLS_SCAN_COUNT,
        SUM(NVL(RET_MANUAL_COUNT, 0)) RET_MANUAL_COUNT,
        SUM(NVL(RET_SCAN_COUNT, 0)) RET_SCAN_COUNT,
        MAX(SUBSTR(INTEGRATION_ID, 1, INSTR(INTEGRATION_ID, '~', 1, 1)) ||
            SUBSTR(TO_CHAR(DT_WID), 2, 6) ||
            SUBSTR(INTEGRATION_ID,
                   INSTR(INTEGRATION_ID, '~', 1, 2),
                   LENGTH(INTEGRATION_ID) - INSTR(INTEGRATION_ID, '~', 1, 2) + 1)) INTEGRATION_ID,
        BBG_RETAIL_TYPE_WID,
        SUM(NVL(BBG_CUSTOMER_COUNT, 0)) BBG_CUSTOMER_COUNT,
        SUM(NVL(BBG_SERVICE_SATISFACTION, 0)) BBG_SERVICE_SATISFACTION,
        SYSDATE W_INSERT_DT,
        SYSDATE W_UPDATE_DT,
        MAX(BBG_REFERENCE_DO1) BBG_REFERENCE_DO1,
        MAX(BBG_REFERENCE_DO2) BBG_REFERENCE_DO2,
        MAX(BBG_REFERENCE_DO3) BBG_REFERENCE_DO3,
        MAX(BBG_REFERENCE_DO4) BBG_REFERENCE_DO4,
        MAX(BBG_REFERENCE_DO5) BBG_REFERENCE_DO5,
        MAX(BBG_REFERENCE_FO1) BBG_REFERENCE_FO1,
        SUM(BBG_REFERENCE_FO2) BBG_REFERENCE_FO2,
        MAX(BBG_REFERENCE_FO3) BBG_REFERENCE_FO3,
        MAX(BBG_REFERENCE_FO4) BBG_REFERENCE_FO4,
        MAX(BBG_REFERENCE_FO5) BBG_REFERENCE_FO5,
        MAX(BBG_REFERENCE_FO6) BBG_REFERENCE_FO6,
        MAX(BBG_REFERENCE_FO7) BBG_REFERENCE_FO7,
        MAX(BBG_REFERENCE_FO8) BBG_REFERENCE_FO8,
        MAX(BBG_REFERENCE_FO9) BBG_REFERENCE_FO9,
        MAX(BBG_REFERENCE_FO10) BBG_REFERENCE_FO10,
        SUM(vip_sls_qty) vip_sls_qty,
        SUM(vip_sls_amt_lcl) vip_sls_amt_lcl,
        SUM(vip_sls_profit_amt_lcl) vip_sls_profit_amt_lcl,
        SUM(vip_sls_tax_amt_lcl) vip_sls_tax_amt_lcl,
        SUM(vip_sls_emp_disc_amt_lcl) vip_sls_emp_disc_amt_lcl,
        SUM(vip_ret_qty) vip_ret_qty,
        SUM(vip_ret_amt_lcl) vip_ret_amt_lcl,
        SUM(vip_ret_profit_amt_lcl) vip_ret_profit_amt_lcl,
        SUM(vip_ret_tax_amt_lcl) vip_ret_tax_amt_lcl,
        SUM(vip_ret_emp_disc_amt_lcl) vip_ret_emp_disc_amt_lcl,
        SUM(vip_sls_manual_mkdn_amt_lcl) vip_sls_manual_mkdn_amt_lcl,
        SUM(vip_sls_manual_mkup_amt_lcl) vip_sls_manual_mkup_amt_lcl,
        SUM(vip_ret_manual_mkdn_amt_lcl) vip_ret_manual_mkdn_amt_lcl,
        SUM(vip_ret_manual_mkup_amt_lcl) vip_ret_manual_mkup_amt_lcl,
        SUM(vip_sls_amt) vip_sls_amt,
        SUM(vip_sls_amt_global1) vip_sls_amt_global1,
        SUM(vip_sls_amt_global2) vip_sls_amt_global2,
        SUM(vip_sls_amt_global3) vip_sls_amt_global3,
        SUM(vip_sls_profit_amt) vip_sls_profit_amt,
        SUM(vip_sls_profit_amt_global1) vip_sls_profit_amt_global1,
        SUM(vip_sls_profit_amt_global2) vip_sls_profit_amt_global2,
        SUM(vip_sls_profit_amt_global3) vip_sls_profit_amt_global3,
        SUM(vip_sls_manual_mkdn_amt) vip_sls_manual_mkdn_amt,
        SUM(vip_sls_manual_mkup_amt) vip_sls_manual_mkup_amt,
        SUM(vip_sls_tax_amt) vip_sls_tax_amt,
        SUM(vip_sls_tax_amt_global1) vip_sls_tax_amt_global1,
        SUM(vip_sls_tax_amt_global2) vip_sls_tax_amt_global2,
        SUM(vip_sls_tax_amt_global3) vip_sls_tax_amt_global3,
        SUM(vip_sls_emp_disc_amt) vip_sls_emp_disc_amt,
        SUM(vip_sls_emp_disc_amt_global1) vip_sls_emp_disc_amt_global1,
        SUM(vip_sls_emp_disc_amt_global2) vip_sls_emp_disc_amt_global2,
        SUM(vip_sls_emp_disc_amt_global3) vip_sls_emp_disc_amt_global3,
        SUM(vip_ret_amt) vip_ret_amt,
        SUM(vip_ret_amt_global1) vip_ret_amt_global1,
        SUM(vip_ret_amt_global2) vip_ret_amt_global2,
        SUM(vip_ret_amt_global3) vip_ret_amt_global3,
        SUM(vip_ret_profit_amt) vip_ret_profit_amt,
        SUM(vip_ret_profit_amt_global1) vip_ret_profit_amt_global1,
        SUM(vip_ret_profit_amt_global2) vip_ret_profit_amt_global2,
        SUM(vip_ret_profit_amt_global3) vip_ret_profit_amt_global3,
        SUM(vip_ret_manual_mkdn_amt) vip_ret_manual_mkdn_amt,
        SUM(vip_ret_manual_mkup_amt) vip_ret_manual_mkup_amt,
        SUM(vip_ret_tax_amt) vip_ret_tax_amt,
        SUM(vip_ret_tax_amt_global1) vip_ret_tax_amt_global1,
        SUM(vip_ret_tax_amt_global2) vip_ret_tax_amt_global2,
        SUM(vip_ret_tax_amt_global3) vip_ret_tax_amt_global3,
        SUM(vip_ret_emp_disc_amt) vip_ret_emp_disc_amt,
        SUM(vip_ret_emp_disc_amt_global1) vip_ret_emp_disc_amt_global1,
        SUM(vip_ret_emp_disc_amt_global2) vip_ret_emp_disc_amt_global2,
        SUM(vip_ret_emp_disc_amt_global3) vip_ret_emp_disc_amt_global3,
        SUM(vip_sls_manual_count) vip_sls_manual_count,
        SUM(vip_sls_scan_count) vip_sls_scan_count,
        SUM(vip_ret_manual_count) vip_ret_manual_count,
        SUM(vip_ret_scan_count) vip_ret_scan_count,
        SUM(v_sls_manual_mkdn_amt_global1) v_sls_manual_mkdn_amt_global1,
        SUM(v_sls_manual_mkdn_amt_global2) v_sls_manual_mkdn_amt_global2,
        SUM(v_sls_manual_mkdn_amt_global3) v_sls_manual_mkdn_amt_global3,
        SUM(v_sls_manual_mkup_amt_global1) v_sls_manual_mkup_amt_global1,
        SUM(v_sls_manual_mkup_amt_global2) v_sls_manual_mkup_amt_global2,
        SUM(v_sls_manual_mkup_amt_global3) v_sls_manual_mkup_amt_global3,
        SUM(v_ret_manual_mkdn_amt_global1) v_ret_manual_mkdn_amt_global1,
        SUM(v_ret_manual_mkdn_amt_global2) v_ret_manual_mkdn_amt_global2,
        SUM(v_ret_manual_mkdn_amt_global3) v_ret_manual_mkdn_amt_global3,
        SUM(v_ret_manual_mkup_amt_global1) v_ret_manual_mkup_amt_global1,
        SUM(v_ret_manual_mkup_amt_global2) v_ret_manual_mkup_amt_global2,
        SUM(v_ret_manual_mkup_amt_global3) v_ret_manual_mkup_amt_global3,
        SUM(NVL(SLS_COUPON_AMT_LCL, 0)) SLS_COUPON_AMT_LCL,
        SUM(NVL(RET_COUPON_AMT_LCL, 0)) RET_COUPON_AMT_LCL,
        SUM(NVL(SLS_TAX_COUPON_AMT_LCL, 0)) SLS_TAX_COUPON_AMT_LCL,
        SUM(NVL(RET_TAX_COUPON_AMT_LCL, 0)) RET_TAX_COUPON_AMT_LCL
       
         FROM RADM.W_RTL_SLS_SC_DY_A
        WHERE DT_WID BETWEEN 120160601000 AND 120160630000
        GROUP BY PROD_DH_WID,
                 SUBSTR(TO_CHAR(DT_WID), 2, 6),
                 RTL_TYPE_WID,
                 BBG_RETAIL_TYPE_WID) S
ON (T.PROD_DH_WID = S.PROD_DH_WID AND T.MN_WID = S.MN_WID AND T.RTL_TYPE_WID = S.RTL_TYPE_WID AND T.BBG_RETAIL_TYPE_WID = S.BBG_RETAIL_TYPE_WID)
WHEN MATCHED THEN
  UPDATE
     SET T.SLS_QTY                       = S.SLS_QTY,
         T.SLS_AMT_LCL                   = S.SLS_AMT_LCL,
         T.SLS_PROFIT_AMT_LCL            = S.SLS_PROFIT_AMT_LCL,
         T.SLS_TAX_AMT_LCL               = S.SLS_TAX_AMT_LCL,
         T.SLS_EMP_DISC_AMT_LCL          = S.SLS_EMP_DISC_AMT_LCL,
         T.RET_QTY                       = S.RET_QTY,
         T.RET_AMT_LCL                   = S.RET_AMT_LCL,
         T.RET_PROFIT_AMT_LCL            = S.RET_PROFIT_AMT_LCL,
         T.RET_TAX_AMT_LCL               = S.RET_TAX_AMT_LCL,
         T.RET_EMP_DISC_AMT_LCL          = S.RET_EMP_DISC_AMT_LCL,
         T.SLS_MANUAL_MKDN_AMT_LCL       = S.SLS_MANUAL_MKDN_AMT_LCL,
         T.SLS_MANUAL_MKUP_AMT_LCL       = S.SLS_MANUAL_MKUP_AMT_LCL,
         T.RET_MANUAL_MKDN_AMT_LCL       = S.RET_MANUAL_MKDN_AMT_LCL,
         T.RET_MANUAL_MKUP_AMT_LCL       = S.RET_MANUAL_MKUP_AMT_LCL,
         T.SLS_AMT                       = S.SLS_AMT,
         T.SLS_AMT_GLOBAL1               = S.SLS_AMT_GLOBAL1,
         T.SLS_AMT_GLOBAL2               = S.SLS_AMT_GLOBAL2,
         T.SLS_AMT_GLOBAL3               = S.SLS_AMT_GLOBAL3,
         T.SLS_PROFIT_AMT                = S.SLS_PROFIT_AMT,
         T.SLS_PROFIT_AMT_GLOBAL1        = S.SLS_PROFIT_AMT_GLOBAL1,
         T.SLS_PROFIT_AMT_GLOBAL2        = S.SLS_PROFIT_AMT_GLOBAL2,
         T.SLS_PROFIT_AMT_GLOBAL3        = S.SLS_PROFIT_AMT_GLOBAL3,
         T.SLS_MANUAL_MKDN_AMT           = S.SLS_MANUAL_MKDN_AMT,
         T.SLS_MANUAL_MKDN_AMT_GLOBAL1   = S.SLS_MANUAL_MKDN_AMT_GLOBAL1,
         T.SLS_MANUAL_MKDN_AMT_GLOBAL2   = S.SLS_MANUAL_MKDN_AMT_GLOBAL2,
         T.SLS_MANUAL_MKDN_AMT_GLOBAL3   = S.SLS_MANUAL_MKDN_AMT_GLOBAL3,
         T.SLS_MANUAL_MKUP_AMT           = S.SLS_MANUAL_MKUP_AMT,
         T.SLS_MANUAL_MKUP_AMT_GLOBAL1   = S.SLS_MANUAL_MKUP_AMT_GLOBAL1,
         T.SLS_MANUAL_MKUP_AMT_GLOBAL2   = S.SLS_MANUAL_MKUP_AMT_GLOBAL2,
         T.SLS_MANUAL_MKUP_AMT_GLOBAL3   = S.SLS_MANUAL_MKUP_AMT_GLOBAL3,
         T.SLS_TAX_AMT                   = S.SLS_TAX_AMT,
         T.SLS_TAX_AMT_GLOBAL1           = S.SLS_TAX_AMT_GLOBAL1,
         T.SLS_TAX_AMT_GLOBAL2           = S.SLS_TAX_AMT_GLOBAL2,
         T.SLS_TAX_AMT_GLOBAL3           = S.SLS_TAX_AMT_GLOBAL3,
         T.SLS_EMP_DISC_AMT              = S.SLS_EMP_DISC_AMT,
         T.SLS_EMP_DISC_AMT_GLOBAL1      = S.SLS_EMP_DISC_AMT_GLOBAL1,
         T.SLS_EMP_DISC_AMT_GLOBAL2      = S.SLS_EMP_DISC_AMT_GLOBAL2,
         T.SLS_EMP_DISC_AMT_GLOBAL3      = S.SLS_EMP_DISC_AMT_GLOBAL3,
         T.RET_AMT                       = S.RET_AMT,
         T.RET_AMT_GLOBAL1               = S.RET_AMT_GLOBAL1,
         T.RET_AMT_GLOBAL2               = S.RET_AMT_GLOBAL2,
         T.RET_AMT_GLOBAL3               = S.RET_AMT_GLOBAL3,
         T.RET_PROFIT_AMT                = S.RET_PROFIT_AMT,
         T.RET_PROFIT_AMT_GLOBAL1        = S.RET_PROFIT_AMT_GLOBAL1,
         T.RET_PROFIT_AMT_GLOBAL2        = S.RET_PROFIT_AMT_GLOBAL2,
         T.RET_PROFIT_AMT_GLOBAL3        = S.RET_PROFIT_AMT_GLOBAL3,
         T.RET_MANUAL_MKDN_AMT           = S.RET_MANUAL_MKDN_AMT,
         T.RET_MANUAL_MKDN_AMT_GLOBAL1   = S.RET_MANUAL_MKDN_AMT_GLOBAL1,
         T.RET_MANUAL_MKDN_AMT_GLOBAL2   = S.RET_MANUAL_MKDN_AMT_GLOBAL2,
         T.RET_MANUAL_MKDN_AMT_GLOBAL3   = S.RET_MANUAL_MKDN_AMT_GLOBAL3,
         T.RET_MANUAL_MKUP_AMT           = S.RET_MANUAL_MKUP_AMT,
         T.RET_MANUAL_MKUP_AMT_GLOBAL1   = S.RET_MANUAL_MKUP_AMT_GLOBAL1,
         T.RET_MANUAL_MKUP_AMT_GLOBAL2   = S.RET_MANUAL_MKUP_AMT_GLOBAL2,
         T.RET_MANUAL_MKUP_AMT_GLOBAL3   = S.RET_MANUAL_MKUP_AMT_GLOBAL3,
         T.RET_TAX_AMT                   = S.RET_TAX_AMT,
         T.RET_TAX_AMT_GLOBAL1           = S.RET_TAX_AMT_GLOBAL1,
         T.RET_TAX_AMT_GLOBAL2           = S.RET_TAX_AMT_GLOBAL2,
         T.RET_TAX_AMT_GLOBAL3           = S.RET_TAX_AMT_GLOBAL3,
         T.RET_EMP_DISC_AMT              = S.RET_EMP_DISC_AMT,
         T.RET_EMP_DISC_AMT_GLOBAL1      = S.RET_EMP_DISC_AMT_GLOBAL1,
         T.RET_EMP_DISC_AMT_GLOBAL2      = S.RET_EMP_DISC_AMT_GLOBAL2,
         T.RET_EMP_DISC_AMT_GLOBAL3      = S.RET_EMP_DISC_AMT_GLOBAL3,
         T.SLS_MANUAL_COUNT              = S.SLS_MANUAL_COUNT,
         T.SLS_SCAN_COUNT                = S.SLS_SCAN_COUNT,
         T.RET_MANUAL_COUNT              = S.RET_MANUAL_COUNT,
         T.RET_SCAN_COUNT                = S.RET_SCAN_COUNT,
         T.BBG_CUSTOMER_COUNT            = S.BBG_CUSTOMER_COUNT,
         T.BBG_SERVICE_SATISFACTION      = S.BBG_SERVICE_SATISFACTION,
         T.W_UPDATE_DT                   = S.W_UPDATE_DT,
         T.BBG_REFERENCE_FO1             = S.BBG_REFERENCE_FO1,
         T.BBG_REFERENCE_FO2             = S.BBG_REFERENCE_FO2,
         T.BBG_REFERENCE_FO3             = S.BBG_REFERENCE_FO3,
         T.BBG_REFERENCE_FO4             = S.BBG_REFERENCE_FO4,
         T.BBG_REFERENCE_FO5             = S.BBG_REFERENCE_FO5,
         T.BBG_REFERENCE_FO6             = S.BBG_REFERENCE_FO6,
         T.BBG_REFERENCE_FO7             = S.BBG_REFERENCE_FO7,
         T.BBG_REFERENCE_FO8             = S.BBG_REFERENCE_FO8,
         T.BBG_REFERENCE_FO9             = S.BBG_REFERENCE_FO9,
         T.BBG_REFERENCE_FO10            = S.BBG_REFERENCE_FO10,
         T.vip_sls_qty                   = S.vip_sls_qty,
         T.vip_sls_amt_lcl               = S.vip_sls_amt_lcl,
         T.vip_sls_profit_amt_lcl        = S.vip_sls_profit_amt_lcl,
         T.vip_sls_tax_amt_lcl           = S.vip_sls_tax_amt_lcl,
         T.vip_sls_emp_disc_amt_lcl      = S.vip_sls_emp_disc_amt_lcl,
         T.vip_ret_qty                   = S.vip_ret_qty,
         T.vip_ret_amt_lcl               = S.vip_ret_amt_lcl,
         T.vip_ret_profit_amt_lcl        = S.vip_ret_profit_amt_lcl,
         T.vip_ret_tax_amt_lcl           = S.vip_ret_tax_amt_lcl,
         T.vip_ret_emp_disc_amt_lcl      = S.vip_ret_emp_disc_amt_lcl,
         T.vip_sls_manual_mkdn_amt_lcl   = S.vip_sls_manual_mkdn_amt_lcl,
         T.vip_sls_manual_mkup_amt_lcl   = S.vip_sls_manual_mkup_amt_lcl,
         T.vip_ret_manual_mkdn_amt_lcl   = S.vip_ret_manual_mkdn_amt_lcl,
         T.vip_ret_manual_mkup_amt_lcl   = S.vip_ret_manual_mkup_amt_lcl,
         T.vip_sls_amt                   = S.vip_sls_amt,
         T.vip_sls_amt_global1           = S.vip_sls_amt_global1,
         T.vip_sls_amt_global2           = S.vip_sls_amt_global2,
         T.vip_sls_amt_global3           = S.vip_sls_amt_global3,
         T.vip_sls_profit_amt            = S.vip_sls_profit_amt,
         T.vip_sls_profit_amt_global1    = S.vip_sls_profit_amt_global1,
         T.vip_sls_profit_amt_global2    = S.vip_sls_profit_amt_global2,
         T.vip_sls_profit_amt_global3    = S.vip_sls_profit_amt_global3,
         T.vip_sls_manual_mkdn_amt       = S.vip_sls_manual_mkdn_amt,
         T.vip_sls_manual_mkup_amt       = S.vip_sls_manual_mkup_amt,
         T.vip_sls_tax_amt               = S.vip_sls_tax_amt,
         T.vip_sls_tax_amt_global1       = S.vip_sls_tax_amt_global1,
         T.vip_sls_tax_amt_global2       = S.vip_sls_tax_amt_global2,
         T.vip_sls_tax_amt_global3       = S.vip_sls_tax_amt_global3,
         T.vip_sls_emp_disc_amt          = S.vip_sls_emp_disc_amt,
         T.vip_sls_emp_disc_amt_global1  = S.vip_sls_emp_disc_amt_global1,
         T.vip_sls_emp_disc_amt_global2  = S.vip_sls_emp_disc_amt_global2,
         T.vip_sls_emp_disc_amt_global3  = S.vip_sls_emp_disc_amt_global3,
         T.vip_ret_amt                   = S.vip_ret_amt,
         T.vip_ret_amt_global1           = S.vip_ret_amt_global1,
         T.vip_ret_amt_global2           = S.vip_ret_amt_global2,
         T.vip_ret_amt_global3           = S.vip_ret_amt_global3,
         T.vip_ret_profit_amt            = S.vip_ret_profit_amt,
         T.vip_ret_profit_amt_global1    = S.vip_ret_profit_amt_global1,
         T.vip_ret_profit_amt_global2    = S.vip_ret_profit_amt_global2,
         T.vip_ret_profit_amt_global3    = S.vip_ret_profit_amt_global3,
         T.vip_ret_manual_mkdn_amt       = S.vip_ret_manual_mkdn_amt,
         T.vip_ret_manual_mkup_amt       = S.vip_ret_manual_mkup_amt,
         T.vip_ret_tax_amt               = S.vip_ret_tax_amt,
         T.vip_ret_tax_amt_global1       = S.vip_ret_tax_amt_global1,
         T.vip_ret_tax_amt_global2       = S.vip_ret_tax_amt_global2,
         T.vip_ret_tax_amt_global3       = S.vip_ret_tax_amt_global3,
         T.vip_ret_emp_disc_amt          = S.vip_ret_emp_disc_amt,
         T.vip_ret_emp_disc_amt_global1  = S.vip_ret_emp_disc_amt_global1,
         T.vip_ret_emp_disc_amt_global2  = S.vip_ret_emp_disc_amt_global2,
         T.vip_ret_emp_disc_amt_global3  = S.vip_ret_emp_disc_amt_global3,
         T.vip_sls_manual_count          = S.vip_sls_manual_count,
         T.vip_sls_scan_count            = S.vip_sls_scan_count,
         T.vip_ret_manual_count          = S.vip_ret_manual_count,
         T.vip_ret_scan_count            = S.vip_ret_scan_count,
         T.v_sls_manual_mkdn_amt_global1 = S.v_sls_manual_mkdn_amt_global1,
         T.v_sls_manual_mkdn_amt_global2 = S.v_sls_manual_mkdn_amt_global2,
         T.v_sls_manual_mkdn_amt_global3 = S.v_sls_manual_mkdn_amt_global3,
         T.v_sls_manual_mkup_amt_global1 = S.v_sls_manual_mkup_amt_global1,
         T.v_sls_manual_mkup_amt_global2 = S.v_sls_manual_mkup_amt_global2,
         T.v_sls_manual_mkup_amt_global3 = S.v_sls_manual_mkup_amt_global3,
         T.v_ret_manual_mkdn_amt_global1 = S.v_ret_manual_mkdn_amt_global1,
         T.v_ret_manual_mkdn_amt_global2 = S.v_ret_manual_mkdn_amt_global2,
         T.v_ret_manual_mkdn_amt_global3 = S.v_ret_manual_mkdn_amt_global3,
         T.v_ret_manual_mkup_amt_global1 = S.v_ret_manual_mkup_amt_global1,
         T.v_ret_manual_mkup_amt_global2 = S.v_ret_manual_mkup_amt_global2,
         T.v_ret_manual_mkup_amt_global3 = S.v_ret_manual_mkup_amt_global3,
         T.SLS_COUPON_AMT_LCL            = S.SLS_COUPON_AMT_LCL,
         T.RET_COUPON_AMT_LCL            = S.RET_COUPON_AMT_LCL,
         T.SLS_TAX_COUPON_AMT_LCL        = S.SLS_TAX_COUPON_AMT_LCL,
         T.RET_TAX_COUPON_AMT_LCL        = S.RET_TAX_COUPON_AMT_LCL
  

WHEN NOT MATCHED THEN
  INSERT
    (T.PROD_DH_WID,
     T.MN_WID,
     T.RTL_TYPE_WID,
     T.SLS_QTY,
     T.SLS_AMT_LCL,
     T.SLS_PROFIT_AMT_LCL,
     T.SLS_TAX_AMT_LCL,
     T.SLS_EMP_DISC_AMT_LCL,
     T.RET_QTY,
     T.RET_AMT_LCL,
     T.RET_PROFIT_AMT_LCL,
     T.RET_TAX_AMT_LCL,
     T.RET_EMP_DISC_AMT_LCL,
     T.SLS_MANUAL_MKDN_AMT_LCL,
     T.SLS_MANUAL_MKUP_AMT_LCL,
     T.RET_MANUAL_MKDN_AMT_LCL,
     T.RET_MANUAL_MKUP_AMT_LCL,
     T.SLS_AMT,
     T.SLS_AMT_GLOBAL1,
     T.SLS_AMT_GLOBAL2,
     T.SLS_AMT_GLOBAL3,
     T.SLS_PROFIT_AMT,
     T.SLS_PROFIT_AMT_GLOBAL1,
     T.SLS_PROFIT_AMT_GLOBAL2,
     T.SLS_PROFIT_AMT_GLOBAL3,
     T.SLS_MANUAL_MKDN_AMT,
     T.SLS_MANUAL_MKDN_AMT_GLOBAL1,
     T.SLS_MANUAL_MKDN_AMT_GLOBAL2,
     T.SLS_MANUAL_MKDN_AMT_GLOBAL3,
     T.SLS_MANUAL_MKUP_AMT,
     T.SLS_MANUAL_MKUP_AMT_GLOBAL1,
     T.SLS_MANUAL_MKUP_AMT_GLOBAL2,
     T.SLS_MANUAL_MKUP_AMT_GLOBAL3,
     T.SLS_TAX_AMT,
     T.SLS_TAX_AMT_GLOBAL1,
     T.SLS_TAX_AMT_GLOBAL2,
     T.SLS_TAX_AMT_GLOBAL3,
     T.SLS_EMP_DISC_AMT,
     T.SLS_EMP_DISC_AMT_GLOBAL1,
     T.SLS_EMP_DISC_AMT_GLOBAL2,
     T.SLS_EMP_DISC_AMT_GLOBAL3,
     T.RET_AMT,
     T.RET_AMT_GLOBAL1,
     T.RET_AMT_GLOBAL2,
     T.RET_AMT_GLOBAL3,
     T.RET_PROFIT_AMT,
     T.RET_PROFIT_AMT_GLOBAL1,
     T.RET_PROFIT_AMT_GLOBAL2,
     T.RET_PROFIT_AMT_GLOBAL3,
     T.RET_MANUAL_MKDN_AMT,
     T.RET_MANUAL_MKDN_AMT_GLOBAL1,
     T.RET_MANUAL_MKDN_AMT_GLOBAL2,
     T.RET_MANUAL_MKDN_AMT_GLOBAL3,
     T.RET_MANUAL_MKUP_AMT,
     T.RET_MANUAL_MKUP_AMT_GLOBAL1,
     T.RET_MANUAL_MKUP_AMT_GLOBAL2,
     T.RET_MANUAL_MKUP_AMT_GLOBAL3,
     T.RET_TAX_AMT,
     T.RET_TAX_AMT_GLOBAL1,
     T.RET_TAX_AMT_GLOBAL2,
     T.RET_TAX_AMT_GLOBAL3,
     T.RET_EMP_DISC_AMT,
     T.RET_EMP_DISC_AMT_GLOBAL1,
     T.RET_EMP_DISC_AMT_GLOBAL2,
     T.RET_EMP_DISC_AMT_GLOBAL3,
     T.SLS_MANUAL_COUNT,
     T.SLS_SCAN_COUNT,
     T.RET_MANUAL_COUNT,
     T.RET_SCAN_COUNT,
     T.INTEGRATION_ID,
     T.BBG_RETAIL_TYPE_WID,
     T.BBG_CUSTOMER_COUNT,
     T.BBG_SERVICE_SATISFACTION,
     T.BBG_REFERENCE_DO1,
     T.BBG_REFERENCE_DO2,
     T.BBG_REFERENCE_DO3,
     T.BBG_REFERENCE_DO4,
     T.BBG_REFERENCE_DO5,
     T.BBG_REFERENCE_FO1,
     T.BBG_REFERENCE_FO2,
     T.BBG_REFERENCE_FO3,
     T.BBG_REFERENCE_FO4,
     T.BBG_REFERENCE_FO5,
     T.BBG_REFERENCE_FO6,
     T.BBG_REFERENCE_FO7,
     T.BBG_REFERENCE_FO8,
     T.BBG_REFERENCE_FO9,
     T.BBG_REFERENCE_FO10,
     T.vip_sls_qty,
     T.vip_sls_amt_lcl,
     T.vip_sls_profit_amt_lcl,
     T.vip_sls_tax_amt_lcl,
     T.vip_sls_emp_disc_amt_lcl,
     T.vip_ret_qty,
     T.vip_ret_amt_lcl,
     T.vip_ret_profit_amt_lcl,
     T.vip_ret_tax_amt_lcl,
     T.vip_ret_emp_disc_amt_lcl,
     T.vip_sls_manual_mkdn_amt_lcl,
     T.vip_sls_manual_mkup_amt_lcl,
     T.vip_ret_manual_mkdn_amt_lcl,
     T.vip_ret_manual_mkup_amt_lcl,
     T.vip_sls_amt,
     T.vip_sls_amt_global1,
     T.vip_sls_amt_global2,
     T.vip_sls_amt_global3,
     T.vip_sls_profit_amt,
     T.vip_sls_profit_amt_global1,
     T.vip_sls_profit_amt_global2,
     T.vip_sls_profit_amt_global3,
     T.vip_sls_manual_mkdn_amt,
     T.vip_sls_manual_mkup_amt,
     T.vip_sls_tax_amt,
     T.vip_sls_tax_amt_global1,
     T.vip_sls_tax_amt_global2,
     T.vip_sls_tax_amt_global3,
     T.vip_sls_emp_disc_amt,
     T.vip_sls_emp_disc_amt_global1,
     T.vip_sls_emp_disc_amt_global2,
     T.vip_sls_emp_disc_amt_global3,
     T.vip_ret_amt,
     T.vip_ret_amt_global1,
     T.vip_ret_amt_global2,
     T.vip_ret_amt_global3,
     T.vip_ret_profit_amt,
     T.vip_ret_profit_amt_global1,
     T.vip_ret_profit_amt_global2,
     T.vip_ret_profit_amt_global3,
     T.vip_ret_manual_mkdn_amt,
     T.vip_ret_manual_mkup_amt,
     T.vip_ret_tax_amt,
     T.vip_ret_tax_amt_global1,
     T.vip_ret_tax_amt_global2,
     T.vip_ret_tax_amt_global3,
     T.vip_ret_emp_disc_amt,
     T.vip_ret_emp_disc_amt_global1,
     T.vip_ret_emp_disc_amt_global2,
     T.vip_ret_emp_disc_amt_global3,
     T.vip_sls_manual_count,
     T.vip_sls_scan_count,
     T.vip_ret_manual_count,
     T.vip_ret_scan_count,
     T.v_sls_manual_mkdn_amt_global1,
     T.v_sls_manual_mkdn_amt_global2,
     T.v_sls_manual_mkdn_amt_global3,
     T.v_sls_manual_mkup_amt_global1,
     T.v_sls_manual_mkup_amt_global2,
     T.v_sls_manual_mkup_amt_global3,
     T.v_ret_manual_mkdn_amt_global1,
     T.v_ret_manual_mkdn_amt_global2,
     T.v_ret_manual_mkdn_amt_global3,
     T.v_ret_manual_mkup_amt_global1,
     T.v_ret_manual_mkup_amt_global2,
     T.v_ret_manual_mkup_amt_global3,
     T.SLS_COUPON_AMT_LCL,
     T.RET_COUPON_AMT_LCL,
     T.SLS_TAX_COUPON_AMT_LCL,
     T.RET_TAX_COUPON_AMT_LCL)
  VALUES
    (S.PROD_DH_WID,
     S.MN_WID,
     S.RTL_TYPE_WID,
     S.SLS_QTY,
     S.SLS_AMT_LCL,
     S.SLS_PROFIT_AMT_LCL,
     S.SLS_TAX_AMT_LCL,
     S.SLS_EMP_DISC_AMT_LCL,
     S.RET_QTY,
     S.RET_AMT_LCL,
     S.RET_PROFIT_AMT_LCL,
     S.RET_TAX_AMT_LCL,
     S.RET_EMP_DISC_AMT_LCL,
     S.SLS_MANUAL_MKDN_AMT_LCL,
     S.SLS_MANUAL_MKUP_AMT_LCL,
     S.RET_MANUAL_MKDN_AMT_LCL,
     S.RET_MANUAL_MKUP_AMT_LCL,
     S.SLS_AMT,
     S.SLS_AMT_GLOBAL1,
     S.SLS_AMT_GLOBAL2,
     S.SLS_AMT_GLOBAL3,
     S.SLS_PROFIT_AMT,
     S.SLS_PROFIT_AMT_GLOBAL1,
     S.SLS_PROFIT_AMT_GLOBAL2,
     S.SLS_PROFIT_AMT_GLOBAL3,
     S.SLS_MANUAL_MKDN_AMT,
     S.SLS_MANUAL_MKDN_AMT_GLOBAL1,
     S.SLS_MANUAL_MKDN_AMT_GLOBAL2,
     S.SLS_MANUAL_MKDN_AMT_GLOBAL3,
     S.SLS_MANUAL_MKUP_AMT,
     S.SLS_MANUAL_MKUP_AMT_GLOBAL1,
     S.SLS_MANUAL_MKUP_AMT_GLOBAL2,
     S.SLS_MANUAL_MKUP_AMT_GLOBAL3,
     S.SLS_TAX_AMT,
     S.SLS_TAX_AMT_GLOBAL1,
     S.SLS_TAX_AMT_GLOBAL2,
     S.SLS_TAX_AMT_GLOBAL3,
     S.SLS_EMP_DISC_AMT,
     S.SLS_EMP_DISC_AMT_GLOBAL1,
     S.SLS_EMP_DISC_AMT_GLOBAL2,
     S.SLS_EMP_DISC_AMT_GLOBAL3,
     S.RET_AMT,
     S.RET_AMT_GLOBAL1,
     S.RET_AMT_GLOBAL2,
     S.RET_AMT_GLOBAL3,
     S.RET_PROFIT_AMT,
     S.RET_PROFIT_AMT_GLOBAL1,
     S.RET_PROFIT_AMT_GLOBAL2,
     S.RET_PROFIT_AMT_GLOBAL3,
     S.RET_MANUAL_MKDN_AMT,
     S.RET_MANUAL_MKDN_AMT_GLOBAL1,
     S.RET_MANUAL_MKDN_AMT_GLOBAL2,
     S.RET_MANUAL_MKDN_AMT_GLOBAL3,
     S.RET_MANUAL_MKUP_AMT,
     S.RET_MANUAL_MKUP_AMT_GLOBAL1,
     S.RET_MANUAL_MKUP_AMT_GLOBAL2,
     S.RET_MANUAL_MKUP_AMT_GLOBAL3,
     S.RET_TAX_AMT,
     S.RET_TAX_AMT_GLOBAL1,
     S.RET_TAX_AMT_GLOBAL2,
     S.RET_TAX_AMT_GLOBAL3,
     S.RET_EMP_DISC_AMT,
     S.RET_EMP_DISC_AMT_GLOBAL1,
     S.RET_EMP_DISC_AMT_GLOBAL2,
     S.RET_EMP_DISC_AMT_GLOBAL3,
     S.SLS_MANUAL_COUNT,
     S.SLS_SCAN_COUNT,
     S.RET_MANUAL_COUNT,
     S.RET_SCAN_COUNT,
     S.INTEGRATION_ID,
     S.BBG_RETAIL_TYPE_WID,
     S.BBG_CUSTOMER_COUNT,
     S.BBG_SERVICE_SATISFACTION,
     S.BBG_REFERENCE_DO1,
     S.BBG_REFERENCE_DO2,
     S.BBG_REFERENCE_DO3,
     S.BBG_REFERENCE_DO4,
     S.BBG_REFERENCE_DO5,
     S.BBG_REFERENCE_FO1,
     S.BBG_REFERENCE_FO2,
     S.BBG_REFERENCE_FO3,
     S.BBG_REFERENCE_FO4,
     S.BBG_REFERENCE_FO5,
     S.BBG_REFERENCE_FO6,
     S.BBG_REFERENCE_FO7,
     S.BBG_REFERENCE_FO8,
     S.BBG_REFERENCE_FO9,
     S.BBG_REFERENCE_FO10,
     S.vip_sls_qty,
     S.vip_sls_amt_lcl,
     S.vip_sls_profit_amt_lcl,
     S.vip_sls_tax_amt_lcl,
     S.vip_sls_emp_disc_amt_lcl,
     S.vip_ret_qty,
     S.vip_ret_amt_lcl,
     S.vip_ret_profit_amt_lcl,
     S.vip_ret_tax_amt_lcl,
     S.vip_ret_emp_disc_amt_lcl,
     S.vip_sls_manual_mkdn_amt_lcl,
     S.vip_sls_manual_mkup_amt_lcl,
     S.vip_ret_manual_mkdn_amt_lcl,
     S.vip_ret_manual_mkup_amt_lcl,
     S.vip_sls_amt,
     S.vip_sls_amt_global1,
     S.vip_sls_amt_global2,
     S.vip_sls_amt_global3,
     S.vip_sls_profit_amt,
     S.vip_sls_profit_amt_global1,
     S.vip_sls_profit_amt_global2,
     S.vip_sls_profit_amt_global3,
     S.vip_sls_manual_mkdn_amt,
     S.vip_sls_manual_mkup_amt,
     S.vip_sls_tax_amt,
     S.vip_sls_tax_amt_global1,
     S.vip_sls_tax_amt_global2,
     S.vip_sls_tax_amt_global3,
     S.vip_sls_emp_disc_amt,
     S.vip_sls_emp_disc_amt_global1,
     S.vip_sls_emp_disc_amt_global2,
     S.vip_sls_emp_disc_amt_global3,
     S.vip_ret_amt,
     S.vip_ret_amt_global1,
     S.vip_ret_amt_global2,
     S.vip_ret_amt_global3,
     S.vip_ret_profit_amt,
     S.vip_ret_profit_amt_global1,
     S.vip_ret_profit_amt_global2,
     S.vip_ret_profit_amt_global3,
     S.vip_ret_manual_mkdn_amt,
     S.vip_ret_manual_mkup_amt,
     S.vip_ret_tax_amt,
     S.vip_ret_tax_amt_global1,
     S.vip_ret_tax_amt_global2,
     S.vip_ret_tax_amt_global3,
     S.vip_ret_emp_disc_amt,
     S.vip_ret_emp_disc_amt_global1,
     S.vip_ret_emp_disc_amt_global2,
     S.vip_ret_emp_disc_amt_global3,
     S.vip_sls_manual_count,
     S.vip_sls_scan_count,
     S.vip_ret_manual_count,
     S.vip_ret_scan_count,
     S.v_sls_manual_mkdn_amt_global1,
     S.v_sls_manual_mkdn_amt_global2,
     S.v_sls_manual_mkdn_amt_global3,
     S.v_sls_manual_mkup_amt_global1,
     S.v_sls_manual_mkup_amt_global2,
     S.v_sls_manual_mkup_amt_global3,
     S.v_ret_manual_mkdn_amt_global1,
     S.v_ret_manual_mkdn_amt_global2,
     S.v_ret_manual_mkdn_amt_global3,
     S.v_ret_manual_mkup_amt_global1,
     S.v_ret_manual_mkup_amt_global2,
     S.v_ret_manual_mkup_amt_global3,
     S.SLS_COUPON_AMT_LCL,
     S.RET_COUPON_AMT_LCL,
     S.SLS_TAX_COUPON_AMT_LCL,
     S.RET_TAX_COUPON_AMT_LCL);
COMMIT;
--2.W_RTL_SLS_SC_LC_MN_A
MERGE /*+APPEND PARALLEL(16)*/
INTO RADM.W_RTL_SLS_SC_LC_MN_A T
USING (SELECT /*+PARALLEL(16)*/
        PROD_DH_WID,
        ORG_WID,
        MAX(ORG_SCD1_WID) ORG_SCD1_WID,
        MAX(ORG_DH_WID) ORG_DH_WID,
        SUBSTR(TO_CHAR(DT_WID), 2, 6) MN_WID,
        RTL_TYPE_WID,
        SUM(NVL(SLS_QTY, 0)) SLS_QTY,
        SUM(NVL(SLS_AMT_LCL, 0)) SLS_AMT_LCL,
        SUM(NVL(SLS_PROFIT_AMT_LCL, 0)) SLS_PROFIT_AMT_LCL,
        SUM(NVL(SLS_MANUAL_MKDN_AMT_LCL, 0)) SLS_MANUAL_MKDN_AMT_LCL,
        SUM(NVL(SLS_MANUAL_MKUP_AMT_LCL, 0)) SLS_MANUAL_MKUP_AMT_LCL,
        SUM(NVL(SLS_TAX_AMT_LCL, 0)) SLS_TAX_AMT_LCL,
        SUM(NVL(SLS_EMP_DISC_AMT_LCL, 0)) SLS_EMP_DISC_AMT_LCL,
        SUM(NVL(SLS_MANUAL_COUNT, 0)) SLS_MANUAL_COUNT,
        SUM(NVL(SLS_SCAN_COUNT, 0)) SLS_SCAN_COUNT,
        SUM(NVL(RET_QTY, 0)) RET_QTY,
        SUM(NVL(RET_AMT_LCL, 0)) RET_AMT_LCL,
        SUM(NVL(RET_PROFIT_AMT_LCL, 0)) RET_PROFIT_AMT_LCL,
        SUM(NVL(RET_MANUAL_MKDN_AMT_LCL, 0)) RET_MANUAL_MKDN_AMT_LCL,
        SUM(NVL(RET_MANUAL_MKUP_AMT_LCL, 0)) RET_MANUAL_MKUP_AMT_LCL,
        SUM(NVL(RET_TAX_AMT_LCL, 0)) RET_TAX_AMT_LCL,
        SUM(NVL(RET_EMP_DISC_AMT_LCL, 0)) RET_EMP_DISC_AMT_LCL,
        SUM(NVL(RET_MANUAL_COUNT, 0)) RET_MANUAL_COUNT,
        SUM(NVL(RET_SCAN_COUNT, 0)) RET_SCAN_COUNT,
        MAX(SUBSTR(INTEGRATION_ID, 1, INSTR(INTEGRATION_ID, '~', 1, 1)) ||
            SUBSTR(INTEGRATION_ID,
                   INSTR(INTEGRATION_ID, '~', 1, 1) + 1,
                   INSTR(INTEGRATION_ID, '~', 1, 2) -
                   INSTR(INTEGRATION_ID, '~', 1, 1)) ||
            SUBSTR(TO_CHAR(DT_WID), 2, 6) ||
            SUBSTR(INTEGRATION_ID,
                   INSTR(INTEGRATION_ID, '~', 1, 3),
                   LENGTH(INTEGRATION_ID) - INSTR(INTEGRATION_ID, '~', 1, 3) + 1)) INTEGRATION_ID,
        MAX(GLOBAL1_EXCHANGE_RATE) GLOBAL1_EXCHANGE_RATE,
        MAX(GLOBAL2_EXCHANGE_RATE) GLOBAL2_EXCHANGE_RATE,
        MAX(GLOBAL3_EXCHANGE_RATE) GLOBAL3_EXCHANGE_RATE,
        MAX(LOC_EXCHANGE_RATE) LOC_EXCHANGE_RATE,
        BBG_RETAIL_TYPE_WID,
        SUM(NVL(BBG_CUSTOMER_COUNT, 0)) BBG_CUSTOMER_COUNT,
        SUM(NVL(BBG_SERVICE_SATISFACTION, 0)) BBG_SERVICE_SATISFACTION,
        SYSDATE W_INSERT_DT,
        SYSDATE W_UPDATE_DT,
        MAX(BBG_REFERENCE_DO1) BBG_REFERENCE_DO1,
        MAX(BBG_REFERENCE_DO2) BBG_REFERENCE_DO2,
        MAX(BBG_REFERENCE_DO3) BBG_REFERENCE_DO3,
        MAX(BBG_REFERENCE_DO4) BBG_REFERENCE_DO4,
        MAX(BBG_REFERENCE_DO5) BBG_REFERENCE_DO5,
        MAX(BBG_REFERENCE_FO1) BBG_REFERENCE_FO1,
        MAX(BBG_REFERENCE_FO2) BBG_REFERENCE_FO2,
        MAX(BBG_REFERENCE_FO3) BBG_REFERENCE_FO3,
        MAX(BBG_REFERENCE_FO4) BBG_REFERENCE_FO4,
        MAX(BBG_REFERENCE_FO5) BBG_REFERENCE_FO5,
        MAX(BBG_REFERENCE_FO6) BBG_REFERENCE_FO6,
        MAX(BBG_REFERENCE_FO7) BBG_REFERENCE_FO7,
        MAX(BBG_REFERENCE_FO8) BBG_REFERENCE_FO8,
        MAX(BBG_REFERENCE_FO9) BBG_REFERENCE_FO9,
        MAX(BBG_REFERENCE_FO10) BBG_REFERENCE_FO10,
        SUM(NVL(vip_sls_qty, 0)) vip_sls_qty,
        SUM(NVL(vip_sls_amt_lcl, 0)) vip_sls_amt_lcl,
        SUM(NVL(vip_sls_profit_amt_lcl, 0)) vip_sls_profit_amt_lcl,
        SUM(NVL(vip_sls_manual_mkdn_amt_lcl, 0)) vip_sls_manual_mkdn_amt_lcl,
        SUM(NVL(vip_sls_manual_mkup_amt_lcl, 0)) vip_sls_manual_mkup_amt_lcl,
        SUM(NVL(vip_sls_tax_amt_lcl, 0)) vip_sls_tax_amt_lcl,
        SUM(NVL(vip_sls_emp_disc_amt_lcl, 0)) vip_sls_emp_disc_amt_lcl,
        SUM(NVL(vip_sls_manual_count, 0)) vip_sls_manual_count,
        SUM(NVL(vip_sls_scan_count, 0)) vip_sls_scan_count,
        SUM(NVL(vip_ret_qty, 0)) vip_ret_qty,
        SUM(NVL(vip_ret_amt_lcl, 0)) vip_ret_amt_lcl,
        SUM(NVL(vip_ret_profit_amt_lcl, 0)) vip_ret_profit_amt_lcl,
        SUM(NVL(vip_ret_manual_mkdn_amt_lcl, 0)) vip_ret_manual_mkdn_amt_lcl,
        SUM(NVL(vip_ret_manual_mkup_amt_lcl, 0)) vip_ret_manual_mkup_amt_lcl,
        SUM(NVL(vip_ret_tax_amt_lcl, 0)) vip_ret_tax_amt_lcl,
        SUM(NVL(vip_ret_emp_disc_amt_lcl, 0)) vip_ret_emp_disc_amt_lcl,
        SUM(NVL(vip_ret_manual_count, 0)) vip_ret_manual_count,
        SUM(NVL(vip_ret_scan_count, 0)) vip_ret_scan_count,
        SUM(NVL(SLS_COUPON_AMT_LCL, 0)) SLS_COUPON_AMT_LCL,
        SUM(NVL(RET_COUPON_AMT_LCL, 0)) RET_COUPON_AMT_LCL,
        SUM(NVL(SLS_TAX_COUPON_AMT_LCL, 0)) SLS_TAX_COUPON_AMT_LCL,
        SUM(NVL(RET_TAX_COUPON_AMT_LCL, 0)) RET_TAX_COUPON_AMT_LCL
         FROM RADM.W_RTL_SLS_SC_LC_DY_A
        WHERE DT_WID BETWEEN 120160601000 AND 120160630000
        GROUP BY PROD_DH_WID,
                 ORG_WID,
                 SUBSTR(TO_CHAR(DT_WID), 2, 6),
                 RTL_TYPE_WID,
                 BBG_RETAIL_TYPE_WID) S
ON (T.PROD_DH_WID = S.PROD_DH_WID AND T.ORG_WID = S.ORG_WID AND T.MN_WID = S.MN_WID AND T.RTL_TYPE_WID = S.RTL_TYPE_WID AND T.BBG_RETAIL_TYPE_WID = S.BBG_RETAIL_TYPE_WID)
WHEN MATCHED THEN
  UPDATE
     SET T.SLS_QTY                     = S.SLS_QTY,
         T.SLS_AMT_LCL                 = S.SLS_AMT_LCL,
         T.SLS_PROFIT_AMT_LCL          = S.SLS_PROFIT_AMT_LCL,
         T.SLS_MANUAL_MKDN_AMT_LCL     = S.SLS_MANUAL_MKDN_AMT_LCL,
         T.SLS_MANUAL_MKUP_AMT_LCL     = S.SLS_MANUAL_MKUP_AMT_LCL,
         T.SLS_TAX_AMT_LCL             = S.SLS_TAX_AMT_LCL,
         T.SLS_EMP_DISC_AMT_LCL        = S.SLS_EMP_DISC_AMT_LCL,
         T.SLS_MANUAL_COUNT            = S.SLS_MANUAL_COUNT,
         T.SLS_SCAN_COUNT              = S.SLS_SCAN_COUNT,
         T.RET_QTY                     = S.RET_QTY,
         T.RET_AMT_LCL                 = S.RET_AMT_LCL,
         T.RET_PROFIT_AMT_LCL          = S.RET_PROFIT_AMT_LCL,
         T.RET_MANUAL_MKDN_AMT_LCL     = S.RET_MANUAL_MKDN_AMT_LCL,
         T.RET_MANUAL_MKUP_AMT_LCL     = S.RET_MANUAL_MKUP_AMT_LCL,
         T.RET_TAX_AMT_LCL             = S.RET_TAX_AMT_LCL,
         T.RET_EMP_DISC_AMT_LCL        = S.RET_EMP_DISC_AMT_LCL,
         T.RET_MANUAL_COUNT            = S.RET_MANUAL_COUNT,
         T.RET_SCAN_COUNT              = S.RET_SCAN_COUNT,
         T.BBG_CUSTOMER_COUNT          = S.BBG_CUSTOMER_COUNT,
         T.BBG_SERVICE_SATISFACTION    = S.BBG_SERVICE_SATISFACTION,
         T.W_UPDATE_DT                 = S.W_UPDATE_DT,
         T.BBG_REFERENCE_FO1           = S.BBG_REFERENCE_FO1,
         T.BBG_REFERENCE_FO2           = S.BBG_REFERENCE_FO2,
         T.BBG_REFERENCE_FO3           = S.BBG_REFERENCE_FO3,
         T.BBG_REFERENCE_FO4           = S.BBG_REFERENCE_FO4,
         T.BBG_REFERENCE_FO5           = S.BBG_REFERENCE_FO5,
         T.BBG_REFERENCE_FO6           = S.BBG_REFERENCE_FO6,
         T.BBG_REFERENCE_FO7           = S.BBG_REFERENCE_FO7,
         T.BBG_REFERENCE_FO8           = S.BBG_REFERENCE_FO8,
         T.BBG_REFERENCE_FO9           = S.BBG_REFERENCE_FO9,
         T.BBG_REFERENCE_FO10          = S.BBG_REFERENCE_FO10,
         T.vip_sls_qty                 = S.vip_sls_qty,
         T.vip_sls_amt_lcl             = S.vip_sls_amt_lcl,
         T.vip_sls_profit_amt_lcl      = S.vip_sls_profit_amt_lcl,
         T.vip_sls_manual_mkdn_amt_lcl = S.vip_sls_manual_mkdn_amt_lcl,
         T.vip_sls_manual_mkup_amt_lcl = S.vip_sls_manual_mkup_amt_lcl,
         T.vip_sls_tax_amt_lcl         = S.vip_sls_tax_amt_lcl,
         T.vip_sls_emp_disc_amt_lcl    = S.vip_sls_emp_disc_amt_lcl,
         T.vip_sls_manual_count        = S.vip_sls_manual_count,
         T.vip_sls_scan_count          = S.vip_sls_scan_count,
         T.vip_ret_qty                 = S.vip_ret_qty,
         T.vip_ret_amt_lcl             = S.vip_ret_amt_lcl,
         T.vip_ret_profit_amt_lcl      = S.vip_ret_profit_amt_lcl,
         T.vip_ret_manual_mkdn_amt_lcl = S.vip_ret_manual_mkdn_amt_lcl,
         T.vip_ret_manual_mkup_amt_lcl = S.vip_ret_manual_mkup_amt_lcl,
         T.vip_ret_tax_amt_lcl         = S.vip_ret_tax_amt_lcl,
         T.vip_ret_emp_disc_amt_lcl    = S.vip_ret_emp_disc_amt_lcl,
         T.vip_ret_manual_count        = S.vip_ret_manual_count,
         T.vip_ret_scan_count          = S.vip_ret_scan_count,
         T.SLS_COUPON_AMT_LCL          = S.SLS_COUPON_AMT_LCL,
         T.RET_COUPON_AMT_LCL          = S.RET_COUPON_AMT_LCL,
         T.SLS_TAX_COUPON_AMT_LCL      = S.SLS_TAX_COUPON_AMT_LCL,
         T.RET_TAX_COUPON_AMT_LCL      = S.RET_TAX_COUPON_AMT_LCL
  

WHEN NOT MATCHED THEN
  INSERT
    (T.PROD_DH_WID,
     T.ORG_WID,
     T.ORG_SCD1_WID,
     T.ORG_DH_WID,
     T.MN_WID,
     T.RTL_TYPE_WID,
     T.SLS_QTY,
     T.SLS_AMT_LCL,
     T.SLS_PROFIT_AMT_LCL,
     T.SLS_MANUAL_MKDN_AMT_LCL,
     T.SLS_MANUAL_MKUP_AMT_LCL,
     T.SLS_TAX_AMT_LCL,
     T.SLS_EMP_DISC_AMT_LCL,
     T.SLS_MANUAL_COUNT,
     T.SLS_SCAN_COUNT,
     T.RET_QTY,
     T.RET_AMT_LCL,
     T.RET_PROFIT_AMT_LCL,
     T.RET_MANUAL_MKDN_AMT_LCL,
     T.RET_MANUAL_MKUP_AMT_LCL,
     T.RET_TAX_AMT_LCL,
     T.RET_EMP_DISC_AMT_LCL,
     T.RET_MANUAL_COUNT,
     T.RET_SCAN_COUNT,
     T.INTEGRATION_ID,
     T.GLOBAL1_EXCHANGE_RATE,
     T.GLOBAL2_EXCHANGE_RATE,
     T.GLOBAL3_EXCHANGE_RATE,
     T.LOC_EXCHANGE_RATE,
     T.BBG_RETAIL_TYPE_WID,
     T.BBG_CUSTOMER_COUNT,
     T.BBG_SERVICE_SATISFACTION,
     T.W_INSERT_DT,
     T.W_UPDATE_DT,
     T.BBG_REFERENCE_DO1,
     T.BBG_REFERENCE_DO2,
     T.BBG_REFERENCE_DO3,
     T.BBG_REFERENCE_DO4,
     T.BBG_REFERENCE_DO5,
     T.BBG_REFERENCE_FO1,
     T.BBG_REFERENCE_FO2,
     T.BBG_REFERENCE_FO3,
     T.BBG_REFERENCE_FO4,
     T.BBG_REFERENCE_FO5,
     T.BBG_REFERENCE_FO6,
     T.BBG_REFERENCE_FO7,
     T.BBG_REFERENCE_FO8,
     T.BBG_REFERENCE_FO9,
     T.BBG_REFERENCE_FO10,
     T.vip_sls_qty,
     T.vip_sls_amt_lcl,
     T.vip_sls_profit_amt_lcl,
     T.vip_sls_manual_mkdn_amt_lcl,
     T.vip_sls_manual_mkup_amt_lcl,
     T.vip_sls_tax_amt_lcl,
     T.vip_sls_emp_disc_amt_lcl,
     T.vip_sls_manual_count,
     T.vip_sls_scan_count,
     T.vip_ret_qty,
     T.vip_ret_amt_lcl,
     T.vip_ret_profit_amt_lcl,
     T.vip_ret_manual_mkdn_amt_lcl,
     T.vip_ret_manual_mkup_amt_lcl,
     T.vip_ret_tax_amt_lcl,
     T.vip_ret_emp_disc_amt_lcl,
     T.vip_ret_manual_count,
     T.vip_ret_scan_count,
     T.SLS_COUPON_AMT_LCL,
     T.RET_COUPON_AMT_LCL,
     T.SLS_TAX_COUPON_AMT_LCL,
     T.RET_TAX_COUPON_AMT_LCL)
  VALUES
    (S.PROD_DH_WID,
     S.ORG_WID,
     S.ORG_SCD1_WID,
     S.ORG_DH_WID,
     S.MN_WID,
     S.RTL_TYPE_WID,
     S.SLS_QTY,
     S.SLS_AMT_LCL,
     S.SLS_PROFIT_AMT_LCL,
     S.SLS_MANUAL_MKDN_AMT_LCL,
     S.SLS_MANUAL_MKUP_AMT_LCL,
     S.SLS_TAX_AMT_LCL,
     S.SLS_EMP_DISC_AMT_LCL,
     S.SLS_MANUAL_COUNT,
     S.SLS_SCAN_COUNT,
     S.RET_QTY,
     S.RET_AMT_LCL,
     S.RET_PROFIT_AMT_LCL,
     S.RET_MANUAL_MKDN_AMT_LCL,
     S.RET_MANUAL_MKUP_AMT_LCL,
     S.RET_TAX_AMT_LCL,
     S.RET_EMP_DISC_AMT_LCL,
     S.RET_MANUAL_COUNT,
     S.RET_SCAN_COUNT,
     S.INTEGRATION_ID,
     S.GLOBAL1_EXCHANGE_RATE,
     S.GLOBAL2_EXCHANGE_RATE,
     S.GLOBAL3_EXCHANGE_RATE,
     S.LOC_EXCHANGE_RATE,
     S.BBG_RETAIL_TYPE_WID,
     S.BBG_CUSTOMER_COUNT,
     S.BBG_SERVICE_SATISFACTION,
     S.W_INSERT_DT,
     S.W_UPDATE_DT,
     S.BBG_REFERENCE_DO1,
     S.BBG_REFERENCE_DO2,
     S.BBG_REFERENCE_DO3,
     S.BBG_REFERENCE_DO4,
     S.BBG_REFERENCE_DO5,
     S.BBG_REFERENCE_FO1,
     S.BBG_REFERENCE_FO2,
     S.BBG_REFERENCE_FO3,
     S.BBG_REFERENCE_FO4,
     S.BBG_REFERENCE_FO5,
     S.BBG_REFERENCE_FO6,
     S.BBG_REFERENCE_FO7,
     S.BBG_REFERENCE_FO8,
     S.BBG_REFERENCE_FO9,
     S.BBG_REFERENCE_FO10,
     S.vip_sls_qty,
     S.vip_sls_amt_lcl,
     S.vip_sls_profit_amt_lcl,
     S.vip_sls_manual_mkdn_amt_lcl,
     S.vip_sls_manual_mkup_amt_lcl,
     S.vip_sls_tax_amt_lcl,
     S.vip_sls_emp_disc_amt_lcl,
     S.vip_sls_manual_count,
     S.vip_sls_scan_count,
     S.vip_ret_qty,
     S.vip_ret_amt_lcl,
     S.vip_ret_profit_amt_lcl,
     S.vip_ret_manual_mkdn_amt_lcl,
     S.vip_ret_manual_mkup_amt_lcl,
     S.vip_ret_tax_amt_lcl,
     S.vip_ret_emp_disc_amt_lcl,
     S.vip_ret_manual_count,
     S.vip_ret_scan_count,
     S.SLS_COUPON_AMT_LCL,
     S.RET_COUPON_AMT_LCL,
     S.SLS_TAX_COUPON_AMT_LCL,
     S.RET_TAX_COUPON_AMT_LCL);
COMMIT;

--3.W_RTL_SLS_LC_MN_A
MERGE /*+APPEND PARALLEL(16)*/
INTO RADM.W_RTL_SLS_LC_MN_A T
USING (SELECT /*+PARALLEL(16)*/
        ORG_WID,
        MAX(ORG_DH_WID) ORG_DH_WID,
        MAX(ORG_SCD1_WID) ORG_SCD1_WID,
        SUBSTR(TO_CHAR(DT_WID), 2, 6) MN_WID,
        RTL_TYPE_WID,
        SUM(NVL(SLS_QTY, 0)) SLS_QTY,
        SUM(NVL(SLS_AMT_LCL, 0)) SLS_AMT_LCL,
        SUM(NVL(SLS_PROFIT_AMT_LCL, 0)) SLS_PROFIT_AMT_LCL,
        SUM(NVL(SLS_TAX_AMT_LCL, 0)) SLS_TAX_AMT_LCL,
        SUM(NVL(SLS_EMP_DISC_AMT_LCL, 0)) SLS_EMP_DISC_AMT_LCL,
        SUM(NVL(SLS_MANUAL_MKDN_AMT_LCL, 0)) SLS_MANUAL_MKDN_AMT_LCL,
        SUM(NVL(SLS_MANUAL_MKUP_AMT_LCL, 0)) SLS_MANUAL_MKUP_AMT_LCL,
        SUM(NVL(SLS_TRX_COUNT, 0)) SLS_TRX_COUNT,
        SUM(NVL(RET_QTY, 0)) RET_QTY,
        SUM(NVL(RET_AMT_LCL, 0)) RET_AMT_LCL,
        SUM(NVL(RET_PROFIT_AMT_LCL, 0)) RET_PROFIT_AMT_LCL,
        SUM(NVL(RET_TAX_AMT_LCL, 0)) RET_TAX_AMT_LCL,
        SUM(NVL(RET_EMP_DISC_AMT_LCL, 0)) RET_EMP_DISC_AMT_LCL,
        SUM(NVL(RET_MANUAL_MKDN_AMT_LCL, 0)) RET_MANUAL_MKDN_AMT_LCL,
        SUM(NVL(RET_MANUAL_MKUP_AMT_LCL, 0)) RET_MANUAL_MKUP_AMT_LCL,
        SUM(NVL(RET_TRX_COUNT, 0)) RET_TRX_COUNT,
        MAX(SUBSTR(INTEGRATION_ID, 1, INSTR(INTEGRATION_ID, '~', 1, 1)) ||
            SUBSTR(TO_CHAR(DT_WID), 2, 6) ||
            SUBSTR(INTEGRATION_ID,
                   INSTR(INTEGRATION_ID, '~', 1, 2),
                   INSTR(INTEGRATION_ID, '~', 1, 3) -
                   INSTR(INTEGRATION_ID, '~', 1, 2)) ||
            SUBSTR(INTEGRATION_ID,
                   INSTR(INTEGRATION_ID, '~', 1, 3),
                   LENGTH(INTEGRATION_ID) - INSTR(INTEGRATION_ID, '~', 1, 3) + 1)) INTEGRATION_ID,
        max(GLOBAL1_EXCHANGE_RATE) GLOBAL1_EXCHANGE_RATE,
        max(GLOBAL2_EXCHANGE_RATE) GLOBAL2_EXCHANGE_RATE,
        max(GLOBAL3_EXCHANGE_RATE) GLOBAL3_EXCHANGE_RATE,
        max(LOC_EXCHANGE_RATE) LOC_EXCHANGE_RATE,
        BBG_RETAIL_TYPE_WID,
        SUM(NVL(BBG_CUSTOMER_COUNT, 0)) BBG_CUSTOMER_COUNT,
        SUM(NVL(BBG_SERVICE_SATISFACTION, 0)) BBG_SERVICE_SATISFACTION,
        SYSDATE W_INSERT_DT,
        SYSDATE W_UPDATE_DT,
        MAX(BBG_REFERENCE_DO1) BBG_REFERENCE_DO1,
        MAX(BBG_REFERENCE_DO2) BBG_REFERENCE_DO2,
        MAX(BBG_REFERENCE_DO3) BBG_REFERENCE_DO3,
        MAX(BBG_REFERENCE_DO4) BBG_REFERENCE_DO4,
        MAX(BBG_REFERENCE_DO5) BBG_REFERENCE_DO5,
        MAX(BBG_REFERENCE_FO1) BBG_REFERENCE_FO1,
        MAX(BBG_REFERENCE_FO2) BBG_REFERENCE_FO2,
        MAX(BBG_REFERENCE_FO3) BBG_REFERENCE_FO3,
        MAX(BBG_REFERENCE_FO4) BBG_REFERENCE_FO4,
        MAX(BBG_REFERENCE_FO5) BBG_REFERENCE_FO5,
        MAX(BBG_REFERENCE_FO6) BBG_REFERENCE_FO6,
        MAX(BBG_REFERENCE_FO7) BBG_REFERENCE_FO7,
        MAX(BBG_REFERENCE_FO8) BBG_REFERENCE_FO8,
        MAX(BBG_REFERENCE_FO9) BBG_REFERENCE_FO9,
        MAX(BBG_REFERENCE_FO10) BBG_REFERENCE_FO10,
        SUM(NVL(vip_sls_qty, 0)) vip_sls_qty,
        SUM(NVL(vip_sls_amt_lcl, 0)) vip_sls_amt_lcl,
        SUM(NVL(vip_sls_profit_amt_lcl, 0)) vip_sls_profit_amt_lcl,
        SUM(NVL(vip_sls_manual_mkdn_amt_lcl, 0)) vip_sls_manual_mkdn_amt_lcl,
        SUM(NVL(vip_sls_manual_mkup_amt_lcl, 0)) vip_sls_manual_mkup_amt_lcl,
        SUM(NVL(vip_sls_tax_amt_lcl, 0)) vip_sls_tax_amt_lcl,
        SUM(NVL(vip_sls_emp_disc_amt_lcl, 0)) vip_sls_emp_disc_amt_lcl,
        SUM(NVL(vip_sls_trx_count, 0)) vip_sls_trx_count,
        SUM(NVL(vip_ret_qty, 0)) vip_ret_qty,
        SUM(NVL(vip_ret_amt_lcl, 0)) vip_ret_amt_lcl,
        SUM(NVL(vip_ret_profit_amt_lcl, 0)) vip_ret_profit_amt_lcl,
        SUM(NVL(vip_ret_manual_mkdn_amt_lcl, 0)) vip_ret_manual_mkdn_amt_lcl,
        SUM(NVL(vip_ret_manual_mkup_amt_lcl, 0)) vip_ret_manual_mkup_amt_lcl,
        SUM(NVL(vip_ret_tax_amt_lcl, 0)) vip_ret_tax_amt_lcl,
        SUM(NVL(vip_ret_emp_disc_amt_lcl, 0)) vip_ret_emp_disc_amt_lcl,
        SUM(NVL(vip_ret_trx_count, 0)) vip_ret_trx_count,
        SUM(NVL(SLS_COUPON_AMT_LCL, 0)) SLS_COUPON_AMT_LCL,
        SUM(NVL(RET_COUPON_AMT_LCL, 0)) RET_COUPON_AMT_LCL,
        SUM(NVL(SLS_TAX_COUPON_AMT_LCL, 0)) SLS_TAX_COUPON_AMT_LCL,
        SUM(NVL(RET_TAX_COUPON_AMT_LCL, 0)) RET_TAX_COUPON_AMT_LCL
         FROM RADM.W_RTL_SLS_LC_DY_A
        WHERE DT_WID BETWEEN 120160601000 AND 120160630000
        GROUP BY ORG_WID,
                 SUBSTR(TO_CHAR(DT_WID), 2, 6),
                 RTL_TYPE_WID,
                 BBG_RETAIL_TYPE_WID) S
ON (T.ORG_WID = S.ORG_WID AND T.MN_WID = S.MN_WID AND T.RTL_TYPE_WID = S.RTL_TYPE_WID AND T.BBG_RETAIL_TYPE_WID = S.BBG_RETAIL_TYPE_WID)
WHEN MATCHED THEN
  UPDATE
     SET T.SLS_QTY                     = S.SLS_QTY,
         T.SLS_AMT_LCL                 = S.SLS_AMT_LCL,
         T.SLS_PROFIT_AMT_LCL          = S.SLS_PROFIT_AMT_LCL,
         T.SLS_TAX_AMT_LCL             = S.SLS_TAX_AMT_LCL,
         T.SLS_EMP_DISC_AMT_LCL        = S.SLS_EMP_DISC_AMT_LCL,
         T.SLS_MANUAL_MKDN_AMT_LCL     = S.SLS_MANUAL_MKDN_AMT_LCL,
         T.SLS_MANUAL_MKUP_AMT_LCL     = S.SLS_MANUAL_MKUP_AMT_LCL,
         T.SLS_TRX_COUNT               = S.SLS_TRX_COUNT,
         T.RET_QTY                     = S.RET_QTY,
         T.RET_AMT_LCL                 = S.RET_AMT_LCL,
         T.RET_PROFIT_AMT_LCL          = S.RET_PROFIT_AMT_LCL,
         T.RET_TAX_AMT_LCL             = S.RET_TAX_AMT_LCL,
         T.RET_EMP_DISC_AMT_LCL        = S.RET_EMP_DISC_AMT_LCL,
         T.RET_MANUAL_MKDN_AMT_LCL     = S.RET_MANUAL_MKDN_AMT_LCL,
         T.RET_MANUAL_MKUP_AMT_LCL     = S.RET_MANUAL_MKUP_AMT_LCL,
         T.RET_TRX_COUNT               = S.RET_TRX_COUNT,
         T.GLOBAL1_EXCHANGE_RATE       = S.GLOBAL1_EXCHANGE_RATE,
         T.GLOBAL2_EXCHANGE_RATE       = S.GLOBAL2_EXCHANGE_RATE,
         T.GLOBAL3_EXCHANGE_RATE       = S.GLOBAL3_EXCHANGE_RATE,
         T.LOC_EXCHANGE_RATE           = S.LOC_EXCHANGE_RATE,
         T.BBG_CUSTOMER_COUNT          = S.BBG_CUSTOMER_COUNT,
         T.BBG_SERVICE_SATISFACTION    = S.BBG_SERVICE_SATISFACTION,
         T.W_UPDATE_DT                 = S.W_UPDATE_DT,
         T.BBG_REFERENCE_FO1           = S.BBG_REFERENCE_FO1,
         T.BBG_REFERENCE_FO2           = S.BBG_REFERENCE_FO2,
         T.BBG_REFERENCE_FO3           = S.BBG_REFERENCE_FO3,
         T.BBG_REFERENCE_FO4           = S.BBG_REFERENCE_FO4,
         T.BBG_REFERENCE_FO5           = S.BBG_REFERENCE_FO5,
         T.BBG_REFERENCE_FO6           = S.BBG_REFERENCE_FO6,
         T.BBG_REFERENCE_FO7           = S.BBG_REFERENCE_FO7,
         T.BBG_REFERENCE_FO8           = S.BBG_REFERENCE_FO8,
         T.BBG_REFERENCE_FO9           = S.BBG_REFERENCE_FO9,
         T.BBG_REFERENCE_FO10          = S.BBG_REFERENCE_FO10,
         T.vip_sls_qty                 = S.vip_sls_qty,
         T.vip_sls_amt_lcl             = S.vip_sls_amt_lcl,
         T.vip_sls_profit_amt_lcl      = S.vip_sls_profit_amt_lcl,
         T.vip_sls_manual_mkdn_amt_lcl = S.vip_sls_manual_mkdn_amt_lcl,
         T.vip_sls_manual_mkup_amt_lcl = S.vip_sls_manual_mkup_amt_lcl,
         T.vip_sls_tax_amt_lcl         = S.vip_sls_tax_amt_lcl,
         T.vip_sls_emp_disc_amt_lcl    = S.vip_sls_emp_disc_amt_lcl,
         T.vip_sls_trx_count           = S.vip_sls_trx_count,
         T.vip_ret_qty                 = S.vip_ret_qty,
         T.vip_ret_amt_lcl             = S.vip_ret_amt_lcl,
         T.vip_ret_profit_amt_lcl      = S.vip_ret_profit_amt_lcl,
         T.vip_ret_manual_mkdn_amt_lcl = S.vip_ret_manual_mkdn_amt_lcl,
         T.vip_ret_manual_mkup_amt_lcl = S.vip_ret_manual_mkup_amt_lcl,
         T.vip_ret_tax_amt_lcl         = S.vip_ret_tax_amt_lcl,
         T.vip_ret_emp_disc_amt_lcl    = S.vip_ret_emp_disc_amt_lcl,
         T.vip_ret_trx_count           = S.vip_ret_trx_count,
         T.SLS_COUPON_AMT_LCL          = S.SLS_COUPON_AMT_LCL,
         T.RET_COUPON_AMT_LCL          = S.RET_COUPON_AMT_LCL,
         T.SLS_TAX_COUPON_AMT_LCL      = S.SLS_TAX_COUPON_AMT_LCL,
         T.RET_TAX_COUPON_AMT_LCL      = S.RET_TAX_COUPON_AMT_LCL
WHEN NOT MATCHED THEN
  INSERT
    (T.ORG_WID,
     T.ORG_DH_WID,
     T.ORG_SCD1_WID,
     T.MN_WID,
     T.RTL_TYPE_WID,
     T.SLS_QTY,
     T.SLS_AMT_LCL,
     T.SLS_PROFIT_AMT_LCL,
     T.SLS_TAX_AMT_LCL,
     T.SLS_EMP_DISC_AMT_LCL,
     T.SLS_MANUAL_MKDN_AMT_LCL,
     T.SLS_MANUAL_MKUP_AMT_LCL,
     T.SLS_TRX_COUNT,
     T.RET_QTY,
     T.RET_AMT_LCL,
     T.RET_PROFIT_AMT_LCL,
     T.RET_TAX_AMT_LCL,
     T.RET_EMP_DISC_AMT_LCL,
     T.RET_MANUAL_MKDN_AMT_LCL,
     T.RET_MANUAL_MKUP_AMT_LCL,
     T.RET_TRX_COUNT,
     T.INTEGRATION_ID,
     T.GLOBAL1_EXCHANGE_RATE,
     T.GLOBAL2_EXCHANGE_RATE,
     T.GLOBAL3_EXCHANGE_RATE,
     T.LOC_EXCHANGE_RATE,
     T.BBG_RETAIL_TYPE_WID,
     T.BBG_CUSTOMER_COUNT,
     T.BBG_SERVICE_SATISFACTION,
     T.W_INSERT_DT,
     T.W_UPDATE_DT,
     T.BBG_REFERENCE_DO1,
     T.BBG_REFERENCE_DO2,
     T.BBG_REFERENCE_DO3,
     T.BBG_REFERENCE_DO4,
     T.BBG_REFERENCE_DO5,
     T.BBG_REFERENCE_FO1,
     T.BBG_REFERENCE_FO2,
     T.BBG_REFERENCE_FO3,
     T.BBG_REFERENCE_FO4,
     T.BBG_REFERENCE_FO5,
     T.BBG_REFERENCE_FO6,
     T.BBG_REFERENCE_FO7,
     T.BBG_REFERENCE_FO8,
     T.BBG_REFERENCE_FO9,
     T.BBG_REFERENCE_FO10,
     T.vip_sls_qty,
     T.vip_sls_amt_lcl,
     T.vip_sls_profit_amt_lcl,
     T.vip_sls_manual_mkdn_amt_lcl,
     T.vip_sls_manual_mkup_amt_lcl,
     T.vip_sls_tax_amt_lcl,
     T.vip_sls_emp_disc_amt_lcl,
     T.vip_sls_trx_count,
     T.vip_ret_qty,
     T.vip_ret_amt_lcl,
     T.vip_ret_profit_amt_lcl,
     T.vip_ret_manual_mkdn_amt_lcl,
     T.vip_ret_manual_mkup_amt_lcl,
     T.vip_ret_tax_amt_lcl,
     T.vip_ret_emp_disc_amt_lcl,
     T.vip_ret_trx_count,
     T.SLS_COUPON_AMT_LCL,
     T.RET_COUPON_AMT_LCL,
     T.SLS_TAX_COUPON_AMT_LCL,
     T.RET_TAX_COUPON_AMT_LCL)
  VALUES
    (S.ORG_WID,
     S.ORG_DH_WID,
     S.ORG_SCD1_WID,
     S.MN_WID,
     S.RTL_TYPE_WID,
     S.SLS_QTY,
     S.SLS_AMT_LCL,
     S.SLS_PROFIT_AMT_LCL,
     S.SLS_TAX_AMT_LCL,
     S.SLS_EMP_DISC_AMT_LCL,
     S.SLS_MANUAL_MKDN_AMT_LCL,
     S.SLS_MANUAL_MKUP_AMT_LCL,
     S.SLS_TRX_COUNT,
     S.RET_QTY,
     S.RET_AMT_LCL,
     S.RET_PROFIT_AMT_LCL,
     S.RET_TAX_AMT_LCL,
     S.RET_EMP_DISC_AMT_LCL,
     S.RET_MANUAL_MKDN_AMT_LCL,
     S.RET_MANUAL_MKUP_AMT_LCL,
     S.RET_TRX_COUNT,
     S.INTEGRATION_ID,
     S.GLOBAL1_EXCHANGE_RATE,
     S.GLOBAL2_EXCHANGE_RATE,
     S.GLOBAL3_EXCHANGE_RATE,
     S.LOC_EXCHANGE_RATE,
     S.BBG_RETAIL_TYPE_WID,
     S.BBG_CUSTOMER_COUNT,
     S.BBG_SERVICE_SATISFACTION,
     S.W_INSERT_DT,
     S.W_UPDATE_DT,
     S.BBG_REFERENCE_DO1,
     S.BBG_REFERENCE_DO2,
     S.BBG_REFERENCE_DO3,
     S.BBG_REFERENCE_DO4,
     S.BBG_REFERENCE_DO5,
     S.BBG_REFERENCE_FO1,
     S.BBG_REFERENCE_FO2,
     S.BBG_REFERENCE_FO3,
     S.BBG_REFERENCE_FO4,
     S.BBG_REFERENCE_FO5,
     S.BBG_REFERENCE_FO6,
     S.BBG_REFERENCE_FO7,
     S.BBG_REFERENCE_FO8,
     S.BBG_REFERENCE_FO9,
     S.BBG_REFERENCE_FO10,
     S.vip_sls_qty,
     S.vip_sls_amt_lcl,
     S.vip_sls_profit_amt_lcl,
     S.vip_sls_manual_mkdn_amt_lcl,
     S.vip_sls_manual_mkup_amt_lcl,
     S.vip_sls_tax_amt_lcl,
     S.vip_sls_emp_disc_amt_lcl,
     S.vip_sls_trx_count,
     S.vip_ret_qty,
     S.vip_ret_amt_lcl,
     S.vip_ret_profit_amt_lcl,
     S.vip_ret_manual_mkdn_amt_lcl,
     S.vip_ret_manual_mkup_amt_lcl,
     S.vip_ret_tax_amt_lcl,
     S.vip_ret_emp_disc_amt_lcl,
     S.vip_ret_trx_count,
     S.SLS_COUPON_AMT_LCL,
     S.RET_COUPON_AMT_LCL,
     S.SLS_TAX_COUPON_AMT_LCL,
     S.RET_TAX_COUPON_AMT_LCL);
COMMIT;

--4.W_RTL_SLS_IT_LC_MN_A:

--5.W_RTL_SLS_DP_LC_MN_A
MERGE /*+APPEND PARALLEL(16)*/
INTO RADM.W_RTL_SLS_DP_LC_MN_A T
USING (SELECT /*+PARALLEL(16)*/
        ORG_WID,
        MAX(ORG_DH_WID) ORG_DH_WID,
        MAX(ORG_SCD1_WID) ORG_SCD1_WID,
        PROD_DH_WID,
        SUBSTR(TO_CHAR(DT_WID), 2, 6) MN_WID,
        RTL_TYPE_WID,
        SUM(NVL(SLS_QTY, 0)) SLS_QTY,
        SUM(NVL(SLS_AMT_LCL, 0)) SLS_AMT_LCL,
        SUM(NVL(SLS_PROFIT_AMT_LCL, 0)) SLS_PROFIT_AMT_LCL,
        SUM(NVL(SLS_TAX_AMT_LCL, 0)) SLS_TAX_AMT_LCL,
        SUM(NVL(SLS_EMP_DISC_AMT_LCL, 0)) SLS_EMP_DISC_AMT_LCL,
        SUM(NVL(SLS_MANUAL_MKDN_AMT_LCL, 0)) SLS_MANUAL_MKDN_AMT_LCL,
        SUM(NVL(SLS_MANUAL_MKUP_AMT_LCL, 0)) SLS_MANUAL_MKUP_AMT_LCL,
        SUM(NVL(RET_QTY, 0)) RET_QTY,
        SUM(NVL(RET_AMT_LCL, 0)) RET_AMT_LCL,
        SUM(NVL(RET_PROFIT_AMT_LCL, 0)) RET_PROFIT_AMT_LCL,
        SUM(NVL(RET_TAX_AMT_LCL, 0)) RET_TAX_AMT_LCL,
        SUM(NVL(RET_EMP_DISC_AMT_LCL, 0)) RET_EMP_DISC_AMT_LCL,
        SUM(NVL(RET_MANUAL_MKDN_AMT_LCL, 0)) RET_MANUAL_MKDN_AMT_LCL,
        SUM(NVL(RET_MANUAL_MKUP_AMT_LCL, 0)) RET_MANUAL_MKUP_AMT_LCL,
        SUM(NVL(SLS_MANUAL_COUNT, 0)) SLS_MANUAL_COUNT,
        SUM(NVL(SLS_SCAN_COUNT, 0)) SLS_SCAN_COUNT,
        SUM(NVL(RET_MANUAL_COUNT, 0)) RET_MANUAL_COUNT,
        SUM(NVL(RET_SCAN_COUNT, 0)) RET_SCAN_COUNT,
        MAX(SUBSTR(INTEGRATION_ID, 1, INSTR(INTEGRATION_ID, '~', 1, 1)) ||
            SUBSTR(INTEGRATION_ID,
                   INSTR(INTEGRATION_ID, '~', 1, 1) + 1,
                   INSTR(INTEGRATION_ID, '~', 1, 2) -
                   INSTR(INTEGRATION_ID, '~', 1, 1)) ||
            SUBSTR(TO_CHAR(DT_WID), 2, 6) ||
            SUBSTR(INTEGRATION_ID,
                   INSTR(INTEGRATION_ID, '~', 1, 3),
                   LENGTH(INTEGRATION_ID) - INSTR(INTEGRATION_ID, '~', 1, 3) + 1)) INTEGRATION_ID,
        MAX(GLOBAL1_EXCHANGE_RATE) GLOBAL1_EXCHANGE_RATE,
        MAX(GLOBAL2_EXCHANGE_RATE) GLOBAL2_EXCHANGE_RATE,
        MAX(GLOBAL3_EXCHANGE_RATE) GLOBAL3_EXCHANGE_RATE,
        MAX(LOC_EXCHANGE_RATE) LOC_EXCHANGE_RATE,
        BBG_RETAIL_TYPE_WID,
        SUM(NVL(BBG_CUSTOMER_COUNT, 0)) BBG_CUSTOMER_COUNT,
        SUM(NVL(BBG_SERVICE_SATISFACTION, 0)) BBG_SERVICE_SATISFACTION,
        SYSDATE W_INSERT_DT,
        SYSDATE W_UPDATE_DT,
        MAX(BBG_REFERENCE_DO1) BBG_REFERENCE_DO1,
        MAX(BBG_REFERENCE_DO2) BBG_REFERENCE_DO2,
        MAX(BBG_REFERENCE_DO3) BBG_REFERENCE_DO3,
        MAX(BBG_REFERENCE_DO4) BBG_REFERENCE_DO4,
        MAX(BBG_REFERENCE_DO5) BBG_REFERENCE_DO5,
        MAX(BBG_REFERENCE_FO1) BBG_REFERENCE_FO1,
        MAX(BBG_REFERENCE_FO2) BBG_REFERENCE_FO2,
        MAX(BBG_REFERENCE_FO3) BBG_REFERENCE_FO3,
        MAX(BBG_REFERENCE_FO4) BBG_REFERENCE_FO4,
        MAX(BBG_REFERENCE_FO5) BBG_REFERENCE_FO5,
        MAX(BBG_REFERENCE_FO6) BBG_REFERENCE_FO6,
        MAX(BBG_REFERENCE_FO7) BBG_REFERENCE_FO7,
        MAX(BBG_REFERENCE_FO8) BBG_REFERENCE_FO8,
        MAX(BBG_REFERENCE_FO9) BBG_REFERENCE_FO9,
        MAX(BBG_REFERENCE_FO10) BBG_REFERENCE_FO10,
        SUM(NVL(vip_sls_qty, 0)) vip_sls_qty,
        SUM(NVL(vip_sls_amt_lcl, 0)) vip_sls_amt_lcl,
        SUM(NVL(vip_sls_profit_amt_lcl, 0)) vip_sls_profit_amt_lcl,
        SUM(NVL(vip_sls_tax_amt_lcl, 0)) vip_sls_tax_amt_lcl,
        SUM(NVL(vip_sls_emp_disc_amt_lcl, 0)) vip_sls_emp_disc_amt_lcl,
        SUM(NVL(vip_ret_qty, 0)) vip_ret_qty,
        SUM(NVL(vip_ret_amt_lcl, 0)) vip_ret_amt_lcl,
        SUM(NVL(vip_ret_profit_amt_lcl, 0)) vip_ret_profit_amt_lcl,
        SUM(NVL(vip_ret_tax_amt_lcl, 0)) vip_ret_tax_amt_lcl,
        SUM(NVL(vip_ret_emp_disc_amt_lcl, 0)) vip_ret_emp_disc_amt_lcl,
        SUM(NVL(vip_sls_manual_mkdn_amt_lcl, 0)) vip_sls_manual_mkdn_amt_lcl,
        SUM(NVL(vip_sls_manual_mkup_amt_lcl, 0)) vip_sls_manual_mkup_amt_lcl,
        SUM(NVL(vip_ret_manual_mkdn_amt_lcl, 0)) vip_ret_manual_mkdn_amt_lcl,
        SUM(NVL(vip_ret_manual_mkup_amt_lcl, 0)) vip_ret_manual_mkup_amt_lcl,
        SUM(NVL(vip_sls_manual_count, 0)) vip_sls_manual_count,
        SUM(NVL(vip_sls_scan_count, 0)) vip_sls_scan_count,
        SUM(NVL(vip_ret_manual_count, 0)) vip_ret_manual_count,
        SUM(NVL(vip_ret_scan_count, 0)) vip_ret_scan_count,
        SUM(NVL(SLS_COUPON_AMT_LCL, 0)) SLS_COUPON_AMT_LCL,
        SUM(NVL(RET_COUPON_AMT_LCL, 0)) RET_COUPON_AMT_LCL,
        SUM(NVL(SLS_TAX_COUPON_AMT_LCL, 0)) SLS_TAX_COUPON_AMT_LCL,
        SUM(NVL(RET_TAX_COUPON_AMT_LCL, 0)) RET_TAX_COUPON_AMT_LCL
         FROM RADM.W_RTL_SLS_DP_LC_DY_A
        WHERE DT_WID BETWEEN 120160601000 AND 120160630000
        GROUP BY ORG_WID,
                 PROD_DH_WID,
                 SUBSTR(TO_CHAR(DT_WID), 2, 6),
                 RTL_TYPE_WID,
                 BBG_RETAIL_TYPE_WID) S
ON (T.ORG_WID = S.ORG_WID AND T.PROD_DH_WID = S.PROD_DH_WID AND T.MN_WID = S.MN_WID AND T.RTL_TYPE_WID = S.RTL_TYPE_WID AND T.BBG_RETAIL_TYPE_WID = S.BBG_RETAIL_TYPE_WID)
WHEN MATCHED THEN
  UPDATE
     SET T.SLS_QTY                     = S.SLS_QTY,
         T.SLS_AMT_LCL                 = S.SLS_AMT_LCL,
         T.SLS_PROFIT_AMT_LCL          = S.SLS_PROFIT_AMT_LCL,
         T.SLS_TAX_AMT_LCL             = S.SLS_TAX_AMT_LCL,
         T.SLS_EMP_DISC_AMT_LCL        = S.SLS_EMP_DISC_AMT_LCL,
         T.SLS_MANUAL_MKDN_AMT_LCL     = S.SLS_MANUAL_MKDN_AMT_LCL,
         T.SLS_MANUAL_MKUP_AMT_LCL     = S.SLS_MANUAL_MKUP_AMT_LCL,
         T.RET_QTY                     = S.RET_QTY,
         T.RET_AMT_LCL                 = S.RET_AMT_LCL,
         T.RET_PROFIT_AMT_LCL          = S.RET_PROFIT_AMT_LCL,
         T.RET_TAX_AMT_LCL             = S.RET_TAX_AMT_LCL,
         T.RET_EMP_DISC_AMT_LCL        = S.RET_EMP_DISC_AMT_LCL,
         T.RET_MANUAL_MKDN_AMT_LCL     = S.RET_MANUAL_MKDN_AMT_LCL,
         T.RET_MANUAL_MKUP_AMT_LCL     = S.RET_MANUAL_MKUP_AMT_LCL,
         T.SLS_MANUAL_COUNT            = S.SLS_MANUAL_COUNT,
         T.SLS_SCAN_COUNT              = S.SLS_SCAN_COUNT,
         T.RET_MANUAL_COUNT            = S.RET_MANUAL_COUNT,
         T.RET_SCAN_COUNT              = S.RET_SCAN_COUNT,
         T.GLOBAL1_EXCHANGE_RATE       = S.GLOBAL1_EXCHANGE_RATE,
         T.GLOBAL2_EXCHANGE_RATE       = S.GLOBAL2_EXCHANGE_RATE,
         T.GLOBAL3_EXCHANGE_RATE       = S.GLOBAL3_EXCHANGE_RATE,
         T.LOC_EXCHANGE_RATE           = S.LOC_EXCHANGE_RATE,
         T.BBG_CUSTOMER_COUNT          = S.BBG_CUSTOMER_COUNT,
         T.BBG_SERVICE_SATISFACTION    = S.BBG_SERVICE_SATISFACTION,
         T.W_UPDATE_DT                 = S.W_UPDATE_DT,
         T.BBG_REFERENCE_FO1           = S.BBG_REFERENCE_FO1,
         T.BBG_REFERENCE_FO2           = S.BBG_REFERENCE_FO2,
         T.BBG_REFERENCE_FO3           = S.BBG_REFERENCE_FO3,
         T.BBG_REFERENCE_FO4           = S.BBG_REFERENCE_FO4,
         T.BBG_REFERENCE_FO5           = S.BBG_REFERENCE_FO5,
         T.BBG_REFERENCE_FO6           = S.BBG_REFERENCE_FO6,
         T.BBG_REFERENCE_FO7           = S.BBG_REFERENCE_FO7,
         T.BBG_REFERENCE_FO8           = S.BBG_REFERENCE_FO8,
         T.BBG_REFERENCE_FO9           = S.BBG_REFERENCE_FO9,
         T.BBG_REFERENCE_FO10          = S.BBG_REFERENCE_FO10,
         T.vip_sls_qty                 = S.vip_sls_qty,
         T.vip_sls_amt_lcl             = S.vip_sls_amt_lcl,
         T.vip_sls_profit_amt_lcl      = S.vip_sls_profit_amt_lcl,
         T.vip_sls_tax_amt_lcl         = S.vip_sls_tax_amt_lcl,
         T.vip_sls_emp_disc_amt_lcl    = S.vip_sls_emp_disc_amt_lcl,
         T.vip_ret_qty                 = S.vip_ret_qty,
         T.vip_ret_amt_lcl             = S.vip_ret_amt_lcl,
         T.vip_ret_profit_amt_lcl      = S.vip_ret_profit_amt_lcl,
         T.vip_ret_tax_amt_lcl         = S.vip_ret_tax_amt_lcl,
         T.vip_ret_emp_disc_amt_lcl    = S.vip_ret_emp_disc_amt_lcl,
         T.vip_sls_manual_mkdn_amt_lcl = S.vip_sls_manual_mkdn_amt_lcl,
         T.vip_sls_manual_mkup_amt_lcl = S.vip_sls_manual_mkup_amt_lcl,
         T.vip_ret_manual_mkdn_amt_lcl = S.vip_ret_manual_mkdn_amt_lcl,
         T.vip_ret_manual_mkup_amt_lcl = S.vip_ret_manual_mkup_amt_lcl,
         T.vip_sls_manual_count        = S.vip_sls_manual_count,
         T.vip_sls_scan_count          = S.vip_sls_scan_count,
         T.vip_ret_manual_count        = S.vip_ret_manual_count,
         T.vip_ret_scan_count          = S.vip_ret_scan_count,
         T.SLS_COUPON_AMT_LCL          = S.SLS_COUPON_AMT_LCL,
         T.RET_COUPON_AMT_LCL          = S.RET_COUPON_AMT_LCL,
         T.SLS_TAX_COUPON_AMT_LCL      = S.SLS_TAX_COUPON_AMT_LCL,
         T.RET_TAX_COUPON_AMT_LCL      = S.RET_TAX_COUPON_AMT_LCL
WHEN NOT MATCHED THEN
  INSERT
    (T.ORG_WID,
     T.ORG_DH_WID,
     T.ORG_SCD1_WID,
     T.PROD_DH_WID,
     T.MN_WID,
     T.RTL_TYPE_WID,
     T.SLS_QTY,
     T.SLS_AMT_LCL,
     T.SLS_PROFIT_AMT_LCL,
     T.SLS_TAX_AMT_LCL,
     T.SLS_EMP_DISC_AMT_LCL,
     T.SLS_MANUAL_MKDN_AMT_LCL,
     T.SLS_MANUAL_MKUP_AMT_LCL,
     T.RET_QTY,
     T.RET_AMT_LCL,
     T.RET_PROFIT_AMT_LCL,
     T.RET_TAX_AMT_LCL,
     T.RET_EMP_DISC_AMT_LCL,
     T.RET_MANUAL_MKDN_AMT_LCL,
     T.RET_MANUAL_MKUP_AMT_LCL,
     T.SLS_MANUAL_COUNT,
     T.SLS_SCAN_COUNT,
     T.RET_MANUAL_COUNT,
     T.RET_SCAN_COUNT,
     T.INTEGRATION_ID,
     T.GLOBAL1_EXCHANGE_RATE,
     T.GLOBAL2_EXCHANGE_RATE,
     T.GLOBAL3_EXCHANGE_RATE,
     T.LOC_EXCHANGE_RATE,
     T.BBG_RETAIL_TYPE_WID,
     T.BBG_CUSTOMER_COUNT,
     T.BBG_SERVICE_SATISFACTION,
     T.W_INSERT_DT,
     T.W_UPDATE_DT,
     T.BBG_REFERENCE_DO1,
     T.BBG_REFERENCE_DO2,
     T.BBG_REFERENCE_DO3,
     T.BBG_REFERENCE_DO4,
     T.BBG_REFERENCE_DO5,
     T.BBG_REFERENCE_FO1,
     T.BBG_REFERENCE_FO2,
     T.BBG_REFERENCE_FO3,
     T.BBG_REFERENCE_FO4,
     T.BBG_REFERENCE_FO5,
     T.BBG_REFERENCE_FO6,
     T.BBG_REFERENCE_FO7,
     T.BBG_REFERENCE_FO8,
     T.BBG_REFERENCE_FO9,
     T.BBG_REFERENCE_FO10,
     T.vip_sls_qty,
     T.vip_sls_amt_lcl,
     T.vip_sls_profit_amt_lcl,
     T.vip_sls_tax_amt_lcl,
     T.vip_sls_emp_disc_amt_lcl,
     T.vip_ret_qty,
     T.vip_ret_amt_lcl,
     T.vip_ret_profit_amt_lcl,
     T.vip_ret_tax_amt_lcl,
     T.vip_ret_emp_disc_amt_lcl,
     T.vip_sls_manual_mkdn_amt_lcl,
     T.vip_sls_manual_mkup_amt_lcl,
     T.vip_ret_manual_mkdn_amt_lcl,
     T.vip_ret_manual_mkup_amt_lcl,
     T.vip_sls_manual_count,
     T.vip_sls_scan_count,
     T.vip_ret_manual_count,
     T.vip_ret_scan_count,
     T.SLS_COUPON_AMT_LCL,
     T.RET_COUPON_AMT_LCL,
     T.SLS_TAX_COUPON_AMT_LCL,
     T.RET_TAX_COUPON_AMT_LCL)
  VALUES
    (S.ORG_WID,
     S.ORG_DH_WID,
     S.ORG_SCD1_WID,
     S.PROD_DH_WID,
     S.MN_WID,
     S.RTL_TYPE_WID,
     S.SLS_QTY,
     S.SLS_AMT_LCL,
     S.SLS_PROFIT_AMT_LCL,
     S.SLS_TAX_AMT_LCL,
     S.SLS_EMP_DISC_AMT_LCL,
     S.SLS_MANUAL_MKDN_AMT_LCL,
     S.SLS_MANUAL_MKUP_AMT_LCL,
     S.RET_QTY,
     S.RET_AMT_LCL,
     S.RET_PROFIT_AMT_LCL,
     S.RET_TAX_AMT_LCL,
     S.RET_EMP_DISC_AMT_LCL,
     S.RET_MANUAL_MKDN_AMT_LCL,
     S.RET_MANUAL_MKUP_AMT_LCL,
     S.SLS_MANUAL_COUNT,
     S.SLS_SCAN_COUNT,
     S.RET_MANUAL_COUNT,
     S.RET_SCAN_COUNT,
     S.INTEGRATION_ID,
     S.GLOBAL1_EXCHANGE_RATE,
     S.GLOBAL2_EXCHANGE_RATE,
     S.GLOBAL3_EXCHANGE_RATE,
     S.LOC_EXCHANGE_RATE,
     S.BBG_RETAIL_TYPE_WID,
     S.BBG_CUSTOMER_COUNT,
     S.BBG_SERVICE_SATISFACTION,
     S.W_INSERT_DT,
     S.W_UPDATE_DT,
     S.BBG_REFERENCE_DO1,
     S.BBG_REFERENCE_DO2,
     S.BBG_REFERENCE_DO3,
     S.BBG_REFERENCE_DO4,
     S.BBG_REFERENCE_DO5,
     S.BBG_REFERENCE_FO1,
     S.BBG_REFERENCE_FO2,
     S.BBG_REFERENCE_FO3,
     S.BBG_REFERENCE_FO4,
     S.BBG_REFERENCE_FO5,
     S.BBG_REFERENCE_FO6,
     S.BBG_REFERENCE_FO7,
     S.BBG_REFERENCE_FO8,
     S.BBG_REFERENCE_FO9,
     S.BBG_REFERENCE_FO10,
     S.vip_sls_qty,
     S.vip_sls_amt_lcl,
     S.vip_sls_profit_amt_lcl,
     S.vip_sls_tax_amt_lcl,
     S.vip_sls_emp_disc_amt_lcl,
     S.vip_ret_qty,
     S.vip_ret_amt_lcl,
     S.vip_ret_profit_amt_lcl,
     S.vip_ret_tax_amt_lcl,
     S.vip_ret_emp_disc_amt_lcl,
     S.vip_sls_manual_mkdn_amt_lcl,
     S.vip_sls_manual_mkup_amt_lcl,
     S.vip_ret_manual_mkdn_amt_lcl,
     S.vip_ret_manual_mkup_amt_lcl,
     S.vip_sls_manual_count,
     S.vip_sls_scan_count,
     S.vip_ret_manual_count,
     S.vip_ret_scan_count,
     S.SLS_COUPON_AMT_LCL,
     S.RET_COUPON_AMT_LCL,
     S.SLS_TAX_COUPON_AMT_LCL,
     S.RET_TAX_COUPON_AMT_LCL);
COMMIT;

--6.W_RTL_SLS_CL_LC_MN_A
MERGE /*+APPEND PARALLEL(16)*/
INTO RADM.W_RTL_SLS_CL_LC_MN_A T
USING (SELECT /*+PARALLEL(16)*/
        ORG_WID,
        MAX(ORG_DH_WID) ORG_DH_WID,
        MAX(ORG_SCD1_WID) ORG_SCD1_WID,
        PROD_DH_WID,
        SUBSTR(TO_CHAR(DT_WID), 2, 6) MN_WID,
        RTL_TYPE_WID,
        SUM(NVL(SLS_QTY, 0)) SLS_QTY,
        SUM(NVL(SLS_AMT_LCL, 0)) SLS_AMT_LCL,
        SUM(NVL(SLS_PROFIT_AMT_LCL, 0)) SLS_PROFIT_AMT_LCL,
        SUM(NVL(SLS_TAX_AMT_LCL, 0)) SLS_TAX_AMT_LCL,
        SUM(NVL(SLS_EMP_DISC_AMT_LCL, 0)) SLS_EMP_DISC_AMT_LCL,
        SUM(NVL(SLS_MANUAL_MKDN_AMT_LCL, 0)) SLS_MANUAL_MKDN_AMT_LCL,
        SUM(NVL(SLS_MANUAL_MKUP_AMT_LCL, 0)) SLS_MANUAL_MKUP_AMT_LCL,
        SUM(NVL(RET_QTY, 0)) RET_QTY,
        SUM(NVL(RET_AMT_LCL, 0)) RET_AMT_LCL,
        SUM(NVL(RET_PROFIT_AMT_LCL, 0)) RET_PROFIT_AMT_LCL,
        SUM(NVL(RET_TAX_AMT_LCL, 0)) RET_TAX_AMT_LCL,
        SUM(NVL(RET_EMP_DISC_AMT_LCL, 0)) RET_EMP_DISC_AMT_LCL,
        SUM(NVL(RET_MANUAL_MKDN_AMT_LCL, 0)) RET_MANUAL_MKDN_AMT_LCL,
        SUM(NVL(RET_MANUAL_MKUP_AMT_LCL, 0)) RET_MANUAL_MKUP_AMT_LCL,
        SUM(NVL(SLS_MANUAL_COUNT, 0)) SLS_MANUAL_COUNT,
        SUM(NVL(SLS_SCAN_COUNT, 0)) SLS_SCAN_COUNT,
        SUM(NVL(RET_MANUAL_COUNT, 0)) RET_MANUAL_COUNT,
        SUM(NVL(RET_SCAN_COUNT, 0)) RET_SCAN_COUNT,
        MAX(SUBSTR(INTEGRATION_ID, 1, INSTR(INTEGRATION_ID, '~', 1, 1)) ||
            SUBSTR(INTEGRATION_ID,
                   INSTR(INTEGRATION_ID, '~', 1, 1) + 1,
                   INSTR(INTEGRATION_ID, '~', 1, 2) -
                   INSTR(INTEGRATION_ID, '~', 1, 1)) ||
            SUBSTR(TO_CHAR(DT_WID), 2, 6) ||
            SUBSTR(INTEGRATION_ID,
                   INSTR(INTEGRATION_ID, '~', 1, 3),
                   LENGTH(INTEGRATION_ID) - INSTR(INTEGRATION_ID, '~', 1, 3) + 1)) INTEGRATION_ID,
        MAX(GLOBAL1_EXCHANGE_RATE) GLOBAL1_EXCHANGE_RATE,
        MAX(GLOBAL2_EXCHANGE_RATE) GLOBAL2_EXCHANGE_RATE,
        MAX(GLOBAL3_EXCHANGE_RATE) GLOBAL3_EXCHANGE_RATE,
        MAX(LOC_EXCHANGE_RATE) LOC_EXCHANGE_RATE,
        BBG_RETAIL_TYPE_WID,
        SUM(NVL(BBG_CUSTOMER_COUNT, 0)) BBG_CUSTOMER_COUNT,
        SUM(NVL(BBG_SERVICE_SATISFACTION, 0)) BBG_SERVICE_SATISFACTION,
        SYSDATE W_INSERT_DT,
        SYSDATE W_UPDATE_DT,
        MAX(BBG_REFERENCE_DO1) BBG_REFERENCE_DO1,
        MAX(BBG_REFERENCE_DO2) BBG_REFERENCE_DO2,
        MAX(BBG_REFERENCE_DO3) BBG_REFERENCE_DO3,
        MAX(BBG_REFERENCE_DO4) BBG_REFERENCE_DO4,
        MAX(BBG_REFERENCE_DO5) BBG_REFERENCE_DO5,
        MAX(BBG_REFERENCE_FO1) BBG_REFERENCE_FO1,
        MAX(BBG_REFERENCE_FO2) BBG_REFERENCE_FO2,
        MAX(BBG_REFERENCE_FO3) BBG_REFERENCE_FO3,
        MAX(BBG_REFERENCE_FO4) BBG_REFERENCE_FO4,
        MAX(BBG_REFERENCE_FO5) BBG_REFERENCE_FO5,
        MAX(BBG_REFERENCE_FO6) BBG_REFERENCE_FO6,
        MAX(BBG_REFERENCE_FO7) BBG_REFERENCE_FO7,
        MAX(BBG_REFERENCE_FO8) BBG_REFERENCE_FO8,
        MAX(BBG_REFERENCE_FO9) BBG_REFERENCE_FO9,
        MAX(BBG_REFERENCE_FO10) BBG_REFERENCE_FO10,
        SUM(NVL(vip_sls_qty, 0)) vip_sls_qty,
        SUM(NVL(vip_sls_amt_lcl, 0)) vip_sls_amt_lcl,
        SUM(NVL(vip_sls_profit_amt_lcl, 0)) vip_sls_profit_amt_lcl,
        SUM(NVL(vip_sls_tax_amt_lcl, 0)) vip_sls_tax_amt_lcl,
        SUM(NVL(vip_sls_emp_disc_amt_lcl, 0)) vip_sls_emp_disc_amt_lcl,
        SUM(NVL(vip_ret_qty, 0)) vip_ret_qty,
        SUM(NVL(vip_ret_amt_lcl, 0)) vip_ret_amt_lcl,
        SUM(NVL(vip_ret_profit_amt_lcl, 0)) vip_ret_profit_amt_lcl,
        SUM(NVL(vip_ret_tax_amt_lcl, 0)) vip_ret_tax_amt_lcl,
        SUM(NVL(vip_ret_emp_disc_amt_lcl, 0)) vip_ret_emp_disc_amt_lcl,
        SUM(NVL(vip_sls_manual_mkdn_amt_lcl, 0)) vip_sls_manual_mkdn_amt_lcl,
        SUM(NVL(vip_sls_manual_mkup_amt_lcl, 0)) vip_sls_manual_mkup_amt_lcl,
        SUM(NVL(vip_ret_manual_mkdn_amt_lcl, 0)) vip_ret_manual_mkdn_amt_lcl,
        SUM(NVL(vip_ret_manual_mkup_amt_lcl, 0)) vip_ret_manual_mkup_amt_lcl,
        SUM(NVL(vip_sls_manual_count, 0)) vip_sls_manual_count,
        SUM(NVL(vip_sls_scan_count, 0)) vip_sls_scan_count,
        SUM(NVL(vip_ret_manual_count, 0)) vip_ret_manual_count,
        SUM(NVL(vip_ret_scan_count, 0)) vip_ret_scan_count,
        SUM(NVL(SLS_COUPON_AMT_LCL, 0)) SLS_COUPON_AMT_LCL,
        SUM(NVL(RET_COUPON_AMT_LCL, 0)) RET_COUPON_AMT_LCL,
        SUM(NVL(SLS_TAX_COUPON_AMT_LCL, 0)) SLS_TAX_COUPON_AMT_LCL,
        SUM(NVL(RET_TAX_COUPON_AMT_LCL, 0)) RET_TAX_COUPON_AMT_LCL
       
         FROM RADM.W_RTL_SLS_CL_LC_DY_A
        WHERE DT_WID BETWEEN 120160601000 AND 120160630000
        GROUP BY ORG_WID,
                 PROD_DH_WID,
                 SUBSTR(TO_CHAR(DT_WID), 2, 6),
                 RTL_TYPE_WID,
                 BBG_RETAIL_TYPE_WID) S
ON (T.ORG_WID = S.ORG_WID AND T.PROD_DH_WID = S.PROD_DH_WID AND T.MN_WID = S.MN_WID AND T.RTL_TYPE_WID = S.RTL_TYPE_WID AND T.BBG_RETAIL_TYPE_WID = S.BBG_RETAIL_TYPE_WID)
WHEN MATCHED THEN
  UPDATE
     SET T.SLS_QTY                     = S.SLS_QTY,
         T.SLS_AMT_LCL                 = S.SLS_AMT_LCL,
         T.SLS_PROFIT_AMT_LCL          = S.SLS_PROFIT_AMT_LCL,
         T.SLS_TAX_AMT_LCL             = S.SLS_TAX_AMT_LCL,
         T.SLS_EMP_DISC_AMT_LCL        = S.SLS_EMP_DISC_AMT_LCL,
         T.SLS_MANUAL_MKDN_AMT_LCL     = S.SLS_MANUAL_MKDN_AMT_LCL,
         T.SLS_MANUAL_MKUP_AMT_LCL     = S.SLS_MANUAL_MKUP_AMT_LCL,
         T.RET_QTY                     = S.RET_QTY,
         T.RET_AMT_LCL                 = S.RET_AMT_LCL,
         T.RET_PROFIT_AMT_LCL          = S.RET_PROFIT_AMT_LCL,
         T.RET_TAX_AMT_LCL             = S.RET_TAX_AMT_LCL,
         T.RET_EMP_DISC_AMT_LCL        = S.RET_EMP_DISC_AMT_LCL,
         T.RET_MANUAL_MKDN_AMT_LCL     = S.RET_MANUAL_MKDN_AMT_LCL,
         T.RET_MANUAL_MKUP_AMT_LCL     = S.RET_MANUAL_MKUP_AMT_LCL,
         T.SLS_MANUAL_COUNT            = S.SLS_MANUAL_COUNT,
         T.SLS_SCAN_COUNT              = S.SLS_SCAN_COUNT,
         T.RET_MANUAL_COUNT            = S.RET_MANUAL_COUNT,
         T.RET_SCAN_COUNT              = S.RET_SCAN_COUNT,
         T.GLOBAL1_EXCHANGE_RATE       = S.GLOBAL1_EXCHANGE_RATE,
         T.GLOBAL2_EXCHANGE_RATE       = S.GLOBAL2_EXCHANGE_RATE,
         T.GLOBAL3_EXCHANGE_RATE       = S.GLOBAL3_EXCHANGE_RATE,
         T.LOC_EXCHANGE_RATE           = S.LOC_EXCHANGE_RATE,
         T.BBG_CUSTOMER_COUNT          = S.BBG_CUSTOMER_COUNT,
         T.BBG_SERVICE_SATISFACTION    = S.BBG_SERVICE_SATISFACTION,
         T.BBG_REFERENCE_FO1           = S.BBG_REFERENCE_FO1,
         T.BBG_REFERENCE_FO2           = S.BBG_REFERENCE_FO2,
         T.BBG_REFERENCE_FO3           = S.BBG_REFERENCE_FO3,
         T.BBG_REFERENCE_FO4           = S.BBG_REFERENCE_FO4,
         T.BBG_REFERENCE_FO5           = S.BBG_REFERENCE_FO5,
         T.BBG_REFERENCE_FO6           = S.BBG_REFERENCE_FO6,
         T.BBG_REFERENCE_FO7           = S.BBG_REFERENCE_FO7,
         T.BBG_REFERENCE_FO8           = S.BBG_REFERENCE_FO8,
         T.BBG_REFERENCE_FO9           = S.BBG_REFERENCE_FO9,
         T.BBG_REFERENCE_FO10          = S.BBG_REFERENCE_FO10,
         T.vip_sls_qty                 = S.vip_sls_qty,
         T.vip_sls_amt_lcl             = S.vip_sls_amt_lcl,
         T.vip_sls_profit_amt_lcl      = S.vip_sls_profit_amt_lcl,
         T.vip_sls_tax_amt_lcl         = S.vip_sls_tax_amt_lcl,
         T.vip_sls_emp_disc_amt_lcl    = S.vip_sls_emp_disc_amt_lcl,
         T.vip_ret_qty                 = S.vip_ret_qty,
         T.vip_ret_amt_lcl             = S.vip_ret_amt_lcl,
         T.vip_ret_profit_amt_lcl      = S.vip_ret_profit_amt_lcl,
         T.vip_ret_tax_amt_lcl         = S.vip_ret_tax_amt_lcl,
         T.vip_ret_emp_disc_amt_lcl    = S.vip_ret_emp_disc_amt_lcl,
         T.vip_sls_manual_mkdn_amt_lcl = S.vip_sls_manual_mkdn_amt_lcl,
         T.vip_sls_manual_mkup_amt_lcl = S.vip_sls_manual_mkup_amt_lcl,
         T.vip_ret_manual_mkdn_amt_lcl = S.vip_ret_manual_mkdn_amt_lcl,
         T.vip_ret_manual_mkup_amt_lcl = S.vip_ret_manual_mkup_amt_lcl,
         T.vip_sls_manual_count        = S.vip_sls_manual_count,
         T.vip_sls_scan_count          = S.vip_sls_scan_count,
         T.vip_ret_manual_count        = S.vip_ret_manual_count,
         T.vip_ret_scan_count          = S.vip_ret_scan_count,
         T.SLS_COUPON_AMT_LCL          = S.SLS_COUPON_AMT_LCL,
         T.RET_COUPON_AMT_LCL          = S.RET_COUPON_AMT_LCL,
         T.SLS_TAX_COUPON_AMT_LCL      = S.SLS_TAX_COUPON_AMT_LCL,
         T.RET_TAX_COUPON_AMT_LCL      = S.RET_TAX_COUPON_AMT_LCL
  

WHEN NOT MATCHED THEN
  INSERT
    (T.ORG_WID,
     T.ORG_DH_WID,
     T.ORG_SCD1_WID,
     T.PROD_DH_WID,
     T.MN_WID,
     T.RTL_TYPE_WID,
     T.SLS_QTY,
     T.SLS_AMT_LCL,
     T.SLS_PROFIT_AMT_LCL,
     T.SLS_TAX_AMT_LCL,
     T.SLS_EMP_DISC_AMT_LCL,
     T.SLS_MANUAL_MKDN_AMT_LCL,
     T.SLS_MANUAL_MKUP_AMT_LCL,
     T.RET_QTY,
     T.RET_AMT_LCL,
     T.RET_PROFIT_AMT_LCL,
     T.RET_TAX_AMT_LCL,
     T.RET_EMP_DISC_AMT_LCL,
     T.RET_MANUAL_MKDN_AMT_LCL,
     T.RET_MANUAL_MKUP_AMT_LCL,
     T.SLS_MANUAL_COUNT,
     T.SLS_SCAN_COUNT,
     T.RET_MANUAL_COUNT,
     T.RET_SCAN_COUNT,
     T.INTEGRATION_ID,
     T.GLOBAL1_EXCHANGE_RATE,
     T.GLOBAL2_EXCHANGE_RATE,
     T.GLOBAL3_EXCHANGE_RATE,
     T.LOC_EXCHANGE_RATE,
     T.BBG_RETAIL_TYPE_WID,
     T.BBG_CUSTOMER_COUNT,
     T.BBG_SERVICE_SATISFACTION,
     T.W_INSERT_DT,
     T.W_UPDATE_DT,
     T.BBG_REFERENCE_DO1,
     T.BBG_REFERENCE_DO2,
     T.BBG_REFERENCE_DO3,
     T.BBG_REFERENCE_DO4,
     T.BBG_REFERENCE_DO5,
     T.BBG_REFERENCE_FO1,
     T.BBG_REFERENCE_FO2,
     T.BBG_REFERENCE_FO3,
     T.BBG_REFERENCE_FO4,
     T.BBG_REFERENCE_FO5,
     T.BBG_REFERENCE_FO6,
     T.BBG_REFERENCE_FO7,
     T.BBG_REFERENCE_FO8,
     T.BBG_REFERENCE_FO9,
     T.BBG_REFERENCE_FO10,
     T.vip_sls_qty,
     T.vip_sls_amt_lcl,
     T.vip_sls_profit_amt_lcl,
     T.vip_sls_tax_amt_lcl,
     T.vip_sls_emp_disc_amt_lcl,
     T.vip_ret_qty,
     T.vip_ret_amt_lcl,
     T.vip_ret_profit_amt_lcl,
     T.vip_ret_tax_amt_lcl,
     T.vip_ret_emp_disc_amt_lcl,
     T.vip_sls_manual_mkdn_amt_lcl,
     T.vip_sls_manual_mkup_amt_lcl,
     T.vip_ret_manual_mkdn_amt_lcl,
     T.vip_ret_manual_mkup_amt_lcl,
     T.vip_sls_manual_count,
     T.vip_sls_scan_count,
     T.vip_ret_manual_count,
     T.vip_ret_scan_count,
     T.SLS_COUPON_AMT_LCL,
     T.RET_COUPON_AMT_LCL,
     T.SLS_TAX_COUPON_AMT_LCL,
     T.RET_TAX_COUPON_AMT_LCL)
  VALUES
    (S.ORG_WID,
     S.ORG_DH_WID,
     S.ORG_SCD1_WID,
     S.PROD_DH_WID,
     S.MN_WID,
     S.RTL_TYPE_WID,
     S.SLS_QTY,
     S.SLS_AMT_LCL,
     S.SLS_PROFIT_AMT_LCL,
     S.SLS_TAX_AMT_LCL,
     S.SLS_EMP_DISC_AMT_LCL,
     S.SLS_MANUAL_MKDN_AMT_LCL,
     S.SLS_MANUAL_MKUP_AMT_LCL,
     S.RET_QTY,
     S.RET_AMT_LCL,
     S.RET_PROFIT_AMT_LCL,
     S.RET_TAX_AMT_LCL,
     S.RET_EMP_DISC_AMT_LCL,
     S.RET_MANUAL_MKDN_AMT_LCL,
     S.RET_MANUAL_MKUP_AMT_LCL,
     S.SLS_MANUAL_COUNT,
     S.SLS_SCAN_COUNT,
     S.RET_MANUAL_COUNT,
     S.RET_SCAN_COUNT,
     S.INTEGRATION_ID,
     S.GLOBAL1_EXCHANGE_RATE,
     S.GLOBAL2_EXCHANGE_RATE,
     S.GLOBAL3_EXCHANGE_RATE,
     S.LOC_EXCHANGE_RATE,
     S.BBG_RETAIL_TYPE_WID,
     S.BBG_CUSTOMER_COUNT,
     S.BBG_SERVICE_SATISFACTION,
     S.W_INSERT_DT,
     S.W_UPDATE_DT,
     S.BBG_REFERENCE_DO1,
     S.BBG_REFERENCE_DO2,
     S.BBG_REFERENCE_DO3,
     S.BBG_REFERENCE_DO4,
     S.BBG_REFERENCE_DO5,
     S.BBG_REFERENCE_FO1,
     S.BBG_REFERENCE_FO2,
     S.BBG_REFERENCE_FO3,
     S.BBG_REFERENCE_FO4,
     S.BBG_REFERENCE_FO5,
     S.BBG_REFERENCE_FO6,
     S.BBG_REFERENCE_FO7,
     S.BBG_REFERENCE_FO8,
     S.BBG_REFERENCE_FO9,
     S.BBG_REFERENCE_FO10,
     S.vip_sls_qty,
     S.vip_sls_amt_lcl,
     S.vip_sls_profit_amt_lcl,
     S.vip_sls_tax_amt_lcl,
     S.vip_sls_emp_disc_amt_lcl,
     S.vip_ret_qty,
     S.vip_ret_amt_lcl,
     S.vip_ret_profit_amt_lcl,
     S.vip_ret_tax_amt_lcl,
     S.vip_ret_emp_disc_amt_lcl,
     S.vip_sls_manual_mkdn_amt_lcl,
     S.vip_sls_manual_mkup_amt_lcl,
     S.vip_ret_manual_mkdn_amt_lcl,
     S.vip_ret_manual_mkup_amt_lcl,
     S.vip_sls_manual_count,
     S.vip_sls_scan_count,
     S.vip_ret_manual_count,
     S.vip_ret_scan_count,
     S.SLS_COUPON_AMT_LCL,
     S.RET_COUPON_AMT_LCL,
     S.SLS_TAX_COUPON_AMT_LCL,
     S.RET_TAX_COUPON_AMT_LCL);
COMMIT;

--TMP
SELECT /*+PARALLEL(16)*/
 MIN(T.DT_WID)
  FROM RADM.W_RTL_SLS_TRX_IT_LC_DY_F T
 WHERE T.SLS_COUPON_AMT_LCL <> 0;
SELECT /*+PARALLEL(16)*/
 MIN(T.DT_WID)
  FROM RADM.W_RTL_SLS_LC_DY_A T
 WHERE T.SLS_COUPON_AMT_LCL <> 0;

SELECT *
  FROM ALL_ALL_TABLES T
 WHERE T.owner = 'RADM'
   AND T.table_name LIKE 'W_RTL_SLS%MN_A';
SELECT *
  FROM ALL_ALL_TABLES T
 WHERE T.owner = 'RADM'
   AND T.table_name LIKE 'W_RTL_SLS%MN_CUR_A';

SELECT /*+PARALLEL(16)*/
 MIN(T.MN_WID)
  FROM RADM.W_RTL_SLS_CL_LC_MN_A T
 WHERE T.SLS_COUPON_AMT_LCL <> 0;
SELECT /*+PARALLEL(16)*/
 MIN(T.MN_WID)
  FROM RADM.W_RTL_SLS_DP_LC_MN_A T
 WHERE T.SLS_COUPON_AMT_LCL <> 0;
SELECT /*+PARALLEL(16)*/
 MIN(T.MN_WID)
  FROM RADM.W_RTL_SLS_IT_LC_MN_A T
 WHERE T.SLS_COUPON_AMT_LCL <> 0;
SELECT /*+PARALLEL(16)*/
 MIN(T.MN_WID)
  FROM RADM.W_RTL_SLS_LC_MN_A T
 WHERE T.SLS_COUPON_AMT_LCL <> 0;
SELECT /*+PARALLEL(16)*/
 MIN(T.MN_WID)
  FROM RADM.W_RTL_SLS_SC_LC_MN_A T
 WHERE T.SLS_COUPON_AMT_LCL <> 0;
SELECT /*+PARALLEL(16)*/
 MIN(T.MN_WID)
  FROM RADM.W_RTL_SLS_SC_MN_A T
 WHERE T.SLS_COUPON_AMT_LCL <> 0;
