--1.odi SQL
MERGE /*+ APPEND */
INTO RADM.W_RTL_SLS_TRX_LC_DY_A T
USING (SELECT /*+ APPEND */
        W_RTL_SLS_TRX_IT_LC_DY_TMP.ORG_WID ORG_WID,
        W_RTL_SLS_TRX_IT_LC_DY_TMP.ORG_LC_WID ORG_DH_WID,
        W_RTL_SLS_TRX_IT_LC_DY_TMP.ORG_SCD1_WID ORG_SCD1_WID,
        W_RTL_SLS_TRX_IT_LC_DY_TMP.DT_WID DT_WID,
        W_RTL_SLS_TRX_IT_LC_DY_TMP.MIN_WID MIN_WID,
        W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_TRX_ID SLS_TRX_ID,
        W_RTL_SLS_TRX_IT_LC_DY_TMP.VOUCHER_ID VOUCHER_ID,
        W_RTL_SLS_TRX_IT_LC_DY_TMP.EMPLOYEE_WID EMPLOYEE_WID,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_QTY) SLS_QTY,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_AMT_LCL) SLS_AMT_LCL,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_PROFIT_AMT_LCL) SLS_PROFIT_AMT_LCL,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_MANUAL_MKDN_AMT_LCL) SLS_MANUAL_MKDN_AMT_LCL,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_MANUAL_MKUP_AMT_LCL) SLS_MANUAL_MKUP_AMT_LCL,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_TAX_AMT_LCL) SLS_TAX_AMT_LCL,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_EMP_DISC_AMT_LCL) SLS_EMP_DISC_AMT_LCL,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_MANUAL_COUNT) SLS_MANUAL_COUNT,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_SCAN_COUNT) SLS_SCAN_COUNT,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.RET_QTY) RET_QTY,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.RET_AMT_LCL) RET_AMT_LCL,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.RET_PROFIT_AMT_LCL) RET_PROFIT_AMT_LCL,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.RET_MANUAL_MKDN_AMT_LCL) RET_MANUAL_MKDN_AMT_LCL,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.RET_MANUAL_MKUP_AMT_LCL) RET_MANUAL_MKUP_AMT_LCL,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.RET_TAX_AMT_LCL) RET_TAX_AMT_LCL,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.RET_EMP_DISC_AMT_LCL) RET_EMP_DISC_AMT_LCL,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.RET_MANUAL_COUNT) RET_MANUAL_COUNT,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.RET_SCAN_COUNT) RET_SCAN_COUNT,
        MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.AUX1_CHANGED_ON_DT) AUX1_CHANGED_ON_DT,
        MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.AUX2_CHANGED_ON_DT) AUX2_CHANGED_ON_DT,
        MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.AUX3_CHANGED_ON_DT) AUX3_CHANGED_ON_DT,
        MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.AUX4_CHANGED_ON_DT) AUX4_CHANGED_ON_DT,
        -1 CHANGED_BY_WID,
        MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.CHANGED_ON_DT) CHANGED_ON_DT,
        -1 CREATED_BY_WID,
        MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.CREATED_ON_DT) CREATED_ON_DT,
        MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.DATASOURCE_NUM_ID) DATASOURCE_NUM_ID,
        MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.DELETE_FLG) DELETE_FLG,
        MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.DOC_CURR_CODE) DOC_CURR_CODE,
        100 ETL_PROC_WID,
        MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.GLOBAL1_EXCHANGE_RATE) GLOBAL1_EXCHANGE_RATE,
        MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.GLOBAL2_EXCHANGE_RATE) GLOBAL2_EXCHANGE_RATE,
        MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.GLOBAL3_EXCHANGE_RATE) GLOBAL3_EXCHANGE_RATE,
        W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_TRX_ID || '~' ||
        W_RTL_SLS_TRX_IT_LC_DY_TMP.VOUCHER_ID || '~' ||
        W_RTL_SLS_TRX_IT_LC_DY_TMP.ORG_NUM || '~' ||
        W_RTL_SLS_TRX_IT_LC_DY_TMP.DAY_DT INTEGRATION_ID,
        MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.LOC_CURR_CODE) LOC_CURR_CODE,
        MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.LOC_EXCHANGE_RATE) LOC_EXCHANGE_RATE,
        MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.TENANT_ID) TENANT_ID,
        SYSDATE W_INSERT_DT,
        SYSDATE W_UPDATE_DT,
        MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.X_CUSTOM) X_CUSTOM,
        1 BBG_CUSTOMER_COUNT,
        MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_SERVICE_SATISFACTION) BBG_SERVICE_SATISFACTION,
        MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.SRC_REF_NO1) SRC_REF_NO1,
        MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.SRC_REF_NO2) SRC_REF_NO2,
        MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.SRC_REF_NO3) SRC_REF_NO3,
        MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.SRC_REF_NO7) SRC_REF_NO7,
        MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.SRC_REF_NO8) SRC_REF_NO8,
        MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_DO1) BBG_REFERENCE_DO1,
        MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_DO2) BBG_REFERENCE_DO2,
        MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_DO3) BBG_REFERENCE_DO3,
        MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_DO4) BBG_REFERENCE_DO4,
        MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_DO5) BBG_REFERENCE_DO5,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO1) BBG_REFERENCE_FO1,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO2) BBG_REFERENCE_FO2,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO3) BBG_REFERENCE_FO3,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO4) BBG_REFERENCE_FO4,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO5) BBG_REFERENCE_FO5,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO6) BBG_REFERENCE_FO6,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO7) BBG_REFERENCE_FO7,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO8) BBG_REFERENCE_FO8,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO9) BBG_REFERENCE_FO9,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO10) BBG_REFERENCE_FO10,
        W_RTL_SLS_TRX_IT_LC_DY_TMP.HYK_NO HYK_NO,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.VIP_SLS_QTY) VIP_SLS_QTY,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.VIP_SLS_AMT_LCL) VIP_SLS_AMT_LCL,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.VIP_SLS_PROFIT_AMT_LCL) VIP_SLS_PROFIT_AMT_LCL,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.VIP_SLS_MANUAL_MKDN_AMT_LCL) VIP_SLS_MANUAL_MKDN_AMT_LCL,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.VIP_SLS_MANUAL_MKUP_AMT_LCL) VIP_SLS_MANUAL_MKUP_AMT_LCL,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.VIP_SLS_TAX_AMT_LCL) VIP_SLS_TAX_AMT_LCL,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.VIP_SLS_EMP_DISC_AMT_LCL) VIP_SLS_EMP_DISC_AMT_LCL,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.VIP_SLS_MANUAL_COUNT) VIP_SLS_MANUAL_COUNT,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.VIP_SLS_SCAN_COUNT) VIP_SLS_SCAN_COUNT,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.VIP_RET_QTY) VIP_RET_QTY,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.VIP_RET_AMT_LCL) VIP_RET_AMT_LCL,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.VIP_RET_PROFIT_AMT_LCL) VIP_RET_PROFIT_AMT_LCL,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.VIP_RET_MANUAL_MKDN_AMT_LCL) VIP_RET_MANUAL_MKDN_AMT_LCL,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.VIP_RET_MANUAL_MKUP_AMT_LCL) VIP_RET_MANUAL_MKUP_AMT_LCL,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.VIP_RET_TAX_AMT_LCL) VIP_RET_TAX_AMT_LCL,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.VIP_RET_EMP_DISC_AMT_LCL) VIP_RET_EMP_DISC_AMT_LCL,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.VIP_RET_MANUAL_COUNT) VIP_RET_MANUAL_COUNT,
        SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.VIP_RET_SCAN_COUNT) VIP_RET_SCAN_COUNT,
        SUM(CASE
              WHEN W_RTL_SLS_TRX_IT_LC_DY_TMP.PROD_DV_NUM NOT IN (6, 7, 8, 9) THEN
               (W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_AMT_LCL -
               W_RTL_SLS_TRX_IT_LC_DY_TMP.RET_AMT_LCL) -
               (W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_TAX_AMT_LCL -
               W_RTL_SLS_TRX_IT_LC_DY_TMP.RET_TAX_AMT_LCL)
              ELSE
               0
            END) N69_NET_SALES_AMT,
        SUM(CASE
              WHEN W_RTL_SLS_TRX_IT_LC_DY_TMP.PROD_DV_NUM NOT IN (6, 7, 8, 9) THEN
               (W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_AMT_LCL -
               W_RTL_SLS_TRX_IT_LC_DY_TMP.RET_AMT_LCL)
              ELSE
               0
            END) N69_NET_SALES_AMT_INC_TAX,
        SUM(CASE
              WHEN W_RTL_SLS_TRX_IT_LC_DY_TMP.PROD_DV_NUM NOT IN (6, 7, 8, 9) AND
                   W_RTL_SLS_TRX_IT_LC_DY_TMP.HYK_NO IS NOT NULL THEN
               (W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_AMT_LCL -
               W_RTL_SLS_TRX_IT_LC_DY_TMP.RET_AMT_LCL) -
               (W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_TAX_AMT_LCL -
               W_RTL_SLS_TRX_IT_LC_DY_TMP.RET_TAX_AMT_LCL)
              ELSE
               0
            END) VIP_N69_NET_SALES_AMT,
        SUM(CASE
              WHEN W_RTL_SLS_TRX_IT_LC_DY_TMP.PROD_DV_NUM NOT IN (6, 7, 8, 9) AND
                   W_RTL_SLS_TRX_IT_LC_DY_TMP.HYK_NO IS NOT NULL THEN
               (W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_AMT_LCL -
               W_RTL_SLS_TRX_IT_LC_DY_TMP.RET_AMT_LCL)
              ELSE
               0
            END) VIP_N69_NET_SALES_AMT_INC_TAX
         FROM RABATCHER.W_RTL_SLS_TRX_IT_LC_DY_TMP W_RTL_SLS_TRX_IT_LC_DY_TMP
        WHERE (1 = 1)
        GROUP BY W_RTL_SLS_TRX_IT_LC_DY_TMP.ORG_WID,
                 W_RTL_SLS_TRX_IT_LC_DY_TMP.ORG_LC_WID,
                 W_RTL_SLS_TRX_IT_LC_DY_TMP.ORG_SCD1_WID,
                 W_RTL_SLS_TRX_IT_LC_DY_TMP.DT_WID,
                 W_RTL_SLS_TRX_IT_LC_DY_TMP.MIN_WID,
                 W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_TRX_ID,
                 W_RTL_SLS_TRX_IT_LC_DY_TMP.VOUCHER_ID,
                 W_RTL_SLS_TRX_IT_LC_DY_TMP.EMPLOYEE_WID,
                 W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_TRX_ID || '~' ||
                 W_RTL_SLS_TRX_IT_LC_DY_TMP.VOUCHER_ID || '~' ||
                 W_RTL_SLS_TRX_IT_LC_DY_TMP.ORG_NUM || '~' ||
                 W_RTL_SLS_TRX_IT_LC_DY_TMP.DAY_DT,
                 W_RTL_SLS_TRX_IT_LC_DY_TMP.HYK_NO) S
ON (T.ORG_WID = S.ORG_WID AND T.DT_WID = S.DT_WID AND T.SLS_TRX_ID = S.SLS_TRX_ID AND T.VOUCHER_ID = S.VOUCHER_ID)
WHEN MATCHED THEN
  UPDATE
     SET T.ORG_DH_WID                    = S.ORG_DH_WID,
         T.ORG_SCD1_WID                  = S.ORG_SCD1_WID,
         T.MIN_WID                       = S.MIN_WID,
         T.EMPLOYEE_WID                  = S.EMPLOYEE_WID,
         T.SLS_QTY                       = S.SLS_QTY,
         T.SLS_AMT_LCL                   = S.SLS_AMT_LCL,
         T.SLS_PROFIT_AMT_LCL            = S.SLS_PROFIT_AMT_LCL,
         T.SLS_MANUAL_MKDN_AMT_LCL       = S.SLS_MANUAL_MKDN_AMT_LCL,
         T.SLS_MANUAL_MKUP_AMT_LCL       = S.SLS_MANUAL_MKUP_AMT_LCL,
         T.SLS_TAX_AMT_LCL               = S.SLS_TAX_AMT_LCL,
         T.SLS_EMP_DISC_AMT_LCL          = S.SLS_EMP_DISC_AMT_LCL,
         T.SLS_MANUAL_COUNT              = S.SLS_MANUAL_COUNT,
         T.SLS_SCAN_COUNT                = S.SLS_SCAN_COUNT,
         T.RET_QTY                       = S.RET_QTY,
         T.RET_AMT_LCL                   = S.RET_AMT_LCL,
         T.RET_PROFIT_AMT_LCL            = S.RET_PROFIT_AMT_LCL,
         T.RET_MANUAL_MKDN_AMT_LCL       = S.RET_MANUAL_MKDN_AMT_LCL,
         T.RET_MANUAL_MKUP_AMT_LCL       = S.RET_MANUAL_MKUP_AMT_LCL,
         T.RET_TAX_AMT_LCL               = S.RET_TAX_AMT_LCL,
         T.RET_EMP_DISC_AMT_LCL          = S.RET_EMP_DISC_AMT_LCL,
         T.RET_MANUAL_COUNT              = S.RET_MANUAL_COUNT,
         T.RET_SCAN_COUNT                = S.RET_SCAN_COUNT,
         T.AUX1_CHANGED_ON_DT            = S.AUX1_CHANGED_ON_DT,
         T.AUX2_CHANGED_ON_DT            = S.AUX2_CHANGED_ON_DT,
         T.AUX3_CHANGED_ON_DT            = S.AUX3_CHANGED_ON_DT,
         T.AUX4_CHANGED_ON_DT            = S.AUX4_CHANGED_ON_DT,
         T.CHANGED_BY_WID                = S.CHANGED_BY_WID,
         T.CHANGED_ON_DT                 = S.CHANGED_ON_DT,
         T.CREATED_BY_WID                = S.CREATED_BY_WID,
         T.CREATED_ON_DT                 = S.CREATED_ON_DT,
         T.DATASOURCE_NUM_ID             = S.DATASOURCE_NUM_ID,
         T.DELETE_FLG                    = S.DELETE_FLG,
         T.DOC_CURR_CODE                 = S.DOC_CURR_CODE,
         T.ETL_PROC_WID                  = S.ETL_PROC_WID,
         T.GLOBAL1_EXCHANGE_RATE         = S.GLOBAL1_EXCHANGE_RATE,
         T.GLOBAL2_EXCHANGE_RATE         = S.GLOBAL2_EXCHANGE_RATE,
         T.GLOBAL3_EXCHANGE_RATE         = S.GLOBAL3_EXCHANGE_RATE,
         T.INTEGRATION_ID                = S.INTEGRATION_ID,
         T.LOC_CURR_CODE                 = S.LOC_CURR_CODE,
         T.LOC_EXCHANGE_RATE             = S.LOC_EXCHANGE_RATE,
         T.TENANT_ID                     = S.TENANT_ID,
         T.W_INSERT_DT                   = S.W_INSERT_DT,
         T.W_UPDATE_DT                   = S.W_UPDATE_DT,
         T.X_CUSTOM                      = S.X_CUSTOM,
         T.BBG_CUSTOMER_COUNT            = S.BBG_CUSTOMER_COUNT,
         T.BBG_SERVICE_SATISFACTION      = S.BBG_SERVICE_SATISFACTION,
         T.SRC_REF_NO1                   = S.SRC_REF_NO1,
         T.SRC_REF_NO2                   = S.SRC_REF_NO2,
         T.SRC_REF_NO3                   = S.SRC_REF_NO3,
         T.SRC_REF_NO7                   = S.SRC_REF_NO7,
         T.SRC_REF_NO8                   = S.SRC_REF_NO8,
         T.BBG_REFERENCE_DO1             = S.BBG_REFERENCE_DO1,
         T.BBG_REFERENCE_DO2             = S.BBG_REFERENCE_DO2,
         T.BBG_REFERENCE_DO3             = S.BBG_REFERENCE_DO3,
         T.BBG_REFERENCE_DO4             = S.BBG_REFERENCE_DO4,
         T.BBG_REFERENCE_DO5             = S.BBG_REFERENCE_DO5,
         T.BBG_REFERENCE_FO1             = S.BBG_REFERENCE_FO1,
         T.BBG_REFERENCE_FO2             = S.BBG_REFERENCE_FO2,
         T.BBG_REFERENCE_FO3             = S.BBG_REFERENCE_FO3,
         T.BBG_REFERENCE_FO4             = S.BBG_REFERENCE_FO4,
         T.BBG_REFERENCE_FO5             = S.BBG_REFERENCE_FO5,
         T.BBG_REFERENCE_FO6             = S.BBG_REFERENCE_FO6,
         T.BBG_REFERENCE_FO7             = S.BBG_REFERENCE_FO7,
         T.BBG_REFERENCE_FO8             = S.BBG_REFERENCE_FO8,
         T.BBG_REFERENCE_FO9             = S.BBG_REFERENCE_FO9,
         T.BBG_REFERENCE_FO10            = S.BBG_REFERENCE_FO10,
         T.HYK_NO                        = S.HYK_NO,
         T.VIP_SLS_QTY                   = S.VIP_SLS_QTY,
         T.VIP_SLS_AMT_LCL               = S.VIP_SLS_AMT_LCL,
         T.VIP_SLS_PROFIT_AMT_LCL        = S.VIP_SLS_PROFIT_AMT_LCL,
         T.VIP_SLS_MANUAL_MKDN_AMT_LCL   = S.VIP_SLS_MANUAL_MKDN_AMT_LCL,
         T.VIP_SLS_MANUAL_MKUP_AMT_LCL   = S.VIP_SLS_MANUAL_MKUP_AMT_LCL,
         T.VIP_SLS_TAX_AMT_LCL           = S.VIP_SLS_TAX_AMT_LCL,
         T.VIP_SLS_EMP_DISC_AMT_LCL      = S.VIP_SLS_EMP_DISC_AMT_LCL,
         T.VIP_SLS_MANUAL_COUNT          = S.VIP_SLS_MANUAL_COUNT,
         T.VIP_SLS_SCAN_COUNT            = S.VIP_SLS_SCAN_COUNT,
         T.VIP_RET_QTY                   = S.VIP_RET_QTY,
         T.VIP_RET_AMT_LCL               = S.VIP_RET_AMT_LCL,
         T.VIP_RET_PROFIT_AMT_LCL        = S.VIP_RET_PROFIT_AMT_LCL,
         T.VIP_RET_MANUAL_MKDN_AMT_LCL   = S.VIP_RET_MANUAL_MKDN_AMT_LCL,
         T.VIP_RET_MANUAL_MKUP_AMT_LCL   = S.VIP_RET_MANUAL_MKUP_AMT_LCL,
         T.VIP_RET_TAX_AMT_LCL           = S.VIP_RET_TAX_AMT_LCL,
         T.VIP_RET_EMP_DISC_AMT_LCL      = S.VIP_RET_EMP_DISC_AMT_LCL,
         T.VIP_RET_MANUAL_COUNT          = S.VIP_RET_MANUAL_COUNT,
         T.VIP_RET_SCAN_COUNT            = S.VIP_RET_SCAN_COUNT,
         T.N69_NET_SALES_AMT             = S.N69_NET_SALES_AMT,
         T.N69_NET_SALES_AMT_INC_TAX     = S.N69_NET_SALES_AMT_INC_TAX,
         T.VIP_N69_NET_SALES_AMT         = S.VIP_N69_NET_SALES_AMT,
         T.VIP_N69_NET_SALES_AMT_INC_TAX = S.VIP_N69_NET_SALES_AMT_INC_TAX
WHEN NOT MATCHED THEN
  INSERT
    (T.ROW_WID,
     T.ORG_WID,
     T.ORG_DH_WID,
     T.ORG_SCD1_WID,
     T.DT_WID,
     T.MIN_WID,
     T.SLS_TRX_ID,
     T.VOUCHER_ID,
     T.EMPLOYEE_WID,
     T.SLS_QTY,
     T.SLS_AMT_LCL,
     T.SLS_PROFIT_AMT_LCL,
     T.SLS_MANUAL_MKDN_AMT_LCL,
     T.SLS_MANUAL_MKUP_AMT_LCL,
     T.SLS_TAX_AMT_LCL,
     T.SLS_EMP_DISC_AMT_LCL,
     T.SLS_MANUAL_COUNT,
     T.SLS_SCAN_COUNT,
     T.RET_QTY,
     T.RET_AMT_LCL,
     T.RET_PROFIT_AMT_LCL,
     T.RET_MANUAL_MKDN_AMT_LCL,
     T.RET_MANUAL_MKUP_AMT_LCL,
     T.RET_TAX_AMT_LCL,
     T.RET_EMP_DISC_AMT_LCL,
     T.RET_MANUAL_COUNT,
     T.RET_SCAN_COUNT,
     T.AUX1_CHANGED_ON_DT,
     T.AUX2_CHANGED_ON_DT,
     T.AUX3_CHANGED_ON_DT,
     T.AUX4_CHANGED_ON_DT,
     T.CHANGED_BY_WID,
     T.CHANGED_ON_DT,
     T.CREATED_BY_WID,
     T.CREATED_ON_DT,
     T.DATASOURCE_NUM_ID,
     T.DELETE_FLG,
     T.DOC_CURR_CODE,
     T.ETL_PROC_WID,
     T.GLOBAL1_EXCHANGE_RATE,
     T.GLOBAL2_EXCHANGE_RATE,
     T.GLOBAL3_EXCHANGE_RATE,
     T.INTEGRATION_ID,
     T.LOC_CURR_CODE,
     T.LOC_EXCHANGE_RATE,
     T.TENANT_ID,
     T.W_INSERT_DT,
     T.W_UPDATE_DT,
     T.X_CUSTOM,
     T.BBG_CUSTOMER_COUNT,
     T.BBG_SERVICE_SATISFACTION,
     T.SRC_REF_NO1,
     T.SRC_REF_NO2,
     T.SRC_REF_NO3,
     T.SRC_REF_NO7,
     T.SRC_REF_NO8,
     T.BBG_REFERENCE_DO1,
     T.BBG_REFERENCE_DO2,
     T.BBG_REFERENCE_DO3,
     T.BBG_REFERENCE_DO4,
     T.BBG_REFERENCE_DO5,
     T.BBG_REFERENCE_FO1,
     T.BBG_REFERENCE_FO2,
     T.BBG_REFERENCE_FO3,
     T.BBG_REFERENCE_FO4,
     T.BBG_REFERENCE_FO5,
     T.BBG_REFERENCE_FO6,
     T.BBG_REFERENCE_FO7,
     T.BBG_REFERENCE_FO8,
     T.BBG_REFERENCE_FO9,
     T.BBG_REFERENCE_FO10,
     T.HYK_NO,
     T.VIP_SLS_QTY,
     T.VIP_SLS_AMT_LCL,
     T.VIP_SLS_PROFIT_AMT_LCL,
     T.VIP_SLS_MANUAL_MKDN_AMT_LCL,
     T.VIP_SLS_MANUAL_MKUP_AMT_LCL,
     T.VIP_SLS_TAX_AMT_LCL,
     T.VIP_SLS_EMP_DISC_AMT_LCL,
     T.VIP_SLS_MANUAL_COUNT,
     T.VIP_SLS_SCAN_COUNT,
     T.VIP_RET_QTY,
     T.VIP_RET_AMT_LCL,
     T.VIP_RET_PROFIT_AMT_LCL,
     T.VIP_RET_MANUAL_MKDN_AMT_LCL,
     T.VIP_RET_MANUAL_MKUP_AMT_LCL,
     T.VIP_RET_TAX_AMT_LCL,
     T.VIP_RET_EMP_DISC_AMT_LCL,
     T.VIP_RET_MANUAL_COUNT,
     T.VIP_RET_SCAN_COUNT,
     T.N69_NET_SALES_AMT,
     T.N69_NET_SALES_AMT_INC_TAX,
     T.VIP_N69_NET_SALES_AMT,
     T.VIP_N69_NET_SALES_AMT_INC_TAX)
  VALUES
    (RADM.W_RTL_SLS_TRX_LC_DY_A_SEQ.NEXTVAL,
     S.ORG_WID,
     S.ORG_DH_WID,
     S.ORG_SCD1_WID,
     S.DT_WID,
     S.MIN_WID,
     S.SLS_TRX_ID,
     S.VOUCHER_ID,
     S.EMPLOYEE_WID,
     S.SLS_QTY,
     S.SLS_AMT_LCL,
     S.SLS_PROFIT_AMT_LCL,
     S.SLS_MANUAL_MKDN_AMT_LCL,
     S.SLS_MANUAL_MKUP_AMT_LCL,
     S.SLS_TAX_AMT_LCL,
     S.SLS_EMP_DISC_AMT_LCL,
     S.SLS_MANUAL_COUNT,
     S.SLS_SCAN_COUNT,
     S.RET_QTY,
     S.RET_AMT_LCL,
     S.RET_PROFIT_AMT_LCL,
     S.RET_MANUAL_MKDN_AMT_LCL,
     S.RET_MANUAL_MKUP_AMT_LCL,
     S.RET_TAX_AMT_LCL,
     S.RET_EMP_DISC_AMT_LCL,
     S.RET_MANUAL_COUNT,
     S.RET_SCAN_COUNT,
     S.AUX1_CHANGED_ON_DT,
     S.AUX2_CHANGED_ON_DT,
     S.AUX3_CHANGED_ON_DT,
     S.AUX4_CHANGED_ON_DT,
     S.CHANGED_BY_WID,
     S.CHANGED_ON_DT,
     S.CREATED_BY_WID,
     S.CREATED_ON_DT,
     S.DATASOURCE_NUM_ID,
     S.DELETE_FLG,
     S.DOC_CURR_CODE,
     S.ETL_PROC_WID,
     S.GLOBAL1_EXCHANGE_RATE,
     S.GLOBAL2_EXCHANGE_RATE,
     S.GLOBAL3_EXCHANGE_RATE,
     S.INTEGRATION_ID,
     S.LOC_CURR_CODE,
     S.LOC_EXCHANGE_RATE,
     S.TENANT_ID,
     S.W_INSERT_DT,
     S.W_UPDATE_DT,
     S.X_CUSTOM,
     S.BBG_CUSTOMER_COUNT,
     S.BBG_SERVICE_SATISFACTION,
     S.SRC_REF_NO1,
     S.SRC_REF_NO2,
     S.SRC_REF_NO3,
     S.SRC_REF_NO7,
     S.SRC_REF_NO8,
     S.BBG_REFERENCE_DO1,
     S.BBG_REFERENCE_DO2,
     S.BBG_REFERENCE_DO3,
     S.BBG_REFERENCE_DO4,
     S.BBG_REFERENCE_DO5,
     S.BBG_REFERENCE_FO1,
     S.BBG_REFERENCE_FO2,
     S.BBG_REFERENCE_FO3,
     S.BBG_REFERENCE_FO4,
     S.BBG_REFERENCE_FO5,
     S.BBG_REFERENCE_FO6,
     S.BBG_REFERENCE_FO7,
     S.BBG_REFERENCE_FO8,
     S.BBG_REFERENCE_FO9,
     S.BBG_REFERENCE_FO10,
     S.HYK_NO,
     S.VIP_SLS_QTY,
     S.VIP_SLS_AMT_LCL,
     S.VIP_SLS_PROFIT_AMT_LCL,
     S.VIP_SLS_MANUAL_MKDN_AMT_LCL,
     S.VIP_SLS_MANUAL_MKUP_AMT_LCL,
     S.VIP_SLS_TAX_AMT_LCL,
     S.VIP_SLS_EMP_DISC_AMT_LCL,
     S.VIP_SLS_MANUAL_COUNT,
     S.VIP_SLS_SCAN_COUNT,
     S.VIP_RET_QTY,
     S.VIP_RET_AMT_LCL,
     S.VIP_RET_PROFIT_AMT_LCL,
     S.VIP_RET_MANUAL_MKDN_AMT_LCL,
     S.VIP_RET_MANUAL_MKUP_AMT_LCL,
     S.VIP_RET_TAX_AMT_LCL,
     S.VIP_RET_EMP_DISC_AMT_LCL,
     S.VIP_RET_MANUAL_COUNT,
     S.VIP_RET_SCAN_COUNT,
     S.N69_NET_SALES_AMT,
     S.N69_NET_SALES_AMT_INC_TAX,
     S.VIP_N69_NET_SALES_AMT,
     S.VIP_N69_NET_SALES_AMT_INC_TAX);

--2.BIEE SQL
SELECT DISTINCT 0     AS c1,
                D1.c5 AS c2,
                D1.c1 AS c3,
                D1.c2 AS c4,
                D1.c3 AS c5,
                D1.c4 AS c6,
                D1.c6 AS c7
  FROM (SELECT SUM(CASE
                     WHEN NOT T1051080.N69_NET_SALES_AMT_INC_TAX < 138 THEN
                      T1051080.N69_NET_SALES_AMT_INC_TAX
                   END) AS c1,
               SUM(CASE
                     WHEN NOT T1051080.N69_NET_SALES_AMT_INC_TAX < 88 THEN
                      T1051080.N69_NET_SALES_AMT_INC_TAX
                   END) AS c2,
               SUM(CASE
                     WHEN NOT T1051080.VIP_N69_NET_SALES_AMT_INC_TAX < 138 THEN
                      T1051080.VIP_N69_NET_SALES_AMT_INC_TAX
                   END) AS c3,
               SUM(CASE
                     WHEN NOT T1051080.VIP_N69_NET_SALES_AMT_INC_TAX < 88 THEN
                      T1051080.VIP_N69_NET_SALES_AMT_INC_TAX
                   END) AS c4,
               TRUNC(T960506.MCAL_DAY_DT) AS c5,
               T960506.ROW_WID AS c6
          FROM W_MCAL_DAY_DV         T960506 /* Dim_W_MCAL_DAY_D_Retail_Gregorian_Calendar */,
               W_RTL_SLS_TRX_LC_DY_A T1051080 /* Fact_W_RTL_SLS_TRX_LC_DY_A */
         WHERE (T960506.ROW_WID = T1051080.DT_WID AND
               T960506.MCAL_CAL_WID = 1.0 AND '2010' < T960506.CAL_YEAR AND
               (T1051080.N69_NET_SALES_AMT_INC_TAX >= 88 OR
               T1051080.N69_NET_SALES_AMT_INC_TAX >= 138 OR
               T1051080.VIP_N69_NET_SALES_AMT_INC_TAX >= 88 OR
               T1051080.VIP_N69_NET_SALES_AMT_INC_TAX >= 138) AND
               TRUNC(T960506.MCAL_DAY_DT) BETWEEN
               TO_DATE('2015-07-26', 'YYYY-MM-DD') AND
               TO_DATE('2015-08-10', 'YYYY-MM-DD'))
         GROUP BY T960506.ROW_WID, TRUNC(T960506.MCAL_DAY_DT)) D1
 ORDER BY c2;

--3.OBIEE

SELECT DISTINCT 0     AS c1,
                D1.c5 AS c2,
                D1.c1 AS c3,
                D1.c2 AS c4,
                D1.c3 AS c5,
                D1.c4 AS c6,
                D1.c6 AS c7
  FROM (SELECT SUM(CASE
                     WHEN NOT T1051080.N69_NET_SALES_AMT_INC_TAX < 108 THEN
                      T1051080.N69_NET_SALES_AMT_INC_TAX
                   END) AS c1,
               SUM(CASE
                     WHEN NOT T1051080.N69_NET_SALES_AMT_INC_TAX < 68 THEN
                      T1051080.N69_NET_SALES_AMT_INC_TAX
                   END) AS c2,
               SUM(CASE
                     WHEN NOT T1051080.VIP_N69_NET_SALES_AMT_INC_TAX < 128 THEN
                      T1051080.VIP_N69_NET_SALES_AMT_INC_TAX
                   END) AS c3,
               SUM(CASE
                     WHEN NOT T1051080.VIP_N69_NET_SALES_AMT_INC_TAX < 78 THEN
                      T1051080.VIP_N69_NET_SALES_AMT_INC_TAX
                   END) AS c4,
               CAST(T964463.ORG_NUM AS INTEGER) AS c5,
               T964463.ROW_WID AS c6
          FROM W_INT_ORG_DH          T964333 /* Dim_W_INT_ORG_DH_Retail_As_Was */,
               W_INT_ORG_D           T964463 /* Dim_W_INT_ORG_D_Retail_As_Was */,
               W_MCAL_DAY_DV         T960506 /* Dim_W_MCAL_DAY_D_Retail_Gregorian_Calendar */,
               W_RTL_SLS_TRX_LC_DY_A T1051080 /* Fact_W_RTL_SLS_TRX_LC_DY_A */
         WHERE (T960506.ROW_WID = T1051080.DT_WID AND
               T964333.ROW_WID = T1051080.ORG_DH_WID AND
               T960506.MCAL_CAL_WID = 1.0 AND
               T964333.SCD1_WID = T964463.SCD1_WID AND
               T964463.ROW_WID = T1051080.ORG_WID AND
               '2010' < T960506.CAL_YEAR AND
               (T1051080.N69_NET_SALES_AMT_INC_TAX >= 68 OR
               T1051080.N69_NET_SALES_AMT_INC_TAX >= 108 OR
               T1051080.VIP_N69_NET_SALES_AMT_INC_TAX >= 78 OR
               T1051080.VIP_N69_NET_SALES_AMT_INC_TAX >= 128) AND
               TRUNC(T960506.MCAL_DAY_DT) BETWEEN
               TO_DATE('2015-06-21', 'YYYY-MM-DD') AND
               TO_DATE('2015-07-08', 'YYYY-MM-DD'))
         GROUP BY T964463.ROW_WID, CAST(T964463.ORG_NUM AS INTEGER)) D1
 ORDER BY c2;
