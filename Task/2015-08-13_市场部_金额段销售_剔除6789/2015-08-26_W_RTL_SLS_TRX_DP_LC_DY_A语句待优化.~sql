/* Formatted on 2015-8-26 21:03:45 (QP5 v5.256.13226.35510) */
/* 41d5579f */

SELECT DISTINCT 0 AS c1,
                D1.c5 AS c2,
                D1.c4 - D1.c3 AS c3,
                D1.c2 - D1.c1 AS c4,
                D1.c6 AS c5
  FROM (SELECT SUM(NVL(T1051709.VIP_SLS_TAX_AMT_LCL, 0) -
                   NVL(T1051709.VIP_RET_TAX_AMT_LCL, 0)) AS c1,
               SUM(NVL(T1051709.VIP_SLS_AMT_LCL, 0) -
                   NVL(T1051709.VIP_RET_AMT_LCL, 0)) AS c2,
               SUM(NVL(T1051709.SLS_TAX_AMT_LCL, 0) -
                   NVL(T1051709.RET_TAX_AMT_LCL, 0)) AS c3,
               SUM(NVL(T1051709.SLS_AMT_LCL, 0) -
                   NVL(T1051709.RET_AMT_LCL, 0)) AS c4,
               TRUNC(T960506.MCAL_DAY_DT) AS c5,
               T960506.ROW_WID AS c6
          FROM W_MCAL_DAY_DV            T960506 /* Dim_W_MCAL_DAY_D_Retail_Gregorian_Calendar */,
               W_PROD_CAT_DH            T956667 /* Dim_W_PROD_CAT_DH_Department_As_Was */,
               W_RTL_SLS_TRX_DP_LC_DY_A T1051709 /* Fact_W_RTL_SLS_TRX_DP_LC_DY_A */
         WHERE (T956667.ROW_WID = T1051709.PROD_DH_WID AND
               T956667.LEVEL_NAME = 'DEPT' AND
               T960506.ROW_WID = T1051709.DT_WID AND
               T960506.MCAL_CAL_WID = 1.0 AND
               CAST(T956667.LVL6ANC_PRODCAT_ID AS INTEGER) <> 70 AND
               CAST(T956667.LVL6ANC_PRODCAT_ID AS INTEGER) <> 72 AND
               CAST(T956667.LVL6ANC_PRODCAT_ID AS INTEGER) <> 73 AND
               CAST(T956667.LVL6ANC_PRODCAT_ID AS INTEGER) <> 75 AND
               CAST(T956667.LVL6ANC_PRODCAT_ID AS INTEGER) <> 74 AND
               CAST(T956667.LVL6ANC_PRODCAT_ID AS INTEGER) <> 76 AND
               CAST(T956667.LVL6ANC_PRODCAT_ID AS INTEGER) <> 71 AND
               CAST(T956667.LVL6ANC_PRODCAT_ID AS INTEGER) <> 77 AND
               CAST(T956667.LVL6ANC_PRODCAT_ID AS INTEGER) <> 78 AND
               CAST(T956667.LVL6ANC_PRODCAT_ID AS INTEGER) <> 79 AND
               CAST(T956667.LVL6ANC_PRODCAT_ID AS INTEGER) <> 99 AND
               CAST(T956667.LVL6ANC_PRODCAT_ID AS INTEGER) <> 9101 AND
               CAST(T956667.LVL6ANC_PRODCAT_ID AS INTEGER) <> 9103 AND
               '2010' < T960506.CAL_YEAR AND
               NVL(T1051709.SLS_AMT_LCL, 0) - NVL(T1051709.RET_AMT_LCL, 0) >= 116 AND
               TRUNC(T960506.MCAL_DAY_DT) BETWEEN
               TO_DATE('2015-07-01', 'YYYY-MM-DD') AND
               TO_DATE('2015-07-31', 'YYYY-MM-DD'))
         GROUP BY T960506.ROW_WID, TRUNC(T960506.MCAL_DAY_DT)) D1
 ORDER BY c2
