/*
1.W_RTL_INV_CL_LC_DY_A    OK
2.W_RTL_INV_CL_LC_MN_A    OK FROM390:W_RTL_INV_CL_LC_DY_A
3.W_RTL_INV_DP_LC_DY_A    OK
4.W_RTL_INV_DP_LC_MN_A    OK FROM350:W_RTL_INV_DP_LC_DY_A
5.W_RTL_INV_IT_DY_A       OK
6.W_RTL_INV_SC_DY_A       OK
7.W_RTL_INV_SC_DY_CUR_A   OK
8.W_RTL_INV_SC_LC_DY_A    OK
9.W_RTL_INV_SC_LC_MN_A    OK FROM230:W_RTL_INV_SC_LC_DY_A
10.W_RTL_INV_SC_MN_A      OK FROM310:W_RTL_INV_SC_DY_A
11.W_RTL_INV_SC_MN_CUR_A  OK FROM270:W_RTL_INV_SC_DY_CUR_A
*/
SELECT * FROM ALL_ALL_TABLES T WHERE T.table_name LIKE '%W_RTL_INV%' AND T.owner='RADM';
SELECT *
  FROM RADM.W_RTL_INV_SC_DY_CUR_A T
 WHERE T.INV_SOH_QTY > 0
   AND T.DT_WID = 120140525000;
SELECT * FROM RADM.W_RTL_INV_IT_LC_DY_FV T WHERE T.DT_WID = 120140525000;
SELECT * FROM RABATCHER.W_PRODUCT_D_RTL_TMP T;
SELECT MAX(T.PROD_SC_WID), MIN(T.PROD_SC_WID)
  FROM RABATCHER.W_PRODUCT_D_RTL_TMP T;
SELECT MAX(T.PROD_DH_WID), MIN(T.PROD_DH_WID)
  FROM RADM.W_RTL_INV_SC_DY_A T;
--1.W_RTL_INV_CL_LC_DY_A------------------------------------------------------------------------------
MERGE /*+ APPEND */
INTO RADM.W_RTL_INV_CL_LC_DY_A T
USING (SELECT /*+ PARALLEL(F,20) (P,20) (O,20)*/
        P.PROD_CL_WID,
        F.ORG_WID,
        F.ORG_DH_WID,
        F.ORG_SCD1_WID,
        F.DT_WID,
        F.CLEARANCE_FLG,
        SUM(F.INV_SOH_QTY) INV_SOH_QTY,
        SUM(F.INV_ON_ORD_QTY) INV_ON_ORD_QTY,
        SUM(F.INV_IN_TRAN_QTY) INV_IN_TRAN_QTY,
        SUM(F.INV_MAX_SOH_QTY) INV_MAX_SOH_QTY,
        SUM(F.INV_MIN_SOH_QTY) INV_MIN_SOH_QTY,
        SUM(F.INV_SOH_RTL_AMT_LCL) INV_SOH_RTL_AMT_LCL,
        SUM(F.INV_ON_ORD_RTL_AMT_LCL) INV_ON_ORD_RTL_AMT_LCL,
        SUM(F.INV_IN_TRAN_RTL_AMT_LCL) INV_IN_TRAN_RTL_AMT_LCL,
        SUM(F.INV_MAX_SOH_RTL_AMT_LCL) INV_MAX_SOH_RTL_AMT_LCL,
        SUM(F.INV_MIN_SOH_RTL_AMT_LCL) INV_MIN_SOH_RTL_AMT_LCL,
        SUM(F.INV_SOH_COST_AMT_LCL) INV_SOH_COST_AMT_LCL,
        SUM(F.INV_ON_ORD_COST_AMT_LCL) INV_ON_ORD_COST_AMT_LCL,
        SUM(F.INV_IN_TRAN_COST_AMT_LCL) INV_IN_TRAN_COST_AMT_LCL,
        SUM(F.INV_MAX_SOH_COST_AMT_LCL) INV_MAX_SOH_COST_AMT_LCL,
        SUM(F.INV_MIN_SOH_COST_AMT_LCL) INV_MIN_SOH_COST_AMT_LCL,
        MAX(F.DATASOURCE_NUM_ID) DATASOURCE_NUM_ID,
        MAX(F.DELETE_FLG) DELETE_FLG,
        MAX(F.DOC_CURR_CODE) DOC_CURR_CODE,
        MAX(F.ETL_PROC_WID) ETL_PROC_WID,
        MAX(F.GLOBAL1_EXCHANGE_RATE) GLOBAL1_EXCHANGE_RATE,
        MAX(F.GLOBAL2_EXCHANGE_RATE) GLOBAL2_EXCHANGE_RATE,
        MAX(F.GLOBAL3_EXCHANGE_RATE) GLOBAL3_EXCHANGE_RATE,
        MAX(P.PROD_CL_NUM || O.ORG_NUM ||
            TO_CHAR(TO_DATE(SUBSTR(F.DT_WID, 2, 8), 'YYYYMMDD'),
                    'DD-MON-YY',
                    'NLS_DATE_LANGUAGE=AMERICAN') || F.CLEARANCE_FLG) INTEGRATION_ID,
        MAX(F.LOC_CURR_CODE) LOC_CURR_CODE,
        MAX(F.LOC_EXCHANGE_RATE) LOC_EXCHANGE_RATE,
        MAX(F.TENANT_ID) TENANT_ID,
        SYSDATE W_INSERT_DT,
        SYSDATE W_UPDATE_DT,
        MAX(X_CUSTOM) X_CUSTOM
         FROM RADM.W_RTL_INV_IT_LC_DY_FV    F,
              RABATCHER.W_PRODUCT_D_RTL_TMP P,
              RABATCHER.W_INT_ORG_D_RTL_TMP O
        WHERE F.PROD_WID = P.PROD_IT_WID
          AND F.ORG_WID = O.ORG_WID
          AND F.DT_WID BETWEEN &FROM_DT_WID AND &TO_DT_WID
        GROUP BY P.PROD_CL_WID,
                 F.ORG_WID,
                 F.ORG_DH_WID,
                 F.ORG_SCD1_WID,
                 F.DT_WID,
                 F.CLEARANCE_FLG) S
ON (S.PROD_CL_WID = T.PROD_DH_WID AND S.DT_WID = T.DT_WID AND S.ORG_WID = T.ORG_WID AND S.ORG_DH_WID = T.ORG_DH_WID AND S.ORG_SCD1_WID = T.ORG_SCD1_WID)
WHEN MATCHED THEN
  UPDATE
     SET T.INV_SOH_QTY              = S.INV_SOH_QTY,
         T.INV_ON_ORD_QTY           = S.INV_ON_ORD_QTY,
         T.INV_IN_TRAN_QTY          = S.INV_IN_TRAN_QTY,
         T.INV_MAX_SOH_QTY          = S.INV_MAX_SOH_QTY,
         T.INV_MIN_SOH_QTY          = S.INV_MIN_SOH_QTY,
         T.INV_SOH_RTL_AMT_LCL      = S.INV_SOH_RTL_AMT_LCL,
         T.INV_ON_ORD_RTL_AMT_LCL   = S.INV_ON_ORD_RTL_AMT_LCL,
         T.INV_IN_TRAN_RTL_AMT_LCL  = S.INV_IN_TRAN_RTL_AMT_LCL,
         T.INV_MAX_SOH_RTL_AMT_LCL  = S.INV_MAX_SOH_RTL_AMT_LCL,
         T.INV_MIN_SOH_RTL_AMT_LCL  = S.INV_MIN_SOH_RTL_AMT_LCL,
         T.INV_SOH_COST_AMT_LCL     = S.INV_SOH_COST_AMT_LCL,
         T.INV_ON_ORD_COST_AMT_LCL  = S.INV_ON_ORD_COST_AMT_LCL,
         T.INV_IN_TRAN_COST_AMT_LCL = S.INV_IN_TRAN_COST_AMT_LCL,
         T.INV_MAX_SOH_COST_AMT_LCL = S.INV_MAX_SOH_COST_AMT_LCL,
         T.INV_MIN_SOH_COST_AMT_LCL = S.INV_MIN_SOH_COST_AMT_LCL,
         T.W_UPDATE_DT              = SYSDATE
WHEN NOT MATCHED THEN
  INSERT
    (T.ROW_WID,
     T.PROD_DH_WID,
     T.ORG_WID,
     T.ORG_DH_WID,
     T.ORG_SCD1_WID,
     T.DT_WID,
     T.CLEARANCE_FLG,
     T.INV_SOH_QTY,
     T.INV_ON_ORD_QTY,
     T.INV_IN_TRAN_QTY,
     T.INV_MAX_SOH_QTY,
     T.INV_MIN_SOH_QTY,
     T.INV_SOH_RTL_AMT_LCL,
     T.INV_ON_ORD_RTL_AMT_LCL,
     T.INV_IN_TRAN_RTL_AMT_LCL,
     T.INV_MAX_SOH_RTL_AMT_LCL,
     T.INV_MIN_SOH_RTL_AMT_LCL,
     T.INV_SOH_COST_AMT_LCL,
     T.INV_ON_ORD_COST_AMT_LCL,
     T.INV_IN_TRAN_COST_AMT_LCL,
     T.INV_MAX_SOH_COST_AMT_LCL,
     T.INV_MIN_SOH_COST_AMT_LCL,
     T.DATASOURCE_NUM_ID,
     T.DELETE_FLG,
     T.DOC_CURR_CODE,
     T.ETL_PROC_WID,
     T.GLOBAL1_EXCHANGE_RATE,
     T.GLOBAL2_EXCHANGE_RATE,
     T.GLOBAL3_EXCHANGE_RATE,
     T.INTEGRATION_ID,
     T.LOC_CURR_CODE,
     T.LOC_EXCHANGE_RATE,
     T.TENANT_ID,
     T.W_INSERT_DT,
     T.W_UPDATE_DT,
     T.X_CUSTOM)
  VALUES
    (RADM.W_RTL_INV_CL_LC_DY_A_SEQ.NEXTVAL,
     S.PROD_CL_WID,
     S.ORG_WID,
     S.ORG_DH_WID,
     S.ORG_SCD1_WID,
     S.DT_WID,
     S.CLEARANCE_FLG,
     S.INV_SOH_QTY,
     S.INV_ON_ORD_QTY,
     S.INV_IN_TRAN_QTY,
     S.INV_MAX_SOH_QTY,
     S.INV_MIN_SOH_QTY,
     S.INV_SOH_RTL_AMT_LCL,
     S.INV_ON_ORD_RTL_AMT_LCL,
     S.INV_IN_TRAN_RTL_AMT_LCL,
     S.INV_MAX_SOH_RTL_AMT_LCL,
     S.INV_MIN_SOH_RTL_AMT_LCL,
     S.INV_SOH_COST_AMT_LCL,
     S.INV_ON_ORD_COST_AMT_LCL,
     S.INV_IN_TRAN_COST_AMT_LCL,
     S.INV_MAX_SOH_COST_AMT_LCL,
     S.INV_MIN_SOH_COST_AMT_LCL,
     S.DATASOURCE_NUM_ID,
     S.DELETE_FLG,
     S.DOC_CURR_CODE,
     S.ETL_PROC_WID,
     S.GLOBAL1_EXCHANGE_RATE,
     S.GLOBAL2_EXCHANGE_RATE,
     S.GLOBAL3_EXCHANGE_RATE,
     S.INTEGRATION_ID,
     S.LOC_CURR_CODE,
     S.LOC_EXCHANGE_RATE,
     S.TENANT_ID,
     S.W_INSERT_DT,
     S.W_UPDATE_DT,
     S.X_CUSTOM);
COMMIT;
--3.W_RTL_INV_DP_LC_DY_A------------------------------------------------------------------------------
MERGE /*+ APPEND */
INTO RADM.W_RTL_INV_DP_LC_DY_A T
USING (SELECT /*+ PARALLEL(F,20) (P,20)*/
        P.PROD_DP_WID,
        F.ORG_WID,
        F.ORG_DH_WID,
        F.ORG_SCD1_WID,
        F.DT_WID,
        F.CLEARANCE_FLG,
        SUM(F.INV_SOH_QTY) INV_SOH_QTY,
        SUM(F.INV_ON_ORD_QTY) INV_ON_ORD_QTY,
        SUM(F.INV_IN_TRAN_QTY) INV_IN_TRAN_QTY,
        SUM(F.INV_MAX_SOH_QTY) INV_MAX_SOH_QTY,
        SUM(F.INV_MIN_SOH_QTY) INV_MIN_SOH_QTY,
        SUM(F.INV_SOH_RTL_AMT_LCL) INV_SOH_RTL_AMT_LCL,
        SUM(F.INV_ON_ORD_RTL_AMT_LCL) INV_ON_ORD_RTL_AMT_LCL,
        SUM(F.INV_IN_TRAN_RTL_AMT_LCL) INV_IN_TRAN_RTL_AMT_LCL,
        SUM(F.INV_MAX_SOH_RTL_AMT_LCL) INV_MAX_SOH_RTL_AMT_LCL,
        SUM(F.INV_MIN_SOH_RTL_AMT_LCL) INV_MIN_SOH_RTL_AMT_LCL,
        SUM(F.INV_SOH_COST_AMT_LCL) INV_SOH_COST_AMT_LCL,
        SUM(F.INV_ON_ORD_COST_AMT_LCL) INV_ON_ORD_COST_AMT_LCL,
        SUM(F.INV_IN_TRAN_COST_AMT_LCL) INV_IN_TRAN_COST_AMT_LCL,
        SUM(F.INV_MAX_SOH_COST_AMT_LCL) INV_MAX_SOH_COST_AMT_LCL,
        SUM(F.INV_MIN_SOH_COST_AMT_LCL) INV_MIN_SOH_COST_AMT_LCL,
        MAX(F.DATASOURCE_NUM_ID) DATASOURCE_NUM_ID,
        MAX(F.DELETE_FLG) DELETE_FLG,
        MAX(F.DOC_CURR_CODE) DOC_CURR_CODE,
        MAX(F.ETL_PROC_WID) ETL_PROC_WID,
        MAX(F.GLOBAL1_EXCHANGE_RATE) GLOBAL1_EXCHANGE_RATE,
        MAX(F.GLOBAL2_EXCHANGE_RATE) GLOBAL2_EXCHANGE_RATE,
        MAX(F.GLOBAL3_EXCHANGE_RATE) GLOBAL3_EXCHANGE_RATE,
        MAX(P.PROD_DP_NUM || O.ORG_NUM ||
            TO_CHAR(TO_DATE(SUBSTR(F.DT_WID, 2, 8), 'YYYYMMDD'),
                    'DD-MON-YY',
                    'NLS_DATE_LANGUAGE=AMERICAN') || F.CLEARANCE_FLG) INTEGRATION_ID,
        MAX(F.LOC_CURR_CODE) LOC_CURR_CODE,
        MAX(F.LOC_EXCHANGE_RATE) LOC_EXCHANGE_RATE,
        MAX(F.TENANT_ID) TENANT_ID,
        SYSDATE W_INSERT_DT,
        SYSDATE W_UPDATE_DT,
        MAX(X_CUSTOM) X_CUSTOM
         FROM RADM.W_RTL_INV_IT_LC_DY_FV    F,
              RABATCHER.W_PRODUCT_D_RTL_TMP P,
              RABATCHER.W_INT_ORG_D_RTL_TMP O
        WHERE F.PROD_WID = P.PROD_IT_WID
          AND F.ORG_WID = O.ORG_WID
          AND F.DT_WID BETWEEN &FROM_DT_WID AND &TO_DT_WID
        GROUP BY P.PROD_DP_WID,
                 F.ORG_WID,
                 F.ORG_DH_WID,
                 F.ORG_SCD1_WID,
                 F.DT_WID,
                 F.CLEARANCE_FLG) S
ON (S.PROD_DP_WID = T.PROD_DH_WID AND S.DT_WID = T.DT_WID AND S.ORG_WID = T.ORG_WID AND S.ORG_DH_WID = T.ORG_DH_WID AND S.ORG_SCD1_WID = T.ORG_SCD1_WID)
WHEN MATCHED THEN
  UPDATE
     SET T.INV_SOH_QTY              = S.INV_SOH_QTY,
         T.INV_ON_ORD_QTY           = S.INV_ON_ORD_QTY,
         T.INV_IN_TRAN_QTY          = S.INV_IN_TRAN_QTY,
         T.INV_MAX_SOH_QTY          = S.INV_MAX_SOH_QTY,
         T.INV_MIN_SOH_QTY          = S.INV_MIN_SOH_QTY,
         T.INV_SOH_RTL_AMT_LCL      = S.INV_SOH_RTL_AMT_LCL,
         T.INV_ON_ORD_RTL_AMT_LCL   = S.INV_ON_ORD_RTL_AMT_LCL,
         T.INV_IN_TRAN_RTL_AMT_LCL  = S.INV_IN_TRAN_RTL_AMT_LCL,
         T.INV_MAX_SOH_RTL_AMT_LCL  = S.INV_MAX_SOH_RTL_AMT_LCL,
         T.INV_MIN_SOH_RTL_AMT_LCL  = S.INV_MIN_SOH_RTL_AMT_LCL,
         T.INV_SOH_COST_AMT_LCL     = S.INV_SOH_COST_AMT_LCL,
         T.INV_ON_ORD_COST_AMT_LCL  = S.INV_ON_ORD_COST_AMT_LCL,
         T.INV_IN_TRAN_COST_AMT_LCL = S.INV_IN_TRAN_COST_AMT_LCL,
         T.INV_MAX_SOH_COST_AMT_LCL = S.INV_MAX_SOH_COST_AMT_LCL,
         T.INV_MIN_SOH_COST_AMT_LCL = S.INV_MIN_SOH_COST_AMT_LCL,
         T.W_UPDATE_DT              = SYSDATE
WHEN NOT MATCHED THEN
  INSERT
    (T.ROW_WID,
     T.PROD_DH_WID,
     T.ORG_WID,
     T.ORG_DH_WID,
     T.ORG_SCD1_WID,
     T.DT_WID,
     T.CLEARANCE_FLG,
     T.INV_SOH_QTY,
     T.INV_ON_ORD_QTY,
     T.INV_IN_TRAN_QTY,
     T.INV_MAX_SOH_QTY,
     T.INV_MIN_SOH_QTY,
     T.INV_SOH_RTL_AMT_LCL,
     T.INV_ON_ORD_RTL_AMT_LCL,
     T.INV_IN_TRAN_RTL_AMT_LCL,
     T.INV_MAX_SOH_RTL_AMT_LCL,
     T.INV_MIN_SOH_RTL_AMT_LCL,
     T.INV_SOH_COST_AMT_LCL,
     T.INV_ON_ORD_COST_AMT_LCL,
     T.INV_IN_TRAN_COST_AMT_LCL,
     T.INV_MAX_SOH_COST_AMT_LCL,
     T.INV_MIN_SOH_COST_AMT_LCL,
     T.DATASOURCE_NUM_ID,
     T.DELETE_FLG,
     T.DOC_CURR_CODE,
     T.ETL_PROC_WID,
     T.GLOBAL1_EXCHANGE_RATE,
     T.GLOBAL2_EXCHANGE_RATE,
     T.GLOBAL3_EXCHANGE_RATE,
     T.INTEGRATION_ID,
     T.LOC_CURR_CODE,
     T.LOC_EXCHANGE_RATE,
     T.TENANT_ID,
     T.W_INSERT_DT,
     T.W_UPDATE_DT,
     T.X_CUSTOM)
  VALUES
    (RADM.W_RTL_INV_DP_LC_DY_A_SEQ.NEXTVAL,
     S.PROD_DP_WID,
     S.ORG_WID,
     S.ORG_DH_WID,
     S.ORG_SCD1_WID,
     S.DT_WID,
     S.CLEARANCE_FLG,
     S.INV_SOH_QTY,
     S.INV_ON_ORD_QTY,
     S.INV_IN_TRAN_QTY,
     S.INV_MAX_SOH_QTY,
     S.INV_MIN_SOH_QTY,
     S.INV_SOH_RTL_AMT_LCL,
     S.INV_ON_ORD_RTL_AMT_LCL,
     S.INV_IN_TRAN_RTL_AMT_LCL,
     S.INV_MAX_SOH_RTL_AMT_LCL,
     S.INV_MIN_SOH_RTL_AMT_LCL,
     S.INV_SOH_COST_AMT_LCL,
     S.INV_ON_ORD_COST_AMT_LCL,
     S.INV_IN_TRAN_COST_AMT_LCL,
     S.INV_MAX_SOH_COST_AMT_LCL,
     S.INV_MIN_SOH_COST_AMT_LCL,
     S.DATASOURCE_NUM_ID,
     S.DELETE_FLG,
     S.DOC_CURR_CODE,
     S.ETL_PROC_WID,
     S.GLOBAL1_EXCHANGE_RATE,
     S.GLOBAL2_EXCHANGE_RATE,
     S.GLOBAL3_EXCHANGE_RATE,
     S.INTEGRATION_ID,
     S.LOC_CURR_CODE,
     S.LOC_EXCHANGE_RATE,
     S.TENANT_ID,
     S.W_INSERT_DT,
     S.W_UPDATE_DT,
     S.X_CUSTOM);
COMMIT;
--5.W_RTL_INV_IT_DY_A---------------------------------------------------------------------------------
MERGE /*+ APPEND */
INTO RADM.W_RTL_INV_IT_DY_A T
USING (SELECT /*+ PARALLEL(F,20) (P,20)*/
        F.PROD_WID,
        F.PROD_SCD1_WID,
        F.DT_WID,
        F.CLEARANCE_FLG,
        SUM(F.INV_SOH_QTY) INV_SOH_QTY,
        SUM(F.INV_ON_ORD_QTY) INV_ON_ORD_QTY,
        SUM(F.INV_IN_TRAN_QTY) INV_IN_TRAN_QTY,
        SUM(F.INV_MAX_SOH_QTY) INV_MAX_SOH_QTY,
        SUM(F.INV_MIN_SOH_QTY) INV_MIN_SOH_QTY,
        AVG(F.INV_UNIT_RTL_AMT_LCL) INV_UNIT_RTL_AMT_LCL,
        AVG(F.INV_UNIT_RTL_AMT_LCL / F.LOC_EXCHANGE_RATE) INV_UNIT_RTL_AMT,
        AVG(F.INV_UNIT_RTL_AMT_LCL / F.GLOBAL1_EXCHANGE_RATE) INV_UNIT_RTL_AMT_GLOBAL1,
        AVG(F.INV_UNIT_RTL_AMT_LCL / F.GLOBAL2_EXCHANGE_RATE) INV_UNIT_RTL_AMT_GLOBAL2,
        AVG(F.INV_UNIT_RTL_AMT_LCL / F.GLOBAL3_EXCHANGE_RATE) INV_UNIT_RTL_AMT_GLOBAL3,
        SUM(F.INV_SOH_RTL_AMT_LCL) INV_SOH_RTL_AMT_LCL,
        SUM(F.INV_SOH_RTL_AMT_LCL / F.LOC_EXCHANGE_RATE) INV_SOH_RTL_AMT,
        SUM(F.INV_SOH_RTL_AMT_LCL / F.GLOBAL1_EXCHANGE_RATE) INV_SOH_RTL_AMT_GLOBAL1,
        SUM(F.INV_SOH_RTL_AMT_LCL / F.GLOBAL2_EXCHANGE_RATE) INV_SOH_RTL_AMT_GLOBAL2,
        SUM(F.INV_SOH_RTL_AMT_LCL / F.GLOBAL3_EXCHANGE_RATE) INV_SOH_RTL_AMT_GLOBAL3,
        SUM(F.INV_ON_ORD_RTL_AMT_LCL) INV_ON_ORD_RTL_AMT_LCL,
        SUM(F.INV_ON_ORD_RTL_AMT_LCL / F.LOC_EXCHANGE_RATE) INV_ON_ORD_RTL_AMT,
        SUM(F.INV_ON_ORD_RTL_AMT_LCL / F.GLOBAL1_EXCHANGE_RATE) INV_ON_ORD_RTL_AMT_GLOBAL1,
        SUM(F.INV_ON_ORD_RTL_AMT_LCL / F.GLOBAL2_EXCHANGE_RATE) INV_ON_ORD_RTL_AMT_GLOBAL2,
        SUM(F.INV_ON_ORD_RTL_AMT_LCL / F.GLOBAL3_EXCHANGE_RATE) INV_ON_ORD_RTL_AMT_GLOBAL3,
        SUM(F.INV_IN_TRAN_RTL_AMT_LCL) INV_IN_TRAN_RTL_AMT_LCL,
        SUM(F.INV_IN_TRAN_RTL_AMT_LCL / F.LOC_EXCHANGE_RATE) INV_IN_TRAN_RTL_AMT,
        SUM(F.INV_IN_TRAN_RTL_AMT_LCL / F.GLOBAL1_EXCHANGE_RATE) INV_IN_TRAN_RTL_AMT_GLOBAL1,
        SUM(F.INV_IN_TRAN_RTL_AMT_LCL / F.GLOBAL2_EXCHANGE_RATE) INV_IN_TRAN_RTL_AMT_GLOBAL2,
        SUM(F.INV_IN_TRAN_RTL_AMT_LCL / F.GLOBAL3_EXCHANGE_RATE) INV_IN_TRAN_RTL_AMT_GLOBAL3,
        SUM(F.INV_MAX_SOH_RTL_AMT_LCL) INV_MAX_SOH_RTL_AMT_LCL,
        SUM(F.INV_MAX_SOH_RTL_AMT_LCL / F.LOC_EXCHANGE_RATE) INV_MAX_SOH_RTL_AMT,
        SUM(F.INV_MAX_SOH_RTL_AMT_LCL / F.GLOBAL1_EXCHANGE_RATE) INV_MAX_SOH_RTL_AMT_GLOBAL1,
        SUM(F.INV_MAX_SOH_RTL_AMT_LCL / F.GLOBAL2_EXCHANGE_RATE) INV_MAX_SOH_RTL_AMT_GLOBAL2,
        SUM(F.INV_MAX_SOH_RTL_AMT_LCL / F.GLOBAL3_EXCHANGE_RATE) INV_MAX_SOH_RTL_AMT_GLOBAL3,
        SUM(F.INV_MIN_SOH_RTL_AMT_LCL) INV_MIN_SOH_RTL_AMT_LCL,
        SUM(F.INV_MIN_SOH_RTL_AMT_LCL / F.LOC_EXCHANGE_RATE) INV_MIN_SOH_RTL_AMT,
        SUM(F.INV_MIN_SOH_RTL_AMT_LCL / F.GLOBAL1_EXCHANGE_RATE) INV_MIN_SOH_RTL_AMT_GLOBAL1,
        SUM(F.INV_MIN_SOH_RTL_AMT_LCL / F.GLOBAL2_EXCHANGE_RATE) INV_MIN_SOH_RTL_AMT_GLOBAL2,
        SUM(F.INV_MIN_SOH_RTL_AMT_LCL / F.GLOBAL3_EXCHANGE_RATE) INV_MIN_SOH_RTL_AMT_GLOBAL3,
        AVG(F.INV_AVG_COST_AMT_LCL) INV_AVG_COST_AMT_LCL,
        AVG(F.INV_AVG_COST_AMT_LCL / F.LOC_EXCHANGE_RATE) INV_AVG_COST_AMT,
        AVG(F.INV_AVG_COST_AMT_LCL / F.GLOBAL1_EXCHANGE_RATE) INV_AVG_COST_AMT_GLOBAL1,
        AVG(F.INV_AVG_COST_AMT_LCL / F.GLOBAL2_EXCHANGE_RATE) INV_AVG_COST_AMT_GLOBAL2,
        AVG(F.INV_AVG_COST_AMT_LCL / F.GLOBAL3_EXCHANGE_RATE) INV_AVG_COST_AMT_GLOBAL3,
        AVG(F.INV_UNIT_COST_AMT_LCL) INV_UNIT_COST_AMT_LCL,
        AVG(F.INV_UNIT_COST_AMT_LCL / F.LOC_EXCHANGE_RATE) INV_UNIT_COST_AMT,
        AVG(F.INV_UNIT_COST_AMT_LCL / F.GLOBAL1_EXCHANGE_RATE) INV_UNIT_COST_AMT_GLOBAL1,
        AVG(F.INV_UNIT_COST_AMT_LCL / F.GLOBAL2_EXCHANGE_RATE) INV_UNIT_COST_AMT_GLOBAL2,
        AVG(F.INV_UNIT_COST_AMT_LCL / F.GLOBAL3_EXCHANGE_RATE) INV_UNIT_COST_AMT_GLOBAL3,
        SUM(F.INV_SOH_COST_AMT_LCL) INV_SOH_COST_AMT_LCL,
        SUM(F.INV_SOH_COST_AMT_LCL / F.LOC_EXCHANGE_RATE) INV_SOH_COST_AMT,
        SUM(F.INV_SOH_COST_AMT_LCL / F.GLOBAL1_EXCHANGE_RATE) INV_SOH_COST_AMT_GLOBAL1,
        SUM(F.INV_SOH_COST_AMT_LCL / F.GLOBAL2_EXCHANGE_RATE) INV_SOH_COST_AMT_GLOBAL2,
        SUM(F.INV_SOH_COST_AMT_LCL / F.GLOBAL3_EXCHANGE_RATE) INV_SOH_COST_AMT_GLOBAL3,
        SUM(F.INV_ON_ORD_COST_AMT_LCL) INV_ON_ORD_COST_AMT_LCL,
        SUM(F.INV_ON_ORD_COST_AMT_LCL / F.LOC_EXCHANGE_RATE) INV_ON_ORD_COST_AMT,
        SUM(F.INV_ON_ORD_COST_AMT_LCL / F.GLOBAL1_EXCHANGE_RATE) INV_ON_ORD_COST_AMT_GLOBAL1,
        SUM(F.INV_ON_ORD_COST_AMT_LCL / F.GLOBAL2_EXCHANGE_RATE) INV_ON_ORD_COST_AMT_GLOBAL2,
        SUM(F.INV_ON_ORD_COST_AMT_LCL / F.GLOBAL3_EXCHANGE_RATE) INV_ON_ORD_COST_AMT_GLOBAL3,
        SUM(F.INV_IN_TRAN_COST_AMT_LCL) INV_IN_TRAN_COST_AMT_LCL,
        SUM(F.INV_IN_TRAN_COST_AMT_LCL / F.LOC_EXCHANGE_RATE) INV_IN_TRAN_COST_AMT,
        SUM(F.INV_IN_TRAN_COST_AMT_LCL / F.GLOBAL1_EXCHANGE_RATE) INV_IN_TRAN_COST_AMT_GLOBAL1,
        SUM(F.INV_IN_TRAN_COST_AMT_LCL / F.GLOBAL2_EXCHANGE_RATE) INV_IN_TRAN_COST_AMT_GLOBAL2,
        SUM(F.INV_IN_TRAN_COST_AMT_LCL / F.GLOBAL3_EXCHANGE_RATE) INV_IN_TRAN_COST_AMT_GLOBAL3,
        SUM(F.INV_MAX_SOH_COST_AMT_LCL) INV_MAX_SOH_COST_AMT_LCL,
        SUM(F.INV_MAX_SOH_COST_AMT_LCL / F.LOC_EXCHANGE_RATE) INV_MAX_SOH_COST_AMT,
        SUM(F.INV_MAX_SOH_COST_AMT_LCL / F.GLOBAL1_EXCHANGE_RATE) INV_MAX_SOH_COST_AMT_GLOBAL1,
        SUM(F.INV_MAX_SOH_COST_AMT_LCL / F.GLOBAL2_EXCHANGE_RATE) INV_MAX_SOH_COST_AMT_GLOBAL2,
        SUM(F.INV_MAX_SOH_COST_AMT_LCL / F.GLOBAL3_EXCHANGE_RATE) INV_MAX_SOH_COST_AMT_GLOBAL3,
        SUM(F.INV_MIN_SOH_COST_AMT_LCL) INV_MIN_SOH_COST_AMT_LCL,
        SUM(F.INV_MIN_SOH_COST_AMT_LCL / F.LOC_EXCHANGE_RATE) INV_MIN_SOH_COST_AMT,
        SUM(F.INV_MIN_SOH_COST_AMT_LCL / F.GLOBAL1_EXCHANGE_RATE) INV_MIN_SOH_COST_AMT_GLOBAL1,
        SUM(F.INV_MIN_SOH_COST_AMT_LCL / F.GLOBAL2_EXCHANGE_RATE) INV_MIN_SOH_COST_AMT_GLOBAL2,
        SUM(F.INV_MIN_SOH_COST_AMT_LCL / F.GLOBAL3_EXCHANGE_RATE) INV_MIN_SOH_COST_AMT_GLOBAL3,
        MAX(F.DATASOURCE_NUM_ID) DATASOURCE_NUM_ID,
        MAX(F.DELETE_FLG) DELETE_FLG,
        MAX(F.ETL_PROC_WID) ETL_PROC_WID,
        MAX(P.PROD_SC_NUM ||
            TO_CHAR(TO_DATE(SUBSTR(F.DT_WID, 2, 8), 'YYYYMMDD'),
                    'DD-MON-YY',
                    'NLS_DATE_LANGUAGE=AMERICAN') || F.CLEARANCE_FLG) INTEGRATION_ID,
        MAX(F.TENANT_ID) TENANT_ID,
        SYSDATE W_INSERT_DT,
        SYSDATE W_UPDATE_DT,
        MAX(X_CUSTOM) X_CUSTOM
         FROM RADM.W_RTL_INV_IT_LC_DY_FV F, RABATCHER.W_PRODUCT_D_RTL_TMP P
        WHERE F.PROD_WID = P.PROD_IT_WID
          AND F.DT_WID BETWEEN &FROM_DT_WID AND &TO_DT_WID
        GROUP BY F.PROD_WID, F.PROD_SCD1_WID, F.DT_WID, F.CLEARANCE_FLG) S
ON (S.PROD_WID = T.PROD_WID AND S.DT_WID = T.DT_WID)
WHEN MATCHED THEN
  UPDATE
     SET T.INV_SOH_QTY                  = S.INV_SOH_QTY,
         T.INV_ON_ORD_QTY               = S.INV_ON_ORD_QTY,
         T.INV_IN_TRAN_QTY              = S.INV_IN_TRAN_QTY,
         T.INV_MAX_SOH_QTY              = S.INV_MAX_SOH_QTY,
         T.INV_MIN_SOH_QTY              = S.INV_MIN_SOH_QTY,
         T.INV_UNIT_RTL_AMT_LCL         = S.INV_UNIT_RTL_AMT_LCL,
         T.INV_UNIT_RTL_AMT             = S.INV_UNIT_RTL_AMT,
         T.INV_UNIT_RTL_AMT_GLOBAL1     = S.INV_UNIT_RTL_AMT_GLOBAL1,
         T.INV_UNIT_RTL_AMT_GLOBAL2     = S.INV_UNIT_RTL_AMT_GLOBAL2,
         T.INV_UNIT_RTL_AMT_GLOBAL3     = S.INV_UNIT_RTL_AMT_GLOBAL3,
         T.INV_SOH_RTL_AMT_LCL          = S.INV_SOH_RTL_AMT_LCL,
         T.INV_SOH_RTL_AMT              = S.INV_SOH_RTL_AMT,
         T.INV_SOH_RTL_AMT_GLOBAL1      = S.INV_SOH_RTL_AMT_GLOBAL1,
         T.INV_SOH_RTL_AMT_GLOBAL2      = S.INV_SOH_RTL_AMT_GLOBAL2,
         T.INV_SOH_RTL_AMT_GLOBAL3      = S.INV_SOH_RTL_AMT_GLOBAL3,
         T.INV_ON_ORD_RTL_AMT_LCL       = S.INV_ON_ORD_RTL_AMT_LCL,
         T.INV_ON_ORD_RTL_AMT           = S.INV_ON_ORD_RTL_AMT,
         T.INV_ON_ORD_RTL_AMT_GLOBAL1   = S.INV_ON_ORD_RTL_AMT_GLOBAL1,
         T.INV_ON_ORD_RTL_AMT_GLOBAL2   = S.INV_ON_ORD_RTL_AMT_GLOBAL2,
         T.INV_ON_ORD_RTL_AMT_GLOBAL3   = S.INV_ON_ORD_RTL_AMT_GLOBAL3,
         T.INV_IN_TRAN_RTL_AMT_LCL      = S.INV_IN_TRAN_RTL_AMT_LCL,
         T.INV_IN_TRAN_RTL_AMT          = S.INV_IN_TRAN_RTL_AMT,
         T.INV_IN_TRAN_RTL_AMT_GLOBAL1  = S.INV_IN_TRAN_RTL_AMT_GLOBAL1,
         T.INV_IN_TRAN_RTL_AMT_GLOBAL2  = S.INV_IN_TRAN_RTL_AMT_GLOBAL2,
         T.INV_IN_TRAN_RTL_AMT_GLOBAL3  = S.INV_IN_TRAN_RTL_AMT_GLOBAL3,
         T.INV_MAX_SOH_RTL_AMT_LCL      = S.INV_MAX_SOH_RTL_AMT_LCL,
         T.INV_MAX_SOH_RTL_AMT          = S.INV_MAX_SOH_RTL_AMT,
         T.INV_MAX_SOH_RTL_AMT_GLOBAL1  = S.INV_MAX_SOH_RTL_AMT_GLOBAL1,
         T.INV_MAX_SOH_RTL_AMT_GLOBAL2  = S.INV_MAX_SOH_RTL_AMT_GLOBAL2,
         T.INV_MAX_SOH_RTL_AMT_GLOBAL3  = S.INV_MAX_SOH_RTL_AMT_GLOBAL3,
         T.INV_MIN_SOH_RTL_AMT_LCL      = S.INV_MIN_SOH_RTL_AMT_LCL,
         T.INV_MIN_SOH_RTL_AMT          = S.INV_MIN_SOH_RTL_AMT,
         T.INV_MIN_SOH_RTL_AMT_GLOBAL1  = S.INV_MIN_SOH_RTL_AMT_GLOBAL1,
         T.INV_MIN_SOH_RTL_AMT_GLOBAL2  = S.INV_MIN_SOH_RTL_AMT_GLOBAL2,
         T.INV_MIN_SOH_RTL_AMT_GLOBAL3  = S.INV_MIN_SOH_RTL_AMT_GLOBAL3,
         T.INV_AVG_COST_AMT_LCL         = S.INV_AVG_COST_AMT_LCL,
         T.INV_AVG_COST_AMT             = S.INV_AVG_COST_AMT,
         T.INV_AVG_COST_AMT_GLOBAL1     = S.INV_AVG_COST_AMT_GLOBAL1,
         T.INV_AVG_COST_AMT_GLOBAL2     = S.INV_AVG_COST_AMT_GLOBAL2,
         T.INV_AVG_COST_AMT_GLOBAL3     = S.INV_AVG_COST_AMT_GLOBAL3,
         T.INV_UNIT_COST_AMT_LCL        = S.INV_UNIT_COST_AMT_LCL,
         T.INV_UNIT_COST_AMT            = S.INV_UNIT_COST_AMT,
         T.INV_UNIT_COST_AMT_GLOBAL1    = S.INV_UNIT_COST_AMT_GLOBAL1,
         T.INV_UNIT_COST_AMT_GLOBAL2    = S.INV_UNIT_COST_AMT_GLOBAL2,
         T.INV_UNIT_COST_AMT_GLOBAL3    = S.INV_UNIT_COST_AMT_GLOBAL3,
         T.INV_SOH_COST_AMT_LCL         = S.INV_SOH_COST_AMT_LCL,
         T.INV_SOH_COST_AMT             = S.INV_SOH_COST_AMT,
         T.INV_SOH_COST_AMT_GLOBAL1     = S.INV_SOH_COST_AMT_GLOBAL1,
         T.INV_SOH_COST_AMT_GLOBAL2     = S.INV_SOH_COST_AMT_GLOBAL2,
         T.INV_SOH_COST_AMT_GLOBAL3     = S.INV_SOH_COST_AMT_GLOBAL3,
         T.INV_ON_ORD_COST_AMT_LCL      = S.INV_ON_ORD_COST_AMT_LCL,
         T.INV_ON_ORD_COST_AMT          = S.INV_ON_ORD_COST_AMT,
         T.INV_ON_ORD_COST_AMT_GLOBAL1  = S.INV_ON_ORD_COST_AMT_GLOBAL1,
         T.INV_ON_ORD_COST_AMT_GLOBAL2  = S.INV_ON_ORD_COST_AMT_GLOBAL2,
         T.INV_ON_ORD_COST_AMT_GLOBAL3  = S.INV_ON_ORD_COST_AMT_GLOBAL3,
         T.INV_IN_TRAN_COST_AMT_LCL     = S.INV_IN_TRAN_COST_AMT_LCL,
         T.INV_IN_TRAN_COST_AMT         = S.INV_IN_TRAN_COST_AMT,
         T.INV_IN_TRAN_COST_AMT_GLOBAL1 = S.INV_IN_TRAN_COST_AMT_GLOBAL1,
         T.INV_IN_TRAN_COST_AMT_GLOBAL2 = S.INV_IN_TRAN_COST_AMT_GLOBAL2,
         T.INV_IN_TRAN_COST_AMT_GLOBAL3 = S.INV_IN_TRAN_COST_AMT_GLOBAL3,
         T.INV_MAX_SOH_COST_AMT_LCL     = S.INV_MAX_SOH_COST_AMT_LCL,
         T.INV_MAX_SOH_COST_AMT         = S.INV_MAX_SOH_COST_AMT,
         T.INV_MAX_SOH_COST_AMT_GLOBAL1 = S.INV_MAX_SOH_COST_AMT_GLOBAL1,
         T.INV_MAX_SOH_COST_AMT_GLOBAL2 = S.INV_MAX_SOH_COST_AMT_GLOBAL2,
         T.INV_MAX_SOH_COST_AMT_GLOBAL3 = S.INV_MAX_SOH_COST_AMT_GLOBAL3,
         T.INV_MIN_SOH_COST_AMT_LCL     = S.INV_MIN_SOH_COST_AMT_LCL,
         T.INV_MIN_SOH_COST_AMT         = S.INV_MIN_SOH_COST_AMT,
         T.INV_MIN_SOH_COST_AMT_GLOBAL1 = S.INV_MIN_SOH_COST_AMT_GLOBAL1,
         T.INV_MIN_SOH_COST_AMT_GLOBAL2 = S.INV_MIN_SOH_COST_AMT_GLOBAL2,
         T.INV_MIN_SOH_COST_AMT_GLOBAL3 = S.INV_MIN_SOH_COST_AMT_GLOBAL3,
         T.W_UPDATE_DT                  = SYSDATE
WHEN NOT MATCHED THEN
  INSERT
    (T.ROW_WID,
     T.PROD_WID,
     T.PROD_SCD1_WID,
     T.DT_WID,
     T.CLEARANCE_FLG,
     T.INV_SOH_QTY,
     T.INV_ON_ORD_QTY,
     T.INV_IN_TRAN_QTY,
     T.INV_MAX_SOH_QTY,
     T.INV_MIN_SOH_QTY,
     T.INV_UNIT_RTL_AMT_LCL,
     T.INV_UNIT_RTL_AMT,
     T.INV_UNIT_RTL_AMT_GLOBAL1,
     T.INV_UNIT_RTL_AMT_GLOBAL2,
     T.INV_UNIT_RTL_AMT_GLOBAL3,
     T.INV_SOH_RTL_AMT_LCL,
     T.INV_SOH_RTL_AMT,
     T.INV_SOH_RTL_AMT_GLOBAL1,
     T.INV_SOH_RTL_AMT_GLOBAL2,
     T.INV_SOH_RTL_AMT_GLOBAL3,
     T.INV_ON_ORD_RTL_AMT_LCL,
     T.INV_ON_ORD_RTL_AMT,
     T.INV_ON_ORD_RTL_AMT_GLOBAL1,
     T.INV_ON_ORD_RTL_AMT_GLOBAL2,
     T.INV_ON_ORD_RTL_AMT_GLOBAL3,
     T.INV_IN_TRAN_RTL_AMT_LCL,
     T.INV_IN_TRAN_RTL_AMT,
     T.INV_IN_TRAN_RTL_AMT_GLOBAL1,
     T.INV_IN_TRAN_RTL_AMT_GLOBAL2,
     T.INV_IN_TRAN_RTL_AMT_GLOBAL3,
     T.INV_MAX_SOH_RTL_AMT_LCL,
     T.INV_MAX_SOH_RTL_AMT,
     T.INV_MAX_SOH_RTL_AMT_GLOBAL1,
     T.INV_MAX_SOH_RTL_AMT_GLOBAL2,
     T.INV_MAX_SOH_RTL_AMT_GLOBAL3,
     T.INV_MIN_SOH_RTL_AMT_LCL,
     T.INV_MIN_SOH_RTL_AMT,
     T.INV_MIN_SOH_RTL_AMT_GLOBAL1,
     T.INV_MIN_SOH_RTL_AMT_GLOBAL2,
     T.INV_MIN_SOH_RTL_AMT_GLOBAL3,
     T.INV_AVG_COST_AMT_LCL,
     T.INV_AVG_COST_AMT,
     T.INV_AVG_COST_AMT_GLOBAL1,
     T.INV_AVG_COST_AMT_GLOBAL2,
     T.INV_AVG_COST_AMT_GLOBAL3,
     T.INV_UNIT_COST_AMT_LCL,
     T.INV_UNIT_COST_AMT,
     T.INV_UNIT_COST_AMT_GLOBAL1,
     T.INV_UNIT_COST_AMT_GLOBAL2,
     T.INV_UNIT_COST_AMT_GLOBAL3,
     T.INV_SOH_COST_AMT_LCL,
     T.INV_SOH_COST_AMT,
     T.INV_SOH_COST_AMT_GLOBAL1,
     T.INV_SOH_COST_AMT_GLOBAL2,
     T.INV_SOH_COST_AMT_GLOBAL3,
     T.INV_ON_ORD_COST_AMT_LCL,
     T.INV_ON_ORD_COST_AMT,
     T.INV_ON_ORD_COST_AMT_GLOBAL1,
     T.INV_ON_ORD_COST_AMT_GLOBAL2,
     T.INV_ON_ORD_COST_AMT_GLOBAL3,
     T.INV_IN_TRAN_COST_AMT_LCL,
     T.INV_IN_TRAN_COST_AMT,
     T.INV_IN_TRAN_COST_AMT_GLOBAL1,
     T.INV_IN_TRAN_COST_AMT_GLOBAL2,
     T.INV_IN_TRAN_COST_AMT_GLOBAL3,
     T.INV_MAX_SOH_COST_AMT_LCL,
     T.INV_MAX_SOH_COST_AMT,
     T.INV_MAX_SOH_COST_AMT_GLOBAL1,
     T.INV_MAX_SOH_COST_AMT_GLOBAL2,
     T.INV_MAX_SOH_COST_AMT_GLOBAL3,
     T.INV_MIN_SOH_COST_AMT_LCL,
     T.INV_MIN_SOH_COST_AMT,
     T.INV_MIN_SOH_COST_AMT_GLOBAL1,
     T.INV_MIN_SOH_COST_AMT_GLOBAL2,
     T.INV_MIN_SOH_COST_AMT_GLOBAL3,
     T.DATASOURCE_NUM_ID,
     T.DELETE_FLG,
     T.ETL_PROC_WID,
     T.INTEGRATION_ID,
     T.TENANT_ID,
     T.W_INSERT_DT,
     T.W_UPDATE_DT,
     T.X_CUSTOM)
  VALUES
    (RADM.W_RTL_INV_IT_DY_A_SEQ.NEXTVAL,
     S.PROD_WID,
     S.PROD_SCD1_WID,
     S.DT_WID,
     S.CLEARANCE_FLG,
     S.INV_SOH_QTY,
     S.INV_ON_ORD_QTY,
     S.INV_IN_TRAN_QTY,
     S.INV_MAX_SOH_QTY,
     S.INV_MIN_SOH_QTY,
     S.INV_UNIT_RTL_AMT_LCL,
     S.INV_UNIT_RTL_AMT,
     S.INV_UNIT_RTL_AMT_GLOBAL1,
     S.INV_UNIT_RTL_AMT_GLOBAL2,
     S.INV_UNIT_RTL_AMT_GLOBAL3,
     S.INV_SOH_RTL_AMT_LCL,
     S.INV_SOH_RTL_AMT,
     S.INV_SOH_RTL_AMT_GLOBAL1,
     S.INV_SOH_RTL_AMT_GLOBAL2,
     S.INV_SOH_RTL_AMT_GLOBAL3,
     S.INV_ON_ORD_RTL_AMT_LCL,
     S.INV_ON_ORD_RTL_AMT,
     S.INV_ON_ORD_RTL_AMT_GLOBAL1,
     S.INV_ON_ORD_RTL_AMT_GLOBAL2,
     S.INV_ON_ORD_RTL_AMT_GLOBAL3,
     S.INV_IN_TRAN_RTL_AMT_LCL,
     S.INV_IN_TRAN_RTL_AMT,
     S.INV_IN_TRAN_RTL_AMT_GLOBAL1,
     S.INV_IN_TRAN_RTL_AMT_GLOBAL2,
     S.INV_IN_TRAN_RTL_AMT_GLOBAL3,
     S.INV_MAX_SOH_RTL_AMT_LCL,
     S.INV_MAX_SOH_RTL_AMT,
     S.INV_MAX_SOH_RTL_AMT_GLOBAL1,
     S.INV_MAX_SOH_RTL_AMT_GLOBAL2,
     S.INV_MAX_SOH_RTL_AMT_GLOBAL3,
     S.INV_MIN_SOH_RTL_AMT_LCL,
     S.INV_MIN_SOH_RTL_AMT,
     S.INV_MIN_SOH_RTL_AMT_GLOBAL1,
     S.INV_MIN_SOH_RTL_AMT_GLOBAL2,
     S.INV_MIN_SOH_RTL_AMT_GLOBAL3,
     S.INV_AVG_COST_AMT_LCL,
     S.INV_AVG_COST_AMT,
     S.INV_AVG_COST_AMT_GLOBAL1,
     S.INV_AVG_COST_AMT_GLOBAL2,
     S.INV_AVG_COST_AMT_GLOBAL3,
     S.INV_UNIT_COST_AMT_LCL,
     S.INV_UNIT_COST_AMT,
     S.INV_UNIT_COST_AMT_GLOBAL1,
     S.INV_UNIT_COST_AMT_GLOBAL2,
     S.INV_UNIT_COST_AMT_GLOBAL3,
     S.INV_SOH_COST_AMT_LCL,
     S.INV_SOH_COST_AMT,
     S.INV_SOH_COST_AMT_GLOBAL1,
     S.INV_SOH_COST_AMT_GLOBAL2,
     S.INV_SOH_COST_AMT_GLOBAL3,
     S.INV_ON_ORD_COST_AMT_LCL,
     S.INV_ON_ORD_COST_AMT,
     S.INV_ON_ORD_COST_AMT_GLOBAL1,
     S.INV_ON_ORD_COST_AMT_GLOBAL2,
     S.INV_ON_ORD_COST_AMT_GLOBAL3,
     S.INV_IN_TRAN_COST_AMT_LCL,
     S.INV_IN_TRAN_COST_AMT,
     S.INV_IN_TRAN_COST_AMT_GLOBAL1,
     S.INV_IN_TRAN_COST_AMT_GLOBAL2,
     S.INV_IN_TRAN_COST_AMT_GLOBAL3,
     S.INV_MAX_SOH_COST_AMT_LCL,
     S.INV_MAX_SOH_COST_AMT,
     S.INV_MAX_SOH_COST_AMT_GLOBAL1,
     S.INV_MAX_SOH_COST_AMT_GLOBAL2,
     S.INV_MAX_SOH_COST_AMT_GLOBAL3,
     S.INV_MIN_SOH_COST_AMT_LCL,
     S.INV_MIN_SOH_COST_AMT,
     S.INV_MIN_SOH_COST_AMT_GLOBAL1,
     S.INV_MIN_SOH_COST_AMT_GLOBAL2,
     S.INV_MIN_SOH_COST_AMT_GLOBAL3,
     S.DATASOURCE_NUM_ID,
     S.DELETE_FLG,
     S.ETL_PROC_WID,
     S.INTEGRATION_ID,
     S.TENANT_ID,
     S.W_INSERT_DT,
     S.W_UPDATE_DT,
     S.X_CUSTOM);
COMMIT;
--6.W_RTL_INV_SC_DY_A-----------------------------------------------------------------------------
MERGE /*+ APPEND */
INTO RADM.W_RTL_INV_SC_DY_A T
USING (SELECT /*+ PARALLEL(F,20) (P,20)*/
        P.PROD_SC_WID,
        F.DT_WID,
        F.CLEARANCE_FLG,
        SUM(F.INV_SOH_QTY) INV_SOH_QTY,
        SUM(F.INV_ON_ORD_QTY) INV_ON_ORD_QTY,
        SUM(F.INV_IN_TRAN_QTY) INV_IN_TRAN_QTY,
        SUM(F.INV_MAX_SOH_QTY) INV_MAX_SOH_QTY,
        SUM(F.INV_MIN_SOH_QTY) INV_MIN_SOH_QTY,
        AVG(F.INV_UNIT_RTL_AMT_LCL) INV_UNIT_RTL_AMT_LCL,
        AVG(F.INV_UNIT_RTL_AMT_LCL / F.LOC_EXCHANGE_RATE) INV_UNIT_RTL_AMT,
        AVG(F.INV_UNIT_RTL_AMT_LCL / F.GLOBAL1_EXCHANGE_RATE) INV_UNIT_RTL_AMT_GLOBAL1,
        AVG(F.INV_UNIT_RTL_AMT_LCL / F.GLOBAL2_EXCHANGE_RATE) INV_UNIT_RTL_AMT_GLOBAL2,
        AVG(F.INV_UNIT_RTL_AMT_LCL / F.GLOBAL3_EXCHANGE_RATE) INV_UNIT_RTL_AMT_GLOBAL3,
        SUM(F.INV_SOH_RTL_AMT_LCL) INV_SOH_RTL_AMT_LCL,
        SUM(F.INV_SOH_RTL_AMT_LCL / F.LOC_EXCHANGE_RATE) INV_SOH_RTL_AMT,
        SUM(F.INV_SOH_RTL_AMT_LCL / F.GLOBAL1_EXCHANGE_RATE) INV_SOH_RTL_AMT_GLOBAL1,
        SUM(F.INV_SOH_RTL_AMT_LCL / F.GLOBAL2_EXCHANGE_RATE) INV_SOH_RTL_AMT_GLOBAL2,
        SUM(F.INV_SOH_RTL_AMT_LCL / F.GLOBAL3_EXCHANGE_RATE) INV_SOH_RTL_AMT_GLOBAL3,
        SUM(F.INV_ON_ORD_RTL_AMT_LCL) INV_ON_ORD_RTL_AMT_LCL,
        SUM(F.INV_ON_ORD_RTL_AMT_LCL / F.LOC_EXCHANGE_RATE) INV_ON_ORD_RTL_AMT,
        SUM(F.INV_ON_ORD_RTL_AMT_LCL / F.GLOBAL1_EXCHANGE_RATE) INV_ON_ORD_RTL_AMT_GLOBAL1,
        SUM(F.INV_ON_ORD_RTL_AMT_LCL / F.GLOBAL2_EXCHANGE_RATE) INV_ON_ORD_RTL_AMT_GLOBAL2,
        SUM(F.INV_ON_ORD_RTL_AMT_LCL / F.GLOBAL3_EXCHANGE_RATE) INV_ON_ORD_RTL_AMT_GLOBAL3,
        SUM(F.INV_IN_TRAN_RTL_AMT_LCL) INV_IN_TRAN_RTL_AMT_LCL,
        SUM(F.INV_IN_TRAN_RTL_AMT_LCL / F.LOC_EXCHANGE_RATE) INV_IN_TRAN_RTL_AMT,
        SUM(F.INV_IN_TRAN_RTL_AMT_LCL / F.GLOBAL1_EXCHANGE_RATE) INV_IN_TRAN_RTL_AMT_GLOBAL1,
        SUM(F.INV_IN_TRAN_RTL_AMT_LCL / F.GLOBAL2_EXCHANGE_RATE) INV_IN_TRAN_RTL_AMT_GLOBAL2,
        SUM(F.INV_IN_TRAN_RTL_AMT_LCL / F.GLOBAL3_EXCHANGE_RATE) INV_IN_TRAN_RTL_AMT_GLOBAL3,
        SUM(F.INV_MAX_SOH_RTL_AMT_LCL) INV_MAX_SOH_RTL_AMT_LCL,
        SUM(F.INV_MAX_SOH_RTL_AMT_LCL / F.LOC_EXCHANGE_RATE) INV_MAX_SOH_RTL_AMT,
        SUM(F.INV_MAX_SOH_RTL_AMT_LCL / F.GLOBAL1_EXCHANGE_RATE) INV_MAX_SOH_RTL_AMT_GLOBAL1,
        SUM(F.INV_MAX_SOH_RTL_AMT_LCL / F.GLOBAL2_EXCHANGE_RATE) INV_MAX_SOH_RTL_AMT_GLOBAL2,
        SUM(F.INV_MAX_SOH_RTL_AMT_LCL / F.GLOBAL3_EXCHANGE_RATE) INV_MAX_SOH_RTL_AMT_GLOBAL3,
        SUM(F.INV_MIN_SOH_RTL_AMT_LCL) INV_MIN_SOH_RTL_AMT_LCL,
        SUM(F.INV_MIN_SOH_RTL_AMT_LCL / F.LOC_EXCHANGE_RATE) INV_MIN_SOH_RTL_AMT,
        SUM(F.INV_MIN_SOH_RTL_AMT_LCL / F.GLOBAL1_EXCHANGE_RATE) INV_MIN_SOH_RTL_AMT_GLOBAL1,
        SUM(F.INV_MIN_SOH_RTL_AMT_LCL / F.GLOBAL2_EXCHANGE_RATE) INV_MIN_SOH_RTL_AMT_GLOBAL2,
        SUM(F.INV_MIN_SOH_RTL_AMT_LCL / F.GLOBAL3_EXCHANGE_RATE) INV_MIN_SOH_RTL_AMT_GLOBAL3,
        AVG(F.INV_AVG_COST_AMT_LCL) INV_AVG_COST_AMT_LCL,
        AVG(F.INV_AVG_COST_AMT_LCL / F.LOC_EXCHANGE_RATE) INV_AVG_COST_AMT,
        AVG(F.INV_AVG_COST_AMT_LCL / F.GLOBAL1_EXCHANGE_RATE) INV_AVG_COST_AMT_GLOBAL1,
        AVG(F.INV_AVG_COST_AMT_LCL / F.GLOBAL2_EXCHANGE_RATE) INV_AVG_COST_AMT_GLOBAL2,
        AVG(F.INV_AVG_COST_AMT_LCL / F.GLOBAL3_EXCHANGE_RATE) INV_AVG_COST_AMT_GLOBAL3,
        AVG(F.INV_UNIT_COST_AMT_LCL) INV_UNIT_COST_AMT_LCL,
        AVG(F.INV_UNIT_COST_AMT_LCL / F.LOC_EXCHANGE_RATE) INV_UNIT_COST_AMT,
        AVG(F.INV_UNIT_COST_AMT_LCL / F.GLOBAL1_EXCHANGE_RATE) INV_UNIT_COST_AMT_GLOBAL1,
        AVG(F.INV_UNIT_COST_AMT_LCL / F.GLOBAL2_EXCHANGE_RATE) INV_UNIT_COST_AMT_GLOBAL2,
        AVG(F.INV_UNIT_COST_AMT_LCL / F.GLOBAL3_EXCHANGE_RATE) INV_UNIT_COST_AMT_GLOBAL3,
        SUM(F.INV_SOH_COST_AMT_LCL) INV_SOH_COST_AMT_LCL,
        SUM(F.INV_SOH_COST_AMT_LCL / F.LOC_EXCHANGE_RATE) INV_SOH_COST_AMT,
        SUM(F.INV_SOH_COST_AMT_LCL / F.GLOBAL1_EXCHANGE_RATE) INV_SOH_COST_AMT_GLOBAL1,
        SUM(F.INV_SOH_COST_AMT_LCL / F.GLOBAL2_EXCHANGE_RATE) INV_SOH_COST_AMT_GLOBAL2,
        SUM(F.INV_SOH_COST_AMT_LCL / F.GLOBAL3_EXCHANGE_RATE) INV_SOH_COST_AMT_GLOBAL3,
        SUM(F.INV_ON_ORD_COST_AMT_LCL) INV_ON_ORD_COST_AMT_LCL,
        SUM(F.INV_ON_ORD_COST_AMT_LCL / F.LOC_EXCHANGE_RATE) INV_ON_ORD_COST_AMT,
        SUM(F.INV_ON_ORD_COST_AMT_LCL / F.GLOBAL1_EXCHANGE_RATE) INV_ON_ORD_COST_AMT_GLOBAL1,
        SUM(F.INV_ON_ORD_COST_AMT_LCL / F.GLOBAL2_EXCHANGE_RATE) INV_ON_ORD_COST_AMT_GLOBAL2,
        SUM(F.INV_ON_ORD_COST_AMT_LCL / F.GLOBAL3_EXCHANGE_RATE) INV_ON_ORD_COST_AMT_GLOBAL3,
        SUM(F.INV_IN_TRAN_COST_AMT_LCL) INV_IN_TRAN_COST_AMT_LCL,
        SUM(F.INV_IN_TRAN_COST_AMT_LCL / F.LOC_EXCHANGE_RATE) INV_IN_TRAN_COST_AMT,
        SUM(F.INV_IN_TRAN_COST_AMT_LCL / F.GLOBAL1_EXCHANGE_RATE) INV_IN_TRAN_COST_AMT_GLOBAL1,
        SUM(F.INV_IN_TRAN_COST_AMT_LCL / F.GLOBAL2_EXCHANGE_RATE) INV_IN_TRAN_COST_AMT_GLOBAL2,
        SUM(F.INV_IN_TRAN_COST_AMT_LCL / F.GLOBAL3_EXCHANGE_RATE) INV_IN_TRAN_COST_AMT_GLOBAL3,
        SUM(F.INV_MAX_SOH_COST_AMT_LCL) INV_MAX_SOH_COST_AMT_LCL,
        SUM(F.INV_MAX_SOH_COST_AMT_LCL / F.LOC_EXCHANGE_RATE) INV_MAX_SOH_COST_AMT,
        SUM(F.INV_MAX_SOH_COST_AMT_LCL / F.GLOBAL1_EXCHANGE_RATE) INV_MAX_SOH_COST_AMT_GLOBAL1,
        SUM(F.INV_MAX_SOH_COST_AMT_LCL / F.GLOBAL2_EXCHANGE_RATE) INV_MAX_SOH_COST_AMT_GLOBAL2,
        SUM(F.INV_MAX_SOH_COST_AMT_LCL / F.GLOBAL3_EXCHANGE_RATE) INV_MAX_SOH_COST_AMT_GLOBAL3,
        SUM(F.INV_MIN_SOH_COST_AMT_LCL) INV_MIN_SOH_COST_AMT_LCL,
        SUM(F.INV_MIN_SOH_COST_AMT_LCL / F.LOC_EXCHANGE_RATE) INV_MIN_SOH_COST_AMT,
        SUM(F.INV_MIN_SOH_COST_AMT_LCL / F.GLOBAL1_EXCHANGE_RATE) INV_MIN_SOH_COST_AMT_GLOBAL1,
        SUM(F.INV_MIN_SOH_COST_AMT_LCL / F.GLOBAL2_EXCHANGE_RATE) INV_MIN_SOH_COST_AMT_GLOBAL2,
        SUM(F.INV_MIN_SOH_COST_AMT_LCL / F.GLOBAL3_EXCHANGE_RATE) INV_MIN_SOH_COST_AMT_GLOBAL3,
        MAX(F.DATASOURCE_NUM_ID) DATASOURCE_NUM_ID,
        MAX(F.DELETE_FLG) DELETE_FLG,
        MAX(F.ETL_PROC_WID) ETL_PROC_WID,
        MAX(P.PROD_SC_NUM ||
            TO_CHAR(TO_DATE(SUBSTR(F.DT_WID, 2, 8), 'YYYYMMDD'),
                    'DD-MON-YY',
                    'NLS_DATE_LANGUAGE=AMERICAN') || F.CLEARANCE_FLG) INTEGRATION_ID,
        MAX(F.TENANT_ID) TENANT_ID,
        SYSDATE W_INSERT_DT,
        SYSDATE W_UPDATE_DT,
        MAX(X_CUSTOM) X_CUSTOM
         FROM RADM.W_RTL_INV_IT_LC_DY_FV F, RABATCHER.W_PRODUCT_D_RTL_TMP P
        WHERE F.PROD_WID = P.PROD_IT_WID
          AND F.DT_WID BETWEEN &FROM_DT_WID AND &TO_DT_WID
        GROUP BY P.PROD_SC_WID, F.DT_WID, F.CLEARANCE_FLG) S
ON (S.PROD_SC_WID = T.PROD_DH_WID AND S.DT_WID = T.DT_WID)
WHEN MATCHED THEN
  UPDATE
     SET T.INV_SOH_QTY                  = S.INV_SOH_QTY,
         T.INV_ON_ORD_QTY               = S.INV_ON_ORD_QTY,
         T.INV_IN_TRAN_QTY              = S.INV_IN_TRAN_QTY,
         T.INV_MAX_SOH_QTY              = S.INV_MAX_SOH_QTY,
         T.INV_MIN_SOH_QTY              = S.INV_MIN_SOH_QTY,
         T.INV_UNIT_RTL_AMT_LCL         = S.INV_UNIT_RTL_AMT_LCL,
         T.INV_UNIT_RTL_AMT             = S.INV_UNIT_RTL_AMT,
         T.INV_UNIT_RTL_AMT_GLOBAL1     = S.INV_UNIT_RTL_AMT_GLOBAL1,
         T.INV_UNIT_RTL_AMT_GLOBAL2     = S.INV_UNIT_RTL_AMT_GLOBAL2,
         T.INV_UNIT_RTL_AMT_GLOBAL3     = S.INV_UNIT_RTL_AMT_GLOBAL3,
         T.INV_SOH_RTL_AMT_LCL          = S.INV_SOH_RTL_AMT_LCL,
         T.INV_SOH_RTL_AMT              = S.INV_SOH_RTL_AMT,
         T.INV_SOH_RTL_AMT_GLOBAL1      = S.INV_SOH_RTL_AMT_GLOBAL1,
         T.INV_SOH_RTL_AMT_GLOBAL2      = S.INV_SOH_RTL_AMT_GLOBAL2,
         T.INV_SOH_RTL_AMT_GLOBAL3      = S.INV_SOH_RTL_AMT_GLOBAL3,
         T.INV_ON_ORD_RTL_AMT_LCL       = S.INV_ON_ORD_RTL_AMT_LCL,
         T.INV_ON_ORD_RTL_AMT           = S.INV_ON_ORD_RTL_AMT,
         T.INV_ON_ORD_RTL_AMT_GLOBAL1   = S.INV_ON_ORD_RTL_AMT_GLOBAL1,
         T.INV_ON_ORD_RTL_AMT_GLOBAL2   = S.INV_ON_ORD_RTL_AMT_GLOBAL2,
         T.INV_ON_ORD_RTL_AMT_GLOBAL3   = S.INV_ON_ORD_RTL_AMT_GLOBAL3,
         T.INV_IN_TRAN_RTL_AMT_LCL      = S.INV_IN_TRAN_RTL_AMT_LCL,
         T.INV_IN_TRAN_RTL_AMT          = S.INV_IN_TRAN_RTL_AMT,
         T.INV_IN_TRAN_RTL_AMT_GLOBAL1  = S.INV_IN_TRAN_RTL_AMT_GLOBAL1,
         T.INV_IN_TRAN_RTL_AMT_GLOBAL2  = S.INV_IN_TRAN_RTL_AMT_GLOBAL2,
         T.INV_IN_TRAN_RTL_AMT_GLOBAL3  = S.INV_IN_TRAN_RTL_AMT_GLOBAL3,
         T.INV_MAX_SOH_RTL_AMT_LCL      = S.INV_MAX_SOH_RTL_AMT_LCL,
         T.INV_MAX_SOH_RTL_AMT          = S.INV_MAX_SOH_RTL_AMT,
         T.INV_MAX_SOH_RTL_AMT_GLOBAL1  = S.INV_MAX_SOH_RTL_AMT_GLOBAL1,
         T.INV_MAX_SOH_RTL_AMT_GLOBAL2  = S.INV_MAX_SOH_RTL_AMT_GLOBAL2,
         T.INV_MAX_SOH_RTL_AMT_GLOBAL3  = S.INV_MAX_SOH_RTL_AMT_GLOBAL3,
         T.INV_MIN_SOH_RTL_AMT_LCL      = S.INV_MIN_SOH_RTL_AMT_LCL,
         T.INV_MIN_SOH_RTL_AMT          = S.INV_MIN_SOH_RTL_AMT,
         T.INV_MIN_SOH_RTL_AMT_GLOBAL1  = S.INV_MIN_SOH_RTL_AMT_GLOBAL1,
         T.INV_MIN_SOH_RTL_AMT_GLOBAL2  = S.INV_MIN_SOH_RTL_AMT_GLOBAL2,
         T.INV_MIN_SOH_RTL_AMT_GLOBAL3  = S.INV_MIN_SOH_RTL_AMT_GLOBAL3,
         T.INV_AVG_COST_AMT_LCL         = S.INV_AVG_COST_AMT_LCL,
         T.INV_AVG_COST_AMT             = S.INV_AVG_COST_AMT,
         T.INV_AVG_COST_AMT_GLOBAL1     = S.INV_AVG_COST_AMT_GLOBAL1,
         T.INV_AVG_COST_AMT_GLOBAL2     = S.INV_AVG_COST_AMT_GLOBAL2,
         T.INV_AVG_COST_AMT_GLOBAL3     = S.INV_AVG_COST_AMT_GLOBAL3,
         T.INV_UNIT_COST_AMT_LCL        = S.INV_UNIT_COST_AMT_LCL,
         T.INV_UNIT_COST_AMT            = S.INV_UNIT_COST_AMT,
         T.INV_UNIT_COST_AMT_GLOBAL1    = S.INV_UNIT_COST_AMT_GLOBAL1,
         T.INV_UNIT_COST_AMT_GLOBAL2    = S.INV_UNIT_COST_AMT_GLOBAL2,
         T.INV_UNIT_COST_AMT_GLOBAL3    = S.INV_UNIT_COST_AMT_GLOBAL3,
         T.INV_SOH_COST_AMT_LCL         = S.INV_SOH_COST_AMT_LCL,
         T.INV_SOH_COST_AMT             = S.INV_SOH_COST_AMT,
         T.INV_SOH_COST_AMT_GLOBAL1     = S.INV_SOH_COST_AMT_GLOBAL1,
         T.INV_SOH_COST_AMT_GLOBAL2     = S.INV_SOH_COST_AMT_GLOBAL2,
         T.INV_SOH_COST_AMT_GLOBAL3     = S.INV_SOH_COST_AMT_GLOBAL3,
         T.INV_ON_ORD_COST_AMT_LCL      = S.INV_ON_ORD_COST_AMT_LCL,
         T.INV_ON_ORD_COST_AMT          = S.INV_ON_ORD_COST_AMT,
         T.INV_ON_ORD_COST_AMT_GLOBAL1  = S.INV_ON_ORD_COST_AMT_GLOBAL1,
         T.INV_ON_ORD_COST_AMT_GLOBAL2  = S.INV_ON_ORD_COST_AMT_GLOBAL2,
         T.INV_ON_ORD_COST_AMT_GLOBAL3  = S.INV_ON_ORD_COST_AMT_GLOBAL3,
         T.INV_IN_TRAN_COST_AMT_LCL     = S.INV_IN_TRAN_COST_AMT_LCL,
         T.INV_IN_TRAN_COST_AMT         = S.INV_IN_TRAN_COST_AMT,
         T.INV_IN_TRAN_COST_AMT_GLOBAL1 = S.INV_IN_TRAN_COST_AMT_GLOBAL1,
         T.INV_IN_TRAN_COST_AMT_GLOBAL2 = S.INV_IN_TRAN_COST_AMT_GLOBAL2,
         T.INV_IN_TRAN_COST_AMT_GLOBAL3 = S.INV_IN_TRAN_COST_AMT_GLOBAL3,
         T.INV_MAX_SOH_COST_AMT_LCL     = S.INV_MAX_SOH_COST_AMT_LCL,
         T.INV_MAX_SOH_COST_AMT         = S.INV_MAX_SOH_COST_AMT,
         T.INV_MAX_SOH_COST_AMT_GLOBAL1 = S.INV_MAX_SOH_COST_AMT_GLOBAL1,
         T.INV_MAX_SOH_COST_AMT_GLOBAL2 = S.INV_MAX_SOH_COST_AMT_GLOBAL2,
         T.INV_MAX_SOH_COST_AMT_GLOBAL3 = S.INV_MAX_SOH_COST_AMT_GLOBAL3,
         T.INV_MIN_SOH_COST_AMT_LCL     = S.INV_MIN_SOH_COST_AMT_LCL,
         T.INV_MIN_SOH_COST_AMT         = S.INV_MIN_SOH_COST_AMT,
         T.INV_MIN_SOH_COST_AMT_GLOBAL1 = S.INV_MIN_SOH_COST_AMT_GLOBAL1,
         T.INV_MIN_SOH_COST_AMT_GLOBAL2 = S.INV_MIN_SOH_COST_AMT_GLOBAL2,
         T.INV_MIN_SOH_COST_AMT_GLOBAL3 = S.INV_MIN_SOH_COST_AMT_GLOBAL3,
         T.W_UPDATE_DT                  = SYSDATE
WHEN NOT MATCHED THEN
  INSERT
    (T.ROW_WID,
     T.PROD_DH_WID,
     T.DT_WID,
     T.CLEARANCE_FLG,
     T.INV_SOH_QTY,
     T.INV_ON_ORD_QTY,
     T.INV_IN_TRAN_QTY,
     T.INV_MAX_SOH_QTY,
     T.INV_MIN_SOH_QTY,
     T.INV_UNIT_RTL_AMT_LCL,
     T.INV_UNIT_RTL_AMT,
     T.INV_UNIT_RTL_AMT_GLOBAL1,
     T.INV_UNIT_RTL_AMT_GLOBAL2,
     T.INV_UNIT_RTL_AMT_GLOBAL3,
     T.INV_SOH_RTL_AMT_LCL,
     T.INV_SOH_RTL_AMT,
     T.INV_SOH_RTL_AMT_GLOBAL1,
     T.INV_SOH_RTL_AMT_GLOBAL2,
     T.INV_SOH_RTL_AMT_GLOBAL3,
     T.INV_ON_ORD_RTL_AMT_LCL,
     T.INV_ON_ORD_RTL_AMT,
     T.INV_ON_ORD_RTL_AMT_GLOBAL1,
     T.INV_ON_ORD_RTL_AMT_GLOBAL2,
     T.INV_ON_ORD_RTL_AMT_GLOBAL3,
     T.INV_IN_TRAN_RTL_AMT_LCL,
     T.INV_IN_TRAN_RTL_AMT,
     T.INV_IN_TRAN_RTL_AMT_GLOBAL1,
     T.INV_IN_TRAN_RTL_AMT_GLOBAL2,
     T.INV_IN_TRAN_RTL_AMT_GLOBAL3,
     T.INV_MAX_SOH_RTL_AMT_LCL,
     T.INV_MAX_SOH_RTL_AMT,
     T.INV_MAX_SOH_RTL_AMT_GLOBAL1,
     T.INV_MAX_SOH_RTL_AMT_GLOBAL2,
     T.INV_MAX_SOH_RTL_AMT_GLOBAL3,
     T.INV_MIN_SOH_RTL_AMT_LCL,
     T.INV_MIN_SOH_RTL_AMT,
     T.INV_MIN_SOH_RTL_AMT_GLOBAL1,
     T.INV_MIN_SOH_RTL_AMT_GLOBAL2,
     T.INV_MIN_SOH_RTL_AMT_GLOBAL3,
     T.INV_AVG_COST_AMT_LCL,
     T.INV_AVG_COST_AMT,
     T.INV_AVG_COST_AMT_GLOBAL1,
     T.INV_AVG_COST_AMT_GLOBAL2,
     T.INV_AVG_COST_AMT_GLOBAL3,
     T.INV_UNIT_COST_AMT_LCL,
     T.INV_UNIT_COST_AMT,
     T.INV_UNIT_COST_AMT_GLOBAL1,
     T.INV_UNIT_COST_AMT_GLOBAL2,
     T.INV_UNIT_COST_AMT_GLOBAL3,
     T.INV_SOH_COST_AMT_LCL,
     T.INV_SOH_COST_AMT,
     T.INV_SOH_COST_AMT_GLOBAL1,
     T.INV_SOH_COST_AMT_GLOBAL2,
     T.INV_SOH_COST_AMT_GLOBAL3,
     T.INV_ON_ORD_COST_AMT_LCL,
     T.INV_ON_ORD_COST_AMT,
     T.INV_ON_ORD_COST_AMT_GLOBAL1,
     T.INV_ON_ORD_COST_AMT_GLOBAL2,
     T.INV_ON_ORD_COST_AMT_GLOBAL3,
     T.INV_IN_TRAN_COST_AMT_LCL,
     T.INV_IN_TRAN_COST_AMT,
     T.INV_IN_TRAN_COST_AMT_GLOBAL1,
     T.INV_IN_TRAN_COST_AMT_GLOBAL2,
     T.INV_IN_TRAN_COST_AMT_GLOBAL3,
     T.INV_MAX_SOH_COST_AMT_LCL,
     T.INV_MAX_SOH_COST_AMT,
     T.INV_MAX_SOH_COST_AMT_GLOBAL1,
     T.INV_MAX_SOH_COST_AMT_GLOBAL2,
     T.INV_MAX_SOH_COST_AMT_GLOBAL3,
     T.INV_MIN_SOH_COST_AMT_LCL,
     T.INV_MIN_SOH_COST_AMT,
     T.INV_MIN_SOH_COST_AMT_GLOBAL1,
     T.INV_MIN_SOH_COST_AMT_GLOBAL2,
     T.INV_MIN_SOH_COST_AMT_GLOBAL3,
     T.DATASOURCE_NUM_ID,
     T.DELETE_FLG,
     T.ETL_PROC_WID,
     T.INTEGRATION_ID,
     T.TENANT_ID,
     T.W_INSERT_DT,
     T.W_UPDATE_DT,
     T.X_CUSTOM)
  VALUES
    (RADM.W_RTL_INV_SC_DY_A_SEQ.NEXTVAL,
     S.PROD_SC_WID,
     S.DT_WID,
     S.CLEARANCE_FLG,
     S.INV_SOH_QTY,
     S.INV_ON_ORD_QTY,
     S.INV_IN_TRAN_QTY,
     S.INV_MAX_SOH_QTY,
     S.INV_MIN_SOH_QTY,
     S.INV_UNIT_RTL_AMT_LCL,
     S.INV_UNIT_RTL_AMT,
     S.INV_UNIT_RTL_AMT_GLOBAL1,
     S.INV_UNIT_RTL_AMT_GLOBAL2,
     S.INV_UNIT_RTL_AMT_GLOBAL3,
     S.INV_SOH_RTL_AMT_LCL,
     S.INV_SOH_RTL_AMT,
     S.INV_SOH_RTL_AMT_GLOBAL1,
     S.INV_SOH_RTL_AMT_GLOBAL2,
     S.INV_SOH_RTL_AMT_GLOBAL3,
     S.INV_ON_ORD_RTL_AMT_LCL,
     S.INV_ON_ORD_RTL_AMT,
     S.INV_ON_ORD_RTL_AMT_GLOBAL1,
     S.INV_ON_ORD_RTL_AMT_GLOBAL2,
     S.INV_ON_ORD_RTL_AMT_GLOBAL3,
     S.INV_IN_TRAN_RTL_AMT_LCL,
     S.INV_IN_TRAN_RTL_AMT,
     S.INV_IN_TRAN_RTL_AMT_GLOBAL1,
     S.INV_IN_TRAN_RTL_AMT_GLOBAL2,
     S.INV_IN_TRAN_RTL_AMT_GLOBAL3,
     S.INV_MAX_SOH_RTL_AMT_LCL,
     S.INV_MAX_SOH_RTL_AMT,
     S.INV_MAX_SOH_RTL_AMT_GLOBAL1,
     S.INV_MAX_SOH_RTL_AMT_GLOBAL2,
     S.INV_MAX_SOH_RTL_AMT_GLOBAL3,
     S.INV_MIN_SOH_RTL_AMT_LCL,
     S.INV_MIN_SOH_RTL_AMT,
     S.INV_MIN_SOH_RTL_AMT_GLOBAL1,
     S.INV_MIN_SOH_RTL_AMT_GLOBAL2,
     S.INV_MIN_SOH_RTL_AMT_GLOBAL3,
     S.INV_AVG_COST_AMT_LCL,
     S.INV_AVG_COST_AMT,
     S.INV_AVG_COST_AMT_GLOBAL1,
     S.INV_AVG_COST_AMT_GLOBAL2,
     S.INV_AVG_COST_AMT_GLOBAL3,
     S.INV_UNIT_COST_AMT_LCL,
     S.INV_UNIT_COST_AMT,
     S.INV_UNIT_COST_AMT_GLOBAL1,
     S.INV_UNIT_COST_AMT_GLOBAL2,
     S.INV_UNIT_COST_AMT_GLOBAL3,
     S.INV_SOH_COST_AMT_LCL,
     S.INV_SOH_COST_AMT,
     S.INV_SOH_COST_AMT_GLOBAL1,
     S.INV_SOH_COST_AMT_GLOBAL2,
     S.INV_SOH_COST_AMT_GLOBAL3,
     S.INV_ON_ORD_COST_AMT_LCL,
     S.INV_ON_ORD_COST_AMT,
     S.INV_ON_ORD_COST_AMT_GLOBAL1,
     S.INV_ON_ORD_COST_AMT_GLOBAL2,
     S.INV_ON_ORD_COST_AMT_GLOBAL3,
     S.INV_IN_TRAN_COST_AMT_LCL,
     S.INV_IN_TRAN_COST_AMT,
     S.INV_IN_TRAN_COST_AMT_GLOBAL1,
     S.INV_IN_TRAN_COST_AMT_GLOBAL2,
     S.INV_IN_TRAN_COST_AMT_GLOBAL3,
     S.INV_MAX_SOH_COST_AMT_LCL,
     S.INV_MAX_SOH_COST_AMT,
     S.INV_MAX_SOH_COST_AMT_GLOBAL1,
     S.INV_MAX_SOH_COST_AMT_GLOBAL2,
     S.INV_MAX_SOH_COST_AMT_GLOBAL3,
     S.INV_MIN_SOH_COST_AMT_LCL,
     S.INV_MIN_SOH_COST_AMT,
     S.INV_MIN_SOH_COST_AMT_GLOBAL1,
     S.INV_MIN_SOH_COST_AMT_GLOBAL2,
     S.INV_MIN_SOH_COST_AMT_GLOBAL3,
     S.DATASOURCE_NUM_ID,
     S.DELETE_FLG,
     S.ETL_PROC_WID,
     S.INTEGRATION_ID,
     S.TENANT_ID,
     S.W_INSERT_DT,
     S.W_UPDATE_DT,
     S.X_CUSTOM);
COMMIT;
--7.W_RTL_INV_SC_DY_CUR_A---------------------------------------------------------------------------------
MERGE /*+ APPEND */
INTO RADM.W_RTL_INV_SC_DY_CUR_A T
USING (SELECT /*+ PARALLEL(F,4) (P,4)*/
        P.PROD_SC_WID,
        F.DT_WID,
        F.CLEARANCE_FLG,
        SUM(F.INV_SOH_QTY) INV_SOH_QTY,
        SUM(F.INV_ON_ORD_QTY) INV_ON_ORD_QTY,
        SUM(F.INV_IN_TRAN_QTY) INV_IN_TRAN_QTY,
        SUM(F.INV_MAX_SOH_QTY) INV_MAX_SOH_QTY,
        SUM(F.INV_MIN_SOH_QTY) INV_MIN_SOH_QTY,
        AVG(F.INV_UNIT_RTL_AMT_LCL) INV_UNIT_RTL_AMT_LCL,
        AVG(F.INV_UNIT_RTL_AMT_LCL / F.LOC_EXCHANGE_RATE) INV_UNIT_RTL_AMT,
        AVG(F.INV_UNIT_RTL_AMT_LCL / F.GLOBAL1_EXCHANGE_RATE) INV_UNIT_RTL_AMT_GLOBAL1,
        AVG(F.INV_UNIT_RTL_AMT_LCL / F.GLOBAL2_EXCHANGE_RATE) INV_UNIT_RTL_AMT_GLOBAL2,
        AVG(F.INV_UNIT_RTL_AMT_LCL / F.GLOBAL3_EXCHANGE_RATE) INV_UNIT_RTL_AMT_GLOBAL3,
        SUM(F.INV_SOH_RTL_AMT_LCL) INV_SOH_RTL_AMT_LCL,
        SUM(F.INV_SOH_RTL_AMT_LCL / F.LOC_EXCHANGE_RATE) INV_SOH_RTL_AMT,
        SUM(F.INV_SOH_RTL_AMT_LCL / F.GLOBAL1_EXCHANGE_RATE) INV_SOH_RTL_AMT_GLOBAL1,
        SUM(F.INV_SOH_RTL_AMT_LCL / F.GLOBAL2_EXCHANGE_RATE) INV_SOH_RTL_AMT_GLOBAL2,
        SUM(F.INV_SOH_RTL_AMT_LCL / F.GLOBAL3_EXCHANGE_RATE) INV_SOH_RTL_AMT_GLOBAL3,
        SUM(F.INV_ON_ORD_RTL_AMT_LCL) INV_ON_ORD_RTL_AMT_LCL,
        SUM(F.INV_ON_ORD_RTL_AMT_LCL / F.LOC_EXCHANGE_RATE) INV_ON_ORD_RTL_AMT,
        SUM(F.INV_ON_ORD_RTL_AMT_LCL / F.GLOBAL1_EXCHANGE_RATE) INV_ON_ORD_RTL_AMT_GLOBAL1,
        SUM(F.INV_ON_ORD_RTL_AMT_LCL / F.GLOBAL2_EXCHANGE_RATE) INV_ON_ORD_RTL_AMT_GLOBAL2,
        SUM(F.INV_ON_ORD_RTL_AMT_LCL / F.GLOBAL3_EXCHANGE_RATE) INV_ON_ORD_RTL_AMT_GLOBAL3,
        SUM(F.INV_IN_TRAN_RTL_AMT_LCL) INV_IN_TRAN_RTL_AMT_LCL,
        SUM(F.INV_IN_TRAN_RTL_AMT_LCL / F.LOC_EXCHANGE_RATE) INV_IN_TRAN_RTL_AMT,
        SUM(F.INV_IN_TRAN_RTL_AMT_LCL / F.GLOBAL1_EXCHANGE_RATE) INV_IN_TRAN_RTL_AMT_GLOBAL1,
        SUM(F.INV_IN_TRAN_RTL_AMT_LCL / F.GLOBAL2_EXCHANGE_RATE) INV_IN_TRAN_RTL_AMT_GLOBAL2,
        SUM(F.INV_IN_TRAN_RTL_AMT_LCL / F.GLOBAL3_EXCHANGE_RATE) INV_IN_TRAN_RTL_AMT_GLOBAL3,
        SUM(F.INV_MAX_SOH_RTL_AMT_LCL) INV_MAX_SOH_RTL_AMT_LCL,
        SUM(F.INV_MAX_SOH_RTL_AMT_LCL / F.LOC_EXCHANGE_RATE) INV_MAX_SOH_RTL_AMT,
        SUM(F.INV_MAX_SOH_RTL_AMT_LCL / F.GLOBAL1_EXCHANGE_RATE) INV_MAX_SOH_RTL_AMT_GLOBAL1,
        SUM(F.INV_MAX_SOH_RTL_AMT_LCL / F.GLOBAL2_EXCHANGE_RATE) INV_MAX_SOH_RTL_AMT_GLOBAL2,
        SUM(F.INV_MAX_SOH_RTL_AMT_LCL / F.GLOBAL3_EXCHANGE_RATE) INV_MAX_SOH_RTL_AMT_GLOBAL3,
        SUM(F.INV_MIN_SOH_RTL_AMT_LCL) INV_MIN_SOH_RTL_AMT_LCL,
        SUM(F.INV_MIN_SOH_RTL_AMT_LCL / F.LOC_EXCHANGE_RATE) INV_MIN_SOH_RTL_AMT,
        SUM(F.INV_MIN_SOH_RTL_AMT_LCL / F.GLOBAL1_EXCHANGE_RATE) INV_MIN_SOH_RTL_AMT_GLOBAL1,
        SUM(F.INV_MIN_SOH_RTL_AMT_LCL / F.GLOBAL2_EXCHANGE_RATE) INV_MIN_SOH_RTL_AMT_GLOBAL2,
        SUM(F.INV_MIN_SOH_RTL_AMT_LCL / F.GLOBAL3_EXCHANGE_RATE) INV_MIN_SOH_RTL_AMT_GLOBAL3,
        AVG(F.INV_AVG_COST_AMT_LCL) INV_AVG_COST_AMT_LCL,
        AVG(F.INV_AVG_COST_AMT_LCL / F.LOC_EXCHANGE_RATE) INV_AVG_COST_AMT,
        AVG(F.INV_AVG_COST_AMT_LCL / F.GLOBAL1_EXCHANGE_RATE) INV_AVG_COST_AMT_GLOBAL1,
        AVG(F.INV_AVG_COST_AMT_LCL / F.GLOBAL2_EXCHANGE_RATE) INV_AVG_COST_AMT_GLOBAL2,
        AVG(F.INV_AVG_COST_AMT_LCL / F.GLOBAL3_EXCHANGE_RATE) INV_AVG_COST_AMT_GLOBAL3,
        AVG(F.INV_UNIT_COST_AMT_LCL) INV_UNIT_COST_AMT_LCL,
        AVG(F.INV_UNIT_COST_AMT_LCL / F.LOC_EXCHANGE_RATE) INV_UNIT_COST_AMT,
        AVG(F.INV_UNIT_COST_AMT_LCL / F.GLOBAL1_EXCHANGE_RATE) INV_UNIT_COST_AMT_GLOBAL1,
        AVG(F.INV_UNIT_COST_AMT_LCL / F.GLOBAL2_EXCHANGE_RATE) INV_UNIT_COST_AMT_GLOBAL2,
        AVG(F.INV_UNIT_COST_AMT_LCL / F.GLOBAL3_EXCHANGE_RATE) INV_UNIT_COST_AMT_GLOBAL3,
        SUM(F.INV_SOH_COST_AMT_LCL) INV_SOH_COST_AMT_LCL,
        SUM(F.INV_SOH_COST_AMT_LCL / F.LOC_EXCHANGE_RATE) INV_SOH_COST_AMT,
        SUM(F.INV_SOH_COST_AMT_LCL / F.GLOBAL1_EXCHANGE_RATE) INV_SOH_COST_AMT_GLOBAL1,
        SUM(F.INV_SOH_COST_AMT_LCL / F.GLOBAL2_EXCHANGE_RATE) INV_SOH_COST_AMT_GLOBAL2,
        SUM(F.INV_SOH_COST_AMT_LCL / F.GLOBAL3_EXCHANGE_RATE) INV_SOH_COST_AMT_GLOBAL3,
        SUM(F.INV_ON_ORD_COST_AMT_LCL) INV_ON_ORD_COST_AMT_LCL,
        SUM(F.INV_ON_ORD_COST_AMT_LCL / F.LOC_EXCHANGE_RATE) INV_ON_ORD_COST_AMT,
        SUM(F.INV_ON_ORD_COST_AMT_LCL / F.GLOBAL1_EXCHANGE_RATE) INV_ON_ORD_COST_AMT_GLOBAL1,
        SUM(F.INV_ON_ORD_COST_AMT_LCL / F.GLOBAL2_EXCHANGE_RATE) INV_ON_ORD_COST_AMT_GLOBAL2,
        SUM(F.INV_ON_ORD_COST_AMT_LCL / F.GLOBAL3_EXCHANGE_RATE) INV_ON_ORD_COST_AMT_GLOBAL3,
        SUM(F.INV_IN_TRAN_COST_AMT_LCL) INV_IN_TRAN_COST_AMT_LCL,
        SUM(F.INV_IN_TRAN_COST_AMT_LCL / F.LOC_EXCHANGE_RATE) INV_IN_TRAN_COST_AMT,
        SUM(F.INV_IN_TRAN_COST_AMT_LCL / F.GLOBAL1_EXCHANGE_RATE) INV_IN_TRAN_COST_AMT_GLOBAL1,
        SUM(F.INV_IN_TRAN_COST_AMT_LCL / F.GLOBAL2_EXCHANGE_RATE) INV_IN_TRAN_COST_AMT_GLOBAL2,
        SUM(F.INV_IN_TRAN_COST_AMT_LCL / F.GLOBAL3_EXCHANGE_RATE) INV_IN_TRAN_COST_AMT_GLOBAL3,
        SUM(F.INV_MAX_SOH_COST_AMT_LCL) INV_MAX_SOH_COST_AMT_LCL,
        SUM(F.INV_MAX_SOH_COST_AMT_LCL / F.LOC_EXCHANGE_RATE) INV_MAX_SOH_COST_AMT,
        SUM(F.INV_MAX_SOH_COST_AMT_LCL / F.GLOBAL1_EXCHANGE_RATE) INV_MAX_SOH_COST_AMT_GLOBAL1,
        SUM(F.INV_MAX_SOH_COST_AMT_LCL / F.GLOBAL2_EXCHANGE_RATE) INV_MAX_SOH_COST_AMT_GLOBAL2,
        SUM(F.INV_MAX_SOH_COST_AMT_LCL / F.GLOBAL3_EXCHANGE_RATE) INV_MAX_SOH_COST_AMT_GLOBAL3,
        SUM(F.INV_MIN_SOH_COST_AMT_LCL) INV_MIN_SOH_COST_AMT_LCL,
        SUM(F.INV_MIN_SOH_COST_AMT_LCL / F.LOC_EXCHANGE_RATE) INV_MIN_SOH_COST_AMT,
        SUM(F.INV_MIN_SOH_COST_AMT_LCL / F.GLOBAL1_EXCHANGE_RATE) INV_MIN_SOH_COST_AMT_GLOBAL1,
        SUM(F.INV_MIN_SOH_COST_AMT_LCL / F.GLOBAL2_EXCHANGE_RATE) INV_MIN_SOH_COST_AMT_GLOBAL2,
        SUM(F.INV_MIN_SOH_COST_AMT_LCL / F.GLOBAL3_EXCHANGE_RATE) INV_MIN_SOH_COST_AMT_GLOBAL3,
        MAX(F.DATASOURCE_NUM_ID) DATASOURCE_NUM_ID,
        MAX(F.DELETE_FLG) DELETE_FLG,
        MAX(F.ETL_PROC_WID) ETL_PROC_WID,
        MAX(P.PROD_SC_NUM ||
            TO_CHAR(TO_DATE(SUBSTR(F.DT_WID, 2, 8), 'YYYYMMDD'),
                    'DD-MON-YY',
                    'NLS_DATE_LANGUAGE=AMERICAN') || F.CLEARANCE_FLG) INTEGRATION_ID,
        MAX(F.TENANT_ID) TENANT_ID,
        SYSDATE W_INSERT_DT,
        SYSDATE W_UPDATE_DT,
        MAX(X_CUSTOM) X_CUSTOM
         FROM RADM.W_RTL_INV_IT_LC_DY_FV F, RABATCHER.W_PRODUCT_D_RTL_TMP P
        WHERE F.PROD_WID = P.PROD_IT_WID
          AND F.DT_WID BETWEEN &FROM_DT_WID AND &TO_DT_WID
        GROUP BY P.PROD_SC_WID, F.DT_WID, F.CLEARANCE_FLG) S
ON (S.PROD_SC_WID = T.PROD_DH_WID AND S.DT_WID = T.DT_WID)
WHEN MATCHED THEN
  UPDATE
     SET T.INV_SOH_QTY                  = S.INV_SOH_QTY,
         T.INV_ON_ORD_QTY               = S.INV_ON_ORD_QTY,
         T.INV_IN_TRAN_QTY              = S.INV_IN_TRAN_QTY,
         T.INV_MAX_SOH_QTY              = S.INV_MAX_SOH_QTY,
         T.INV_MIN_SOH_QTY              = S.INV_MIN_SOH_QTY,
         T.INV_UNIT_RTL_AMT_LCL         = S.INV_UNIT_RTL_AMT_LCL,
         T.INV_UNIT_RTL_AMT             = S.INV_UNIT_RTL_AMT,
         T.INV_UNIT_RTL_AMT_GLOBAL1     = S.INV_UNIT_RTL_AMT_GLOBAL1,
         T.INV_UNIT_RTL_AMT_GLOBAL2     = S.INV_UNIT_RTL_AMT_GLOBAL2,
         T.INV_UNIT_RTL_AMT_GLOBAL3     = S.INV_UNIT_RTL_AMT_GLOBAL3,
         T.INV_SOH_RTL_AMT_LCL          = S.INV_SOH_RTL_AMT_LCL,
         T.INV_SOH_RTL_AMT              = S.INV_SOH_RTL_AMT,
         T.INV_SOH_RTL_AMT_GLOBAL1      = S.INV_SOH_RTL_AMT_GLOBAL1,
         T.INV_SOH_RTL_AMT_GLOBAL2      = S.INV_SOH_RTL_AMT_GLOBAL2,
         T.INV_SOH_RTL_AMT_GLOBAL3      = S.INV_SOH_RTL_AMT_GLOBAL3,
         T.INV_ON_ORD_RTL_AMT_LCL       = S.INV_ON_ORD_RTL_AMT_LCL,
         T.INV_ON_ORD_RTL_AMT           = S.INV_ON_ORD_RTL_AMT,
         T.INV_ON_ORD_RTL_AMT_GLOBAL1   = S.INV_ON_ORD_RTL_AMT_GLOBAL1,
         T.INV_ON_ORD_RTL_AMT_GLOBAL2   = S.INV_ON_ORD_RTL_AMT_GLOBAL2,
         T.INV_ON_ORD_RTL_AMT_GLOBAL3   = S.INV_ON_ORD_RTL_AMT_GLOBAL3,
         T.INV_IN_TRAN_RTL_AMT_LCL      = S.INV_IN_TRAN_RTL_AMT_LCL,
         T.INV_IN_TRAN_RTL_AMT          = S.INV_IN_TRAN_RTL_AMT,
         T.INV_IN_TRAN_RTL_AMT_GLOBAL1  = S.INV_IN_TRAN_RTL_AMT_GLOBAL1,
         T.INV_IN_TRAN_RTL_AMT_GLOBAL2  = S.INV_IN_TRAN_RTL_AMT_GLOBAL2,
         T.INV_IN_TRAN_RTL_AMT_GLOBAL3  = S.INV_IN_TRAN_RTL_AMT_GLOBAL3,
         T.INV_MAX_SOH_RTL_AMT_LCL      = S.INV_MAX_SOH_RTL_AMT_LCL,
         T.INV_MAX_SOH_RTL_AMT          = S.INV_MAX_SOH_RTL_AMT,
         T.INV_MAX_SOH_RTL_AMT_GLOBAL1  = S.INV_MAX_SOH_RTL_AMT_GLOBAL1,
         T.INV_MAX_SOH_RTL_AMT_GLOBAL2  = S.INV_MAX_SOH_RTL_AMT_GLOBAL2,
         T.INV_MAX_SOH_RTL_AMT_GLOBAL3  = S.INV_MAX_SOH_RTL_AMT_GLOBAL3,
         T.INV_MIN_SOH_RTL_AMT_LCL      = S.INV_MIN_SOH_RTL_AMT_LCL,
         T.INV_MIN_SOH_RTL_AMT          = S.INV_MIN_SOH_RTL_AMT,
         T.INV_MIN_SOH_RTL_AMT_GLOBAL1  = S.INV_MIN_SOH_RTL_AMT_GLOBAL1,
         T.INV_MIN_SOH_RTL_AMT_GLOBAL2  = S.INV_MIN_SOH_RTL_AMT_GLOBAL2,
         T.INV_MIN_SOH_RTL_AMT_GLOBAL3  = S.INV_MIN_SOH_RTL_AMT_GLOBAL3,
         T.INV_AVG_COST_AMT_LCL         = S.INV_AVG_COST_AMT_LCL,
         T.INV_AVG_COST_AMT             = S.INV_AVG_COST_AMT,
         T.INV_AVG_COST_AMT_GLOBAL1     = S.INV_AVG_COST_AMT_GLOBAL1,
         T.INV_AVG_COST_AMT_GLOBAL2     = S.INV_AVG_COST_AMT_GLOBAL2,
         T.INV_AVG_COST_AMT_GLOBAL3     = S.INV_AVG_COST_AMT_GLOBAL3,
         T.INV_UNIT_COST_AMT_LCL        = S.INV_UNIT_COST_AMT_LCL,
         T.INV_UNIT_COST_AMT            = S.INV_UNIT_COST_AMT,
         T.INV_UNIT_COST_AMT_GLOBAL1    = S.INV_UNIT_COST_AMT_GLOBAL1,
         T.INV_UNIT_COST_AMT_GLOBAL2    = S.INV_UNIT_COST_AMT_GLOBAL2,
         T.INV_UNIT_COST_AMT_GLOBAL3    = S.INV_UNIT_COST_AMT_GLOBAL3,
         T.INV_SOH_COST_AMT_LCL         = S.INV_SOH_COST_AMT_LCL,
         T.INV_SOH_COST_AMT             = S.INV_SOH_COST_AMT,
         T.INV_SOH_COST_AMT_GLOBAL1     = S.INV_SOH_COST_AMT_GLOBAL1,
         T.INV_SOH_COST_AMT_GLOBAL2     = S.INV_SOH_COST_AMT_GLOBAL2,
         T.INV_SOH_COST_AMT_GLOBAL3     = S.INV_SOH_COST_AMT_GLOBAL3,
         T.INV_ON_ORD_COST_AMT_LCL      = S.INV_ON_ORD_COST_AMT_LCL,
         T.INV_ON_ORD_COST_AMT          = S.INV_ON_ORD_COST_AMT,
         T.INV_ON_ORD_COST_AMT_GLOBAL1  = S.INV_ON_ORD_COST_AMT_GLOBAL1,
         T.INV_ON_ORD_COST_AMT_GLOBAL2  = S.INV_ON_ORD_COST_AMT_GLOBAL2,
         T.INV_ON_ORD_COST_AMT_GLOBAL3  = S.INV_ON_ORD_COST_AMT_GLOBAL3,
         T.INV_IN_TRAN_COST_AMT_LCL     = S.INV_IN_TRAN_COST_AMT_LCL,
         T.INV_IN_TRAN_COST_AMT         = S.INV_IN_TRAN_COST_AMT,
         T.INV_IN_TRAN_COST_AMT_GLOBAL1 = S.INV_IN_TRAN_COST_AMT_GLOBAL1,
         T.INV_IN_TRAN_COST_AMT_GLOBAL2 = S.INV_IN_TRAN_COST_AMT_GLOBAL2,
         T.INV_IN_TRAN_COST_AMT_GLOBAL3 = S.INV_IN_TRAN_COST_AMT_GLOBAL3,
         T.INV_MAX_SOH_COST_AMT_LCL     = S.INV_MAX_SOH_COST_AMT_LCL,
         T.INV_MAX_SOH_COST_AMT         = S.INV_MAX_SOH_COST_AMT,
         T.INV_MAX_SOH_COST_AMT_GLOBAL1 = S.INV_MAX_SOH_COST_AMT_GLOBAL1,
         T.INV_MAX_SOH_COST_AMT_GLOBAL2 = S.INV_MAX_SOH_COST_AMT_GLOBAL2,
         T.INV_MAX_SOH_COST_AMT_GLOBAL3 = S.INV_MAX_SOH_COST_AMT_GLOBAL3,
         T.INV_MIN_SOH_COST_AMT_LCL     = S.INV_MIN_SOH_COST_AMT_LCL,
         T.INV_MIN_SOH_COST_AMT         = S.INV_MIN_SOH_COST_AMT,
         T.INV_MIN_SOH_COST_AMT_GLOBAL1 = S.INV_MIN_SOH_COST_AMT_GLOBAL1,
         T.INV_MIN_SOH_COST_AMT_GLOBAL2 = S.INV_MIN_SOH_COST_AMT_GLOBAL2,
         T.INV_MIN_SOH_COST_AMT_GLOBAL3 = S.INV_MIN_SOH_COST_AMT_GLOBAL3,
         T.W_UPDATE_DT                  = SYSDATE
WHEN NOT MATCHED THEN
  INSERT
    (T.ROW_WID,
     T.PROD_DH_WID,
     T.DT_WID,
     T.CLEARANCE_FLG,
     T.INV_SOH_QTY,
     T.INV_ON_ORD_QTY,
     T.INV_IN_TRAN_QTY,
     T.INV_MAX_SOH_QTY,
     T.INV_MIN_SOH_QTY,
     T.INV_UNIT_RTL_AMT_LCL,
     T.INV_UNIT_RTL_AMT,
     T.INV_UNIT_RTL_AMT_GLOBAL1,
     T.INV_UNIT_RTL_AMT_GLOBAL2,
     T.INV_UNIT_RTL_AMT_GLOBAL3,
     T.INV_SOH_RTL_AMT_LCL,
     T.INV_SOH_RTL_AMT,
     T.INV_SOH_RTL_AMT_GLOBAL1,
     T.INV_SOH_RTL_AMT_GLOBAL2,
     T.INV_SOH_RTL_AMT_GLOBAL3,
     T.INV_ON_ORD_RTL_AMT_LCL,
     T.INV_ON_ORD_RTL_AMT,
     T.INV_ON_ORD_RTL_AMT_GLOBAL1,
     T.INV_ON_ORD_RTL_AMT_GLOBAL2,
     T.INV_ON_ORD_RTL_AMT_GLOBAL3,
     T.INV_IN_TRAN_RTL_AMT_LCL,
     T.INV_IN_TRAN_RTL_AMT,
     T.INV_IN_TRAN_RTL_AMT_GLOBAL1,
     T.INV_IN_TRAN_RTL_AMT_GLOBAL2,
     T.INV_IN_TRAN_RTL_AMT_GLOBAL3,
     T.INV_MAX_SOH_RTL_AMT_LCL,
     T.INV_MAX_SOH_RTL_AMT,
     T.INV_MAX_SOH_RTL_AMT_GLOBAL1,
     T.INV_MAX_SOH_RTL_AMT_GLOBAL2,
     T.INV_MAX_SOH_RTL_AMT_GLOBAL3,
     T.INV_MIN_SOH_RTL_AMT_LCL,
     T.INV_MIN_SOH_RTL_AMT,
     T.INV_MIN_SOH_RTL_AMT_GLOBAL1,
     T.INV_MIN_SOH_RTL_AMT_GLOBAL2,
     T.INV_MIN_SOH_RTL_AMT_GLOBAL3,
     T.INV_AVG_COST_AMT_LCL,
     T.INV_AVG_COST_AMT,
     T.INV_AVG_COST_AMT_GLOBAL1,
     T.INV_AVG_COST_AMT_GLOBAL2,
     T.INV_AVG_COST_AMT_GLOBAL3,
     T.INV_UNIT_COST_AMT_LCL,
     T.INV_UNIT_COST_AMT,
     T.INV_UNIT_COST_AMT_GLOBAL1,
     T.INV_UNIT_COST_AMT_GLOBAL2,
     T.INV_UNIT_COST_AMT_GLOBAL3,
     T.INV_SOH_COST_AMT_LCL,
     T.INV_SOH_COST_AMT,
     T.INV_SOH_COST_AMT_GLOBAL1,
     T.INV_SOH_COST_AMT_GLOBAL2,
     T.INV_SOH_COST_AMT_GLOBAL3,
     T.INV_ON_ORD_COST_AMT_LCL,
     T.INV_ON_ORD_COST_AMT,
     T.INV_ON_ORD_COST_AMT_GLOBAL1,
     T.INV_ON_ORD_COST_AMT_GLOBAL2,
     T.INV_ON_ORD_COST_AMT_GLOBAL3,
     T.INV_IN_TRAN_COST_AMT_LCL,
     T.INV_IN_TRAN_COST_AMT,
     T.INV_IN_TRAN_COST_AMT_GLOBAL1,
     T.INV_IN_TRAN_COST_AMT_GLOBAL2,
     T.INV_IN_TRAN_COST_AMT_GLOBAL3,
     T.INV_MAX_SOH_COST_AMT_LCL,
     T.INV_MAX_SOH_COST_AMT,
     T.INV_MAX_SOH_COST_AMT_GLOBAL1,
     T.INV_MAX_SOH_COST_AMT_GLOBAL2,
     T.INV_MAX_SOH_COST_AMT_GLOBAL3,
     T.INV_MIN_SOH_COST_AMT_LCL,
     T.INV_MIN_SOH_COST_AMT,
     T.INV_MIN_SOH_COST_AMT_GLOBAL1,
     T.INV_MIN_SOH_COST_AMT_GLOBAL2,
     T.INV_MIN_SOH_COST_AMT_GLOBAL3,
     T.DATASOURCE_NUM_ID,
     T.DELETE_FLG,
     T.ETL_PROC_WID,
     T.INTEGRATION_ID,
     T.TENANT_ID,
     T.W_INSERT_DT,
     T.W_UPDATE_DT,
     T.X_CUSTOM)
  VALUES
    (RADM.W_RTL_INV_SC_DY_A_SEQ.NEXTVAL,
     S.PROD_SC_WID,
     S.DT_WID,
     S.CLEARANCE_FLG,
     S.INV_SOH_QTY,
     S.INV_ON_ORD_QTY,
     S.INV_IN_TRAN_QTY,
     S.INV_MAX_SOH_QTY,
     S.INV_MIN_SOH_QTY,
     S.INV_UNIT_RTL_AMT_LCL,
     S.INV_UNIT_RTL_AMT,
     S.INV_UNIT_RTL_AMT_GLOBAL1,
     S.INV_UNIT_RTL_AMT_GLOBAL2,
     S.INV_UNIT_RTL_AMT_GLOBAL3,
     S.INV_SOH_RTL_AMT_LCL,
     S.INV_SOH_RTL_AMT,
     S.INV_SOH_RTL_AMT_GLOBAL1,
     S.INV_SOH_RTL_AMT_GLOBAL2,
     S.INV_SOH_RTL_AMT_GLOBAL3,
     S.INV_ON_ORD_RTL_AMT_LCL,
     S.INV_ON_ORD_RTL_AMT,
     S.INV_ON_ORD_RTL_AMT_GLOBAL1,
     S.INV_ON_ORD_RTL_AMT_GLOBAL2,
     S.INV_ON_ORD_RTL_AMT_GLOBAL3,
     S.INV_IN_TRAN_RTL_AMT_LCL,
     S.INV_IN_TRAN_RTL_AMT,
     S.INV_IN_TRAN_RTL_AMT_GLOBAL1,
     S.INV_IN_TRAN_RTL_AMT_GLOBAL2,
     S.INV_IN_TRAN_RTL_AMT_GLOBAL3,
     S.INV_MAX_SOH_RTL_AMT_LCL,
     S.INV_MAX_SOH_RTL_AMT,
     S.INV_MAX_SOH_RTL_AMT_GLOBAL1,
     S.INV_MAX_SOH_RTL_AMT_GLOBAL2,
     S.INV_MAX_SOH_RTL_AMT_GLOBAL3,
     S.INV_MIN_SOH_RTL_AMT_LCL,
     S.INV_MIN_SOH_RTL_AMT,
     S.INV_MIN_SOH_RTL_AMT_GLOBAL1,
     S.INV_MIN_SOH_RTL_AMT_GLOBAL2,
     S.INV_MIN_SOH_RTL_AMT_GLOBAL3,
     S.INV_AVG_COST_AMT_LCL,
     S.INV_AVG_COST_AMT,
     S.INV_AVG_COST_AMT_GLOBAL1,
     S.INV_AVG_COST_AMT_GLOBAL2,
     S.INV_AVG_COST_AMT_GLOBAL3,
     S.INV_UNIT_COST_AMT_LCL,
     S.INV_UNIT_COST_AMT,
     S.INV_UNIT_COST_AMT_GLOBAL1,
     S.INV_UNIT_COST_AMT_GLOBAL2,
     S.INV_UNIT_COST_AMT_GLOBAL3,
     S.INV_SOH_COST_AMT_LCL,
     S.INV_SOH_COST_AMT,
     S.INV_SOH_COST_AMT_GLOBAL1,
     S.INV_SOH_COST_AMT_GLOBAL2,
     S.INV_SOH_COST_AMT_GLOBAL3,
     S.INV_ON_ORD_COST_AMT_LCL,
     S.INV_ON_ORD_COST_AMT,
     S.INV_ON_ORD_COST_AMT_GLOBAL1,
     S.INV_ON_ORD_COST_AMT_GLOBAL2,
     S.INV_ON_ORD_COST_AMT_GLOBAL3,
     S.INV_IN_TRAN_COST_AMT_LCL,
     S.INV_IN_TRAN_COST_AMT,
     S.INV_IN_TRAN_COST_AMT_GLOBAL1,
     S.INV_IN_TRAN_COST_AMT_GLOBAL2,
     S.INV_IN_TRAN_COST_AMT_GLOBAL3,
     S.INV_MAX_SOH_COST_AMT_LCL,
     S.INV_MAX_SOH_COST_AMT,
     S.INV_MAX_SOH_COST_AMT_GLOBAL1,
     S.INV_MAX_SOH_COST_AMT_GLOBAL2,
     S.INV_MAX_SOH_COST_AMT_GLOBAL3,
     S.INV_MIN_SOH_COST_AMT_LCL,
     S.INV_MIN_SOH_COST_AMT,
     S.INV_MIN_SOH_COST_AMT_GLOBAL1,
     S.INV_MIN_SOH_COST_AMT_GLOBAL2,
     S.INV_MIN_SOH_COST_AMT_GLOBAL3,
     S.DATASOURCE_NUM_ID,
     S.DELETE_FLG,
     S.ETL_PROC_WID,
     S.INTEGRATION_ID,
     S.TENANT_ID,
     S.W_INSERT_DT,
     S.W_UPDATE_DT,
     S.X_CUSTOM);
COMMIT;
--8.W_RTL_INV_SC_LC_DY_A----------------------------------------------------------------------------------
MERGE /*+ APPEND */
INTO RADM.W_RTL_INV_SC_LC_DY_A T
USING (SELECT /*+ PARALLEL(F,4) (P,4)*/
        P.PROD_SC_WID,
        F.ORG_WID,
        F.ORG_DH_WID,
        F.ORG_SCD1_WID,
        F.DT_WID,
        F.CLEARANCE_FLG,
        SUM(F.INV_SOH_QTY) INV_SOH_QTY,
        SUM(F.INV_ON_ORD_QTY) INV_ON_ORD_QTY,
        SUM(F.INV_IN_TRAN_QTY) INV_IN_TRAN_QTY,
        SUM(F.INV_MAX_SOH_QTY) INV_MAX_SOH_QTY,
        SUM(F.INV_MIN_SOH_QTY) INV_MIN_SOH_QTY,
        SUM(F.INV_SOH_RTL_AMT_LCL) INV_SOH_RTL_AMT_LCL,
        SUM(F.INV_ON_ORD_RTL_AMT_LCL) INV_ON_ORD_RTL_AMT_LCL,
        SUM(F.INV_IN_TRAN_RTL_AMT_LCL) INV_IN_TRAN_RTL_AMT_LCL,
        SUM(F.INV_MAX_SOH_RTL_AMT_LCL) INV_MAX_SOH_RTL_AMT_LCL,
        SUM(F.INV_MIN_SOH_RTL_AMT_LCL) INV_MIN_SOH_RTL_AMT_LCL,
        SUM(F.INV_SOH_COST_AMT_LCL) INV_SOH_COST_AMT_LCL,
        SUM(F.INV_ON_ORD_COST_AMT_LCL) INV_ON_ORD_COST_AMT_LCL,
        SUM(F.INV_IN_TRAN_COST_AMT_LCL) INV_IN_TRAN_COST_AMT_LCL,
        SUM(F.INV_MAX_SOH_COST_AMT_LCL) INV_MAX_SOH_COST_AMT_LCL,
        SUM(F.INV_MIN_SOH_COST_AMT_LCL) INV_MIN_SOH_COST_AMT_LCL,
        MAX(F.DATASOURCE_NUM_ID) DATASOURCE_NUM_ID,
        MAX(F.DELETE_FLG) DELETE_FLG,
        MAX(F.DOC_CURR_CODE) DOC_CURR_CODE,
        MAX(F.ETL_PROC_WID) ETL_PROC_WID,
        MAX(F.GLOBAL1_EXCHANGE_RATE) GLOBAL1_EXCHANGE_RATE,
        MAX(F.GLOBAL2_EXCHANGE_RATE) GLOBAL2_EXCHANGE_RATE,
        MAX(F.GLOBAL3_EXCHANGE_RATE) GLOBAL3_EXCHANGE_RATE,
        MAX(P.PROD_CL_NUM || O.ORG_NUM ||
            TO_CHAR(TO_DATE(SUBSTR(F.DT_WID, 2, 8), 'YYYYMMDD'),
                    'DD-MON-YY',
                    'NLS_DATE_LANGUAGE=AMERICAN') || F.CLEARANCE_FLG) INTEGRATION_ID,
        MAX(F.LOC_CURR_CODE) LOC_CURR_CODE,
        MAX(F.LOC_EXCHANGE_RATE) LOC_EXCHANGE_RATE,
        MAX(F.TENANT_ID) TENANT_ID,
        SYSDATE W_INSERT_DT,
        SYSDATE W_UPDATE_DT,
        MAX(X_CUSTOM) X_CUSTOM
         FROM RADM.W_RTL_INV_IT_LC_DY_FV    F,
              RABATCHER.W_PRODUCT_D_RTL_TMP P,
              RABATCHER.W_INT_ORG_D_RTL_TMP O
        WHERE F.PROD_WID = P.PROD_IT_WID
          AND F.ORG_WID = O.ORG_WID
          AND F.DT_WID BETWEEN &FROM_DT_WID AND &TO_DT_WID
        GROUP BY P.PROD_SC_WID,
                 F.ORG_WID,
                 F.ORG_DH_WID,
                 F.ORG_SCD1_WID,
                 F.DT_WID,
                 F.CLEARANCE_FLG) S
ON (S.PROD_SC_WID = T.PROD_DH_WID AND S.DT_WID = T.DT_WID AND S.ORG_WID = T.ORG_WID AND S.ORG_DH_WID = T.ORG_DH_WID AND S.ORG_SCD1_WID = T.ORG_SCD1_WID)
WHEN MATCHED THEN
  UPDATE
     SET T.INV_SOH_QTY              = S.INV_SOH_QTY,
         T.INV_ON_ORD_QTY           = S.INV_ON_ORD_QTY,
         T.INV_IN_TRAN_QTY          = S.INV_IN_TRAN_QTY,
         T.INV_MAX_SOH_QTY          = S.INV_MAX_SOH_QTY,
         T.INV_MIN_SOH_QTY          = S.INV_MIN_SOH_QTY,
         T.INV_SOH_RTL_AMT_LCL      = S.INV_SOH_RTL_AMT_LCL,
         T.INV_ON_ORD_RTL_AMT_LCL   = S.INV_ON_ORD_RTL_AMT_LCL,
         T.INV_IN_TRAN_RTL_AMT_LCL  = S.INV_IN_TRAN_RTL_AMT_LCL,
         T.INV_MAX_SOH_RTL_AMT_LCL  = S.INV_MAX_SOH_RTL_AMT_LCL,
         T.INV_MIN_SOH_RTL_AMT_LCL  = S.INV_MIN_SOH_RTL_AMT_LCL,
         T.INV_SOH_COST_AMT_LCL     = S.INV_SOH_COST_AMT_LCL,
         T.INV_ON_ORD_COST_AMT_LCL  = S.INV_ON_ORD_COST_AMT_LCL,
         T.INV_IN_TRAN_COST_AMT_LCL = S.INV_IN_TRAN_COST_AMT_LCL,
         T.INV_MAX_SOH_COST_AMT_LCL = S.INV_MAX_SOH_COST_AMT_LCL,
         T.INV_MIN_SOH_COST_AMT_LCL = S.INV_MIN_SOH_COST_AMT_LCL,
         T.W_UPDATE_DT              = SYSDATE
WHEN NOT MATCHED THEN
  INSERT
    (T.ROW_WID,
     T.PROD_DH_WID,
     T.ORG_WID,
     T.ORG_DH_WID,
     T.ORG_SCD1_WID,
     T.DT_WID,
     T.CLEARANCE_FLG,
     T.INV_SOH_QTY,
     T.INV_ON_ORD_QTY,
     T.INV_IN_TRAN_QTY,
     T.INV_MAX_SOH_QTY,
     T.INV_MIN_SOH_QTY,
     T.INV_SOH_RTL_AMT_LCL,
     T.INV_ON_ORD_RTL_AMT_LCL,
     T.INV_IN_TRAN_RTL_AMT_LCL,
     T.INV_MAX_SOH_RTL_AMT_LCL,
     T.INV_MIN_SOH_RTL_AMT_LCL,
     T.INV_SOH_COST_AMT_LCL,
     T.INV_ON_ORD_COST_AMT_LCL,
     T.INV_IN_TRAN_COST_AMT_LCL,
     T.INV_MAX_SOH_COST_AMT_LCL,
     T.INV_MIN_SOH_COST_AMT_LCL,
     T.DATASOURCE_NUM_ID,
     T.DELETE_FLG,
     T.DOC_CURR_CODE,
     T.ETL_PROC_WID,
     T.GLOBAL1_EXCHANGE_RATE,
     T.GLOBAL2_EXCHANGE_RATE,
     T.GLOBAL3_EXCHANGE_RATE,
     T.INTEGRATION_ID,
     T.LOC_CURR_CODE,
     T.LOC_EXCHANGE_RATE,
     T.TENANT_ID,
     T.W_INSERT_DT,
     T.W_UPDATE_DT,
     T.X_CUSTOM)
  VALUES
    (RADM.W_RTL_INV_CL_LC_DY_A_SEQ.NEXTVAL,
     S.PROD_SC_WID,
     S.ORG_WID,
     S.ORG_DH_WID,
     S.ORG_SCD1_WID,
     S.DT_WID,
     S.CLEARANCE_FLG,
     S.INV_SOH_QTY,
     S.INV_ON_ORD_QTY,
     S.INV_IN_TRAN_QTY,
     S.INV_MAX_SOH_QTY,
     S.INV_MIN_SOH_QTY,
     S.INV_SOH_RTL_AMT_LCL,
     S.INV_ON_ORD_RTL_AMT_LCL,
     S.INV_IN_TRAN_RTL_AMT_LCL,
     S.INV_MAX_SOH_RTL_AMT_LCL,
     S.INV_MIN_SOH_RTL_AMT_LCL,
     S.INV_SOH_COST_AMT_LCL,
     S.INV_ON_ORD_COST_AMT_LCL,
     S.INV_IN_TRAN_COST_AMT_LCL,
     S.INV_MAX_SOH_COST_AMT_LCL,
     S.INV_MIN_SOH_COST_AMT_LCL,
     S.DATASOURCE_NUM_ID,
     S.DELETE_FLG,
     S.DOC_CURR_CODE,
     S.ETL_PROC_WID,
     S.GLOBAL1_EXCHANGE_RATE,
     S.GLOBAL2_EXCHANGE_RATE,
     S.GLOBAL3_EXCHANGE_RATE,
     S.INTEGRATION_ID,
     S.LOC_CURR_CODE,
     S.LOC_EXCHANGE_RATE,
     S.TENANT_ID,
     S.W_INSERT_DT,
     S.W_UPDATE_DT,
     S.X_CUSTOM);
COMMIT;
