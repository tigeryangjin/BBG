--***********************************************************
--创建BBG_RA_CUST_IT_LC_DY_F历史表BBG_RA_CUST_IT_LC_DY_F_HIST
--***********************************************************
-- CREATE PARTITION TABLE 
CREATE TABLE RADM.BBG_RA_CUST_IT_LC_DY_F_HIST
(
  ROW_WID                   NOT NULL,
  PROD_WID                  NOT NULL,
  PROD_SCD1_WID             NOT NULL,
  ORG_WID                   NOT NULL,
  ORG_DH_WID                NOT NULL,
  ORG_SCD1_WID              NOT NULL,
  DT_WID                    NOT NULL,
  BBG_ITEM_LOC_WID          NOT NULL,
  BBG_CUSTOMER_COUNT       ,
  BBG_SERVICE_SATISFACTION ,
  DATASOURCE_NUM_ID         NOT NULL,
  INTEGRATION_ID            NOT NULL,
  W_INSERT_DT              ,
  W_UPDATE_DT              ,
  BBG_REFERENCE_DO1        ,
  BBG_REFERENCE_DO2        ,
  BBG_REFERENCE_DO3        ,
  BBG_REFERENCE_DO4        ,
  BBG_REFERENCE_DO5        ,
  BBG_REFERENCE_FO1        ,
  BBG_REFERENCE_FO2        ,
  BBG_REFERENCE_FO3        ,
  BBG_REFERENCE_FO4        ,
  BBG_REFERENCE_FO5        ,
  BBG_REFERENCE_FO6        ,
  BBG_REFERENCE_FO7        ,
  BBG_REFERENCE_FO8        ,
  BBG_REFERENCE_FO9        ,
  BBG_REFERENCE_FO10       
)
PARTITION BY RANGE (DT_WID)         
(  PARTITION BBGRA_CUST_IT_LC_DY_F_H_201305 VALUES LESS THAN (120130600000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201306 VALUES LESS THAN (120130700000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201307 VALUES LESS THAN (120130800000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201308 VALUES LESS THAN (120130900000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201309 VALUES LESS THAN (120131000000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201310 VALUES LESS THAN (120131100000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201311 VALUES LESS THAN (120131200000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201312 VALUES LESS THAN (120140100000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201401 VALUES LESS THAN (120140200000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201402 VALUES LESS THAN (120140300000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201403 VALUES LESS THAN (120140400000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201404 VALUES LESS THAN (120140500000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201405 VALUES LESS THAN (120140600000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201406 VALUES LESS THAN (120140700000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201407 VALUES LESS THAN (120140800000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201408 VALUES LESS THAN (120140900000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201409 VALUES LESS THAN (120141000000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201410 VALUES LESS THAN (120141100000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201411 VALUES LESS THAN (120141200000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201412 VALUES LESS THAN (120150100000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201501 VALUES LESS THAN (120150200000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201502 VALUES LESS THAN (120150300000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201503 VALUES LESS THAN (120150400000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201504 VALUES LESS THAN (120150500000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201505 VALUES LESS THAN (120150600000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201506 VALUES LESS THAN (120150700000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201507 VALUES LESS THAN (120150800000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201508 VALUES LESS THAN (120150900000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201509 VALUES LESS THAN (120151000000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201510 VALUES LESS THAN (120151100000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201511 VALUES LESS THAN (120151200000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201512 VALUES LESS THAN (120160100000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201601 VALUES LESS THAN (120160200000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201602 VALUES LESS THAN (120160300000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201603 VALUES LESS THAN (120160400000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201604 VALUES LESS THAN (120160500000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201605 VALUES LESS THAN (120160600000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201606 VALUES LESS THAN (120160700000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201607 VALUES LESS THAN (120160800000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201608 VALUES LESS THAN (120160900000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201609 VALUES LESS THAN (120161000000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201610 VALUES LESS THAN (120161100000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201611 VALUES LESS THAN (120161200000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201612 VALUES LESS THAN (120170100000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201701 VALUES LESS THAN (120170200000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201702 VALUES LESS THAN (120170300000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201703 VALUES LESS THAN (120170400000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201704 VALUES LESS THAN (120170500000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201705 VALUES LESS THAN (120170600000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201706 VALUES LESS THAN (120170700000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201707 VALUES LESS THAN (120170800000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201708 VALUES LESS THAN (120170900000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201709 VALUES LESS THAN (120171000000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201710 VALUES LESS THAN (120171100000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201711 VALUES LESS THAN (120171200000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_201712 VALUES LESS THAN (120180100000) TABLESPACE RETAIL_DATA,
   PARTITION BBGRA_CUST_IT_LC_DY_F_H_MAX VALUES LESS THAN (MAXVALUE) TABLESPACE RETAIL_DATA),
TABLESPACE RETAIL_DATA
COMPRESS 
nologging 
parallel 10 as select /*+ PARALLEL(T 10)*/  * from BBG_RA_CUST_IT_LC_DY_F T WHERE DT_WID<'120160800000';


ALTER TABLE BBG_RA_CUST_IT_LC_DY_F_HIST LOGGING;
ALTER TABLE BBG_RA_CUST_IT_LC_DY_F_HIST PARALLEL 1;    


--***********************************************************
--创建BBG_RA_CUST_IT_LC_DY_F分区表BBG_RA_CUST_IT_LC_DY_F_PAR
--***********************************************************
-- CREATE PARTITION TABLE 
CREATE TABLE RADM.BBG_RA_CUST_IT_LC_DY_F_PAR
(
  ROW_WID                   NOT NULL,
  PROD_WID                  NOT NULL,
  PROD_SCD1_WID             NOT NULL,
  ORG_WID                   NOT NULL,
  ORG_DH_WID                NOT NULL,
  ORG_SCD1_WID              NOT NULL,
  DT_WID                    NOT NULL,
  BBG_ITEM_LOC_WID          NOT NULL,
  BBG_CUSTOMER_COUNT       ,
  BBG_SERVICE_SATISFACTION ,
  DATASOURCE_NUM_ID         NOT NULL,
  INTEGRATION_ID            NOT NULL,
  W_INSERT_DT              ,
  W_UPDATE_DT              ,
  BBG_REFERENCE_DO1        ,
  BBG_REFERENCE_DO2        ,
  BBG_REFERENCE_DO3        ,
  BBG_REFERENCE_DO4        ,
  BBG_REFERENCE_DO5        ,
  BBG_REFERENCE_FO1        ,
  BBG_REFERENCE_FO2        ,
  BBG_REFERENCE_FO3        ,
  BBG_REFERENCE_FO4        ,
  BBG_REFERENCE_FO5        ,
  BBG_REFERENCE_FO6        ,
  BBG_REFERENCE_FO7        ,
  BBG_REFERENCE_FO8        ,
  BBG_REFERENCE_FO9        ,
  BBG_REFERENCE_FO10       
)
PARTITION BY RANGE (DT_WID)         
(  PARTITION BBG_RA_CUST_IT_LC_DY_F_201305 VALUES LESS THAN (120130600000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201306 VALUES LESS THAN (120130700000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201307 VALUES LESS THAN (120130800000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201308 VALUES LESS THAN (120130900000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201309 VALUES LESS THAN (120131000000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201310 VALUES LESS THAN (120131100000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201311 VALUES LESS THAN (120131200000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201312 VALUES LESS THAN (120140100000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201401 VALUES LESS THAN (120140200000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201402 VALUES LESS THAN (120140300000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201403 VALUES LESS THAN (120140400000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201404 VALUES LESS THAN (120140500000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201405 VALUES LESS THAN (120140600000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201406 VALUES LESS THAN (120140700000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201407 VALUES LESS THAN (120140800000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201408 VALUES LESS THAN (120140900000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201409 VALUES LESS THAN (120141000000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201410 VALUES LESS THAN (120141100000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201411 VALUES LESS THAN (120141200000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201412 VALUES LESS THAN (120150100000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201501 VALUES LESS THAN (120150200000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201502 VALUES LESS THAN (120150300000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201503 VALUES LESS THAN (120150400000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201504 VALUES LESS THAN (120150500000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201505 VALUES LESS THAN (120150600000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201506 VALUES LESS THAN (120150700000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201507 VALUES LESS THAN (120150800000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201508 VALUES LESS THAN (120150900000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201509 VALUES LESS THAN (120151000000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201510 VALUES LESS THAN (120151100000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201511 VALUES LESS THAN (120151200000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201512 VALUES LESS THAN (120160100000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201601 VALUES LESS THAN (120160200000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201602 VALUES LESS THAN (120160300000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201603 VALUES LESS THAN (120160400000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201604 VALUES LESS THAN (120160500000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201605 VALUES LESS THAN (120160600000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201606 VALUES LESS THAN (120160700000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201607 VALUES LESS THAN (120160800000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201608 VALUES LESS THAN (120160900000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201609 VALUES LESS THAN (120161000000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201610 VALUES LESS THAN (120161100000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201611 VALUES LESS THAN (120161200000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201612 VALUES LESS THAN (120170100000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201701 VALUES LESS THAN (120170200000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201702 VALUES LESS THAN (120170300000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201703 VALUES LESS THAN (120170400000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201704 VALUES LESS THAN (120170500000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201705 VALUES LESS THAN (120170600000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201706 VALUES LESS THAN (120170700000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201707 VALUES LESS THAN (120170800000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201708 VALUES LESS THAN (120170900000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201709 VALUES LESS THAN (120171000000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201710 VALUES LESS THAN (120171100000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201711 VALUES LESS THAN (120171200000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_201712 VALUES LESS THAN (120180100000) TABLESPACE RETAIL_DATA,
   PARTITION BBG_RA_CUST_IT_LC_DY_F_MAX VALUES LESS THAN (MAXVALUE) TABLESPACE RETAIL_DATA),
TABLESPACE RETAIL_DATA
nologging 
parallel 10 as select /*+ PARALLEL(T 10)*/  * from BBG_RA_CUST_IT_LC_DY_F T WHERE DT_WID>'120160731000';

ALTER TABLE BBG_RA_CUST_IT_LC_DY_F_PAR LOGGING;
ALTER TABLE BBG_RA_CUST_IT_LC_DY_F_PAR PARALLEL 1;  


--***********************************************************
--DROP INDEX 
--***********************************************************
ALTER TABLE RADM.BBG_RA_CUST_IT_LC_DY_F
 DROP PRIMARY KEY CASCADE;
 
DROP INDEX PK_BBG_RA_CUST_IT_LC_DY_F;


--***********************************************************
--CHANGE TABLE NAME
--***********************************************************

ALTER TABLE BBG_RA_CUST_IT_LC_DY_F RENAME TO BBG_RA_CUST_IT_LC_DY_F_BAK;
ALTER TABLE BBG_RA_CUST_IT_LC_DY_F_PAR RENAME TO BBG_RA_CUST_IT_LC_DY_F;

--***********************************************************
--CREATE  INDEX 
--***********************************************************
 
CREATE UNIQUE INDEX RADM.PK_BBG_RA_CUST_IT_LC_DY_F ON RADM.BBG_RA_CUST_IT_LC_DY_F
(PROD_WID, ORG_WID, DT_WID, BBG_ITEM_LOC_WID)
NOLOGGING
TABLESPACE DM_FACT_INDEX
PCTFREE    10
INITRANS   12
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
           )
PARALLEL 10
INVISIBLE;


ALTER TABLE RADM.BBG_RA_CUST_IT_LC_DY_F ADD (
  CONSTRAINT PK_BBG_RA_CUST_IT_LC_DY_F
 PRIMARY KEY
 (PROD_WID, ORG_WID, DT_WID, BBG_ITEM_LOC_WID)
    USING INDEX 
    TABLESPACE DM_FACT_INDEX
    PCTFREE    10
    INITRANS   12
    MAXTRANS   255
    STORAGE    (
                INITIAL          64K
                NEXT             1M
                MINEXTENTS       1
                MAXEXTENTS       UNLIMITED
                PCTINCREASE      0
               ));

ALTER INDEX PK_BBG_RA_CUST_IT_LC_DY_F LOGGING;
ALTER INDEX PK_BBG_RA_CUST_IT_LC_DY_F PARALLEL 1;


CREATE UNIQUE INDEX RADM.PK_BBG_RA_CUST_IT_LC_DY_F_HIST ON RADM.BBG_RA_CUST_IT_LC_DY_F_HIST
(PROD_WID, ORG_WID, DT_WID, BBG_ITEM_LOC_WID)
NOLOGGING
TABLESPACE DM_FACT_INDEX
PCTFREE    10
INITRANS   12
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
           )
PARALLEL 10
INVISIBLE;


ALTER TABLE RADM.BBG_RA_CUST_IT_LC_DY_F_HIST ADD (
  CONSTRAINT PK_BBG_RA_CUST_IT_LC_DY_F_HIST
 PRIMARY KEY
 (PROD_WID, ORG_WID, DT_WID, BBG_ITEM_LOC_WID)
    USING INDEX 
    TABLESPACE DM_FACT_INDEX
    PCTFREE    10
    INITRANS   12
    MAXTRANS   255
    STORAGE    (
                INITIAL          64K
                NEXT             1M
                MINEXTENTS       1
                MAXEXTENTS       UNLIMITED
                PCTINCREASE      0
               ));

ALTER INDEX PK_BBG_RA_CUST_IT_LC_DY_F_HIST LOGGONG;
ALTER INDEX PK_BBG_RA_CUST_IT_LC_DY_F_HIST PARALLEL 1;


--***********************************************************
--Analyze TABLE
--***********************************************************

--DBMS.STATS

BEGIN
dbms_stats.gather_table_stats(ownname => 'RADM',
                                      tabname => 'BBG_RA_CUST_IT_LC_DY_F',
                                      granularity=>'ALL',
                                      degree=>8,
                                      Estimate_Percent  => SYS.DBMS_STATS.AUTO_SAMPLE_SIZE,
                                      cascade=>TRUE);
dbms_stats.gather_table_stats(ownname => 'RADM',
                                      tabname => 'BBG_RA_CUST_IT_LC_DY_F_HIST',
                                      granularity=>'ALL',
                                      degree=>8,
                                      cascade=>TRUE,
                                      Estimate_Percent  => SYS.DBMS_STATS.AUTO_SAMPLE_SIZE);                                                                                                              
END;
/
