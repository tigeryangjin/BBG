SELECT * FROM BBG_RA_LOCN_CLASS_V;
--1.在RADM中创建BBG_RA_LOCN_CLASS_V视图
--BBG_RA_LOCN_CLASS_V在ODI的模型Oracle Retail Sources-RA Processing Views下
CREATE VIEW BBG_RA_LOCN_CLASS_V AS
select t.code_id LOCN_CLASS, '118001' H_CODE,
       t.create_date_time,
       t.mod_date_time,
       t.rec_type,
       t.code_type,
       t.code_desc,
       t.short_desc,
       t.misc_flags,
       t.code_id||'118001' code_id      
from sys_code@ra_110001 t where t.rec_type='S' AND t.CODE_TYPE='036';

--2.在RADM中创建W_MA_LOCN_CLASS_D维度表
--W_MA_LOCN_CLASS_D,W_MA_LOCN_CLASS_DT在ODI的模型Oracle Retail Analytics-Dimension Stage下
CREATE TABLE W_MA_LOCN_CLASS_D
(LOCN_CLASS VARCHAR2(40) NOT NULL,
WH_CODE VARCHAR2(40) NOT NULL,
CREATE_DATE_TIME DATE,
MOD_DATE_TIME DATE,
REC_TYPE VARCHAR2(10) NOT NULL,
CODE_TYPE VARCHAR2(10) NOT NULL,
CODE_DESC VARCHAR2(200),
SHORT_DESC VARCHAR2(200),
MISC_FLAGS VARCHAR2(200),
LOCN_WH_CLASS_CODE VARCHAR2(80) NOT NULL,
BBG_REFERENCE_NO1 VARCHAR2(250),
BBG_REFERENCE_NO2 VARCHAR2(250),
BBG_REFERENCE_NO3 VARCHAR2(250),
BBG_REFERENCE_NO4 VARCHAR2(250));

CREATE TABLE W_MA_LOCN_CLASS_DT
(LOCN_CLASS VARCHAR2(40) NOT NULL,
WH_CODE VARCHAR2(40) NOT NULL,
CREATE_DATE_TIME DATE,
MOD_DATE_TIME DATE,
REC_TYPE VARCHAR2(10) NOT NULL,
CODE_TYPE VARCHAR2(10) NOT NULL,
CODE_DESC VARCHAR2(200),
SHORT_DESC VARCHAR2(200),
MISC_FLAGS VARCHAR2(200),
LOCN_WH_CLASS_CODE VARCHAR2(80) NOT NULL,
BBG_REFERENCE_NO1 VARCHAR2(250),
BBG_REFERENCE_NO2 VARCHAR2(250),
BBG_REFERENCE_NO3 VARCHAR2(250),
BBG_REFERENCE_NO4 VARCHAR2(250));

--C_ODI_PARAM
SELECT * FROM C_ODI_PARAM where param_value='W_MA_LOCN_A';

