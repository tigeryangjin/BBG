CREATE TABLE RADM.JIN_SALEDETAIL_TRANS_TMP AS
SELECT /*+PARALLEL(TRX,20)*/
 TRX.STORE,
 TRX.SALEDATE,
 TRX.PERIOD,
 COUNT(TRX.TRX) TRANS,
 SUM(TRX.SALES) SALES
  FROM (SELECT /*+PARALLEL(T,20)*/
         SUBSTR(T.SHOPID, 2, 2) || SUBSTR(T.SHOPID, 1, 1) ||
         SUBSTR(T.SHOPID, 4, 3) STORE,
         T.SD0101 SALEDATE,
         T.SHOPID || '|' || T.SD0101 || '|' || T.SD0109 || '|' || T.SD0106 TRX,
         MAX(SUBSTR(T.SD0108, 1, 2)) PERIOD,
         SUM(T.AMT) SALES
          FROM RADM.SALEDETAIL T
         WHERE T.SD0101 BETWEEN '20130101' AND '20130507'
         GROUP BY SUBSTR(T.SHOPID, 2, 2) || SUBSTR(T.SHOPID, 1, 1) ||
                  SUBSTR(T.SHOPID, 4, 3),
                  T.SD0101,
                  T.SHOPID || '|' || T.SD0101 || '|' || T.SD0109 || '|' ||
                  T.SD0106) TRX
 GROUP BY TRX.STORE, TRX.SALEDATE, TRX.PERIOD;

DROP TABLE RADM.JIN_SALEDETAIL_TRANS_TMP;

CREATE TABLE RMS.JIN_SALEDETAIL_TRANS_TMP AS
SELECT * FROM RADM.JIN_SALEDETAIL_TRANS_TMP@RMS_RA;
