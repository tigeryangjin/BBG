----------------------------------------------------------------------------------
--创建W_RTL_SLS_IT_LC_MN_A表,W_RTL_SLS_IT_LC_MN_A_SEQ序列
--历史数据直接语句插入
----------------------------------------------------------------------------------
--历史数据插入
INSERT INTO RADM.W_RTL_SLS_IT_LC_MN_A
	(ROW_WID,
	 PROD_WID,
	 PROD_SCD1_WID,
	 ORG_WID,
	 ORG_SCD1_WID,
	 ORG_DH_WID,
	 MN_WID,
	 VOUCHER_FLG,
	 RTL_TYPE_WID,
	 EMPLOYEE_WID,
	 SLS_QTY,
	 SLS_AMT_LCL,
	 SLS_PROFIT_AMT_LCL,
	 SLS_MANUAL_MKDN_AMT_LCL,
	 SLS_MANUAL_MKUP_AMT_LCL,
	 SLS_TAX_AMT_LCL,
	 SLS_EMP_DISC_AMT_LCL,
	 SLS_MANUAL_COUNT,
	 SLS_SCAN_COUNT,
	 RET_QTY,
	 RET_AMT_LCL,
	 RET_PROFIT_AMT_LCL,
	 RET_MANUAL_MKDN_AMT_LCL,
	 RET_MANUAL_MKUP_AMT_LCL,
	 RET_TAX_AMT_LCL,
	 RET_EMP_DISC_AMT_LCL,
	 RET_MANUAL_COUNT,
	 RET_SCAN_COUNT,
	 RTL_TYPE_CODE,
	 DATASOURCE_NUM_ID,
	 DELETE_FLG,
	 DOC_CURR_CODE,
	 ETL_PROC_WID,
	 GLOBAL1_EXCHANGE_RATE,
	 GLOBAL2_EXCHANGE_RATE,
	 GLOBAL3_EXCHANGE_RATE,
	 INTEGRATION_ID,
	 LOC_CURR_CODE,
	 LOC_EXCHANGE_RATE,
	 TENANT_ID,
	 W_INSERT_DT,
	 W_UPDATE_DT,
	 X_CUSTOM,
	 BBG_ITEM_LOC_WID,
	 BBG_RETAIL_TYPE_WID,
	 BBG_CUSTOMER_COUNT,
	 BBG_SERVICE_SATISFACTION,
	 BBG_REFERENCE_DO1,
	 BBG_REFERENCE_DO2,
	 BBG_REFERENCE_DO3,
	 BBG_REFERENCE_DO4,
	 BBG_REFERENCE_DO5,
	 BBG_REFERENCE_FO1,
	 BBG_REFERENCE_FO2,
	 BBG_REFERENCE_FO3,
	 BBG_REFERENCE_FO4,
	 BBG_REFERENCE_FO5,
	 BBG_REFERENCE_FO6,
	 BBG_REFERENCE_FO7,
	 BBG_REFERENCE_FO8,
	 BBG_REFERENCE_FO9,
	 BBG_REFERENCE_FO10)
	SELECT W_RTL_SLS_IT_LC_MN_A_SEQ.NEXTVAL, A.*
		FROM (SELECT T.PROD_WID,
								 T.PROD_SCD1_WID,
								 T.ORG_WID,
								 T.ORG_SCD1_WID,
								 MAX(T.ORG_DH_WID) ORG_DH_WID,
								 SUBSTR(T.DT_WID, 2, 6) MN_WID,
								 T.VOUCHER_FLG,
								 T.RTL_TYPE_WID,
								 T.EMPLOYEE_WID,
								 SUM(T.SLS_QTY) SLS_QTY,
								 SUM(T.SLS_AMT_LCL) SLS_AMT_LCL,
								 SUM(T.SLS_PROFIT_AMT_LCL) SLS_PROFIT_AMT_LCL,
								 SUM(T.SLS_MANUAL_MKDN_AMT_LCL) SLS_MANUAL_MKDN_AMT_LCL,
								 SUM(T.SLS_MANUAL_MKUP_AMT_LCL) SLS_MANUAL_MKUP_AMT_LCL,
								 SUM(T.SLS_TAX_AMT_LCL) SLS_TAX_AMT_LCL,
								 SUM(T.SLS_EMP_DISC_AMT_LCL) SLS_EMP_DISC_AMT_LCL,
								 SUM(T.SLS_MANUAL_COUNT) SLS_MANUAL_COUNT,
								 SUM(T.SLS_SCAN_COUNT) SLS_SCAN_COUNT,
								 SUM(T.RET_QTY) RET_QTY,
								 SUM(T.RET_AMT_LCL) RET_AMT_LCL,
								 SUM(T.RET_PROFIT_AMT_LCL) RET_PROFIT_AMT_LCL,
								 SUM(T.RET_MANUAL_MKDN_AMT_LCL) RET_MANUAL_MKDN_AMT_LCL,
								 SUM(T.RET_MANUAL_MKUP_AMT_LCL) RET_MANUAL_MKUP_AMT_LCL,
								 SUM(T.RET_TAX_AMT_LCL) RET_TAX_AMT_LCL,
								 SUM(T.RET_EMP_DISC_AMT_LCL) RET_EMP_DISC_AMT_LCL,
								 SUM(T.RET_MANUAL_COUNT) RET_MANUAL_COUNT,
								 SUM(T.RET_SCAN_COUNT) RET_SCAN_COUNT,
								 T.RTL_TYPE_CODE,
								 MAX(T.DATASOURCE_NUM_ID) DATASOURCE_NUM_ID,
								 MAX(T.DELETE_FLG) DELETE_FLG,
								 MAX(T.DOC_CURR_CODE) DOC_CURR_CODE,
								 MAX(T.ETL_PROC_WID) ETL_PROC_WID,
								 MAX(T.GLOBAL1_EXCHANGE_RATE) GLOBAL1_EXCHANGE_RATE,
								 MAX(T.GLOBAL2_EXCHANGE_RATE) GLOBAL2_EXCHANGE_RATE,
								 MAX(T.GLOBAL3_EXCHANGE_RATE) GLOBAL3_EXCHANGE_RATE,
								 SUBSTR(T.INTEGRATION_ID, 1, 17) || SUBSTR(T.DT_WID, 2, 6) || '~' ||
								 T.RTL_TYPE_CODE INTEGRATION_ID,
								 MAX(T.LOC_CURR_CODE) LOC_CURR_CODE,
								 MAX(T.LOC_EXCHANGE_RATE) LOC_EXCHANGE_RATE,
								 MAX(T.TENANT_ID) TENANT_ID,
								 SYSDATE W_INSERT_DT,
								 SYSDATE W_UPDATE_DT,
								 MAX(T.X_CUSTOM) X_CUSTOM,
								 T.BBG_ITEM_LOC_WID,
								 T.BBG_RETAIL_TYPE_WID,
								 SUM(T.BBG_CUSTOMER_COUNT) BBG_CUSTOMER_COUNT,
								 SUM(T.BBG_SERVICE_SATISFACTION) BBG_SERVICE_SATISFACTION,
								 SUM(T.BBG_REFERENCE_DO1) BBG_REFERENCE_DO1,
								 SUM(T.BBG_REFERENCE_DO2) BBG_REFERENCE_DO2,
								 SUM(T.BBG_REFERENCE_DO3) BBG_REFERENCE_DO3,
								 SUM(T.BBG_REFERENCE_DO4) BBG_REFERENCE_DO4,
								 SUM(T.BBG_REFERENCE_DO5) BBG_REFERENCE_DO5,
								 SUM(T.BBG_REFERENCE_FO1) BBG_REFERENCE_FO1,
								 SUM(T.BBG_REFERENCE_FO2) BBG_REFERENCE_FO2,
								 SUM(T.BBG_REFERENCE_FO3) BBG_REFERENCE_FO3,
								 SUM(T.BBG_REFERENCE_FO4) BBG_REFERENCE_FO4,
								 SUM(T.BBG_REFERENCE_FO5) BBG_REFERENCE_FO5,
								 SUM(T.BBG_REFERENCE_FO6) BBG_REFERENCE_FO6,
								 SUM(T.BBG_REFERENCE_FO7) BBG_REFERENCE_FO7,
								 SUM(T.BBG_REFERENCE_FO8) BBG_REFERENCE_FO8,
								 SUM(T.BBG_REFERENCE_FO9) BBG_REFERENCE_FO9,
								 SUM(T.BBG_REFERENCE_FO10) BBG_REFERENCE_FO10
						FROM W_RTL_SLS_IT_LC_DY_A T
					 GROUP BY T.PROD_WID,
										T.PROD_SCD1_WID,
										T.ORG_WID,
										T.ORG_SCD1_WID,
										SUBSTR(T.DT_WID, 2, 6),
										T.VOUCHER_FLG,
										T.RTL_TYPE_WID,
										T.EMPLOYEE_WID,
										T.RTL_TYPE_CODE,
										SUBSTR(T.INTEGRATION_ID, 1, 17),
										T.BBG_ITEM_LOC_WID,
										T.BBG_RETAIL_TYPE_WID) A;
