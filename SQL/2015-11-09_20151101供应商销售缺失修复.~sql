--BBG_RA_SLS_CL_LC_DY_A,BBG_RA_SLS_DP_LC_DY_A二个表缺失2015.11.1日的销售数据。不明原因。
--RADM.BBG_RA_SLS_CL_LC_DY_A
MERGE INTO RADM.BBG_RA_SLS_CL_LC_DY_A T
USING (SELECT D.ORG_WID,
              D.ORG_DH_WID,
              D.ORG_SCD1_WID,
              D.PROD_DH_WID,
              D.DT_WID,
              D.SUPP_SALES_QTY,
              D.SUPP_SALES_COST,
              D.SUPP_SALES_AMT,
              D.SUPPLIER_WID,
              D.DATASOURCE_NUM_ID,
              D.DELETE_FLG,
              D.DOC_CURR_CODE,
              D.ETL_PROC_WID,
              D.GLOBAL1_EXCHANGE_RATE,
              D.GLOBAL2_EXCHANGE_RATE,
              D.GLOBAL3_EXCHANGE_RATE,
              E.LVL5ANC_PRODCAT_ID || '~' || F.ORG_NUM || '~' ||
              TO_CHAR(TO_DATE(SUBSTR(D.DT_WID, 2, 8), 'YYYYMMDD'),
                      'DD-MON-YY',
                      'NLS_DATE_LANGUAGE = American') || '~' ||
              G.SUPPLIER_NUM INTEGRATION_ID,
              D.LOC_CURR_CODE,
              D.LOC_EXCHANGE_RATE,
              D.TENANT_ID,
              D.X_CUSTOM,
              D.BBG_REFERENCE_DO1,
              D.BBG_REFERENCE_DO2,
              D.BBG_REFERENCE_DO3,
              D.BBG_REFERENCE_DO4,
              D.BBG_REFERENCE_DO5,
              D.BBG_REFERENCE_FO1,
              D.BBG_REFERENCE_FO2,
              D.BBG_REFERENCE_FO3,
              D.BBG_REFERENCE_FO4,
              D.BBG_REFERENCE_FO5,
              D.BBG_REFERENCE_FO6,
              D.BBG_REFERENCE_FO7,
              D.BBG_REFERENCE_FO8,
              D.BBG_REFERENCE_FO9,
              D.BBG_REFERENCE_FO10
         FROM (SELECT /*+PARALLEL(16)*/
                C.ROW_WID PROD_DH_WID,
                A.ORG_WID,
                A.ORG_SCD1_WID,
                A.ORG_DH_WID,
                A.DT_WID,
                A.SUPPLIER_WID,
                SUM(A.SUPP_SALES_QTY) SUPP_SALES_QTY,
                SUM(A.SUPP_SALES_COST) SUPP_SALES_COST,
                SUM(A.SUPP_SALES_AMT) SUPP_SALES_AMT,
                MAX(A.DATASOURCE_NUM_ID) DATASOURCE_NUM_ID,
                MAX(A.DELETE_FLG) DELETE_FLG,
                MAX(A.DOC_CURR_CODE) DOC_CURR_CODE,
                MAX(A.ETL_PROC_WID) ETL_PROC_WID,
                MAX(A.GLOBAL1_EXCHANGE_RATE) GLOBAL1_EXCHANGE_RATE,
                MAX(A.GLOBAL2_EXCHANGE_RATE) GLOBAL2_EXCHANGE_RATE,
                MAX(A.GLOBAL3_EXCHANGE_RATE) GLOBAL3_EXCHANGE_RATE,
                MAX(A.LOC_CURR_CODE) LOC_CURR_CODE,
                MAX(A.LOC_EXCHANGE_RATE) LOC_EXCHANGE_RATE,
                MAX(A.TENANT_ID) TENANT_ID,
                MAX(A.X_CUSTOM) X_CUSTOM,
                A.BBG_REFERENCE_DO1,
                A.BBG_REFERENCE_DO2,
                MAX(A.BBG_REFERENCE_DO3) BBG_REFERENCE_DO3,
                MAX(A.BBG_REFERENCE_DO4) BBG_REFERENCE_DO4,
                MAX(A.BBG_REFERENCE_DO5) BBG_REFERENCE_DO5,
                SUM(A.BBG_REFERENCE_FO1) BBG_REFERENCE_FO1,
                SUM(A.BBG_REFERENCE_FO2) BBG_REFERENCE_FO2,
                SUM(A.BBG_REFERENCE_FO3) BBG_REFERENCE_FO3,
                SUM(A.BBG_REFERENCE_FO4) BBG_REFERENCE_FO4,
                SUM(A.BBG_REFERENCE_FO5) BBG_REFERENCE_FO5,
                SUM(A.BBG_REFERENCE_FO6) BBG_REFERENCE_FO6,
                SUM(A.BBG_REFERENCE_FO7) BBG_REFERENCE_FO7,
                SUM(A.BBG_REFERENCE_FO8) BBG_REFERENCE_FO8,
                SUM(A.BBG_REFERENCE_FO9) BBG_REFERENCE_FO9,
                SUM(A.BBG_REFERENCE_FO10) BBG_REFERENCE_FO10
                 FROM RADM.BBG_RA_SLS_SC_LC_DY_A A,
                      RADM.W_PROD_CAT_DH         B,
                      RADM.W_PROD_CAT_DH         C
                WHERE A.PROD_DH_WID = B.ROW_WID
                  AND B.LVL5ANC_PRODCAT_ID = C.LVL5ANC_PRODCAT_ID
                  AND A.DT_WID = 120151101000
                  AND B.LEVEL_NAME = 'SBC'
                  AND C.LEVEL_NAME = 'CLS'
                GROUP BY C.ROW_WID,
                         A.ORG_WID,
                         A.ORG_SCD1_WID,
                         A.ORG_DH_WID,
                         A.DT_WID,
                         A.SUPPLIER_WID,
                         A.BBG_REFERENCE_DO1,
                         A.BBG_REFERENCE_DO2) D,
              RADM.W_PROD_CAT_DH E,
              RADM.W_INT_ORG_D F,
              RADM.W_PARTY_ORG_D G
        WHERE D.PROD_DH_WID = E.ROW_WID
          AND D.ORG_WID = F.ROW_WID
          AND D.SUPPLIER_WID = G.ROW_WID
          AND E.LEVEL_NAME = 'CLS') S
ON (T.ORG_WID = S.ORG_WID AND T.ORG_DH_WID = S.ORG_DH_WID AND T.ORG_SCD1_WID = S.ORG_SCD1_WID AND T.PROD_DH_WID = S.PROD_DH_WID AND T.DT_WID = S.DT_WID AND T.SUPPLIER_WID = S.SUPPLIER_WID AND T.BBG_REFERENCE_DO1 = S.BBG_REFERENCE_DO1)
WHEN MATCHED THEN
  UPDATE
     SET T.SUPP_SALES_QTY     = S.SUPP_SALES_QTY,
         T.SUPP_SALES_COST    = S.SUPP_SALES_COST,
         T.SUPP_SALES_AMT     = S.SUPP_SALES_AMT,
         T.BBG_REFERENCE_FO1  = S.BBG_REFERENCE_FO1,
         T.BBG_REFERENCE_FO2  = S.BBG_REFERENCE_FO2,
         T.BBG_REFERENCE_FO3  = S.BBG_REFERENCE_FO3,
         T.BBG_REFERENCE_FO4  = S.BBG_REFERENCE_FO4,
         T.BBG_REFERENCE_FO5  = S.BBG_REFERENCE_FO5,
         T.BBG_REFERENCE_FO6  = S.BBG_REFERENCE_FO6,
         T.BBG_REFERENCE_FO7  = S.BBG_REFERENCE_FO7,
         T.BBG_REFERENCE_FO8  = S.BBG_REFERENCE_FO8,
         T.BBG_REFERENCE_FO9  = S.BBG_REFERENCE_FO9,
         T.BBG_REFERENCE_FO10 = S.BBG_REFERENCE_FO10,
         T.W_UPDATE_DT        = SYSDATE
WHEN NOT MATCHED THEN
  INSERT
    (T.ROW_WID,
     T.ORG_WID,
     T.ORG_DH_WID,
     T.ORG_SCD1_WID,
     T.PROD_DH_WID,
     T.DT_WID,
     T.SUPP_SALES_QTY,
     T.SUPP_SALES_COST,
     T.SUPP_SALES_AMT,
     T.SUPPLIER_WID,
     T.DATASOURCE_NUM_ID,
     T.DELETE_FLG,
     T.DOC_CURR_CODE,
     T.ETL_PROC_WID,
     T.GLOBAL1_EXCHANGE_RATE,
     T.GLOBAL2_EXCHANGE_RATE,
     T.GLOBAL3_EXCHANGE_RATE,
     T.INTEGRATION_ID,
     T.LOC_CURR_CODE,
     T.LOC_EXCHANGE_RATE,
     T.TENANT_ID,
     T.W_INSERT_DT,
     T.W_UPDATE_DT,
     T.X_CUSTOM,
     T.BBG_REFERENCE_DO1,
     T.BBG_REFERENCE_DO2,
     T.BBG_REFERENCE_DO3,
     T.BBG_REFERENCE_DO4,
     T.BBG_REFERENCE_DO5,
     T.BBG_REFERENCE_FO1,
     T.BBG_REFERENCE_FO2,
     T.BBG_REFERENCE_FO3,
     T.BBG_REFERENCE_FO4,
     T.BBG_REFERENCE_FO5,
     T.BBG_REFERENCE_FO6,
     T.BBG_REFERENCE_FO7,
     T.BBG_REFERENCE_FO8,
     T.BBG_REFERENCE_FO9,
     T.BBG_REFERENCE_FO10)
  VALUES
    (RADM.BBG_RA_SLS_CL_LC_DY_A_SEQ.NEXTVAL,
     S.ORG_WID,
     S.ORG_DH_WID,
     S.ORG_SCD1_WID,
     S.PROD_DH_WID,
     S.DT_WID,
     S.SUPP_SALES_QTY,
     S.SUPP_SALES_COST,
     S.SUPP_SALES_AMT,
     S.SUPPLIER_WID,
     S.DATASOURCE_NUM_ID,
     S.DELETE_FLG,
     S.DOC_CURR_CODE,
     S.ETL_PROC_WID,
     S.GLOBAL1_EXCHANGE_RATE,
     S.GLOBAL2_EXCHANGE_RATE,
     S.GLOBAL3_EXCHANGE_RATE,
     S.INTEGRATION_ID,
     S.LOC_CURR_CODE,
     S.LOC_EXCHANGE_RATE,
     S.TENANT_ID,
     SYSDATE,
     SYSDATE,
     S.X_CUSTOM,
     S.BBG_REFERENCE_DO1,
     S.BBG_REFERENCE_DO2,
     S.BBG_REFERENCE_DO3,
     S.BBG_REFERENCE_DO4,
     S.BBG_REFERENCE_DO5,
     S.BBG_REFERENCE_FO1,
     S.BBG_REFERENCE_FO2,
     S.BBG_REFERENCE_FO3,
     S.BBG_REFERENCE_FO4,
     S.BBG_REFERENCE_FO5,
     S.BBG_REFERENCE_FO6,
     S.BBG_REFERENCE_FO7,
     S.BBG_REFERENCE_FO8,
     S.BBG_REFERENCE_FO9,
     S.BBG_REFERENCE_FO10);
COMMIT;

--RADM.BBG_RA_SLS_DP_LC_DY_A
MERGE INTO RADM.BBG_RA_SLS_CL_LC_DY_A T
USING (SELECT D.ORG_WID,
              D.ORG_DH_WID,
              D.ORG_SCD1_WID,
              D.PROD_DH_WID,
              D.DT_WID,
              D.SUPP_SALES_QTY,
              D.SUPP_SALES_COST,
              D.SUPP_SALES_AMT,
              D.SUPPLIER_WID,
              D.DATASOURCE_NUM_ID,
              D.DELETE_FLG,
              D.DOC_CURR_CODE,
              D.ETL_PROC_WID,
              D.GLOBAL1_EXCHANGE_RATE,
              D.GLOBAL2_EXCHANGE_RATE,
              D.GLOBAL3_EXCHANGE_RATE,
              E.LVL5ANC_PRODCAT_ID || '~' || F.ORG_NUM || '~' ||
              TO_CHAR(TO_DATE(SUBSTR(D.DT_WID, 2, 8), 'YYYYMMDD'),
                      'DD-MON-YY',
                      'NLS_DATE_LANGUAGE = American') || '~' ||
              G.SUPPLIER_NUM INTEGRATION_ID,
              D.LOC_CURR_CODE,
              D.LOC_EXCHANGE_RATE,
              D.TENANT_ID,
              D.X_CUSTOM,
              D.BBG_REFERENCE_DO1,
              D.BBG_REFERENCE_DO2,
              D.BBG_REFERENCE_DO3,
              D.BBG_REFERENCE_DO4,
              D.BBG_REFERENCE_DO5,
              D.BBG_REFERENCE_FO1,
              D.BBG_REFERENCE_FO2,
              D.BBG_REFERENCE_FO3,
              D.BBG_REFERENCE_FO4,
              D.BBG_REFERENCE_FO5,
              D.BBG_REFERENCE_FO6,
              D.BBG_REFERENCE_FO7,
              D.BBG_REFERENCE_FO8,
              D.BBG_REFERENCE_FO9,
              D.BBG_REFERENCE_FO10
         FROM (SELECT /*+PARALLEL(16)*/
                C.ROW_WID PROD_DH_WID,
                A.ORG_WID,
                A.ORG_SCD1_WID,
                A.ORG_DH_WID,
                A.DT_WID,
                A.SUPPLIER_WID,
                SUM(A.SUPP_SALES_QTY) SUPP_SALES_QTY,
                SUM(A.SUPP_SALES_COST) SUPP_SALES_COST,
                SUM(A.SUPP_SALES_AMT) SUPP_SALES_AMT,
                MAX(A.DATASOURCE_NUM_ID) DATASOURCE_NUM_ID,
                MAX(A.DELETE_FLG) DELETE_FLG,
                MAX(A.DOC_CURR_CODE) DOC_CURR_CODE,
                MAX(A.ETL_PROC_WID) ETL_PROC_WID,
                MAX(A.GLOBAL1_EXCHANGE_RATE) GLOBAL1_EXCHANGE_RATE,
                MAX(A.GLOBAL2_EXCHANGE_RATE) GLOBAL2_EXCHANGE_RATE,
                MAX(A.GLOBAL3_EXCHANGE_RATE) GLOBAL3_EXCHANGE_RATE,
                MAX(A.LOC_CURR_CODE) LOC_CURR_CODE,
                MAX(A.LOC_EXCHANGE_RATE) LOC_EXCHANGE_RATE,
                MAX(A.TENANT_ID) TENANT_ID,
                MAX(A.X_CUSTOM) X_CUSTOM,
                A.BBG_REFERENCE_DO1,
                A.BBG_REFERENCE_DO2,
                MAX(A.BBG_REFERENCE_DO3) BBG_REFERENCE_DO3,
                MAX(A.BBG_REFERENCE_DO4) BBG_REFERENCE_DO4,
                MAX(A.BBG_REFERENCE_DO5) BBG_REFERENCE_DO5,
                SUM(A.BBG_REFERENCE_FO1) BBG_REFERENCE_FO1,
                SUM(A.BBG_REFERENCE_FO2) BBG_REFERENCE_FO2,
                SUM(A.BBG_REFERENCE_FO3) BBG_REFERENCE_FO3,
                SUM(A.BBG_REFERENCE_FO4) BBG_REFERENCE_FO4,
                SUM(A.BBG_REFERENCE_FO5) BBG_REFERENCE_FO5,
                SUM(A.BBG_REFERENCE_FO6) BBG_REFERENCE_FO6,
                SUM(A.BBG_REFERENCE_FO7) BBG_REFERENCE_FO7,
                SUM(A.BBG_REFERENCE_FO8) BBG_REFERENCE_FO8,
                SUM(A.BBG_REFERENCE_FO9) BBG_REFERENCE_FO9,
                SUM(A.BBG_REFERENCE_FO10) BBG_REFERENCE_FO10
                 FROM RADM.BBG_RA_SLS_SC_LC_DY_A A,
                      RADM.W_PROD_CAT_DH         B,
                      RADM.W_PROD_CAT_DH         C
                WHERE A.PROD_DH_WID = B.ROW_WID
                  AND B.LVL5ANC_PRODCAT_ID = C.LVL5ANC_PRODCAT_ID
                  AND A.DT_WID = 120151101000
                  AND B.LEVEL_NAME = 'SBC'
                  AND C.LEVEL_NAME = 'CLS'
                GROUP BY C.ROW_WID,
                         A.ORG_WID,
                         A.ORG_SCD1_WID,
                         A.ORG_DH_WID,
                         A.DT_WID,
                         A.SUPPLIER_WID,
                         A.BBG_REFERENCE_DO1,
                         A.BBG_REFERENCE_DO2) D,
              RADM.W_PROD_CAT_DH E,
              RADM.W_INT_ORG_D F,
              RADM.W_PARTY_ORG_D G
        WHERE D.PROD_DH_WID = E.ROW_WID
          AND D.ORG_WID = F.ROW_WID
          AND D.SUPPLIER_WID = G.ROW_WID
          AND E.LEVEL_NAME = 'CLS') S
ON (T.ORG_WID = S.ORG_WID AND T.ORG_DH_WID = S.ORG_DH_WID AND T.ORG_SCD1_WID = S.ORG_SCD1_WID AND T.PROD_DH_WID = S.PROD_DH_WID AND T.DT_WID = S.DT_WID AND T.SUPPLIER_WID = S.SUPPLIER_WID AND T.BBG_REFERENCE_DO1 = S.BBG_REFERENCE_DO1)
WHEN MATCHED THEN
  UPDATE
     SET T.SUPP_SALES_QTY     = S.SUPP_SALES_QTY,
         T.SUPP_SALES_COST    = S.SUPP_SALES_COST,
         T.SUPP_SALES_AMT     = S.SUPP_SALES_AMT,
         T.BBG_REFERENCE_FO1  = S.BBG_REFERENCE_FO1,
         T.BBG_REFERENCE_FO2  = S.BBG_REFERENCE_FO2,
         T.BBG_REFERENCE_FO3  = S.BBG_REFERENCE_FO3,
         T.BBG_REFERENCE_FO4  = S.BBG_REFERENCE_FO4,
         T.BBG_REFERENCE_FO5  = S.BBG_REFERENCE_FO5,
         T.BBG_REFERENCE_FO6  = S.BBG_REFERENCE_FO6,
         T.BBG_REFERENCE_FO7  = S.BBG_REFERENCE_FO7,
         T.BBG_REFERENCE_FO8  = S.BBG_REFERENCE_FO8,
         T.BBG_REFERENCE_FO9  = S.BBG_REFERENCE_FO9,
         T.BBG_REFERENCE_FO10 = S.BBG_REFERENCE_FO10,
         T.W_UPDATE_DT        = SYSDATE
WHEN NOT MATCHED THEN
  INSERT
    (T.ROW_WID,
     T.ORG_WID,
     T.ORG_DH_WID,
     T.ORG_SCD1_WID,
     T.PROD_DH_WID,
     T.DT_WID,
     T.SUPP_SALES_QTY,
     T.SUPP_SALES_COST,
     T.SUPP_SALES_AMT,
     T.SUPPLIER_WID,
     T.DATASOURCE_NUM_ID,
     T.DELETE_FLG,
     T.DOC_CURR_CODE,
     T.ETL_PROC_WID,
     T.GLOBAL1_EXCHANGE_RATE,
     T.GLOBAL2_EXCHANGE_RATE,
     T.GLOBAL3_EXCHANGE_RATE,
     T.INTEGRATION_ID,
     T.LOC_CURR_CODE,
     T.LOC_EXCHANGE_RATE,
     T.TENANT_ID,
     T.W_INSERT_DT,
     T.W_UPDATE_DT,
     T.X_CUSTOM,
     T.BBG_REFERENCE_DO1,
     T.BBG_REFERENCE_DO2,
     T.BBG_REFERENCE_DO3,
     T.BBG_REFERENCE_DO4,
     T.BBG_REFERENCE_DO5,
     T.BBG_REFERENCE_FO1,
     T.BBG_REFERENCE_FO2,
     T.BBG_REFERENCE_FO3,
     T.BBG_REFERENCE_FO4,
     T.BBG_REFERENCE_FO5,
     T.BBG_REFERENCE_FO6,
     T.BBG_REFERENCE_FO7,
     T.BBG_REFERENCE_FO8,
     T.BBG_REFERENCE_FO9,
     T.BBG_REFERENCE_FO10)
  VALUES
    (RADM.BBG_RA_SLS_CL_LC_DY_A_SEQ.NEXTVAL,
     S.ORG_WID,
     S.ORG_DH_WID,
     S.ORG_SCD1_WID,
     S.PROD_DH_WID,
     S.DT_WID,
     S.SUPP_SALES_QTY,
     S.SUPP_SALES_COST,
     S.SUPP_SALES_AMT,
     S.SUPPLIER_WID,
     S.DATASOURCE_NUM_ID,
     S.DELETE_FLG,
     S.DOC_CURR_CODE,
     S.ETL_PROC_WID,
     S.GLOBAL1_EXCHANGE_RATE,
     S.GLOBAL2_EXCHANGE_RATE,
     S.GLOBAL3_EXCHANGE_RATE,
     S.INTEGRATION_ID,
     S.LOC_CURR_CODE,
     S.LOC_EXCHANGE_RATE,
     S.TENANT_ID,
     SYSDATE,
     SYSDATE,
     S.X_CUSTOM,
     S.BBG_REFERENCE_DO1,
     S.BBG_REFERENCE_DO2,
     S.BBG_REFERENCE_DO3,
     S.BBG_REFERENCE_DO4,
     S.BBG_REFERENCE_DO5,
     S.BBG_REFERENCE_FO1,
     S.BBG_REFERENCE_FO2,
     S.BBG_REFERENCE_FO3,
     S.BBG_REFERENCE_FO4,
     S.BBG_REFERENCE_FO5,
     S.BBG_REFERENCE_FO6,
     S.BBG_REFERENCE_FO7,
     S.BBG_REFERENCE_FO8,
     S.BBG_REFERENCE_FO9,
     S.BBG_REFERENCE_FO10);
COMMIT;

SELECT D.ORG_WID,
       D.ORG_DH_WID,
       D.ORG_SCD1_WID,
       D.PROD_DH_WID,
       D.DT_WID,
       D.SUPP_SALES_QTY,
       D.SUPP_SALES_COST,
       D.SUPP_SALES_AMT,
       D.SUPPLIER_WID,
       D.DATASOURCE_NUM_ID,
       D.DELETE_FLG,
       D.DOC_CURR_CODE,
       D.ETL_PROC_WID,
       D.GLOBAL1_EXCHANGE_RATE,
       D.GLOBAL2_EXCHANGE_RATE,
       D.GLOBAL3_EXCHANGE_RATE,
       E.LVL5ANC_PRODCAT_ID || '~' || F.ORG_NUM || '~' ||
       TO_CHAR(TO_DATE(SUBSTR(D.DT_WID, 2, 8), 'YYYYMMDD'),
               'DD-MON-YY',
               'NLS_DATE_LANGUAGE = American') || '~' || G.SUPPLIER_NUM INTEGRATION_ID,
       D.LOC_CURR_CODE,
       D.LOC_EXCHANGE_RATE,
       D.TENANT_ID,
       D.X_CUSTOM,
       D.BBG_REFERENCE_DO1,
       D.BBG_REFERENCE_DO2,
       D.BBG_REFERENCE_DO3,
       D.BBG_REFERENCE_DO4,
       D.BBG_REFERENCE_DO5,
       D.BBG_REFERENCE_FO1,
       D.BBG_REFERENCE_FO2,
       D.BBG_REFERENCE_FO3,
       D.BBG_REFERENCE_FO4,
       D.BBG_REFERENCE_FO5,
       D.BBG_REFERENCE_FO6,
       D.BBG_REFERENCE_FO7,
       D.BBG_REFERENCE_FO8,
       D.BBG_REFERENCE_FO9,
       D.BBG_REFERENCE_FO10
  FROM (SELECT /*+PARALLEL(16)*/
         C.ROW_WID PROD_DH_WID,
         A.ORG_WID,
         A.ORG_SCD1_WID,
         A.ORG_DH_WID,
         A.DT_WID,
         A.SUPPLIER_WID,
         SUM(A.SUPP_SALES_QTY) SUPP_SALES_QTY,
         SUM(A.SUPP_SALES_COST) SUPP_SALES_COST,
         SUM(A.SUPP_SALES_AMT) SUPP_SALES_AMT,
         MAX(A.DATASOURCE_NUM_ID) DATASOURCE_NUM_ID,
         MAX(A.DELETE_FLG) DELETE_FLG,
         MAX(A.DOC_CURR_CODE) DOC_CURR_CODE,
         MAX(A.ETL_PROC_WID) ETL_PROC_WID,
         MAX(A.GLOBAL1_EXCHANGE_RATE) GLOBAL1_EXCHANGE_RATE,
         MAX(A.GLOBAL2_EXCHANGE_RATE) GLOBAL2_EXCHANGE_RATE,
         MAX(A.GLOBAL3_EXCHANGE_RATE) GLOBAL3_EXCHANGE_RATE,
         MAX(A.LOC_CURR_CODE) LOC_CURR_CODE,
         MAX(A.LOC_EXCHANGE_RATE) LOC_EXCHANGE_RATE,
         MAX(A.TENANT_ID) TENANT_ID,
         MAX(A.X_CUSTOM) X_CUSTOM,
         A.BBG_REFERENCE_DO1,
         A.BBG_REFERENCE_DO2,
         MAX(A.BBG_REFERENCE_DO3) BBG_REFERENCE_DO3,
         MAX(A.BBG_REFERENCE_DO4) BBG_REFERENCE_DO4,
         MAX(A.BBG_REFERENCE_DO5) BBG_REFERENCE_DO5,
         SUM(A.BBG_REFERENCE_FO1) BBG_REFERENCE_FO1,
         SUM(A.BBG_REFERENCE_FO2) BBG_REFERENCE_FO2,
         SUM(A.BBG_REFERENCE_FO3) BBG_REFERENCE_FO3,
         SUM(A.BBG_REFERENCE_FO4) BBG_REFERENCE_FO4,
         SUM(A.BBG_REFERENCE_FO5) BBG_REFERENCE_FO5,
         SUM(A.BBG_REFERENCE_FO6) BBG_REFERENCE_FO6,
         SUM(A.BBG_REFERENCE_FO7) BBG_REFERENCE_FO7,
         SUM(A.BBG_REFERENCE_FO8) BBG_REFERENCE_FO8,
         SUM(A.BBG_REFERENCE_FO9) BBG_REFERENCE_FO9,
         SUM(A.BBG_REFERENCE_FO10) BBG_REFERENCE_FO10
          FROM RADM.BBG_RA_SLS_SC_LC_DY_A A,
               RADM.W_PROD_CAT_DH         B,
               RADM.W_PROD_CAT_DH         C
         WHERE A.PROD_DH_WID = B.ROW_WID
           AND B.LVL5ANC_PRODCAT_ID = C.LVL5ANC_PRODCAT_ID
           AND A.DT_WID = 120151101000
           AND B.LEVEL_NAME = 'SBC'
           AND C.LEVEL_NAME = 'CLS'
         GROUP BY C.ROW_WID,
                  A.ORG_WID,
                  A.ORG_SCD1_WID,
                  A.ORG_DH_WID,
                  A.DT_WID,
                  A.SUPPLIER_WID,
                  A.BBG_REFERENCE_DO1,
                  A.BBG_REFERENCE_DO2) D,
       RADM.W_PROD_CAT_DH E,
       RADM.W_INT_ORG_D F,
       RADM.W_PARTY_ORG_D G
 WHERE D.PROD_DH_WID = E.ROW_WID
   AND D.ORG_WID = F.ROW_WID
   AND D.SUPPLIER_WID = G.ROW_WID
   AND E.LEVEL_NAME = 'CLS';

SELECT /*+PARALLEL(16)*/
 *
  FROM RADM.BBG_RA_SLS_SC_LC_DY_A T
 WHERE T.DT_WID = 120151101000;
SELECT * FROM RADM.BBG_RA_SLS_CL_LC_DY_A;
SELECT * FROM RADM.W_PROD_CAT_DH;
