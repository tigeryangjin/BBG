/* Formatted on 2014/6/18 10:57:41 (QP5 v5.256.13226.35510) */
 /* Formatted on 2014/6/18 11:08:41 (QP5 v5.256.13226.35510) */
  SELECT CASE
            WHEN VALUE BETWEEN '0.00' AND '9.99' THEN '1'
            WHEN VALUE BETWEEN '10' AND '19.99' THEN '2'
            WHEN VALUE BETWEEN '20' AND '29.99' THEN '3'
            WHEN VALUE BETWEEN '30' AND '39.99' THEN '4'
            WHEN VALUE BETWEEN '40' AND '49.99' THEN '5'
            WHEN VALUE BETWEEN '50' AND '59.99' THEN '6'
            WHEN VALUE BETWEEN '60' AND '69.99' THEN '7'
            WHEN VALUE BETWEEN '70' AND '79.99' THEN '8'
            WHEN VALUE BETWEEN '80' AND '89.99' THEN '9'
            WHEN VALUE BETWEEN '90' AND '99.99' THEN '10'
            WHEN VALUE BETWEEN '100' AND '109.99' THEN '11'
            WHEN VALUE BETWEEN '110' AND '119.99' THEN '12'
            WHEN VALUE BETWEEN '120' AND '129.99' THEN '13'
            WHEN VALUE BETWEEN '130' AND '139.99' THEN '14'
            WHEN VALUE BETWEEN '140' AND '149.99' THEN '15'
            WHEN VALUE BETWEEN '150' AND '159.99' THEN '16'
            WHEN VALUE BETWEEN '160' AND '169.99' THEN '17'
            WHEN VALUE BETWEEN '170' AND '179.99' THEN '18'
            WHEN VALUE BETWEEN '180' AND '189.99' THEN '19'
            WHEN VALUE BETWEEN '190' AND '199.99' THEN '20'
            WHEN VALUE BETWEEN '200' AND '209.99' THEN '21'
            WHEN VALUE BETWEEN '210' AND '219.99' THEN '22'
            WHEN VALUE BETWEEN '220' AND '229.99' THEN '23'
            WHEN VALUE BETWEEN '230' AND '239.99' THEN '24'
            WHEN VALUE BETWEEN '240' AND '249.99' THEN '25'
            WHEN VALUE BETWEEN '250' AND '259.99' THEN '26'
            WHEN VALUE BETWEEN '260' AND '269.99' THEN '27'
            WHEN VALUE BETWEEN '270' AND '279.99' THEN '28'
            WHEN VALUE BETWEEN '280' AND '289.99' THEN '29'
            WHEN VALUE BETWEEN '290' AND '299.99' THEN '30'
            WHEN VALUE BETWEEN '300' AND '309.99' THEN '31'
            WHEN VALUE BETWEEN '310' AND '319.99' THEN '32'
            WHEN VALUE BETWEEN '320' AND '329.99' THEN '33'
            WHEN VALUE BETWEEN '330' AND '339.99' THEN '34'
            WHEN VALUE BETWEEN '340' AND '349.99' THEN '35'
            WHEN VALUE BETWEEN '350' AND '359.99' THEN '36'
            WHEN VALUE BETWEEN '360' AND '369.99' THEN '37'
            WHEN VALUE BETWEEN '370' AND '379.99' THEN '38'
            WHEN VALUE BETWEEN '380' AND '389.99' THEN '39'
            WHEN VALUE BETWEEN '390' AND '399.99' THEN '40'
            WHEN VALUE BETWEEN '400' AND '409.99' THEN '41'
            WHEN VALUE BETWEEN '410' AND '419.99' THEN '42'
            WHEN VALUE BETWEEN '420' AND '429.99' THEN '43'
            WHEN VALUE BETWEEN '430' AND '439.99' THEN '44'
            WHEN VALUE BETWEEN '440' AND '449.99' THEN '45'
            WHEN VALUE BETWEEN '450' AND '459.99' THEN '46'
            WHEN VALUE BETWEEN '460' AND '469.99' THEN '47'
            WHEN VALUE BETWEEN '470' AND '479.99' THEN '48'
            WHEN VALUE BETWEEN '480' AND '489.99' THEN '49'
            WHEN VALUE BETWEEN '490' AND '499.99' THEN '50'
            WHEN VALUE BETWEEN '500' AND '549.99' THEN '51'
            WHEN VALUE BETWEEN '550' AND '599.99' THEN '52'
            WHEN VALUE BETWEEN '600' AND '649.99' THEN '53'
            WHEN VALUE BETWEEN '650' AND '699.99' THEN '54'
            WHEN VALUE BETWEEN '700' AND '749.99' THEN '55'
            WHEN VALUE BETWEEN '750' AND '799.99' THEN '56'
            WHEN VALUE BETWEEN '800' AND '849.99' THEN '57'
            WHEN VALUE BETWEEN '850' AND '899.99' THEN '58'
            WHEN VALUE BETWEEN '900' AND '949.99' THEN '59'
            WHEN VALUE BETWEEN '950' AND '999.99' THEN '60'
            WHEN VALUE BETWEEN '1000' AND '1099.99' THEN '61'
            WHEN VALUE BETWEEN '1100' AND '1199.99' THEN '62'
            WHEN VALUE BETWEEN '1200' AND '1299.99' THEN '63'
            WHEN VALUE BETWEEN '1300' AND '1399.99' THEN '64'
            WHEN VALUE BETWEEN '1400' AND '1499.99' THEN '65'
            WHEN VALUE BETWEEN '1500' AND '1599.99' THEN '66'
            WHEN VALUE BETWEEN '1600' AND '1699.99' THEN '67'
            WHEN VALUE BETWEEN '1700' AND '1799.99' THEN '68'
            WHEN VALUE BETWEEN '1800' AND '1899.99' THEN '69'
            WHEN VALUE BETWEEN '1900' AND '1999.99' THEN '70'
            WHEN VALUE BETWEEN '2000' AND '2999.99' THEN '71'
            WHEN VALUE BETWEEN '3000' AND '3999.99' THEN '72'
            WHEN VALUE BETWEEN '4000' AND '4999.99' THEN '73'
            WHEN VALUE BETWEEN '5000' AND '5999.99' THEN '74'
            WHEN VALUE BETWEEN '6000' AND '6999.99' THEN '75'
            WHEN VALUE BETWEEN '7000' AND '7999.99' THEN '76'
            WHEN VALUE BETWEEN '8000' AND '8999.99' THEN '77'
            WHEN VALUE BETWEEN '9000' AND '9999.99' THEN '78'
            ELSE '79'
         END
            消费段,
         SUM (VALUE) 销售额
    FROM SA_TRAN_HEAD
   WHERE TO_CHAR (TRAN_DATETIME, 'YYYYMMDD') BETWEEN '20131031' AND '20140519'
GROUP BY CASE
            WHEN VALUE BETWEEN '0.00' AND '9.99' THEN '1'
            WHEN VALUE BETWEEN '10' AND '19.99' THEN '2'
            WHEN VALUE BETWEEN '20' AND '29.99' THEN '3'
            WHEN VALUE BETWEEN '30' AND '39.99' THEN '4'
            WHEN VALUE BETWEEN '40' AND '49.99' THEN '5'
            WHEN VALUE BETWEEN '50' AND '59.99' THEN '6'
            WHEN VALUE BETWEEN '60' AND '69.99' THEN '7'
            WHEN VALUE BETWEEN '70' AND '79.99' THEN '8'
            WHEN VALUE BETWEEN '80' AND '89.99' THEN '9'
            WHEN VALUE BETWEEN '90' AND '99.99' THEN '10'
            WHEN VALUE BETWEEN '100' AND '109.99' THEN '11'
            WHEN VALUE BETWEEN '110' AND '119.99' THEN '12'
            WHEN VALUE BETWEEN '120' AND '129.99' THEN '13'
            WHEN VALUE BETWEEN '130' AND '139.99' THEN '14'
            WHEN VALUE BETWEEN '140' AND '149.99' THEN '15'
            WHEN VALUE BETWEEN '150' AND '159.99' THEN '16'
            WHEN VALUE BETWEEN '160' AND '169.99' THEN '17'
            WHEN VALUE BETWEEN '170' AND '179.99' THEN '18'
            WHEN VALUE BETWEEN '180' AND '189.99' THEN '19'
            WHEN VALUE BETWEEN '190' AND '199.99' THEN '20'
            WHEN VALUE BETWEEN '200' AND '209.99' THEN '21'
            WHEN VALUE BETWEEN '210' AND '219.99' THEN '22'
            WHEN VALUE BETWEEN '220' AND '229.99' THEN '23'
            WHEN VALUE BETWEEN '230' AND '239.99' THEN '24'
            WHEN VALUE BETWEEN '240' AND '249.99' THEN '25'
            WHEN VALUE BETWEEN '250' AND '259.99' THEN '26'
            WHEN VALUE BETWEEN '260' AND '269.99' THEN '27'
            WHEN VALUE BETWEEN '270' AND '279.99' THEN '28'
            WHEN VALUE BETWEEN '280' AND '289.99' THEN '29'
            WHEN VALUE BETWEEN '290' AND '299.99' THEN '30'
            WHEN VALUE BETWEEN '300' AND '309.99' THEN '31'
            WHEN VALUE BETWEEN '310' AND '319.99' THEN '32'
            WHEN VALUE BETWEEN '320' AND '329.99' THEN '33'
            WHEN VALUE BETWEEN '330' AND '339.99' THEN '34'
            WHEN VALUE BETWEEN '340' AND '349.99' THEN '35'
            WHEN VALUE BETWEEN '350' AND '359.99' THEN '36'
            WHEN VALUE BETWEEN '360' AND '369.99' THEN '37'
            WHEN VALUE BETWEEN '370' AND '379.99' THEN '38'
            WHEN VALUE BETWEEN '380' AND '389.99' THEN '39'
            WHEN VALUE BETWEEN '390' AND '399.99' THEN '40'
            WHEN VALUE BETWEEN '400' AND '409.99' THEN '41'
            WHEN VALUE BETWEEN '410' AND '419.99' THEN '42'
            WHEN VALUE BETWEEN '420' AND '429.99' THEN '43'
            WHEN VALUE BETWEEN '430' AND '439.99' THEN '44'
            WHEN VALUE BETWEEN '440' AND '449.99' THEN '45'
            WHEN VALUE BETWEEN '450' AND '459.99' THEN '46'
            WHEN VALUE BETWEEN '460' AND '469.99' THEN '47'
            WHEN VALUE BETWEEN '470' AND '479.99' THEN '48'
            WHEN VALUE BETWEEN '480' AND '489.99' THEN '49'
            WHEN VALUE BETWEEN '490' AND '499.99' THEN '50'
            WHEN VALUE BETWEEN '500' AND '549.99' THEN '51'
            WHEN VALUE BETWEEN '550' AND '599.99' THEN '52'
            WHEN VALUE BETWEEN '600' AND '649.99' THEN '53'
            WHEN VALUE BETWEEN '650' AND '699.99' THEN '54'
            WHEN VALUE BETWEEN '700' AND '749.99' THEN '55'
            WHEN VALUE BETWEEN '750' AND '799.99' THEN '56'
            WHEN VALUE BETWEEN '800' AND '849.99' THEN '57'
            WHEN VALUE BETWEEN '850' AND '899.99' THEN '58'
            WHEN VALUE BETWEEN '900' AND '949.99' THEN '59'
            WHEN VALUE BETWEEN '950' AND '999.99' THEN '60'
            WHEN VALUE BETWEEN '1000' AND '1099.99' THEN '61'
            WHEN VALUE BETWEEN '1100' AND '1199.99' THEN '62'
            WHEN VALUE BETWEEN '1200' AND '1299.99' THEN '63'
            WHEN VALUE BETWEEN '1300' AND '1399.99' THEN '64'
            WHEN VALUE BETWEEN '1400' AND '1499.99' THEN '65'
            WHEN VALUE BETWEEN '1500' AND '1599.99' THEN '66'
            WHEN VALUE BETWEEN '1600' AND '1699.99' THEN '67'
            WHEN VALUE BETWEEN '1700' AND '1799.99' THEN '68'
            WHEN VALUE BETWEEN '1800' AND '1899.99' THEN '69'
            WHEN VALUE BETWEEN '1900' AND '1999.99' THEN '70'
            WHEN VALUE BETWEEN '2000' AND '2999.99' THEN '71'
            WHEN VALUE BETWEEN '3000' AND '3999.99' THEN '72'
            WHEN VALUE BETWEEN '4000' AND '4999.99' THEN '73'
            WHEN VALUE BETWEEN '5000' AND '5999.99' THEN '74'
            WHEN VALUE BETWEEN '6000' AND '6999.99' THEN '75'
            WHEN VALUE BETWEEN '7000' AND '7999.99' THEN '76'
            WHEN VALUE BETWEEN '8000' AND '8999.99' THEN '77'
            WHEN VALUE BETWEEN '9000' AND '9999.99' THEN '78'
            ELSE '79'
         END;

/* Formatted on 2014/6/19 16:37:40 (QP5 v5.256.13226.35510) */
  SELECT T.XFD 消费段, SUM (I.UNIT_RETAIL * I.QTY)
    FROM SA_TRAN_ITEM I,
         (SELECT CASE
                    WHEN VALUE BETWEEN '0.00' AND '9.99' THEN '1'
                    WHEN VALUE BETWEEN '10' AND '19.99' THEN '2'
                    WHEN VALUE BETWEEN '20' AND '29.99' THEN '3'
                    WHEN VALUE BETWEEN '30' AND '39.99' THEN '4'
                    WHEN VALUE BETWEEN '40' AND '49.99' THEN '5'
                    WHEN VALUE BETWEEN '50' AND '59.99' THEN '6'
                    WHEN VALUE BETWEEN '60' AND '69.99' THEN '7'
                    WHEN VALUE BETWEEN '70' AND '79.99' THEN '8'
                    WHEN VALUE BETWEEN '80' AND '89.99' THEN '9'
                    WHEN VALUE BETWEEN '90' AND '99.99' THEN '10'
                    WHEN VALUE BETWEEN '100' AND '109.99' THEN '11'
                    WHEN VALUE BETWEEN '110' AND '119.99' THEN '12'
                    WHEN VALUE BETWEEN '120' AND '129.99' THEN '13'
                    WHEN VALUE BETWEEN '130' AND '139.99' THEN '14'
                    WHEN VALUE BETWEEN '140' AND '149.99' THEN '15'
                    WHEN VALUE BETWEEN '150' AND '159.99' THEN '16'
                    WHEN VALUE BETWEEN '160' AND '169.99' THEN '17'
                    WHEN VALUE BETWEEN '170' AND '179.99' THEN '18'
                    WHEN VALUE BETWEEN '180' AND '189.99' THEN '19'
                    WHEN VALUE BETWEEN '190' AND '199.99' THEN '20'
                    WHEN VALUE BETWEEN '200' AND '209.99' THEN '21'
                    WHEN VALUE BETWEEN '210' AND '219.99' THEN '22'
                    WHEN VALUE BETWEEN '220' AND '229.99' THEN '23'
                    WHEN VALUE BETWEEN '230' AND '239.99' THEN '24'
                    WHEN VALUE BETWEEN '240' AND '249.99' THEN '25'
                    WHEN VALUE BETWEEN '250' AND '259.99' THEN '26'
                    WHEN VALUE BETWEEN '260' AND '269.99' THEN '27'
                    WHEN VALUE BETWEEN '270' AND '279.99' THEN '28'
                    WHEN VALUE BETWEEN '280' AND '289.99' THEN '29'
                    WHEN VALUE BETWEEN '290' AND '299.99' THEN '30'
                    WHEN VALUE BETWEEN '300' AND '309.99' THEN '31'
                    WHEN VALUE BETWEEN '310' AND '319.99' THEN '32'
                    WHEN VALUE BETWEEN '320' AND '329.99' THEN '33'
                    WHEN VALUE BETWEEN '330' AND '339.99' THEN '34'
                    WHEN VALUE BETWEEN '340' AND '349.99' THEN '35'
                    WHEN VALUE BETWEEN '350' AND '359.99' THEN '36'
                    WHEN VALUE BETWEEN '360' AND '369.99' THEN '37'
                    WHEN VALUE BETWEEN '370' AND '379.99' THEN '38'
                    WHEN VALUE BETWEEN '380' AND '389.99' THEN '39'
                    WHEN VALUE BETWEEN '390' AND '399.99' THEN '40'
                    WHEN VALUE BETWEEN '400' AND '409.99' THEN '41'
                    WHEN VALUE BETWEEN '410' AND '419.99' THEN '42'
                    WHEN VALUE BETWEEN '420' AND '429.99' THEN '43'
                    WHEN VALUE BETWEEN '430' AND '439.99' THEN '44'
                    WHEN VALUE BETWEEN '440' AND '449.99' THEN '45'
                    WHEN VALUE BETWEEN '450' AND '459.99' THEN '46'
                    WHEN VALUE BETWEEN '460' AND '469.99' THEN '47'
                    WHEN VALUE BETWEEN '470' AND '479.99' THEN '48'
                    WHEN VALUE BETWEEN '480' AND '489.99' THEN '49'
                    WHEN VALUE BETWEEN '490' AND '499.99' THEN '50'
                    WHEN VALUE BETWEEN '500' AND '549.99' THEN '51'
                    WHEN VALUE BETWEEN '550' AND '599.99' THEN '52'
                    WHEN VALUE BETWEEN '600' AND '649.99' THEN '53'
                    WHEN VALUE BETWEEN '650' AND '699.99' THEN '54'
                    WHEN VALUE BETWEEN '700' AND '749.99' THEN '55'
                    WHEN VALUE BETWEEN '750' AND '799.99' THEN '56'
                    WHEN VALUE BETWEEN '800' AND '849.99' THEN '57'
                    WHEN VALUE BETWEEN '850' AND '899.99' THEN '58'
                    WHEN VALUE BETWEEN '900' AND '949.99' THEN '59'
                    WHEN VALUE BETWEEN '950' AND '999.99' THEN '60'
                    WHEN VALUE BETWEEN '1000' AND '1099.99' THEN '61'
                    WHEN VALUE BETWEEN '1100' AND '1199.99' THEN '62'
                    WHEN VALUE BETWEEN '1200' AND '1299.99' THEN '63'
                    WHEN VALUE BETWEEN '1300' AND '1399.99' THEN '64'
                    WHEN VALUE BETWEEN '1400' AND '1499.99' THEN '65'
                    WHEN VALUE BETWEEN '1500' AND '1599.99' THEN '66'
                    WHEN VALUE BETWEEN '1600' AND '1699.99' THEN '67'
                    WHEN VALUE BETWEEN '1700' AND '1799.99' THEN '68'
                    WHEN VALUE BETWEEN '1800' AND '1899.99' THEN '69'
                    WHEN VALUE BETWEEN '1900' AND '1999.99' THEN '70'
                    WHEN VALUE BETWEEN '2000' AND '2999.99' THEN '71'
                    WHEN VALUE BETWEEN '3000' AND '3999.99' THEN '72'
                    WHEN VALUE BETWEEN '4000' AND '4999.99' THEN '73'
                    WHEN VALUE BETWEEN '5000' AND '5999.99' THEN '74'
                    WHEN VALUE BETWEEN '6000' AND '6999.99' THEN '75'
                    WHEN VALUE BETWEEN '7000' AND '7999.99' THEN '76'
                    WHEN VALUE BETWEEN '8000' AND '8999.99' THEN '77'
                    WHEN VALUE BETWEEN '9000' AND '9999.99' THEN '78'
                    ELSE '79'
                 END
                    XFD,
                 TRAN_SEQ_NO
            FROM SA_TRAN_HEAD
           WHERE TO_CHAR (TRAN_DATETIME, 'YYYYMMDD') BETWEEN '20131031'
                                                         AND '20140519') T
   WHERE    SUBCLASS IN (2951,
                         2952,
                         2953,
                         2954,
                         2941,
                         2916,
                         2938,
                         2711,
                         1211,
                         1217,
                         1261,
                         1263,
                         1916,
                         1917)
         OR CLASS = 175 AND T.TRAN_SEQ_NO = I.TRAN_SEQ_NO
GROUP BY T.XFD;
       
  ;


