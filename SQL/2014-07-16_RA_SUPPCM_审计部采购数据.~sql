CREATE MATERIALIZED VIEW RADM.JIN_SUPPCM_RECEIVED_YEAR AS
SELECT SUBSTR(T.DT_WID, 2, 4) YEAR,
       Q.SUPPLIER_NUM SUPPLIER,
       P.PROD_IT_NUM ITEM,
       NVL(SUM(T.RECEIVED_QTY), 0) RECEIVED_QTY,
       NVL(SUM(T.BBG_REFERENCE_FO2), 0) RECEIVED_AMT
  FROM RADM.W_RTL_SUPPCM_IT_LC_DY_F  T,
       RABATCHER.W_PRODUCT_D_RTL_TMP P,
       RADM.W_PARTY_ORG_D            Q
 WHERE P.PROD_IT_WID = T.PROD_WID
   AND T.SUPPLIER_WID = Q.ROW_WID
   AND T.DT_WID BETWEEN 120120101000 AND 120140630000
 GROUP BY SUBSTR(T.DT_WID, 2, 4), Q.SUPPLIER_NUM, P.PROD_IT_NUM
 ORDER BY SUBSTR(T.DT_WID, 2, 4), Q.SUPPLIER_NUM, P.PROD_IT_NUM;

SELECT * FROM RABATCHER.W_PRODUCT_D_RTL_TMP P;
SELECT * FROM RADM.W_RTL_SUPPCM_IT_LC_DY_F T;
SELECT * FROM RADM.W_PARTY_D;
SELECT * FROM RADM.W_PARTY_ORG_D;
