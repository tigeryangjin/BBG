CREATE TABLE A (A INT);
CREATE TABLE B (B INT);
CREATE TABLE C (C INT);

CREATE TABLE F1 (A INT,B INT,C INT,F01 VARCHAR2(10));
CREATE TABLE F2 (A INT,B INT,C INT,F02 VARCHAR2(10));
CREATE TABLE F3 (A INT,B INT,C INT,F03 VARCHAR2(10));
CREATE TABLE F4 (A INT,B INT,C INT,F04 VARCHAR2(10));
-------------------
INSERT INTO A VALUES(1);
COMMIT;
INSERT INTO A VALUES(2);
COMMIT;
INSERT INTO A VALUES(3);
COMMIT;
INSERT INTO A VALUES(4);
COMMIT;
INSERT INTO A VALUES(5);
COMMIT;

INSERT INTO B VALUES(1);
COMMIT;
INSERT INTO B VALUES(2);
COMMIT;
INSERT INTO B VALUES(3);
COMMIT;
INSERT INTO B VALUES(4);
COMMIT;
INSERT INTO B VALUES(5);
COMMIT;

INSERT INTO C VALUES(1);
COMMIT;
INSERT INTO C VALUES(2);
COMMIT;
INSERT INTO C VALUES(3);
COMMIT;
INSERT INTO C VALUES(4);
COMMIT;
INSERT INTO C VALUES(5);
COMMIT;


SELECT * FROM A;
SELECT * FROM B;
SELECT * FROM C;
----------------------------
INSERT INTO F1 VALUES(1,1,1,'AB');
COMMIT;
INSERT INTO F1 VALUES(1,1,2,'AB');
COMMIT;
INSERT INTO F1 VALUES(1,1,3,'AB');
COMMIT;
INSERT INTO F1 VALUES(1,1,4,'AB');
COMMIT;
INSERT INTO F1 VALUES(1,1,5,'AB');
COMMIT;
INSERT INTO F1 VALUES(1,2,1,'AB');
COMMIT;
INSERT INTO F1 VALUES(1,2,2,'AB');
COMMIT;
INSERT INTO F1 VALUES(1,2,3,'AB');
COMMIT;
INSERT INTO F1 VALUES(1,2,4,'AB');
COMMIT;
INSERT INTO F1 VALUES(1,2,5,'AB');
COMMIT;
INSERT INTO F1 VALUES(1,3,1,'AB');
COMMIT;
INSERT INTO F1 VALUES(1,3,2,'AB');
COMMIT;
INSERT INTO F1 VALUES(1,3,3,'AB');
COMMIT;
INSERT INTO F1 VALUES(1,3,4,'AB');
COMMIT;
INSERT INTO F1 VALUES(1,3,5,'AB');
COMMIT;
---------------
INSERT INTO F2 VALUES(1,4,1,'AB');
COMMIT;
INSERT INTO F2 VALUES(1,4,2,'AB');
COMMIT;
INSERT INTO F2 VALUES(1,4,3,'AB');
COMMIT;
INSERT INTO F2 VALUES(1,4,4,'AB');
COMMIT;
INSERT INTO F2 VALUES(1,4,5,'AB');
COMMIT;
INSERT INTO F2 VALUES(1,2,1,'AB');
COMMIT;
INSERT INTO F2 VALUES(1,2,2,'AB');
COMMIT;
INSERT INTO F2 VALUES(1,2,3,'AB');
COMMIT;
INSERT INTO F2 VALUES(1,2,4,'AB');
COMMIT;
INSERT INTO F2 VALUES(1,2,5,'AB');
COMMIT;
INSERT INTO F2 VALUES(1,3,1,'AB');
COMMIT;
INSERT INTO F2 VALUES(1,3,2,'AB');
COMMIT;
INSERT INTO F2 VALUES(1,3,3,'AB');
COMMIT;
INSERT INTO F2 VALUES(1,3,4,'AB');
COMMIT;
INSERT INTO F2 VALUES(1,3,5,'AB');
COMMIT;
-----------------------------------------
INSERT INTO F3 VALUES(1,4,1,'AB');
COMMIT;
INSERT INTO F3 VALUES(1,4,2,'AB');
COMMIT;
INSERT INTO F3 VALUES(1,4,3,'AB');
COMMIT;
INSERT INTO F3 VALUES(1,4,4,'AB');
COMMIT;
INSERT INTO F3 VALUES(1,4,5,'AB');
COMMIT;
INSERT INTO F3 VALUES(1,5,1,'AB');
COMMIT;
INSERT INTO F3 VALUES(1,5,2,'AB');
COMMIT;
INSERT INTO F3 VALUES(1,5,3,'AB');
COMMIT;
INSERT INTO F3 VALUES(1,5,4,'AB');
COMMIT;
INSERT INTO F3 VALUES(1,5,5,'AB');
COMMIT;
INSERT INTO F3 VALUES(1,3,1,'AB');
COMMIT;
INSERT INTO F3 VALUES(1,3,2,'AB');
COMMIT;
INSERT INTO F3 VALUES(1,3,3,'AB');
COMMIT;
INSERT INTO F3 VALUES(1,3,4,'AB');
COMMIT;
INSERT INTO F3 VALUES(1,3,5,'AB');
COMMIT;
--------------------------------
INSERT INTO F4 VALUES(1,5,1,'AB');
COMMIT;
INSERT INTO F4 VALUES(1,5,2,'AB');
COMMIT;
INSERT INTO F4 VALUES(1,5,3,'AB');
COMMIT;
INSERT INTO F4 VALUES(1,5,4,'AB');
COMMIT;
INSERT INTO F4 VALUES(1,5,5,'AB');
COMMIT;
INSERT INTO F4 VALUES(1,2,1,'AB');
COMMIT;
INSERT INTO F4 VALUES(1,2,2,'AB');
COMMIT;
INSERT INTO F4 VALUES(1,2,3,'AB');
COMMIT;
INSERT INTO F4 VALUES(1,2,4,'AB');
COMMIT;
INSERT INTO F4 VALUES(1,2,5,'AB');
COMMIT;
INSERT INTO F4 VALUES(1,3,1,'AB');
COMMIT;
INSERT INTO F4 VALUES(1,3,2,'AB');
COMMIT;
INSERT INTO F4 VALUES(1,3,3,'AB');
COMMIT;
INSERT INTO F4 VALUES(1,3,4,'AB');
COMMIT;
INSERT INTO F4 VALUES(1,3,5,'AB');
COMMIT;

SELECT * FROM A;
SELECT * FROM B;
SELECT * FROM C;

SELECT * FROM F1 ORDER BY 1,2,3;
SELECT * FROM F2 ORDER BY 1,2,3;
SELECT * FROM F3 ORDER BY 1,2,3;
SELECT * FROM F4 ORDER BY 1,2,3;


CREATE TABLE RADM.ABC AS
SELECT A.A, B.B, C.C, F1.F01, F2.F02, F3.F03, F4.F04
  FROM A, B, C, F1, F2, F3, F4
 WHERE A.A = F1.A(+)
   AND A.A = F2.A(+)
   AND A.A = F3.A(+)
   AND A.A = F4.A(+)
   AND B.B = F1.B(+)
   AND B.B = F2.B(+)
   AND B.B = F3.B(+)
   AND B.B = F4.B(+)
   AND C.C = F1.C(+)
   AND C.C = F2.C(+)
   AND C.C = F3.C(+)
   AND C.C = F4.C(+)
	 ORDER BY 1,2,3;


SELECT A.A, B.B, C.C, F1.F01, F2.F02, F3.F03, F4.F04
  FROM A, B, C, F1, F2, F3, F4
 WHERE A.A = F1.A(+)
   AND A.A = F2.A(+)
   AND A.A = F3.A(+)
   AND A.A = F4.A(+)
   AND B.B = F1.B(+)
   AND B.B = F2.B(+)
   AND B.B = F3.B(+)
   AND B.B = F4.B(+)
   AND C.C = F1.C(+)
   AND C.C = F2.C(+)
   AND C.C = F3.C(+)
   AND C.C = F4.C(+)
	 ORDER BY 1,2,3;

MERGE INTO RADM.ABC T
USING (SELECT A.A, B.B, C.C, F1.F01, F2.F02, F3.F03, F4.F04
         FROM A, B, C, F1, F2, F3, F4
        WHERE A.A = F1.A(+)
          AND A.A = F2.A(+)
          AND A.A = F3.A(+)
          AND A.A = F4.A(+)
          AND B.B = F1.B(+)
          AND B.B = F2.B(+)
          AND B.B = F3.B(+)
          AND B.B = F4.B(+)
          AND C.C = F1.C(+)
          AND C.C = F2.C(+)
          AND C.C = F3.C(+)
          AND C.C = F4.C(+)
        ORDER BY 1, 2, 3) S
ON (S.A = T.A AND S.B = T.B AND S.C = T.C)
WHEN MATCHED THEN
  UPDATE SET T.F01 = S.F01, T.F02 = S.F02, T.F03 = S.F03, T.F04 = S.F04
WHEN NOT MATCHED THEN
  INSERT
    (T.A, T.B, T.C, T.F01, T.F02, T.F03, T.F04)
  VALUES
    (S.A, S.B, S.C, S.F01, S.F02, S.F03, S.F04);
COMMIT;


SELECT * FROM ABC FOR UPDATE;
