SELECT /*+PARALLEL(T,20) PARALLEL(P,20)*/
 SUBSTR(T.DT_WID, 2, 6) MONTH,
 P.PROD_DP_NUM DEPT,
 SUM(T.SLS_AMT_LCL - T.RET_AMT_LCL) SALEAMT,
 SUM(CASE
       WHEN T.HYK_NO IS NOT NULL THEN
        T.SLS_AMT_LCL - T.RET_AMT_LCL
       ELSE
        0
     END) VIPSALEAMT
  FROM RADM.W_RTL_SLS_TRX_IT_LC_DY_F T, RABATCHER.W_PRODUCT_D_RTL_TMP P
 WHERE T.PROD_WID = P.PROD_IT_WID
   AND T.DT_WID BETWEEN 120141201000 AND 120150228000
 GROUP BY SUBSTR(T.DT_WID, 2, 6), P.PROD_DP_NUM
 ORDER BY SUBSTR(T.DT_WID, 2, 6), P.PROD_DP_NUM;

--
SELECT /*+PARALLEL(T,20)*/
 *
  FROM RADM.W_RTL_SLS_TRX_IT_LC_DY_F T
 WHERE T.DT_WID BETWEEN 120141201000 AND 120150228000
   AND NOT EXISTS (SELECT /*+PARALLEL(P,20)*/
         1
          FROM RABATCHER.W_PRODUCT_D_RTL_TMP P
         WHERE T.PROD_WID = P.PROD_IT_WID);
