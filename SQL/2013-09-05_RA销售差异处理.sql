
--补销售
--销售补不进去，RABATCHER.W_PRODUCT_D_RTL_TMP表没有商品信息，经过查询，接口PLP_RetailProductDimensionLkUpTempLoad往此表插入数据。
--从RA_RMS.BBG_XTERN_RDWT_HIST取销售数据,当要补传的销售是昨日之前时,就只能这样操作.
--RMS下运行
INSERT INTO RA_RMS.BBG_XTERN_RDWT    
SELECT * FROM RA_RMS.BBG_XTERN_RDWT_HIST T WHERE T.BUSINESS_DT='20130903' AND T.LOCATION='0000120036' AND T.ITEM='100614835';
INSERT INTO RA_RMS.BBG_XTERN_RDWT 
SELECT * FROM RA_RMS.BBG_XTERN_RDWT_HIST T WHERE T.BUSINESS_DT='20130903' AND T.LOCATION='0000120113' AND T.ITEM='100614835';
INSERT INTO RA_RMS.BBG_XTERN_RDWT 
SELECT * FROM RA_RMS.BBG_XTERN_RDWT_HIST T WHERE T.BUSINESS_DT='20130903' AND T.LOCATION='0000120151' AND T.ITEM='100620750';
INSERT INTO RA_RMS.BBG_XTERN_RDWT 
SELECT * FROM RA_RMS.BBG_XTERN_RDWT_HIST T WHERE T.BUSINESS_DT='20130903' AND T.LOCATION='0000120151' AND T.ITEM='100622341';
INSERT INTO RA_RMS.BBG_XTERN_RDWT 
SELECT * FROM RA_RMS.BBG_XTERN_RDWT_HIST T WHERE T.BUSINESS_DT='20130903' AND T.LOCATION='0000120151' AND T.ITEM='100622376';
INSERT INTO RA_RMS.BBG_XTERN_RDWT 
SELECT * FROM RA_RMS.BBG_XTERN_RDWT_HIST T WHERE T.BUSINESS_DT='20130903' AND T.LOCATION='0000120151' AND T.ITEM='100622472';
INSERT INTO RA_RMS.BBG_XTERN_RDWT 
SELECT * FROM RA_RMS.BBG_XTERN_RDWT_HIST T WHERE T.BUSINESS_DT='20130903' AND T.LOCATION='0000120170' AND T.ITEM='100620389';
INSERT INTO RA_RMS.BBG_XTERN_RDWT 
SELECT * FROM RA_RMS.BBG_XTERN_RDWT_HIST T WHERE T.BUSINESS_DT='20130903' AND T.LOCATION='0000120170' AND T.ITEM='800420671';

SELECT * FROM RA_RMS.BBG_XTERN_RDWT@RA_RMS_DBLINK;

TRUNCATE TABLE RA_RMS.C_LOAD_DATES;

--修改视图日期条件
RA_RMS.BBG_RA_ITEM_LOC_SOH_V


--RADM
--检查销售没有传过来的商品在RA商品维度中是否存在
SELECT * FROM W_PRODUCT_D T WHERE T.PROD_NUM IN ('800420671','100620750','100620418','100620805','100617892');
SELECT * FROM RABATCHER.W_PRODUCT_D_RTL_TMP T WHERE T.PROD_IT_NUM='800420671'

--首先查询W_RTL_SLS_TRX_IT_LC_DY_FS是否有数据,如果有,则可以跳过SDE步骤.
SELECT * FROM W_RTL_SLS_TRX_IT_LC_DY_FS;

CREATE TABLE W_RTL_SLS_TRX_IT_LC_DY_FS_0904 AS
SELECT * FROM W_RTL_SLS_TRX_IT_LC_DY_FS T WHERE (T.ORG_NUM='120036' AND T.PROD_IT_NUM='100614835')
OR (T.ORG_NUM='120063' AND T.PROD_IT_NUM='100620750')
OR (T.ORG_NUM='120113' AND T.PROD_IT_NUM='100620418')
OR (T.ORG_NUM='120144' AND T.PROD_IT_NUM='100620805')
OR (T.ORG_NUM='120190' AND T.PROD_IT_NUM='100617892');

TRUNCATE TABLE W_RTL_SLS_TRX_IT_LC_DY_FS;

INSERT INTO W_RTL_SLS_TRX_IT_LC_DY_FS
SELECT * FROM W_RTL_SLS_TRX_IT_LC_DY_FS_0904;

TRUNCATE TABLE RADM.C_LOAD_DATES;

--查询W_RTL_SLS_TRX_IT_LC_DY_TMP是否有数据.
SELECT * FROM RABATCHER.W_RTL_SLS_TRX_IT_LC_DY_TMP T WHERE T.ORG_NUM='120036' AND T.PROD_IT_NUM='100614835';
--SELECT * FROM W_RTL_SLS_TRX_IT_LC_DY_F T WHERE T.PROD_WID=262356 AND T.ORG_WID=47 AND T.DT_WID='120130904000';




