INSERT INTO W_PRODUCT_DS 
(PRODUCT_TYPE_CODE,UOM_CODE,SRC_EFF_FROM_DT,DATASOURCE_NUM_ID,INTEGRATION_ID,PROD_CAT5,PACK_FLG,PROD_CAT5_AS_WAS,PROD_NUM,BBG_ITEM_BRAND,BBG_ITEM_UOM_DESC)
SELECT ITEM.ITEM_NUMBER_TYPE,ITEM.STANDARD_UOM,DATE'2013-09-02',1/*DATASOURCE_NUM_ID*/,
ITEM.ITEM,DIVISION.DIVISION||'~'||GROUPS.GROUP_NO||'~'||ITEM.DEPT||'~'||ITEM.CLASS||'~'||ITEM.SUBCLASS, /*PROD_CAT5*/
ITEM.PACK_IND,/*PACK_FLG*/ 
DIVISION.DIVISION||'~'||GROUPS.GROUP_NO||'~'||ITEM.DEPT||'~'||ITEM.CLASS||'~'||ITEM.SUBCLASS,/*PROD_CAT5_AS_WAS*/
ITEM.ITEM /*PROD_NUM*/,
BBG_RA_ITEM_CUSTOM_V.BBG_ITEM_BRAND /*BBG_ITEM_BRAND*/,
UOM_CLASS.UOM_DESC /*BBG_ITEM_UOM_DESC*/
FROM ITEM_MASTER@RA_RMS_DBLINK ITEM,
     DIVISION@RA_RMS_DBLINK DIVISION,
     GROUPS@RA_RMS_DBLINK GROUPS,
     BBG_RA_ITEM_CUSTOM_V@RA_RMS_DBLINK BBG_RA_ITEM_CUSTOM_V,
     UOM_CLASS@RA_RMS_DBLINK UOM_CLASS,
     DEPS@RA_RMS_DBLINK DEPS
WHERE GROUPS.DIVISION=DIVISION.DIVISION
 AND ITEM.STANDARD_UOM=UOM_CLASS.UOM
 AND DEPS.GROUP_NO=GROUPS.GROUP_NO
 AND ITEM.DEPT=DEPS.DEPT
 AND ITEM.ITEM=BBG_RA_ITEM_CUSTOM_V.ITEM
 AND ITEM.STATUS='A'
/* AND (ITEM.PACK_IND='N' OR (ITEM.PACK_IND='Y' AND NOT EXISTS (SELECT 'X'
            FROM QUALIFY(V_PACKSKU_QTY) V_PACKSKU1,QUALIFY(ITEM_MASTER) IM1
            WHERE V_PACKSKU1.PACK_NO = ITEM.ITEM 
            AND V_PACKSKU1.ITEM = IM1.ITEM
            AND IM1.ITEM_XFORM_IND = 'Y'
            AND ROWNUM = 1)))*/
 AND ITEM.ITEM_XFORM_IND!='Y'
 AND ITEM.ITEM LIKE '100622%'
 AND NOT EXISTS(SELECT 1 FROM W_PRODUCT_D T WHERE T.PROD_NUM=ITEM.ITEM AND T.PROD_NUM LIKE '100622%');





SELECT * FROM W_PRODUCT_D T WHERE T.PROD_NUM LIKE '100622%';

SELECT * FROM ITEM_MASTER@RA_RMS_DBLINK T WHERE T.STATUS='A' AND  T.ITEM LIKE '100622%';

SELECT * FROM W_PRODUCT_DS T WHERE T.PROD_NUM LIKE '100622%';

SELECT * FROM RA_RMS.W_RTL_ITEM_D_TMP@RA_RMS_DBLINK T WHERE T.PROD_IT_NUM LIKE '100622%';

SELECT * FROM ITEM_MASTER@RA_RMS_DBLINK T WHERE T.STATUS='A' AND  T.ITEM IN ( '100622499','100622501');
SELECT * FROM W_PRODUCT_DS T WHERE T.PROD_NUM LIKE '100622%';

select SUBSTR(TO_CHAR(TO_DATE(trim(PARAM_VALUE), 'YYYYMMDD'),'YYYY-MM-DD'),1,10)
from RA_RMS.RA_SRC_CURR_PARAM_G@RA_RMS_DBLINK
where param_name='VDATE'

DS
100622499
100622501


 

SELECT * FROM DIVISION@RA_RMS_DBLINK;
SELECT * FROM GROUPS@RA_RMS_DBLINK;
SELECT * FROM DEPS@RA_RMS_DBLINK
