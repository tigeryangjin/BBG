/* DETECTION_STRATEGY = NOT_EXISTS */
insert into   RABATCHER.W_RTL_SLS_IT_LC_DY_TMP T
  (
  ORG_WID,
  ORG_SCD1_WID,
  PROD_IT_WID,
  PROD_SCD1_WID,
  VOUCHER_FLG,
  RTL_TYPE_WID,
  EMPLOYEE_WID,
  ORG_LC_WID,
  ORG_DS_WID,
  ORG_RG_WID,
  ORG_AR_WID,
  ORG_CH_WID,
  PROD_DV_WID,
  PROD_GP_WID,
  PROD_DP_WID,
  PROD_CL_WID,
  PROD_SC_WID,
  DT_WID,
  WK_WID,
  PR_WID,
  QT_WID,
  DAY_DT,
  WK_NUM,
  PR_NUM,
  QT_NUM,
  ORG_NUM,
  ORG_DS_NUM,
  ORG_RG_NUM,
  ORG_AR_NUM,
  ORG_CH_NUM,
  PROD_IT_NUM,
  PROD_SC_NUM,
  PROD_CL_NUM,
  PROD_DP_NUM,
  PROD_GP_NUM,
  PROD_DV_NUM,
  RTL_TYPE_CODE,
  SLS_QTY,
  SLS_AMT_LCL,
  SLS_PROFIT_AMT_LCL,
  SLS_MANUAL_MKDN_AMT_LCL,
  SLS_MANUAL_MKUP_AMT_LCL,
  SLS_TAX_AMT_LCL,
  SLS_EMP_DISC_AMT_LCL,
  SLS_MANUAL_COUNT,
  SLS_SCAN_COUNT,
  RET_QTY,
  RET_AMT_LCL,
  RET_PROFIT_AMT_LCL,
  RET_MANUAL_MKDN_AMT_LCL,
  RET_MANUAL_MKUP_AMT_LCL,
  RET_TAX_AMT_LCL,
  RET_EMP_DISC_AMT_LCL,
  RET_MANUAL_COUNT,
  RET_SCAN_COUNT,
  SLS_TRX_COUNT,
  RET_TRX_COUNT,
  AUX1_CHANGED_ON_DT,
  AUX2_CHANGED_ON_DT,
  AUX3_CHANGED_ON_DT,
  AUX4_CHANGED_ON_DT,
  CHANGED_BY_ID,
  CHANGED_ON_DT,
  CREATED_BY_ID,
  CREATED_ON_DT,
  DATASOURCE_NUM_ID,
  DELETE_FLG,
  DOC_CURR_CODE,
  GLOBAL1_EXCHANGE_RATE,
  GLOBAL2_EXCHANGE_RATE,
  GLOBAL3_EXCHANGE_RATE,
  LOC_CURR_CODE,
  LOC_EXCHANGE_RATE,
  TENANT_ID,
  X_CUSTOM,
  BBG_ITEM_LOC_WID,
  BBG_RETAIL_TYPE_WID,
  BBG_CUSTOMER_COUNT,
  BBG_SERVICE_SATISFACTION,
  BBG_REFERENCE_DO1,
  BBG_REFERENCE_DO2,
  BBG_REFERENCE_DO3,
  BBG_REFERENCE_DO4,
  BBG_REFERENCE_DO5,
  BBG_REFERENCE_FO1,
  BBG_REFERENCE_FO2,
  BBG_REFERENCE_FO3,
  BBG_REFERENCE_FO4,
  BBG_REFERENCE_FO5,
  BBG_REFERENCE_FO6,
  BBG_REFERENCE_FO7,
  BBG_REFERENCE_FO8,
  BBG_REFERENCE_FO9,
  BBG_REFERENCE_FO10,
  BBG_RETAIL_TYPE_ID
  
  )
select     W_RTL_SLS_TRX_IT_LC_DY_TMP.ORG_WID,
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.ORG_SCD1_WID),
  W_RTL_SLS_TRX_IT_LC_DY_TMP.PROD_IT_WID,
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.PROD_SCD1_WID),
  (CASE
WHEN SUM((CASE
WHEN  W_RTL_SLS_TRX_IT_LC_DY_TMP.VOUCHER_ID = '-1' THEN  -1 
ELSE 0
END )) <= 0 THEN  'N'
ELSE 'Y'
END ),
  W_RTL_SLS_TRX_IT_LC_DY_TMP.RTL_TYPE_WID,
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.EMPLOYEE_WID),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.ORG_LC_WID),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.ORG_DS_WID),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.ORG_RG_WID),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.ORG_AR_WID),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.ORG_CH_WID),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.PROD_DV_WID),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.PROD_GP_WID),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.PROD_DP_WID),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.PROD_CL_WID),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.PROD_SC_WID),
  W_RTL_SLS_TRX_IT_LC_DY_TMP.DT_WID,
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.WK_WID),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.PR_WID),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.QT_WID),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.DAY_DT),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.WK_NUM),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.PR_NUM),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.QT_NUM),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.ORG_NUM),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.ORG_DS_NUM),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.ORG_RG_NUM),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.ORG_AR_NUM),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.ORG_CH_NUM),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.PROD_IT_NUM),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.PROD_SC_NUM),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.PROD_CL_NUM),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.PROD_DP_NUM),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.PROD_GP_NUM),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.PROD_DV_NUM),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.RTL_TYPE_CODE),
  SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_QTY),
  SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_AMT_LCL),
  SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_PROFIT_AMT_LCL),
  SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_MANUAL_MKDN_AMT_LCL),
  SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_MANUAL_MKUP_AMT_LCL),
  SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_TAX_AMT_LCL),
  SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_EMP_DISC_AMT_LCL),
  SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_MANUAL_COUNT),
  SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_SCAN_COUNT),
  SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.RET_QTY),
  SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.RET_AMT_LCL),
  SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.RET_PROFIT_AMT_LCL),
  SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.RET_MANUAL_MKDN_AMT_LCL),
  SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.RET_MANUAL_MKUP_AMT_LCL),
  SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.RET_TAX_AMT_LCL),
  SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.RET_EMP_DISC_AMT_LCL),
  SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.RET_MANUAL_COUNT),
  SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.RET_SCAN_COUNT),
  COUNT(
DISTINCT(
(CASE
WHEN (W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_MANUAL_COUNT >0 AND W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_SCAN_COUNT >0) THEN W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_TRX_ID
ELSE NULL
END )
)),
  COUNT(
DISTINCT(
(CASE
WHEN (W_RTL_SLS_TRX_IT_LC_DY_TMP.RET_MANUAL_COUNT >0 AND W_RTL_SLS_TRX_IT_LC_DY_TMP.RET_SCAN_COUNT >0) THEN W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_TRX_ID
ELSE NULL
END )
)),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.AUX1_CHANGED_ON_DT),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.AUX2_CHANGED_ON_DT),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.AUX3_CHANGED_ON_DT),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.AUX4_CHANGED_ON_DT),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.CHANGED_BY_ID),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.CHANGED_ON_DT),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.CREATED_BY_ID),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.CREATED_ON_DT),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.DATASOURCE_NUM_ID),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.DELETE_FLG),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.DOC_CURR_CODE),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.GLOBAL1_EXCHANGE_RATE),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.GLOBAL2_EXCHANGE_RATE),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.GLOBAL3_EXCHANGE_RATE),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.LOC_CURR_CODE),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.LOC_EXCHANGE_RATE),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.TENANT_ID),
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.X_CUSTOM),
  W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_ITEM_LOC_WID,
  W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_RETAIL_TYPE_WID,
  count(distinct W_RTL_SLS_TRX_IT_LC_DY_TMP.SLS_TRX_ID ),
  avg(W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_SERVICE_SATISFACTION),
  W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_DO1,
  W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_DO2,
  W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_DO3,
  W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_DO4,
  W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_DO5,
  SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO1),
  SUM(W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO2),
  W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO3,
  W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO4,
  W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO5,
  W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO6,
  W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO7,
  W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO8,
  W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO9,
  W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO10,
  MAX(W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_RETAIL_TYPE_ID)
  
from  RABATCHER.W_RTL_SLS_TRX_IT_LC_DY_TMP   W_RTL_SLS_TRX_IT_LC_DY_TMP
where  (1=1)


Group By W_RTL_SLS_TRX_IT_LC_DY_TMP.ORG_WID,
 W_RTL_SLS_TRX_IT_LC_DY_TMP.PROD_IT_WID,
 W_RTL_SLS_TRX_IT_LC_DY_TMP.RTL_TYPE_WID,
 W_RTL_SLS_TRX_IT_LC_DY_TMP.DT_WID,
 W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_ITEM_LOC_WID,
 W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_RETAIL_TYPE_WID,
 W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_DO1,
 W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_DO2,
 W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_DO3,
 W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_DO4,
 W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_DO5,
 W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO3,
 W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO4,
 W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO5,
 W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO6,
 W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO7,
 W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO8,
 W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO9,
 W_RTL_SLS_TRX_IT_LC_DY_TMP.BBG_REFERENCE_FO10


