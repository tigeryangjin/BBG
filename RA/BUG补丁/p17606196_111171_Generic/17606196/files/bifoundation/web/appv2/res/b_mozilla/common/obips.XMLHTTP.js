obips.XMLHTTP=function(){};obips.XMLHTTP.XMLHttpRequestObjectPool=new Array();obips.XMLHTTP.getXMLHttpRequestObject=function(){var b=null;if(obips.XMLHTTP.XMLHttpRequestObjectPool.length>0){b=obips.XMLHTTP.XMLHttpRequestObjectPool.shift();b.abort()}else{if(window.XMLHttpRequest){b=new XMLHttpRequest()}else{try{b=new ActiveXObject("Msxml2.XMLHTTP")}catch(a){try{b=new ActiveXObject("Microsoft.XMLHTTP")}catch(a){throw new Error("This browser doesn't provide an XMLHttpRequest object.")}}}}return b};obips.XMLHTTP.syncGetRequest=function(b,e){var d=obips.XMLHTTP.getXMLHttpRequestObject();d.open("get",b,false);d.setRequestHeader("X-OBIPS-AJAX",1);d.send(null);var c=1;while(c<4&&(d.status==1500||d.status==undefined)){d=obips.XMLHTTP.getXMLHttpRequestObject();d.open("get",b,false);d.setRequestHeader("X-OBIPS-AJAX",1);d.send(null);c++}if(d.status==undefined){throw new Error("XMLHttpRequest returned with 'status = undefined'.")}else{if(d.status==500){alert("We are having difficulty communicating with the server - please try again later.\nSorry for any inconvenience this has caused.");if(window.obips_debug){alert("Error loading XML Document from "+b+". \nThe response given was:\n"+d.responseText)}return null}else{if(d.status!=200){alert("Error loading XML Document from "+b+". \nThe response given was:\n"+d.responseText);return null}}}obips.XMLHTTP.XMLHttpRequestObjectPool.push(d);var a=null;if(d.responseXML&&d.responseXML.childNodes.length>0){if(saw.userAgent.is_ie10up){a=obips.XMLDOM.parseXML(d.responseText,false)}else{a=d.responseXML}}else{if(e=="text/plain"){a=d.responseText}else{a=obips.XMLDOM.parseXML(d.responseText,false)}}return a};obips.XMLHTTP.syncPostRequest=function(a,d){var c=obips.XMLHTTP.getXMLHttpRequestObject();c.open("post",a,false);c.send(d);var b=1;while(b<4&&(c.status==500||c.status==undefined)){c=obips.XMLHTTP.getXMLHttpRequestObject();c.open("get",a,false);c.send(d);b++}if(c.status==undefined){throw new Error("XMLHttpRequest returned with 'status = undefined'.")}else{if(c.status==500){alert("We are having difficulty communicating with the server - please try again later.\nSorry for any inconvenience this has caused.");if(window.obips_debug){alert("Error loading XML Document from "+a+". \nThe response given was:\n"+c.responseText)}return null}else{if(c.status!=200){alert("Error loading XML Document from "+a+". \nThe response given was:\n"+c.responseText);return null}}}obips.XMLHTTP.XMLHttpRequestObjectPool.push(c);return c.responseXML||c.text};obips.XMLHTTP.syncSOAPAction=function(b,c,e){var d=obips.XMLHTTP.getXMLHttpRequestObject();d.open("POST",b,false);d.setRequestHeader("SOAPAction",c);d.send(e);obips.XMLHTTP.XMLHttpRequestObjectPool.push(d);var a=null;if(saw.userAgent.is_ie10up){a=obips.XMLDOM.parseXML(d.responseText,false)}else{a=d.responseXML}return a};obips.XMLHTTP.createSoapEnvelope=function(){var d=obips.XMLDOM.createXMLDom();var c="http://schemas.xmlsoap.org/soap/envelope/";var b=obips.XMLDOM.createElementNS(d,c,"Envelope");var a=obips.XMLDOM.createElementNS(d,c,"Body");b.appendChild(a);d.appendChild(b);return d};obips.XMLHTTP.AJAX=function(){};obips.XMLHTTP.AJAX.Request=function(a,d,c,f,e,b){this.url=a;this.payload=d;this.soapAction=c;this.okCallback=f;this.errorCallback=e||new obips.Callback(null,obips.XMLHTTP.AJAX.defaultErrorHandler);this.attempt=b};obips.XMLHTTP.AJAX.RequestQueue=function(){var a=obips.getSingleton(obips.XMLHTTP.AJAX.RequestQueue.SINGLETON_NAME);if(a){return a}this.timeoutID=null;this.queryIntervalMS=5000;this.requestQueue=null;this.responseQueue=null;this.reset();globalRegister.addObject(obips.XMLHTTP.AJAX.RequestQueue.SINGLETON_NAME,this)};obips.XMLHTTP.AJAX.RequestQueue.SINGLETON_NAME="ajaxRequestQueue";obips.XMLHTTP.AJAX.RequestQueue.getSingleton=function(){return obips.getSingleton(obips.XMLHTTP.AJAX.RequestQueue.SINGLETON_NAME)};obips.XMLHTTP.AJAX.RequestQueue.prototype.hasPendingRequest=function(){return this.requestQueue.length!=0||this.responseQueue.queue.length!=0};obips.XMLHTTP.AJAX.RequestQueue.prototype.reset=function(){if(this.timeoutID!=null){clearTimeout(this.timeoutID)}this.requestQueue=new Array();this.responseQueue=new obips.XMLHTTP.AJAX.ResponseQueue()};obips.XMLHTTP.AJAX.RequestQueue.prototype.add=function(a){if(!a.attempt){a.attempt=1}this.requestQueue.push(a)};obips.XMLHTTP.AJAX.RequestQueue.prototype.run=function(){this.suspend();if(this.requestQueue.length>0&&this.responseQueue.queue.length<3){var b=this.requestQueue.shift();var d=obips.XMLHTTP.getXMLHttpRequestObject();var f=(b.payload)?"post":"get";d.open(f,b.url,true);if(saw.userAgent.is_ie10up){try{d.responseType="msxml-document"}catch(c){}}var a=this;this.responseQueue.addResponse(new obips.XMLHTTP.AJAX.Response(d,b));if(b.soapAction){d.setRequestHeader("SOAPAction",b.soapAction)}d.onreadystatechange=function(){a.handleReadyStateChange.call(a)};d.send(b.payload)}if(this.requestQueue.length>0){this.timeoutID=setTimeout("ajaxRequestQueue.run()",this.queryIntervalMS)}};obips.XMLHTTP.AJAX.RequestQueue.prototype.suspend=function(){if(this.timeoutID!=null){clearInterval(this.timeoutID)}this.timeoutID=null};obips.XMLHTTP.AJAX.RequestQueue.prototype.handleReadyStateChange=function(){var a=this.responseQueue.getFirstCompleteResponse();if(a&&a.xmlHttpRequest.status!=0){if(a.xmlHttpRequest.status==200){a.ajaxRequest.okCallback.functionPointer.call(a.ajaxRequest.okCallback.thisContext,a);obips.XMLHTTP.XMLHttpRequestObjectPool.push(a.xmlHttpRequest)}else{obips.XMLHTTP.AJAX.errorHandler(a)}}};obips.XMLHTTP.AJAX.Response=function(b,a){this.xmlHttpRequest=b;this.ajaxRequest=a};obips.XMLHTTP.AJAX.errorHandler=function(a){if(a.xmlHttpRequest.status==500&&a.ajaxRequest.attempt<=3){ajaxRequestQueue.add(new obips.XMLHTTP.AJAX.Request(a.ajaxRequest.url,a.ajaxRequest.payload,a.ajaxRequest.soapAction,a.ajaxRequest.okCallback,a.ajaxRequest.errorCallback,a.ajaxRequest.attempt+1));ajaxRequestQueue.run()}else{a.ajaxRequest.errorCallback.functionPointer.call(a.ajaxRequest.errorCallback.thisContext,a)}};obips.XMLHTTP.AJAX.defaultErrorHandler=function(a){alert("Error loading XML Document from "+a.ajaxRequest.url+". \nThe response given was: Status "+a.xmlHttpRequest.status+"\n"+a.xmlHttpRequest.responseText)};obips.XMLHTTP.AJAX.ResponseQueue=function(){this.queue=new Array()};obips.XMLHTTP.AJAX.ResponseQueue.prototype.addResponse=function(a){this.queue.push(a)};obips.XMLHTTP.AJAX.ResponseQueue.prototype.getFirstCompleteResponse=function(){var a=null;for(var b=0;b<this.queue.length;b++){if(this.queue[b].xmlHttpRequest.readyState==4){a=this.queue.splice(b,1)[0];break}}return a};obips.XMLHTTP.AJAX.ResponseQueue.prototype.reset=function(){if(this.queue.length>0){for(var a=0;a<this.queue.length;a++){this.queue[a].xmlHttpRequest.abort()}}this.queue=new Array()};var ajaxRequestQueue=new obips.XMLHTTP.AJAX.RequestQueue();