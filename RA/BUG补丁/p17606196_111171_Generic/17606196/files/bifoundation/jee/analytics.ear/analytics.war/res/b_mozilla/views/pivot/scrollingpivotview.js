if(typeof(scrollingpivotview_js)=="undefined"){scrollingpivotview_js=true;obips.ScrollingPivotTable=function(G,aj,d,V,l,f,m,h,u,R,aa,x,z,ag,W,ah,F,e,T,w){obips.ScrollingPivotTable.baseConstructor.call(this,G,aj,d,V,l,f,m,h,u,R,aa,x,z,ag,W,ah,F,e,T);this.idList=d.split(",");this._childScrollInfo=[];var af=saw.userAgent.is_ie7;if(af){var y=this.getHtmlElement();if(y){var D=obips.ResourceManager.getSingleton();var a="views/pivot/obips.gridview.xml";y.innerHTML=D.getResource(a,"kmsgNoScrollingSupportForIE7").getString()}return}var s=(s&&w=="toParent");var B=0;var Z=0;if(s){var o=this.getHtmlElement().parentNode;B=o.offsetWidth;Z=o.offsetHeight}for(var ac=0;ac<this.idList.length;ac++){var N=this.idList[ac];var M=document.getElementById("scrolling_"+this.idList[ac]);if(!M){continue}var Q=M.children[0];var n=this._getChildById(N,"PPRTarget");var K=this._getChildById(N,"Corner");var O=this._getChildById(N,"ColHeader");var t=this._getChildById(N,"ColHeaderScrollbarSpacer");var q=this._getChildById(N,"RowHeaderLabel");var g=this._getChildById(N,"RowHeader");var U=this._getChildById(N,"Databody");var A=this._getChildById(N,"DatabodyScroller");var H=A.children[0];var L=this._getChildById(N,"RowHeaderScrollbarSpacer");var E=this._getChildById(N,"CornerScrollbarSpacer");var ab=this._getChildById(N,"StatusBar");var C=(this._statusBar!=null);var Y=this._getChildById(N,"ri");var b=this._getChildById(N,"FetchStatus");var S=this._getChildById(N,"ScrollbarTesterParent");var P=this._getChildById(N,"MoreRows");var k=this._getChildById(N,"MoreCols");var p=this._getChildById(N,"AxisVerticalTitle");var v=this._getChildById(N,"AxisVertical");var ae=this._getChildById(N,"AxisHorizontalTitle");var J=this._getChildById(N,"AxisHorizontal");var X=saw.isRToL();var ad=0;var I=0;if(B==0){B=this.getIntAttribute(M,"_width")}if(B<75){B=75}if(Z==0){Z=this.getIntAttribute(M,"_height")}if(Z<75){Z=75}var ai={id:N,container:M,innerContainer:Q,pprTarget:n,corner:K,rowHeader:g,colHeader:O,rowHeaderLabel:q,databody:U,databodyScroller:A,databodyScrollerCanvas:H,statusBar:ab,hasStatusBar:C,colHeaderScrollbarSpacer:t,rowHeaderScrollbarSpacer:L,cornerScrollbarSpacer:E,_resizeIndicator:Y,_fetchStatus:b,scrollbarTester:S,moreRows:P,moreCols:k,axisVerticalTitle:p,axisVertical:v,axisHorizontalTitle:ae,axisHorizontal:J,rightToLeft:X,lastScrollHorizPos:ad,lastScrollTop:I,maxWidth:B,maxHeight:Z};this._childScrollInfo[this.idList[ac]]=ai;this.setupEdgeConstants(ai);this.initBuffer(ai);this.initBlock(ai);this._lastRequestInLocalQueue;if(!saw.userAgent.is_touchdevice){saw.addEventListener(ai.rowHeader,"scroll",this.handleRowHdrScroll);saw.addEventListener(ai.databodyScroller,"scroll",this.HandleDomScroll);if(saw.userAgent.is_ie8){}else{if(saw.userAgent.is_nav){saw.addEventListener(ai.databody,"DOMMouseScroll",this.handleMouseWheel);saw.addEventListener(ai.databodyScroller,"DOMMouseScroll",this.handleMouseWheel);saw.addEventListener(ai.rowHeader,"DOMMouseScroll",this.handleMouseWheel)}else{ai.databody.onmousewheel=this.handleMouseWheel;ai.databodyScroller.onmousewheel=this.handleMouseWheel;ai.rowHeader.onmousewheel=this.handleMouseWheel}}}else{saw.addEventListener(ai.databody,"touchstart",this.handleTouchStart);saw.addEventListener(ai.databody,"touchmove",this.handleTouchMove);saw.addEventListener(ai.rowHeader,"touchstart",this.handleTouchStart);saw.addEventListener(ai.rowHeader,"touchmove",this.handleTouchMove);saw.addEventListener(ai.colHeader,"touchstart",this.handleTouchStart);saw.addEventListener(ai.colHeader,"touchmove",this.handleTouchMove)}}};extend(obips.ScrollingPivotTable,obips.PivotTable);obips.ScrollingPivotTable.prototype.setupEdgeConstants=function(a){a.edgeConstants=[];a.edgeConstants[obips.ScrollingPivotTable.COLUMN_EDGE]={scrollPos:"scrollLeft",maxScrollPos:"_maxScrollHorizPos",lastScrollPos:"_lastScrollHorizPos"};a.edgeConstants[obips.ScrollingPivotTable.ROW_EDGE]={scrollPos:"scrollTop",maxScrollPos:"_maxScrollTop",lastScrollPos:"_lastScrollTop"}};obips.ScrollingPivotTable.prototype.getEdgeConstants=function(a,b){return a.edgeConstants[b]};obips.ScrollingPivotTable.viewsHandlingAjax=new Object();obips.ScrollingPivotTable.DATABODY=-1;obips.ScrollingPivotTable.COLUMN_EDGE=0;obips.ScrollingPivotTable.ROW_EDGE=1;obips.ScrollingPivotTable.PAGE_EDGE=2;obips.ScrollingPivotTable.AXIS_VERTICAL=3;obips.ScrollingPivotTable.AXIS_HORIZONTAL=4;obips.ScrollingPivotTable.ROW_PIVOT_HANDLES=2;obips.ScrollingPivotTable.COL_PIVOT_HANDLES=3;obips.ScrollingPivotTable.MAYBE=-1;obips.ScrollingPivotTable.CELL_EXTRA_WIDTH=9;obips.ScrollingPivotTable.CELL_EXTRA_HEIGHT=3;obips.ScrollingPivotTable.CONTAINER_EXTRA_WIDTH=0;obips.ScrollingPivotTable.CONTAINER_EXTRA_HEIGHT=0;obips.ScrollingPivotTable.COLUMN_HEADER_EXTRA_WIDTH=1;obips.ScrollingPivotTable.COLUMN_HEADER_EXTRA_HEIGHT=0;obips.ScrollingPivotTable.ROW_HEADER_EXTRA_WIDTH=0;obips.ScrollingPivotTable.ROW_HEADER_EXTRA_HEIGHT=1;obips.ScrollingPivotTable.DATABODY_EXTRA_WIDTH=1;obips.ScrollingPivotTable.DATABODY_EXTRA_HEIGHT=1;obips.ScrollingPivotTable.DATABODY_SCROLLER_EXTRA_WIDTH=1;obips.ScrollingPivotTable.DATABODY_SCROLLER_EXTRA_HEIGHT=1;obips.ScrollingPivotTable.COLUMN_HEADER_SCROLLBAR_SPACER_EXTRA_WIDTH=1;obips.ScrollingPivotTable.COLUMN_HEADER_SCROLLBAR_SPACER_EXTRA_HEIGHT=0;obips.ScrollingPivotTable.ROW_HEADER_SCROLLBAR_SPACER_EXTRA_WIDTH=0;obips.ScrollingPivotTable.ROW_HEADER_SCROLLBAR_SPACER_EXTRA_HEIGHT=2;obips.ScrollingPivotTable.PLACEHOLDER_ROW_HEIGHT=1;obips.ScrollingPivotTable.FETCH_EVENT_TYPE="fetch";obips.ScrollingPivotTable.FETCH_TYPE_INITIAL="initBlock";obips.ScrollingPivotTable.FETCH_TYPE_INITIAL_FILL_VIEWPORT="initialFillViewport";obips.ScrollingPivotTable.FETCH_TYPE_SHORT_SCROLL="shortScroll";obips.ScrollingPivotTable.FETCH_TYPE_LONG_SCROLL="longScroll";obips.ScrollingPivotTable.FETCH_TYPE_NO_FETCH_REQUIRED="noFetchRequired";obips.ScrollingPivotTable.FETCH_TYPE_MORE_COLS="moreCols";obips.ScrollingPivotTable.FETCH_TYPE_MORE_ROWS="moreRows";obips.ScrollingPivotTable.FETCH_TYPE_HIER_DRILL_OR_COLLAPSE="hierDrillOrCollapse";obips.ScrollingPivotTable.getFetchTypeString=function(a){if(isNaN(a)){return a}else{switch(a){case obips.ScrollingPivotTable.FETCH_TYPE_LONG_SCROLL:return"replace_buffer";case obips.ScrollingPivotTable.FETCH_TYPE_SHORT_SCROLL:return"augment_buffer";case obips.ScrollingPivotTable.FETCH_TYPE_NO_FETCH_REQUIRED:return"no_fetch_needed"}}return"unknown_fetch_type"};obips.ScrollingPivotTable.DELAY_INITIAL=0;obips.ScrollingPivotTable.DELAY_FILL_VIEWPORT=0;obips.ScrollingPivotTable.DELAY_SHORT_SCROLL=50;obips.ScrollingPivotTable.DELAY_LONG_SCROLL=800;obips.ScrollingPivotTable.PIVOT_BEFOREAFTER_MARGIN=5;obips.ScrollingPivotTable.COLUMN_RESIZE_MARGIN=3;obips.ScrollingPivotTable.ROW_RESIZE_MARGIN=1;obips.ScrollingPivotTable.MIN_COLUMN_WIDTH=10;obips.ScrollingPivotTable.MIN_ROW_HEIGHT=10;obips.ScrollingPivotTable.MIN_ROW_HEADER_WIDTH=10;obips.ScrollingPivotTable.MIN_COL_HEADER_HEIGHT=10;obips.ScrollingPivotTable.prototype.handleRowHdrScroll=function(a,l,d){var b=null;var k;if(l){k=obips.ViewModel.getViewModelById(l);b=k._childScrollInfo[d]}else{var f=saw.getEventTarget(a);k=obips.ViewModel.getViewModelById(f.parentNode.parentNode.id.slice(10));b=k._childScrollInfo[f.parentNode.parentNode.id.slice(10)]}var h=b.rowHeader;var e=b.rowHeaderLabel;var g=h.scrollLeft;e.scrollLeft=g};obips.ScrollingPivotTable.prototype.HandleDomScroll=function(b,p,k){var f=null;var o=null;if(p){o=obips.ViewModel.getViewModelById(p);f=o._childScrollInfo[k]}else{var m=saw.getEventTarget(b);o=obips.ViewModel.getViewModelById(m.parentNode.parentNode.id.slice(10));f=o._childScrollInfo[m.parentNode.parentNode.id.slice(10)]}if(f._ignoreScrollPosChange){return}var m=saw.getEventTarget(b);var n;var t=null;if(m){t=m.id}if(t=="Databody"){n=f.databody}else{if(t=="RowHeader"){n=f.rowHeader}else{if(t=="ColHeader"){n=f.colHeader}else{n=f.databodyScroller}}}var e=n.scrollTop;var u=o.getScrollHorizPos(f,n);if((e==f.lastScrollTop)&&(u==f.lastScrollHorizPos)){return}f.lastScrollTop=e;f.lastScrollHorizPos=u;var l=o.getOldScrollPos(f,obips.ScrollingPivotTable.ROW_EDGE);var g=o.getOldScrollPos(f,obips.ScrollingPivotTable.COLUMN_EDGE);var a=e-l;var h=u-g;var d=o.rangeOfBlocksOverlappingShiftedViewport(f,obips.ScrollingPivotTable.ROW_EDGE,a);var q=o.rangeOfBlocksOverlappingShiftedViewport(f,obips.ScrollingPivotTable.COLUMN_EDGE,h);var s=o.identifyScrollType(f,d,q);switch(s){case obips.ScrollingPivotTable.FETCH_TYPE_LONG_SCROLL:o.longJump(f,a,h,d,q,e,u);break;case obips.ScrollingPivotTable.FETCH_TYPE_SHORT_SCROLL:o._hideStatus(f._fetchStatus);o.shortScrollWithFetch(f,a,h,d,q);break;case obips.ScrollingPivotTable.FETCH_TYPE_NO_FETCH_REQUIRED:o._hideStatus(f._fetchStatus);o.scrollHTMLBlocks(f,null,n);break}o.showMoreRowsColsWhenNecessary(f,s)};obips.ScrollingPivotTable.prototype.showMoreRowsColsWhenNecessary=function(b,e){if(typeof(e)=="undefined"||e==obips.ScrollingPivotTable.FETCH_TYPE_NO_FETCH_REQUIRED){var a=b.databodyScroller;var g=b._lastVertPage;if(g=="false"){if(a.scrollTop+a._height+1>=a.scrollHeight){this._showMoreRows(b)}else{this._hideMoreRows(b)}}var d=b._lastHorizPage;if(d=="false"){var f=this.getScrollHorizPos(b,a);if(f+a._width+1>=a.scrollWidth){this._showMoreCols(b)}else{this._hideMoreCols(b)}}}};obips.ScrollingPivotTable.prototype.handleTouchStart=function(b){var a=saw.getEventTarget(b);var d=obips.DatabodyCoords.findCoords(a);if(!d){d=obips.EdgeCoords.findCoords(a)}masterPivotTable=obips.ViewModel.getViewModelById(d.getId());var e=b.touches[0];masterPivotTable.lastTouchY=e.pageY;masterPivotTable.lastTouchX=e.pageX};obips.ScrollingPivotTable.prototype.handleTouchMove=function(a){var d=obips.ScrollingPivotTable.DATABODY;var h=saw.getEventTarget(a);var q=obips.DatabodyCoords.findCoords(h);if(!q){q=obips.EdgeCoords.findCoords(h);d=q.getEdge()}masterPivotTable=obips.ViewModel.getViewModelById(q.getId());var e=masterPivotTable._childScrollInfo[q.getId()];var g=a.touches[0];var n=masterPivotTable.lastTouchX;var l=masterPivotTable.lastTouchY;masterPivotTable.lastTouchX=g.pageX;masterPivotTable.lastTouchY=g.pageY;var p=masterPivotTable.lastTouchY-l;var o=masterPivotTable.lastTouchX-n;var k=e.databodyScroller;k.scrollTop-=p;if(d==obips.ScrollingPivotTable.DATABODY||d==obips.ScrollingPivotTable.COLUMN_EDGE){k.scrollLeft-=o}else{if(d==obips.ScrollingPivotTable.ROW_EDGE){var f=e.rowHeaderLabel;var m=e.rowHeader;f.scrollLeft-=o;m.scrollLeft-=o}else{if(d==obips.ScrollingPivotTable.COLUMN_EDGE){var b=e.colHeader;b.scrollLeft-=o}}}masterPivotTable.HandleDomScroll(a,q.getId(),q.getId());a.preventDefault();a.stopPropagation()};obips.ScrollingPivotTable.prototype.handleMouseWheel=function(e){var d=saw.getEventCurrentTarget(e);var f=obips.ViewModel.getViewModelById(d.parentNode.parentNode.id.slice(10));var b=f._childScrollInfo[d.parentNode.parentNode.id.slice(10)];var a=b.databodyScroller;var g=Math.round(e.detail?e.detail/3:-e.wheelDelta/120);a.scrollTop+=32*g;e.stopPropagation();e.preventDefault()};obips.ScrollingPivotTable.prototype.handleScrollResponse=function(d,h){var g=this.getArrivingBlocks(d.pprTarget,d.id,obips.ScrollingPivotTable.DATABODY);if((h!="moreRows"&&h!="moreCols")&&!this.requestMatchesResponse(this._lastRequestInLocalQueue,g,h)){if(obips.ViewModelBase.logEnabled){obips.ViewModelBase.log("Last request doesn't match response in handleScrollResponse")}return}obips.ViewModelBase.log("handleScrollResponse %s",h);switch(h){case obips.ScrollingPivotTable.FETCH_TYPE_LONG_SCROLL:case obips.ScrollingPivotTable.FETCH_TYPE_HIER_DRILL_OR_COLLAPSE:d._rowHeaderStartPixel_Key=d.rowHeader.scrollLeft;d._columnHeaderStartPixel_Key=d.colHeader.scrollTop;if(h==obips.ScrollingPivotTable.FETCH_TYPE_HIER_DRILL_OR_COLLAPSE){var a=d.pprTarget;d._colExtent=this.getIntAttribute(a,"_cExtent");d._rowExtent=this.getIntAttribute(a,"_rExtent")}var b=g[0];var f=this.getIntAttribute(b,"_startRow");var k=this.getIntAttribute(b,"_startCol");this.removeAllBlocks(d);this.addBlocksToBuffer(d);var e=this.sizeInitialHTMLBlocks(d,f,k,true);this.sizePivotTable(d,d.maxWidth,d.maxHeight);this.positionInitialBlocks(d,f,k,e);this.markBlocksNotNew(d);this.hackIE(d);this.fetchNearbyBlocks(d,true);break;case obips.ScrollingPivotTable.FETCH_TYPE_SHORT_SCROLL:case obips.ScrollingPivotTable.FETCH_TYPE_MORE_COLS:case obips.ScrollingPivotTable.FETCH_TYPE_MORE_ROWS:case obips.ScrollingPivotTable.FETCH_TYPE_INITIAL_FILL_VIEWPORT:vertDelta=d.databodyScroller.scrollTop-this.getOldScrollPos(d,obips.ScrollingPivotTable.ROW_EDGE);horizDelta=this.getScrollHorizPos(d)-this.getOldScrollPos(d,obips.ScrollingPivotTable.COLUMN_EDGE);this.trimBuffer(d,vertDelta,horizDelta);this.addBlocksToBuffer(d);this.sizeNewHTMLBlocks(d);if(h==obips.ScrollingPivotTable.FETCH_TYPE_MORE_COLS||h==obips.ScrollingPivotTable.FETCH_TYPE_MORE_ROWS){this.resetInitBlock(d)}this.sizePivotTable(d,d.maxWidth,d.maxHeight);this.positionNewHTMLBlocks(d,vertDelta,horizDelta);this.scrollHTMLBlocks(d,true,null);this.setViewportStartSliceFromPosition(d);this.highlightNewBlocks(d);this.markBlocksNotNew(d);this.fetchNearbyBlocks(d,true);if(h==obips.ScrollingPivotTable.FETCH_TYPE_MORE_ROWS){d.databodyScroller.scrollTop+=32}break}this._hideStatus(d._fetchStatus);this.showMoreRowsColsWhenNecessary(d)};obips.ScrollingPivotTable.prototype.fetchNearbyBlocks=function(b,e,g,f,a,d){if(g==undefined){g=0}if(f==undefined){f=0}if(a==undefined){a=this.rangeOfBlocksOverlappingShiftedViewport(b,obips.ScrollingPivotTable.ROW_EDGE,g)}if(d==undefined){d=this.rangeOfBlocksOverlappingShiftedViewport(b,obips.ScrollingPivotTable.COLUMN_EDGE,f)}return this.requestAllBlocksInRange(b,e,d.start,d.end,a.start,a.end)};obips.ScrollingPivotTable.prototype.isShiftedViewportSatisfied=function(a,d,b){return(b.start!=-1&&b.end!=a.buffers[d].length)};obips.ScrollingPivotTable.prototype.doesBufferOverlapShiftedViewport=function(b,e,d){if(e==obips.ScrollingPivotTable.COLUMN_EDGE&&b._colExtent==0){return true}var f=d.start;var a=d.end;return !(f==a&&(f==-1||f==b.buffers[e].length))};obips.ScrollingPivotTable.prototype.identifyScrollType=function(g,f,l){var b=this.doesBufferOverlapShiftedViewport(g,obips.ScrollingPivotTable.ROW_EDGE,f);var e=this.doesBufferOverlapShiftedViewport(g,obips.ScrollingPivotTable.COLUMN_EDGE,l);var h=b&&e;if(!h){return obips.ScrollingPivotTable.FETCH_TYPE_LONG_SCROLL}var k=this.isShiftedViewportSatisfied(g,obips.ScrollingPivotTable.ROW_EDGE,f);var d=this.isShiftedViewportSatisfied(g,obips.ScrollingPivotTable.COLUMN_EDGE,l);var a=k&&d;if(a){return obips.ScrollingPivotTable.FETCH_TYPE_NO_FETCH_REQUIRED}else{return obips.ScrollingPivotTable.FETCH_TYPE_SHORT_SCROLL}};obips.ScrollingPivotTable.prototype.rangeOfBlocksOverlappingShiftedViewport=function(d,g,z){if(z==undefined){z=0}switch(g){case obips.ScrollingPivotTable.COLUMN_EDGE:var k="_horizPos";var s="_width";var y=d.colHeaderBuffer;var w=d._colExtent;break;case obips.ScrollingPivotTable.ROW_EDGE:k="_top";s="_height";y=d.rowHeaderBuffer;w=d._rowExtent;break}var x=d.databody;var t=z;var q=z+x[s];var l=y.length;var e=-2;var m=l;var f=y[0];var a=f[k];if(a>t){e=-1}else{for(var v=0;v<l;++v){var n=y[v];var h=n[k];var p=n[s];var u=h+p;if(t<u){e=v;break}if(p==0&&t==u){e=v;break}}}if(e==-2){return{start:l,end:l}}if(e==-1){if(q<=a){return{start:-1,end:-1}}var b=0;var n=y[0];startSlice=this.getIntAttribute(n,"_startSlice");if(startSlice==0){e=0}}else{var b=e}for(var v=b;v<l;++v){var n=y[v];var h=n[k];var p=n[s];var u=h+p;if(q<=u){m=v;break}}if(m==l){var n=y[l-1];startSlice=this.getIntAttribute(n,"_startSlice");numSlices=this.getIntAttribute(n,"_numSlices");var o=startSlice+numSlices;if(o>=w){--m}}return{start:e,end:m}};obips.ScrollingPivotTable.prototype.firstSliceInShiftedViewport=function(f,b,p,a){if(a==undefined){a=this.rangeOfBlocksOverlappingShiftedViewport(f,b,p)}var g=f.buffers[b];var t=a.start;if(t==-1||t==g.length){return{slice:-1,pixel:-1}}var l=g[t];var q=l.children[0];var s=q.rows;var h;var o;var k;if(b==obips.ScrollingPivotTable.ROW_EDGE){h=l._top-p;o=s;k="offsetHeight"}else{h=l._horizPos-p;o=s[0].cells;k="offsetWidth"}for(var m=1;m<o.length;++m){var n=o[m];var e=n[k];h+=e;if(h>0){var d=this.getIntAttribute(l,"_startSlice");return{slice:d+m-1,pixel:e-h}}}if(obips.ViewModelBase.logEnabled){obips.ViewModelBase.log("firstSliceInShiftedViewport completed without finding a first slice, which shouldn't happen")}return{slice:-1,pixel:-1}};obips.ScrollingPivotTable.prototype.requestAllBlocksInRange=function(U,u,F,W,N,b,s){if(obips.ViewModelBase.logEnabled){obips.ViewModelBase.log("requestAllBlocksInRange: %s %s %s %s",F,W,N,b)}var A=this.getPivotViewXML();var K=obips.PivotTable.isTable(A);var Q=U.rowHeaderBuffer;var Y=U.colHeaderBuffer;var w=U.databodyBuffer;var g=Q.length;var l=Y.length;var X=[];var p=Q.length;var v=[p];for(var R=0;R<p;R++){v[R]=false}p=Y.length;var d=[p];for(var R=0;R<p;R++){d[R]=false}var E=false;var h=false;var H=false;var z=false;if(F==-1){F=0;E=true}if(N==-1){N=0;H=true}if(W==l){W-=1;if(!K&&U._colExtent>0){h=true}}if(b==g){b-=1;z=true}var S=new Array(l);for(var V=F;V<=W;++V){var O=Y[V];var T={};T.needColHeaderBlock=(O._placeholder)?true:false;T.startCol=this.getIntAttribute(O,"_startSlice");T.numCols=this.getIntAttribute(O,"_numSlices");S[V]=T}if(E){var q={};q.needColHeaderBlock=true;q.numCols=Math.min(this._colBlockSize,S[0].startCol);q.startCol=S[0].startCol-q.numCols}if(h){var L={};L.needColHeaderBlock=true;L.startCol=S[W].startCol+S[W].numCols;L.numCols=Math.min(this._colBlockSize,U._colExtent-L.startCol)}for(var M=N;M<=b;++M){var J=Q[M];var o=(J._placeholder)?true:false;var e=this.getIntAttribute(J,"_startSlice");var D=this.getIntAttribute(J,"_numSlices");var I=w[M];for(var V=F;V<=W;++V){if(I[V]==null){var P=S[V];var k=this.createBlockParameters(P.startCol,e,P.needColHeaderBlock,o,P.numCols,D);X.push(k);if(!o){v[M]=true}if(!P.needColHeaderBlock){d[V]=true}}}if(E){var k=this.createBlockParameters(q.startCol,e,q.needColHeaderBlock,o,q.numCols,D);X.push(k);if(!o){v[M]=true}}if(h){var k=this.createBlockParameters(L.startCol,e,L.needColHeaderBlock,o,L.numCols,D);X.push(k);if(!o){v[M]=true}}}if(H){var o=true;var t=Q[0];var a=this.getIntAttribute(t,"_startSlice");var D=Math.min(this._rowBlockSize,a);var e=a-D;for(var V=F;V<=W;++V){var P=S[V];var k=this.createBlockParameters(P.startCol,e,P.needColHeaderBlock,o,P.numCols,D);X.push(k);if(!P.needColHeaderBlock){d[V]=true}}if(E){var k=this.createBlockParameters(q.startCol,e,false,false,q.numCols,D);X.push(k)}if(h){var k=this.createBlockParameters(L.startCol,e,false,false,L.numCols,D);X.push(k)}}if(z){var o=true;var y=Q[b];var G=this.getIntAttribute(y,"_startSlice");var m=this.getIntAttribute(y,"_numSlices");var e=G+m;var D=Math.min(this._rowBlockSize,U._rowExtent-e);for(var V=F;V<=W;++V){var P=S[V];var k=this.createBlockParameters(P.startCol,e,P.needColHeaderBlock,o,P.numCols,D);X.push(k);if(!P.needColHeaderBlock){d[V]=true}}if(K){var k=this.createBlockParameters(0,e,false,o,0,D);X.push(k)}if(E){var k=this.createBlockParameters(q.startCol,e,false,false,q.numCols,D);X.push(k)}if(h){var k=this.createBlockParameters(L.startCol,e,false,false,L.numCols,D);X.push(k)}}var C=[];var B=null;var x=null;var p=v.length;for(var R=0;R<p;R++){if(v[R]){var e=this.getIntAttribute(Q[R],"_startSlice");var f=this.getSizeString(false,Q[R]);var n=this.createSizingParameter(true,false,e,f);C.push(n)}}var p=d.length;for(var R=0;R<p;R++){if(d[R]){var e=this.getIntAttribute(Y[R],"_startSlice");var f=this.getSizeString(true,Y[R]);var n=this.createSizingParameter(false,true,e,f);C.push(n)}}if(B==null){B=this.getRowHeaderWidths(U)}if(x==null){x=this.getColumnHeaderHeights(U)}if(X.length>0){if(u){this.fetchBlocks(U,obips.ScrollingPivotTable.FETCH_TYPE_INITIAL_FILL_VIEWPORT,obips.ScrollingPivotTable.DELAY_FILL_VIEWPORT,X,null,C,B,x)}else{if(typeof(s)=="undefined"){s=obips.ScrollingPivotTable.FETCH_TYPE_SHORT_SCROLL}this.fetchBlocks(U,s,obips.ScrollingPivotTable.DELAY_SHORT_SCROLL,X,null,C,B,x)}return true}return false};obips.ScrollingPivotTable.prototype.scrollHTMLBlocks=function(b,l,u){if(!u){u=b.databodyScroller}var w=(u.id=="Databody");var y=(u.id=="RowHeader");var z=b.rowHeaderBuffer;var g=b.colHeaderBuffer;var h=b.databodyBuffer;var o=b.axisVerticalBuffer;var x=b.axisHorizontalBuffer;var m=z.length;var q=g.length;if(m==0||q==0){return}var e=u.scrollTop;var d=this.getScrollHorizPos(b,u);var v=l||(e-this.getOldScrollPos(b,obips.ScrollingPivotTable.ROW_EDGE))!=0;if(v){for(var t=0;t<m;t++){var a=z[t];if(!y&&!a._placeholder){var f=this.getNewBlockPos(obips.ScrollingPivotTable.ROW_EDGE,a,e);this._setCachedTop(a,f)}var k=h[t];for(var s=0;s<q;s++){var n=k[s];if(!w&&n){f=this.getNewBlockPos(obips.ScrollingPivotTable.ROW_EDGE,n,e);this._setCachedTop(n,f)}}var p=o[t];if(p&&(!p._placeholder)){f=this.getNewBlockPos(obips.ScrollingPivotTable.AXIS_VERTICAL,p,e);this._setCachedTop(p,f)}}this.setViewportStartSliceFromPosition(b,obips.ScrollingPivotTable.ROW_EDGE)}v=!y&&(l||(d-this.getOldScrollPos(b,obips.ScrollingPivotTable.COLUMN_EDGE))!=0);if(v){for(s=0;s<q;s++){a=g[s];if(!a._placeholder){f=this.getNewBlockPos(obips.ScrollingPivotTable.COLUMN_EDGE,a,d);this.setHorizPos(b,f,a)}var p=x[s];if(p&&(!p._placeholder)){f=this.getNewBlockPos(obips.ScrollingPivotTable.AXIS_HORIZONTAL,p,d);this.setHorizPos(b,f,p)}}for(t=0;t<m;t++){k=h[t];for(s=0;s<q;s++){n=k[s];if(!w&&n){f=this.getNewBlockPos(obips.ScrollingPivotTable.COLUMN_EDGE,n,d);this.setHorizPos(b,f,n)}}}this.setViewportStartSliceFromPosition(b,obips.ScrollingPivotTable.COLUMN_EDGE)}};obips.ScrollingPivotTable.prototype.setScrollPos=function(b,f,e,d){var k=this.getEdgeConstants(b,f);var h=b[k.maxScrollPos];var a=b.databodyScroller;e=Math.min(e,h);e=Math.max(e,0);if(b.rightToLeft&&f==obips.ScrollingPivotTable.COLUMN_EDGE){var g=b.maxScrollHorizPos-e}else{var g=e}if(!d){b._ignoreScrollPosChange=true;try{this[k.lastScrollPos]=e;a[k.scrollPos]=g}finally{b._ignoreScrollPosChange=false}}else{a[k.scrollPos]=g}return e};obips.ScrollingPivotTable.prototype.trySettingScrollPos=function(a,e,d,b){if(obips.ViewModelBase.logEnabled){obips.ViewModelBase.log("trySettingScrollPos %s %s %s",obips.JSDataLayout.getViewXMLEdgeName(e),d,b)}if(this.scrollbarExists(a,e)){return this.setScrollPos(a,e,d,b)}else{return 0}};obips.ScrollingPivotTable.prototype.scrollbarExists=function(a,b){var e=this.getEdgeConstants(a,b);var d=a[e.maxScrollPos];return(d>0)};obips.ScrollingPivotTable.prototype.fetchBlocks=function(b,d,f,a,o,h,n,k){this.logBlockInfo(d,a);var e={_fetchType:d,_blocks:a,_size:o,_databodySizing:h,_rowHeaderWidths:n,_colHeaderHeights:k,_eventId:b.id};this.setLastRequestInLocalQueue(e);if(f){var l=new Function("var c = arguments.callee;c._self._processFetchTimeout(c._sTop, c._sLeft, c._event);");var g=b.databodyScroller;l._sTop=g.scrollTop;l._sLeft=g.scrollLeft;l._event=e;l._self=this;var m=setTimeout(l,f)}else{this._queueFetchEventImmediately(b,e)}};obips.ScrollingPivotTable.prototype._processFetchTimeout=function(f,g,e){var d=this._childScrollInfo[e._eventId];var a=d.databodyScroller;var b=e._fetchType;if((b==obips.ScrollingPivotTable.FETCH_TYPE_LONG_SCROLL&&(a.scrollTop!=f||a.scrollLeft!=g))||(b==obips.ScrollingPivotTable.FETCH_TYPE_SHORT_SCROLL&&(!this._lastRequestInLocalQueue||!this.requestsMatch(this._lastRequestInLocalQueue,e)))){if(obips.ViewModelBase.logEnabled){obips.ViewModelBase.log("Bailing out of fetch in LongScroll/ShortScroll check - user scrolled far enough that these are no longer needed")}return}this._queueFetchEventImmediately(d,e)};obips.ScrollingPivotTable.prototype._queueFetchEventImmediately=function(f,w){var F=this._lastRequestInFrameworkQueue;if(F&&this.requestsMatch(F,w)){if(obips.ViewModelBase.logEnabled){obips.ViewModelBase.log("Bailing out of fetch in match check - we have already sent a duplicate request")}return}this.setLastRequestInLocalQueue(w);this.setLastRequestInFrameworkQueue(w);if(w._fetchType==obips.ScrollingPivotTable.FETCH_TYPE_SHORT_SCROLL||w._fetchType==obips.ScrollingPivotTable.FETCH_TYPE_LONG_SCROLL){var s=obips.ResourceManager.getSingleton();var C="views/pivot/obips.gridview.xml";this._displayStatus(f,s.getResource(C,"kmsgScrollingGridViewFetchingData").getString())}var e=obips.ScrollingPivotTable.superClass.getReportXML.call(this);var H;var D;var l;var k;var I;var b;var g;var x;var A;var d;for(var B=0;B<w._blocks.length;B++){if(B==0){H=w._blocks[B].includeColHeaderBlock;D=w._blocks[B].includeRowHeaderBlock;l=w._blocks[B].numCols;k=w._blocks[B].numRows;I=w._blocks[B].startCol;b=w._blocks[B].startRow;g=b;A=I;if(w._fetchType=="longScroll"){var G=f.pprTarget;var q=this.getIntAttribute(G,"_rblocksize");var p=this.getIntAttribute(G,"_cblocksize");x=b+q;d=I+p}else{x=b+k;d=I+l}}else{H+=":"+w._blocks[B].includeColHeaderBlock;D+=":"+w._blocks[B].includeRowHeaderBlock;l+=":"+w._blocks[B].numCols;k+=":"+w._blocks[B].numRows;I+=":"+w._blocks[B].startCol;b+=":"+w._blocks[B].startRow;x=w._blocks[B].startRow+w._blocks[B].numRows;d=w._blocks[B].startCol+w._blocks[B].numCols}}var a="";var v="";for(var B=0;B<w._databodySizing.length;B++){if(w._databodySizing[B].isWidth==true){var J=w._databodySizing[B].sizes.lastIndexOf(",");var o=w._databodySizing[B].sizes.substr(0,J);if(a.length==0){a=w._databodySizing[B].startSlice.toString();a+=":"+o}else{a+=","+o}}else{if(v.length>0){v+=":"}v+=w._databodySizing[B].sizes}}var u=0;var n=0;var z=0;var E=0;if(w._fetchType=="longScroll"){u=g;n=x;z=A;E=d}else{var K=f.rowHeaderBuffer;if(K.length>0){u=this.getIntAttribute(K[0],"_startSlice");if(g<u){u=g;n=this.getIntAttribute(K[K.length-1],"_startSlice")+this.getIntAttribute(K[K.length-1],"_numSlices")}else{n=x}}var h=f.colHeaderBuffer;if(h.length>0){z=this.getIntAttribute(h[0],"_startSlice");if(A<z){z=A;E=this.getIntAttribute(h[h.length-1],"_startSlice")+this.getIntAttribute(h[h.length-1],"_numSlices")}else{E=d}}}var y={P5:w._blocks[0].startRow,fetchType:w._fetchType,childScrollingPivotId:f.id,numBlocks:w._blocks.length,includeRowHeaderBlock:D.toString(),includeColHeaderBlock:H.toString(),numCols:l,numRows:k,startCol:I.toString(),startRow:b.toString(),databodyWidths:a,databodyHeights:v,rowHeaderWidths:w._rowHeaderWidths,colHeaderHeights:w._colHeaderHeights,clientRowStart:u,clientRowEnd:n,clientColStart:z,clientColEnd:E};this._updateClientStateWithEventParams(y);if(obips.ViewModelBase.logEnabled){obips.ViewModelBase.log("Raising fetchBlocks event:")}this.logBlockInfo(w._fetchType,w._blocks);var m=new obips.Callback(this,this._handleFetchBlocksResponse);m.childScrollingPivotId=f.id;var t=new obips.gridview.FetchBlocksEvent(this.getViewID(),this.reportStatePath,"fetchBlocks",y,m);obips.AnalysisEventManager.raiseReadOnlyEventWithCallback(t)};obips.ScrollingPivotTable.prototype._updateClientStateWithEventParams=function(a){var b=obips.views.ViewController.getController(this.getViewID()).getClientStateManager();b.setStateValue(this.getViewID(),"clientRowStart",a.clientRowStart);b.setStateValue(this.getViewID(),"clientRowEnd",a.clientRowEnd);b.setStateValue(this.getViewID(),"clientColStart",a.clientColStart);b.setStateValue(this.getViewID(),"clientColEnd",a.clientColEnd)};obips.ScrollingPivotTable.prototype.shortScrollWithFetch=function(b,f,e,a,d){this.fetchNearbyBlocks(b,false,f,e,a,d)};obips.ScrollingPivotTable.prototype.longJump=function(e,p,o,s,q,h,f,m,l){if(typeof(l)=="undefined"){l=true}if(!m){m=obips.ScrollingPivotTable.FETCH_TYPE_LONG_SCROLL}var d=e._rowExtent;var b=e._colExtent;var t=this.firstSliceInShiftedViewport(e,obips.ScrollingPivotTable.ROW_EDGE,p,s);var n=this.firstSliceInShiftedViewport(e,obips.ScrollingPivotTable.COLUMN_EDGE,o,q);var a=t.slice;var v=n.slice;var u=t.pixel;var g=n.pixel;var w=e.rowHeaderBuffer;var k=e.colHeaderBuffer;if(a==-1){a=this.approximateViewportStartSlice(d,h,e._canvasHeight,e.databody._height+1,e._defRowHeight,w[0]._canvasTop);u=0}if(v==-1){v=this.approximateViewportStartSlice(b,f,e._canvasWidth,e.databody._width+1,e._defColWidth,k[0]._canvasHorizPos);g=0}this.longJumpToLoc(e,a,v,u,g,m,l)};obips.ScrollingPivotTable.prototype.longJumpToLoc=function(f,a,H,F,g,u,n){var d=f._rowExtent;var b=f._colExtent;var E=this._rowBlockSize;var D=this._colBlockSize;var K=f.rowHeaderBuffer;var o=f.colHeaderBuffer;var x=4;var w=3;var s=this.getBlockStartSlice(a,E,x,d);var p=this.getBlockStartSlice(H,D,w,b);f._startRow_Key=a;f._startColumn_Key=H;f._startRowPixel_Key=F;f._startColumnPixel_Key=g;var m=(a==d)?a:a+1;var e=(H==b)?H:H+1;var l=this.getPivotViewXML();var I=obips.PivotTable.isTable(l);var v=obips.ResourceManager.getSingleton();var B="views/pivot/obips.gridview.xml";var z=v.getResource(B,"kmsgScrollingGridViewFetchingColumn").getString();z=z.replace("@1",e);var G=v.getResource(B,"kmsgScrollingGridViewFetchingRow").getString();G=G.replace("@1",m);if(!I){this._displayStatus(f,G+"<br>"+z)}else{this._displayStatus(f,G)}var C=[];C[0]=this.createBlockParameters(p,s,true,true);var J=[];var y=null;var k=null;if(u!=obips.ScrollingPivotTable.FETCH_TYPE_HIER_DRILL_OR_COLLAPSE){var q=K.length;for(var A=0;A<q;A++){var t=this.getSizeString(false,K[A]);var h=this.createSizingParameter(true,false,this.getIntAttribute(K[A],"_startSlice"),t);J.push(h)}var q=o.length;for(var A=0;A<q;A++){var t=this.getSizeString(true,o[A]);var h=this.createSizingParameter(false,true,this.getIntAttribute(o[A],"_startSlice"),t);J.push(h)}if(y==null){y=this.getRowHeaderWidths(f)}if(k==null){k=this.getColumnHeaderHeights(f)}}this.fetchBlocks(f,u,n?obips.ScrollingPivotTable.DELAY_LONG_SCROLL:0,C,undefined,J,y,k)};obips.ScrollingPivotTable.prototype.approximateViewportStartSlice=function(h,g,b,a,d,f){if((b-g)<=a){return h}else{if(g<f){return Math.floor(g/d)}else{var e=Math.ceil((b-g)/d);return h-e}}};obips.ScrollingPivotTable.prototype.getBlockStartSlice=function(b,a,d,f){if(b>=f){return Math.max(f-a,0)}else{b=Math.max(b,0);var e=b-Math.round(a/d);e=Math.min(e,f-a);e=Math.max(e,0);return e}};obips.ScrollingPivotTable.prototype.displayScrollbarSpacer=function(b,f,e,a,d){b.style.display="inline";b.style.position="absolute";this._setCachedLeft(b,f);this._setCachedTop(b,e);this._setCachedWidth(b,a);this._setCachedHeight(b,d)};obips.ScrollingPivotTable.prototype.sizePivotTable=function(aN,L,t){var ap=aN.rightToLeft;var T=aN.hasStatusBar;var aZ=true;var aq=aN.colHeader;var ay=aN.rowHeader;var n=aN.rowHeaderLabel;var Y=aN.databody;var Q=aN.databodyScroller;var U=aN.databodyScrollerCanvas;var f=aN.corner;var K=aN.statusBar;var s=aN.colHeaderScrollbarSpacer;var S=aN.rowHeaderScrollbarSpacer;var a3=aN.cornerScrollbarSpacer;var A=aN.innerContainer;var a=aN.scrollbarTester;var R=aN.axisVerticalTitle;var M=aN.axisVertical;var an=aN.axisHorizontalTitle;var at=aN.axisHorizontal;var aM=L-obips.ScrollingPivotTable.CONTAINER_EXTRA_WIDTH;var ax=t-obips.ScrollingPivotTable.CONTAINER_EXTRA_HEIGHT;var b=obips.ScrollingPivotTable.COLUMN_HEADER_EXTRA_WIDTH;var a7=obips.ScrollingPivotTable.COLUMN_HEADER_EXTRA_HEIGHT;var X=obips.ScrollingPivotTable.ROW_HEADER_EXTRA_WIDTH;var ai=obips.ScrollingPivotTable.ROW_HEADER_EXTRA_HEIGHT;var g=obips.ScrollingPivotTable.DATABODY_EXTRA_WIDTH;var aA=obips.ScrollingPivotTable.DATABODY_EXTRA_HEIGHT;var aw=obips.ScrollingPivotTable.COLUMN_HEADER_SCROLLBAR_SPACER_EXTRA_WIDTH;var aj=obips.ScrollingPivotTable.COLUMN_HEADER_SCROLLBAR_SPACER_EXTRA_HEIGHT;var aW=obips.ScrollingPivotTable.ROW_HEADER_SCROLLBAR_SPACER_EXTRA_WIDTH;var a4=obips.ScrollingPivotTable.ROW_HEADER_SCROLLBAR_SPACER_EXTRA_HEIGHT;var J=aw;var ag=a4;var e=this.getFirstHeaderBlockSize(aN.rowHeaderBuffer,"_width");var a6=this.getHeaderBlocksSize(aN.rowHeaderBuffer,"_height");var G=this.getHeaderBlocksSize(aN.colHeaderBuffer,"_width");var D=this.getFirstHeaderBlockSize(aN.colHeaderBuffer,"_height");var ak=a.offsetWidth-a.clientWidth+1;var aP=a.offsetHeight-a.clientHeight+1;var q=(T)?K.offsetHeight:0;var aO=0;var ba=0;if(R.children[0]){aO=R.children[0].offsetWidth}if(M.children[0]){ba=M.children[0].offsetWidth}var ar=aO+ba;var ac=0;var a5=0;if(an.children[0]){ac=an.children[0].offsetHeight}if(at.children[0]){a5=at.children[0].offsetHeight}var F=ac+a5;var y=aM-ar;var B=ax-q-F;var h=aN._colExtent-this.getSliceCountInBuffer(aN,obips.ScrollingPivotTable.COLUMN_EDGE);var a8=aN._rowExtent-this.getSliceCountInBuffer(aN,obips.ScrollingPivotTable.ROW_EDGE);var Z=G+(h*aN._defColWidth);var ae=a6+(a8*aN._defRowHeight);var aQ;var m;var ah;var aK;var aT;var W;var E;var l;var w;var aB;var v;var aF=this._emptyTextDiv;if(aF){aQ=false;m=false;ah=0;aK=0;var al=this.getIntAttribute(aF,"_totHorizMargin");var aD=this.getIntAttribute(aF,"_totVertMargin");emptyTextInnerDiv=this._getChildById(aN.id,aF.id+"Inner");aT=67;W=33;E=emptyTextInnerDiv.offsetWidth+al;l=emptyTextInnerDiv.offsetHeight+aD}else{var aa=this.determineScrollbarStatus(y,Z,e,X,ak,B,ae,D,a7,aP);aQ=aa[0];m=aa[1];ah=(aQ)?aP:0;aK=(m)?ak:0;var V=f._initialHeight;if(!V){aB=f.offsetHeight-1}else{aB=V}if(aB>Math.floor(0.5*B)){aB=Math.floor(0.5*B)}v=5;if(n.children[0]){w=n.children[0].offsetHeight}else{w=0}aT=Math.max(v,e+X);W=Math.max(aB,D+a7);E=Z+aK;l=ae+ah}var o=this.calcHeaderSize(y,aT,E);var z=o[0];if(aF){var ab=false;var O=false}else{var ab=o[1];var O=o[2]}var I=(ab)?aP:0;var bc=(O)?aP:0;var au=this.calcHeaderSize(B,W,l);var C=au[0];if(aF){var a2=0;var H=0}else{var a2=au[1];var H=au[2]}var a1=(a2)?ak:0;var aG=(H)?ak:0;if(aZ){var ad;var a9;ad=aT+E+ar;a9=Math.max(Math.max(aB,W),w)+l+F;y=Math.min(y,ad);B=Math.min(B,a9);aM=y;ax=B+q}var aE=y-z-ar+0;var a0=B-Math.max(aB,C)-F;var az=aE-1;var af=a0;if(H&&!a2){var aL=true;if(C==0){aL=false}var p=false;var aU=(ap)?0:y-aK-ar+0-1;var P=0;var aS=aK;var ao=aS-aw;var av=C;var aJ=av-aj;var u=0}else{if(!H&&a2){aL=true;p=true;az-=aK;aU=(ap)?0:y-aK;P=C;aS=aK;ao=aS-aw;av=a0-ah;aJ=av-aj;u=aK}else{aL=false;p=false;u=0}}if(O&&!ab){var k=true;var aX=false;horizSpacerLeft=(ap)?y-z:0;horizSpacerTop=B-ah-F;horizSpacerOuterWidth=z;horizSpacerInnerWidth=horizSpacerOuterWidth-aW;horizSpacerOuterHeight=ah;horizSpacerInnerHeight=horizSpacerOuterHeight-a4}else{if(!O&&ab){k=true;aX=true;af-=ah;horizSpacerLeft=(ap)?aK:z;horizSpacerTop=B-ah;horizSpacerOuterWidth=aE-aK;horizSpacerInnerWidth=horizSpacerOuterWidth-aW;horizSpacerOuterHeight=ah;horizSpacerInnerHeight=horizSpacerOuterHeight-a4}else{k=false;aX=false}}if((aX&&m)||(p&&aQ)){if(O){bNeedCornerScrollbarSpacer=true}else{bNeedCornerScrollbarSpacer=false}cornerSpacerLeft=(ap)?0:y-aK;cornerSpacerTop=B-ah;cornerSpacerOuterWidth=aK;cornerSpacerInnerWidth=cornerSpacerOuterWidth-J;cornerSpacerOuterHeight=ah;cornerSpacerInnerHeight=cornerSpacerOuterHeight-ag}else{bNeedCornerScrollbarSpacer=false}n.style.top=Math.max(aB,C)-w+"px";this._setCachedTop(ay,Math.max(aB,C));this._setCachedTop(Y,Math.max(aB,C));this._setCachedTop(Q,Math.max(aB,C));R.style.top=Math.max(aB,C)+"px";M.style.top=Math.max(aB,C)+"px";an.style.top=B-an.offsetHeight+"px";at.style.top=B-F+"px";if(T){this._setCachedTop(K,B);this._setCachedLeft(K,0)}if(ap){this._setCachedLeft(aq,0);this._setCachedLeft(Y,aK);this._setCachedLeft(Q,u);this._setCachedLeft(ay,aE)}else{this._setCachedLeft(aq,z);this._setCachedLeft(Y,z);this._setCachedLeft(Q,z);this._setCachedLeft(ay,0);R.style.left=y-aO+0+"px";M.style.left=y-ar+0+"px";an.style.left=z+"px";at.style.left=z+"px"}this._setCachedWidth(Q,az+0);this._setCachedHeight(Q,af-1);var x=az-aG;var am=af-bc;Q._usableWidth=x;Q._usableHeight=am;aN._maxScrollHorizPos=Math.max(0,Z-x);aN._maxScrollTop=Math.max(0,ae-am);aN._canvasWidth=Z;aN._canvasHeight=ae;U.style.width=Z+"px";U.style.height=ae+"px";var d=z-X;var aI=a0-1;var aV=aI-ai;this._setCachedWidth(ay,d+0);this._setCachedHeight(ay,aV+1);this._setCachedWidth(f,z);if(f.children[0]){f.children[0].style.width=z+"px"}this._setCachedHeight(f,Math.max(aB,C));if(f.children[0]){f.children[0].style.height=Math.max(aB,C)+"px"}n.style.width=d+"px";n.style.height=w+"px";var aR=aE;var aC=aR-b;var N=C-a7;this._setCachedWidth(aq,aC);this._setCachedHeight(aq,N);var bb=aE-aK;var aY=a0-ah-1;var aH=bb-g;var bd=aY-aA;this._setCachedWidth(Y,aH+0);this._setCachedHeight(Y,bd+1);this._setCachedWidth(M,ba);this._setCachedHeight(M,bd);if(R.children[0]!=undefined){R.style.height=bd+"px";R.children[0].style.height=bd+"px"}this._setCachedWidth(at,aC);this._setCachedHeight(at,a5);if(an.children[0]!=undefined){an.style.width=aC+"px";an.children[0].style.width=aC+"px"}if(T){this._setCachedWidth(K,aM)}if(aL){this.displayScrollbarSpacer(s,aU,P,ao,aJ)}else{s.style.display="none"}if(k){this.displayScrollbarSpacer(S,horizSpacerLeft,horizSpacerTop,horizSpacerInnerWidth,horizSpacerInnerHeight)}else{S.style.display="none"}if(bNeedCornerScrollbarSpacer){this.displayScrollbarSpacer(a3,cornerSpacerLeft,cornerSpacerTop,cornerSpacerInnerWidth,cornerSpacerInnerHeight)}else{a3.style.display="none"}if(aH==0){f.style.borderRightStyle="none";aq.style.borderBottomStyle="none";aq.style.borderRightStyle="none"}if(w==0){n.style.display="none"}Q.style.overflowX=(O)?"scroll":"hidden";Q.style.overflowY=(H)?"scroll":"hidden";this._setCachedWidth(A,aM);this._setCachedHeight(A,ax);if(aZ){this._setCachedWidth(aN.container,aM+obips.ScrollingPivotTable.CONTAINER_EXTRA_WIDTH+0);this._setCachedHeight(aN.container,ax+obips.ScrollingPivotTable.CONTAINER_EXTRA_HEIGHT+0)}};obips.ScrollingPivotTable.prototype.positionInitialBlocks=function(e,k,n,m){var b=e.id;var f=this._getChildById(b,"RowHeaderBlock::"+k);var h=this._getChildById(b,"AxisVerticalBlock::"+k);var o=this._getChildById(b,"ColHeaderBlock::"+n);var g=this._getChildById(b,"AxisHorizontalBlock::"+n);var l=this._getChildById(b,"DatabodyBlock::"+k+"::"+n);var d=this._positionInitialBlocks(e,obips.ScrollingPivotTable.ROW_EDGE,e._rowExtent,f,l,h,k,e._defRowHeight,e._canvasHeight,e._maxScrollTop,m.heightBeforeViewport,"_height",k);var q=this._positionInitialBlocks(e,obips.ScrollingPivotTable.COLUMN_EDGE,e._colExtent,o,l,g,n,e._defColWidth,e._canvasWidth,e._maxScrollHorizPos,m.widthBeforeViewport,"_width",n);var p=this.trySettingScrollPos(e,obips.ScrollingPivotTable.ROW_EDGE,d);var a=this.trySettingScrollPos(e,obips.ScrollingPivotTable.COLUMN_EDGE,q);o._top=0};obips.ScrollingPivotTable.prototype._positionInitialBlocks=function(b,g,u,a,n,p,f,q,d,m,v,w,k){var s=true;if(k>=u){var o=f*q;var t=m;var h=o-t}else{o=f*q;var l=-v;var e=o-m;h=Math.max(l,e);if(h==l){s=false}t=o-h}this.setPos(b,g,h,n);this.setPos(b,g,h,a);if(p){this.setPos(b,g,h,p)}this.setCanvasPos(g,o,n);this.setCanvasPos(g,o,a);if(p){this.setCanvasPos(g,o,p)}if(s){this.setViewportStartSliceFromPosition(b,g)}return t};obips.ScrollingPivotTable.prototype.determineScrollbarStatus=function(q,h,p,e,n,d,m,s,a,f){var o=p+h;var l=s+m;var t=q-e;var g=d-a;var b;var k;if(o>t){b=true}else{if(o<=t-n){b=false}else{b=obips.ScrollingPivotTable.MAYBE}}if(l>g){k=true}else{if(l<=g-f){k=false}else{k=obips.ScrollingPivotTable.MAYBE}}if(b===obips.ScrollingPivotTable.MAYBE){b=(k===true)}if(k===obips.ScrollingPivotTable.MAYBE){k=(b===true)}return[b,k]};obips.ScrollingPivotTable.prototype.calcHeaderSize=function(g,k,b){var h=(this._emptyTextDiv)?0.15:0.5;var d=Math.floor(h*g);var a=g-d;var e,l,f;if(g>=k+b){e=k;l=false;f=false}else{if(k<=d){e=k;l=false;f=true}else{if(b<=a){e=g-b;l=true;f=false}else{e=d;l=true;f=true}}}return[e,l,f]};obips.ScrollingPivotTable.prototype.getHeaderBlocksSize=function(b,a){var f=b.length;var e=0;for(var d=0;d<f;d++){e+=b[d][a]}return e};obips.ScrollingPivotTable.prototype.getFirstHeaderBlockSize=function(b,a){return b[0][a]};obips.ScrollingPivotTable.prototype.hasColHeaderScrollbar=function(a){return(a.colHeader._height<a.colHeaderBuffer[0]._height)};obips.ScrollingPivotTable.prototype.getColHeaderScrollbarWidth=function(a){if(this.hasColHeaderScrollbar(a)){return a.colHeader.offsetWidth-a.colHeader.clientWidth-obips.ScrollingPivotTable.COLUMN_HEADER_EXTRA_WIDTH}else{return 0}};obips.ScrollingPivotTable.prototype.sizeNewHTMLBlocks=function(a){this.coordinateNewBlockSizes(a);var h;var g=saw.userAgent.is_ie7;if(g){var e=a.rowHeaderBuffer.length;for(i=0;i<e;i++){h=a.rowHeaderBuffer[i];if(h&&h._new){}}e=a.colHeaderBuffer.length;for(i=0;i<e;i++){h=a.colHeaderBuffer[i];if(h&&h._new){}var d=a.databodyBuffer.length;for(var f=0;f<d;f++){h=a.databodyBuffer[f][i];if(h&&h._new){}}}}else{var k=a.rowHeaderBuffer.length;var b;for(i=0;i<k;i++){b=a.rowHeaderBuffer[i];if(b&&b._new){this._setCachedWidth(b,b.children[0].offsetWidth)}}}};obips.ScrollingPivotTable.prototype.coordinateNewBlockSizes=function(e){var d=saw.userAgent.is_ie;var b=e.colHeaderBuffer.length;var l=[];for(var p=0;p<b;p++){var o=e.colHeaderBuffer[p];if(o){if(o._new){var h=[];var k=e.databodyBuffer.length;for(var n=0;n<k;n++){var g=e.databodyBuffer[n][p];if(g&&g._new){h.push(g)}}this.coordinateHTMLBlockColumnWidths(e,o,h)}l.push(o)}}var b=e.rowHeaderBuffer.length;for(var n=0;n<b;n++){var f=e.rowHeaderBuffer[n];if(f._new){var h=[];var m=[];var a=e.databodyBuffer[0].length;for(p=0;p<a;p++){var g=e.databodyBuffer[n][p];if(g&&g._new){if(d&&e.rightToLeft){g.childNodes[0].style.position="absolute"}h.push(g)}else{m.push(g)}}this.coordinateHTMLBlockRowHeights(e,f,h,m,n)}else{var h=[];var m=[];var a=e.databodyBuffer[0].length;for(p=0;p<a;p++){var g=e.databodyBuffer[n][p];if(g&&g._new){if(d&&e.rightToLeft){g.childNodes[0].style.position="absolute"}h.push(g)}else{m.push(g)}}if(h.length>0){this.coordinateHTMLBlockRowHeights(e,f,h,m,n)}}}this.coordinateColumnHeaderRowHeights(e,l)};obips.ScrollingPivotTable.prototype.sizeInitialHTMLBlocks=function(f,n,a,e){var b=f.id;var g=this._getChildById(b,"RowHeaderBlock::"+n);var m=this._getChildById(b,"ColHeaderBlock::"+a);var h=this._getChildById(b,"DatabodyBlock::"+n+"::"+a);var l={};var k=Math.round(this.coordinateHTMLBlockColumnWidths(f,m,[h],l));this.setInitialRowHeaderBlockColumnWidths(f,g);this.coordinateColumnHeaderRowHeights(f,[m]);var d=Math.round(this.coordinateHTMLBlockRowHeights(f,g,[h],undefined,undefined,l));if(e){f._defColWidth=k;f._defRowHeight=d}return l};obips.ScrollingPivotTable.prototype.setInitialRowHeaderBlockColumnWidths=function(a,b){var g=a.rowHeaderLabel.children[0];var o=b.children[0];var d=o.rows[0].cells;var e=d.length-1;var l=new Array(e);var k=0;for(var f=0;f<e;f++){var n;var h=this.getIntAttribute(d[f+1],"_winW");if(h!=undefined){n=h}else{n=d[f+1].offsetWidth}if(g){n=Math.max(n,g.rows[0].cells[f+1].offsetWidth)}l[f]=n;k=k+n}for(f=0;f<e;f++){d[f+1].style.width=(l[f])+"px";if(g){g.rows[0].cells[f+1].style.width=(l[f])+"px"}}var p=a.corner.offsetWidth-2;if(p>k){k=p}b.style.width=k+"px";b._width=k;b.children[0].style.width=k+"px";if(g){if(saw.userAgent.is_ie8){var m=g.offsetHeight;g.style.width=k+"px";g.style.height=m+"px"}else{g.style.width=k+"px"}}a.rowHeader.scrollLeft=a._rowHeaderStartPixel_Key};obips.ScrollingPivotTable.prototype.positionNewHTMLBlocks=function(a,p,h){var q,o;var w=a.rowHeaderBuffer;var d=w.length;var s=null;var m=w[0];if(!m._new){s=m}var f=this.getIntAttribute(m,"_startSlice");m._canvasTop=a._defRowHeight*f;for(q=1;q<d;q++){var n=m;m=w[q];if(s==null&&!m._new){s=m}m._canvasTop=n._canvasTop+n._height;m.style.left="0px"}var b=a.colHeaderBuffer;d=b.length;var t=null;m=b[0];if(!m._new){t=m}f=this.getIntAttribute(m,"_startSlice");this.setCanvasHorizPos(a._defColWidth*f,m);for(q=1;q<d;q++){n=m;m=b[q];if(t==null&&!m._new){t=m}this.setCanvasHorizPos(n._canvasHorizPos+n._width,m);m.style.top="0px"}var k=a.databodyBuffer;d=k.length;for(q=0;q<d;q++){var l=k[q];var g=l.length;var u=w[q];for(o=0;o<g;o++){m=l[o];m._canvasTop=u._canvasTop;this.setCanvasHorizPos(b[o]._canvasHorizPos,m)}}var e=s._top-p;var v=t._horizPos-h;this.trySettingScrollPos(a,obips.ScrollingPivotTable.ROW_EDGE,s._canvasTop-e);this.trySettingScrollPos(a,obips.ScrollingPivotTable.COLUMN_EDGE,t._canvasHorizPos-v)};obips.ScrollingPivotTable.prototype.coordinateHTMLBlockColumnWidths=function(b,d,s,B){var w=d.children[0];var h=s.length;var t=w.rows[0].cells;var k=t.length-1;var q=new Array(k);var g=0;var D=b._startColumn_Key;var f=this.getIntAttribute(d,"_startSlice");var E=D-f-1;var p=0;var v={},o=this,x=[];x.push.apply(x,arguments);function l(){o.coordinateHTMLBlockColumnWidths.apply(o,x);o.sizePivotTable(b,b.maxWidth,b.maxHeight);o.scrollHTMLBlocks(b,null,null)}for(var z=0;z<k;z++){var A;var a=this.getIntAttribute(t[z+1],"_winW");if(a!=undefined){A=a}else{A=t[z+1].offsetWidth;for(var u=0;u<h;u++){var C=s[u].children[0];var m=C.rows[0].cells;var n=m[z+1].offsetWidth;A=Math.max(A,n);this._onImgsLoaded(C,l,v)}}q[z]=A;g=g+A;if(z==E){p=g}}if(B){p+=b._startColumnPixel_Key;B.widthBeforeViewport=p}for(z=0;z<k;z++){var e=this.getIntAttribute(t[z+1],"_winW")!=undefined;if(!e){var y=(q[z])+"px";t[z+1].style.width=y;for(var u=0;u<h;u++){var C=s[u].children[0];var m=C.rows[0].cells;m[z+1].style.width=y}}}g=g+0;this._setCachedWidth(d,g);d.children[0].style.width=g+"px";for(var u=0;u<h;u++){this._setCachedWidth(s[u],g);s[u].children[0].style.width=g+"px"}return(k==0)?0:g/k};obips.ScrollingPivotTable.prototype.getSizeString=function(g,k){var b=saw.userAgent.is_ie8up;var f="";var e=k.children[0];if(g){var h=e.rows[0].cells;var d=h.length;for(var a=1;a<d;a++){f+=h[a].offsetWidth+","}f+=k.offsetWidth}else{var d=e.rows.length;for(var a=1;a<d;a++){f+=(b)?e.rows[a].cells[0].offsetHeight+",":e.rows[a].offsetHeight+","}f+=k.offsetHeight}return f};obips.ScrollingPivotTable.prototype.coordinateColumnHeaderRowHeights=function(b,p){var B=saw.userAgent.is_ie;var y=saw.userAgent.is_ie8up;var w=saw.userAgent.is_webkit;var H=b.rowHeaderLabel.children[0];var E=H&&H.offsetHeight||0;var z=p[0].children[0];var f=p.length;var k=z.rows.length;var t=new Array(k);var I=0;var A;if(B){A=new Array(f);for(var x=0;x<f;x++){if(p[x]._processOffsetHeight==undefined){p[x]._processOffsetHeight=1;A[x]=new Array(k);for(var m=k-1;m>0;m--){var o=p[x].children[0].rows[m];if(A[x][m]==undefined){A[x][m]=(y)?o.cells[0].offsetHeight:o.offsetHeight}else{A[x][m]+=((y)?o.cells[0].offsetHeight:o.offsetHeight)}if(o.cells.length==1&&o.cells[0].className=="PTColSizingCell"){A[x][m-1]=A[x][m];A[x][m]=0}}}}}for(var m=1;m<k;m++){var g=0;for(var x=0;x<f;x++){var s=p[x];if(s){var o=s.children[0].rows[m];var J;if(B&&s._processOffsetHeight==1){J=A[x][m];if(m==(k-1)){s._processOffsetHeight=2}}else{J=(y)?o.cells[0].offsetHeight:o.offsetHeight}if(g<J){g=J}if(o._minRH==undefined){o._minRH=J;var G=this.getIntAttribute(o,"_winH");if((G!=undefined)&&G>g){g=G}}}}var K=b.id;var n=document.getElementById("hl_"+K+"_"+obips.ScrollingPivotTable.COLUMN_EDGE+"_"+(m-1));if(n){g=Math.max(g,n.offsetHeight)}t[m]=g;I=I+g}for(var x=0;x<f;x++){var s=p[x];if(s){var z=s.children[0];var u=z.rows;var a=0;for(var F=1;F<k;F++){var o=u[F];var h=(w||y)?o.cells[0]:o;a+=t[F];if(F==k-1&&a<E){h.style.height=E+"px"}else{h.style.height=t[F]+"px"}}if(saw.userAgent.is_ie8){if(H&&H.rows.length>0){var l=H.rows[1].cells[0].offsetHeight;resizedElem2=H.rows[1].cells[0];resizedElem2.style.height=E+"px"}for(var F=1;F<k;F++){var D=(y)?u[F].cells[0].offsetHeight:u[F].offsetHeight;if(D!=t[F]){var C=t[F]+t[F]-D;var v=E;if(C>=0){var o=u[F];var h=(w||y)?o.cells[0]:o;h.style.height=Math.max(C,v)+"px"}}}}if(H&&(k>0)){s.style.height=Math.max(I,E)+"px";s._height=Math.max(I,E);s.children[0].style.height=Math.max(I,E)+"px"}else{s.style.height=I+"px";s._height=I;s.children[0].style.height=I+"px"}}}var q=b.corner.children[0];if(q){var e=q.rows;for(var F=1;F<k;F++){var d=e[F-1];if(d){d.style.height=t[F]+"px"}}q.style.height=I+"px"}b.corner._initialHeight=I;b.colHeader.scrollTop=b._columnHeaderStartPixel_Key};obips.ScrollingPivotTable.prototype.coordinateHTMLBlockRowHeights=function(P,F,b,q,K,y){var p=saw.userAgent.is_ie;var h=saw.userAgent.is_ie8up;var g=saw.userAgent.is_webkit;var a=P.axisVerticalTitle.children[0];var N=P.axisVertical.children[0];var M=F.children[0];var C=M.rows.length-1;var m=new Array(C);var s=new Array(C);var A=0;var v;var O=P._startRow_Key;var I=this.getIntAttribute(F,"_startSlice");var n=O-I-1;var f=0;var Q={},E=this,z=[];z.push.apply(z,arguments);function w(){E.coordinateHTMLBlockRowHeights.apply(E,z);E.sizePivotTable(P,P.maxWidth,P.maxHeight);E.scrollHTMLBlocks(P,null,null)}for(var L=0;L<C;L++){var u=M.rows[L+1];var e=(h)?u.cells[0].offsetHeight:u.offsetHeight;if(u._minRH==undefined){u._minRH=e;var B=this.getIntAttribute(u,"_winH");if((B!=undefined)&&B>e){e=B}}v=b.length;var J=e;for(var l=0;l<v;l++){var x=b[l].children[0];var t=x.rows[L+1];var d=(h)?t.cells[0].offsetHeight:t.offsetHeight;this._onImgsLoaded(t,w,Q);if(t._minRH==undefined){t._minRH=d;B=this.getIntAttribute(t,"_winH");if((B!=undefined)&&B>d){d=B}}J=Math.max(J,d);if(!F._new){s[L]=e<J}}if(h&&F._new){J+=1}m[L]=J;A=A+J;if(L==n){f=A}}if(y){f+=P._startRowPixel_Key;y.heightBeforeViewport=f}var k=0;if(p&&!h){k=obips.ScrollingPivotTable.CELL_EXTRA_HEIGHT}for(L=0;L<C;L++){var o=M.rows[L+1];this._onImgsLoaded(o,w,Q);var G=(g||h)?o.cells[0]:o;G.style.height=(m[L]-k)+"px";v=b.length;for(var l=0;l<v;l++){var x=b[l].children[0];var D=x.rows[L+1];var G=(g||h)?D.cells[0]:D;G.style.height=(m[L]-k)+"px"}if(s[L]&&(q!=undefined)){v=q.length;for(var l=0;l<v;l++){var x=q[l].childNodes[0];var D=x.rows[L+1];var G=(g||h)?D.cells[0]:D;G.style.height=(m[L]-k)+"px"}}}F.style.height=A+"px";if(!F._new){var H=F._height-A;if(H!=0){this.moveExistingBlocksTop(P,K+1,H)}}F._height=A;if(a){a.style.height=A+"px"}if(N){N.style.height=A+"px";N.children[0].style.height=A+"px"}if(p&&!h){F.children[0].style.height=(A+1)+"px"}else{F.children[0].style.height=(A)+"px"}v=b.length;for(var l=0;l<v;l++){if(p&&!h){b[l].style.height=(A+1)+"px"}else{b[l].style.height=A+"px"}b[l]._height=A;b[l].children[0].style.height=A+"px"}if(q!=undefined){v=q.length;for(var l=0;l<v;l++){if(p&&!h){q[l].style.height=(A+1)+"px"}else{q[l].style.height=A+"px"}q[l]._height=A;q[l].children[0].style.height=A+"px"}}return(C==0)?0:A/C};obips.ScrollingPivotTable.prototype._onImgsLoaded=function(e,h,d){var g,a,f;if(e){if(!d){d={}}if(!d.count){d.count=0}function b(){d.count--;if(d.count===0){h()}}g=e.getElementsByTagName("img");for(a=0,f=g.length;a<f;a++){if(!g[a].complete){d.count++;saw.addEventListener(g[a],"load",b);saw.addEventListener(g[a],"error",b)}}}return d};obips.ScrollingPivotTable.prototype.getOldScrollPos=function(b,e){switch(e){case obips.ScrollingPivotTable.COLUMN_EDGE:var a=b.colHeaderBuffer;var d="_canvasHorizPos";var g="_horizPos";break;case obips.ScrollingPivotTable.ROW_EDGE:a=b.rowHeaderBuffer;d="_canvasTop";g="_top";break;default:throw new Error("bad edge passed to getOldScrollPos.")}var f=a[0];return f[d]-f[g]};obips.ScrollingPivotTable.prototype.getNewBlockPos=function(d,e,b){switch(d){case obips.ScrollingPivotTable.COLUMN_EDGE:case obips.ScrollingPivotTable.AXIS_HORIZONTAL:var a="_canvasHorizPos";break;case obips.ScrollingPivotTable.ROW_EDGE:case obips.ScrollingPivotTable.AXIS_VERTICAL:a="_canvasTop";break}return e[a]-b};obips.ScrollingPivotTable.prototype.getHeaderSizingBlock=function(a){var e=null;var b=a.length;for(i=0;i<b;i++){var d=a[i];if(!d._placeholder){if(!d._new){e=d}}}return e};obips.ScrollingPivotTable.prototype.getRowHeaderWidths=function(a){var b=this.getHeaderSizingBlock(a.rowHeaderBuffer);return this.getSizeString(true,b)};obips.ScrollingPivotTable.prototype.getColumnHeaderHeights=function(a){var b=this.getHeaderSizingBlock(a.colHeaderBuffer);return this.getSizeString(false,b)};obips.ScrollingPivotTable.prototype.initBuffer=function(a){a.databodyBuffer=[];a.colHeaderBuffer=[];a.rowHeaderBuffer=[];a.axisVerticalBuffer=[];a.axisHorizontalBuffer=[];a.buffers=[a.colHeaderBuffer,a.rowHeaderBuffer];a.buffers[this.DATABODY]=a.databodyBuffer};obips.ScrollingPivotTable.prototype.resetInitBlock=function(b){var a=b.pprTarget;b._startRow_Key=0;b._startColumn_Key=0;b._startRowPixel_Key=0;b._startColumnPixel_Key=0;b._rowHeaderStartPixel_Key=0;b._columnHeaderStartPixel_Key=0;b._colExtent=this.getIntAttribute(a,"_cExtent");b._rowExtent=this.getIntAttribute(a,"_rExtent");b._lastVertPage=a.getAttribute("_lastvertpage");b._lastHorizPage=a.getAttribute("_lasthorizpage");this._emptyTextDiv=null;this._colLayerCount=this.getIntAttribute(a,"_cLayerCount");this._rowLayerCount=this.getIntAttribute(a,"_rLayerCount");this._rowBlockSize=this.getIntAttribute(a,"_rBlockSize");this._colBlockSize=this.getIntAttribute(a,"_cBlockSize")};obips.ScrollingPivotTable.prototype.initBlock=function(d){var a=d.pprTarget;this.resetInitBlock(d);var h=this.getArrivingBlocks(a,d.id,obips.ScrollingPivotTable.DATABODY);var b=h[0];var f=this.getIntAttribute(b,"_startRow");var k=this.getIntAttribute(b,"_startCol");this.removeAllBlocks(d);this.addBlocksToBuffer(d);var e=this.sizeInitialHTMLBlocks(d,f,k,true);this.sizePivotTable(d,d.maxWidth,d.maxHeight);this.positionInitialBlocks(d,f,k,e);this.markBlocksNotNew(d);this.hackIE(d);var g=this;setTimeout(function(){g.fetchNearbyBlocks(d,true)},10)};obips.ScrollingPivotTable.prototype.removeExistingBlocksFromDOM=function(a){this.removeChildren(a.colHeader);this.removeChildren(a.rowHeader);this.removeChildren(a.databody)};obips.ScrollingPivotTable.prototype.hackIE=function(a){if(saw.userAgent.is_ie7up){var b=a.databodyScroller.scrollTop;var d=a.databodyScroller.scrollLeft;a.container.style.display="none";a.container.style.display="block";a.databodyScroller.scrollTop=b;a.databodyScroller.scrollLeft=d}};obips.ScrollingPivotTable.prototype.removeChildren=function(d,e){if(!e){e=d.childNodes}var b=e.length;for(var a=b-1;a>=0;--a){var f=e[a];if(f instanceof Array){this.removeChildren(d,f)}else{if(f.parentNode==d){d.removeChild(f)}}}};obips.ScrollingPivotTable.prototype.trimBuffer=function(b,u,l){if(u==undefined){u=0}if(l==undefined){l=0}var g=b.colHeaderBuffer;var B=b.rowHeaderBuffer;var n=b.databodyBuffer;var s=B.length;var f=g.length;if(s==0||f==0){alert("trimBuffer found that the buffer was already empty.  This is unexpected.");this.removeAllBlocks(b);return}var x=this.rangeOfBlocksOverlappingShiftedViewport(b,obips.ScrollingPivotTable.ROW_EDGE,u);var w=this.rangeOfBlocksOverlappingShiftedViewport(b,obips.ScrollingPivotTable.COLUMN_EDGE,l);var A=w.start;var a=x.start;var p=w.end;var t=x.end;if((A==p&&(A==-1||A==f))||(a==t&&(a==-1||a==s))){alert("trimBuffer is removing all blocks due to no overlap.  This is unexpected. "+A+" "+p+" "+a+" "+t+" "+f+" "+s);this.removeAllBlocks(b);return}A=Math.max(A,0);a=Math.max(a,0);p=Math.min(p,f-1);t=Math.min(t,s-1);var k=b.rowHeader;var m=b.colHeader;var v=b.databody;var z=s-t-1;var q=B.splice(t+1,z);var o=n.splice(t+1,z);this.removeChildren(k,q);this.removeChildren(v,o);var q=B.splice(0,a);var o=n.splice(0,a);this.removeChildren(k,q);this.removeChildren(v,o);var z=f-p-1;var y=g.splice(p+1,z);this.deleteColumnsFromDatabodyBuffer(b,true,z);this.removeChildren(m,y);var y=g.splice(0,A);this.deleteColumnsFromDatabodyBuffer(b,false,A);this.removeChildren(m,y);s=B.length;f=g.length;var d=s-1;var h=f-1;if(B[d]._placeholder){var q=B.splice(d,1);var o=n.splice(d,1);this.removeChildren(k,q);this.removeChildren(v,o)}if(g[h]._placeholder){var y=g.splice(h,1);this.deleteColumnsFromDatabodyBuffer(b,true,1);this.removeChildren(m,y)}var e=B[0];if(e&&e._placeholder){var q=B.splice(0,1);var o=n.splice(0,1);this.removeChildren(k,q);this.removeChildren(v,o)}var e=g[0];if(e&&e._placeholder){var y=g.splice(0,1);this.deleteColumnsFromDatabodyBuffer(b,false,1);this.removeChildren(m,y)}s=B.length;f=g.length;if(s==0||f==0){alert("trimBuffer found overlap betweeen the buffer and the viewport, but that overlap was exclusively placeholder rows/columns, so it removed all blocks.  This is unexpected.");this.removeAllBlocks(b)}};obips.ScrollingPivotTable.prototype.removeAllBlocks=function(a){this.initBuffer(a);this.removeExistingBlocksFromDOM(a)};obips.ScrollingPivotTable.prototype.addBlocksToBuffer=function(a){this.addRowHeaderBlocksToBuffer(a);this.addColHeaderBlocksToBuffer(a);this.addDatabodyBlocksToBuffer(a);this.addAxisBlocksToBuffer(a);var b=a.pprTarget;for(var d=b.children.length-1;d>=0;d--){b.removeChild(b.children[d])}};obips.ScrollingPivotTable.prototype.addRowHeaderBlocksToBuffer=function(d){var G=d.rowHeaderBuffer;var e=d.colHeaderBuffer;var D=d.databodyBuffer;var s=d.axisVerticalBuffer;var m=this.getArrivingBlocks(d.pprTarget,d.id,obips.ScrollingPivotTable.ROW_EDGE);var h=m.length;var t=e.length;for(var F=0;F<h;++F){var o=m[F];this.addBlockToDOM(d,d.rowHeader,o);var k=this.getIntAttribute(o,"_startSlice");var y=this.getIntAttribute(o,"_numSlices");var q=G.length;if(q==0){G[0]=o;D[0]=new Array(t);s[0]=null;continue}var B=G[0];var a=this.getIntAttribute(B,"_startSlice");if(k<a){var p=k+y;if(p==a){G.unshift(o);D.unshift(new Array(t))}else{var w=a-p;var l={_startSlice:p,_numSlices:w,_placeholder:true};G.unshift(o,l);D.unshift(new Array(t),new Array(t))}continue}var n=G[q-1];var v=this.getIntAttribute(n,"_startSlice");var x=this.getIntAttribute(n,"_numSlices");if(k>v){var p=v+x;if(p==k){G.push(o);D.push(new Array(t));s.push(null)}else{var w=k-p;var l={_startSlice:p,_numSlices:w,_placeholder:true};G.push(l,o);D.push(new Array(t),new Array(t));s.push(null)}continue}for(var z=0;z<q;++z){var E=G[z];var g=this.getIntAttribute(E,"_startSlice");var A=this.getIntAttribute(E,"_numSlices");var C=g+A;if(k==g){G[z]=o;if(y<A){var l={_startSlice:k+y,_numSlices:A-y,_placeholder:true};G.splice(z+1,0,l);D.splice(z+1,0,new Array(t))}break}if(k<C){G[z]=o;var l={_startSlice:g,_numSlices:k-g,_placeholder:true};G.splice(z,0,l);D.splice(z,0,new Array(t));var u=k+y;if(u<C){var l={_startSlice:u,_numSlices:C-u,_placeholder:true};G.splice(z+2,0,l);D.splice(z+2,0,new Array(t))}break}}}for(var z=0,f=G.length;z<f;++z){if(G[z]._placeholder){obips.ViewModelBase.log("Attempting to add one or more placeholder rows... this could be an error condition")}}};obips.ScrollingPivotTable.prototype.addColHeaderBlocksToBuffer=function(d){var D=d.rowHeaderBuffer;var e=d.colHeaderBuffer;var q=this.getArrivingBlocks(d.pprTarget,d.id,obips.ScrollingPivotTable.COLUMN_EDGE);var h=q.length;for(var C=0;C<h;++C){var n=q[C];this.addBlockToDOM(d,d.colHeader,n);var k=this.getIntAttribute(n,"_startSlice");var w=this.getIntAttribute(n,"_numSlices");var p=e.length;if(p==0){e[0]=n;this.insertColumnIntoDatabodyBuffer(d,0);continue}var z=e[0];var a=this.getIntAttribute(z,"_startSlice");if(k<a){var o=k+w;if(o==a){e.unshift(n);this.insertColumnIntoDatabodyBuffer(d,0)}else{var t=a-o;var l={_startSlice:o,_numSlices:t,_placeholder:true};e.unshift(n,l);this.insertColumnIntoDatabodyBuffer(d,0);this.insertColumnIntoDatabodyBuffer(d,0)}continue}var m=e[p-1];var u=this.getIntAttribute(m,"_startSlice");var v=this.getIntAttribute(m,"_numSlices");if(k>u){var o=u+v;if(o==k){e.push(n);this.insertColumnIntoDatabodyBuffer(d,p)}else{var t=k-o;var l={_startSlice:o,_numSlices:t,_placeholder:true};e.push(l,n);this.insertColumnIntoDatabodyBuffer(d,p);this.insertColumnIntoDatabodyBuffer(d,p)}continue}for(var x=0;x<p;++x){var B=e[x];var g=this.getIntAttribute(B,"_startSlice");var y=this.getIntAttribute(B,"_numSlices");var A=g+y;if(k==g){e[x]=n;if(w<y){var l={_startSlice:k+w,_numSlices:y-w,_placeholder:true};e.splice(x+1,0,l);this.insertColumnIntoDatabodyBuffer(d,x+1)}break}if(k<A){e[x]=n;var l={_startSlice:g,_numSlices:k-g,_placeholder:true};e.splice(x,0,l);this.insertColumnIntoDatabodyBuffer(d,x);var s=k+w;if(s<A){var l={_startSlice:s,_numSlices:A-s,_placeholder:true};e.splice(x+2,0,l);this.insertColumnIntoDatabodyBuffer(d,x+2)}break}}}for(var x=0,f=e.length;x<f;++x){if(e[x]._placeholder){throw new Error("Attempting to add one or more placeholder cols!")}}};obips.ScrollingPivotTable.prototype.addDatabodyBlocksToBuffer=function(f){var d=f.rowHeaderBuffer;var t=f.colHeaderBuffer;var q=f.databodyBuffer;var o=d.length;var s=t.length;var g=this.getArrivingBlocks(f.pprTarget,f.id,obips.ScrollingPivotTable.DATABODY);var p=g.length;for(var n=0;n<p;++n){var h=g[n];this.addBlockToDOM(f,f.databody,h);var k=this.getIntAttribute(h,"_startRow");var m=this.getIntAttribute(h,"_startCol");for(var a=0;a<o;++a){var e=this.getIntAttribute(d[a],"_startSlice");if(k==e){break}}for(var l=0;l<s;++l){var e=this.getIntAttribute(t[l],"_startSlice");if(m==e){break}}q[a][l]=h}};obips.ScrollingPivotTable.prototype.addAxisBlocksToBuffer=function(f){var d=f.rowHeaderBuffer;var u=f.colHeaderBuffer;var p=d.length;var t=u.length;var g=this.getArrivingBlocks(f.pprTarget,f.id,obips.ScrollingPivotTable.AXIS_VERTICAL);var m=g.length;for(var q=0;q<m;++q){var h=g[q];this.addBlockToDOM(f,f.axisVertical,h);var l=this.getIntAttribute(h,"_startRow");for(var a=0;a<p;++a){var e=this.getIntAttribute(d[a],"_startSlice");if(l==e){break}}f.axisVerticalBuffer[q]=h}var k=this.getArrivingBlocks(f.pprTarget,f.id,obips.ScrollingPivotTable.AXIS_HORIZONTAL);var s=k.length;for(var q=0;q<s;++q){var h=k[q];this.addBlockToDOM(f,f.axisHorizontal,h);var o=this.getIntAttribute(h,"_startCol");for(var n=0;a<t;++n){var e=this.getIntAttribute(u[n],"_startSlice");if(o==e){break}}f.axisHorizontalBuffer[n]=h}};obips.ScrollingPivotTable.prototype.getArrivingBlocks=function(a,e,d){switch(d){case obips.ScrollingPivotTable.DATABODY:var b=e+"_DatabodyBlock";break;case obips.ScrollingPivotTable.COLUMN_EDGE:var b=e+"_ColHeaderBlock";break;case obips.ScrollingPivotTable.ROW_EDGE:var b=e+"_RowHeaderBlock";break;case obips.ScrollingPivotTable.AXIS_VERTICAL:var b=e+"_AxisVerticalBlock";break;case obips.ScrollingPivotTable.AXIS_HORIZONTAL:var b=e+"_AxisHorizontalBlock";break;default:throw new Error("bad edge passed to getArrivingBlocks")}return this.getArrivingElements(a,b)};obips.ScrollingPivotTable.prototype.getArrivingElements=function(a,f){var g=[];var b=a.childNodes;for(var d=0;d<b.length;d++){var e=b[d];var h=e.id;if(h&&(h.indexOf(f)==0)){g.push(e)}}return g};obips.ScrollingPivotTable.prototype.addBlockToDOM=function(a,b,d){b.appendChild(d);d._new=true;return};obips.ScrollingPivotTable.prototype.markBlocksNotNew=function(b){var a=b.rowHeaderBuffer;var g=a.length;var f=0;var e,d;for(e=0;e<g;e++){a[e]._new=false}a=b.colHeaderBuffer;g=a.length;f=0;for(e=0;e<g;e++){a[e]._new=false}a=b.databodyBuffer;g=a.length;f=0;for(e=0;e<g;e++){var k=a[e];var h=k.length;for(d=0;d<h;d++){k[d]._new=false}}};obips.ScrollingPivotTable.prototype.insertColumnIntoDatabodyBuffer=function(b,f){var a=b.databodyBuffer;var e=b.axis;var d=a.length;for(var g=0;g<d;++g){a[g].splice(f,0,null)}};obips.ScrollingPivotTable.prototype.deleteColumnsFromDatabodyBuffer=function(e,d,k){var b=e.databodyBuffer;var f=b.length;if(f==0){return}startCol=(d)?b[0].length-k:0;var a=e.databody;for(var h=0;h<f;++h){var g=b[h].splice(startCol,k);this.removeChildren(a,g)}};obips.ScrollingPivotTable.prototype.getSliceCountInBuffer=function(b,f){var a=b.buffers[f];var e=a[a.length-1];var g=this.getIntAttribute(a[0],"_startSlice");var d=this.getIntAttribute(e,"_startSlice")+this.getIntAttribute(e,"_numSlices");return d-g};obips.ScrollingPivotTable.prototype.setViewportStartSliceFromPosition=function(a,b){if(b===undefined){this.setViewportStartSliceFromPosition(a,obips.ScrollingPivotTable.COLUMN_EDGE);this.setViewportStartSliceFromPosition(a,obips.ScrollingPivotTable.ROW_EDGE);return}viewportStartSliceObj=this.firstSliceInShiftedViewport(a,b,0);viewportStartSlice=viewportStartSliceObj.slice;if(viewportStartSlice!=-1){switch(b){case obips.ScrollingPivotTable.COLUMN_EDGE:currentChildScrollingPivot_startColumn_Key=viewportStartSlice;currentChildScrollingPivot_startColumnPixel_Key=viewportStartSliceObj.pixel;break;case obips.ScrollingPivotTable.ROW_EDGE:currentChildScrollingPivot_startRow_Key=viewportStartSlice;currentChildScrollingPivot_startRowPixel_Key=viewportStartSliceObj.pixel;break;default:throw new Error("bad edge passed to setViewportStartSliceFromPosition.")}}};obips.ScrollingPivotTable.prototype.setPos=function(a,d,e,b){if(d==obips.ScrollingPivotTable.COLUMN_EDGE){this.setHorizPos(a,e,b)}else{b._top=e;b.style.top=e+"px"}};obips.ScrollingPivotTable.prototype.getIntAttribute=function(d,b,a){if(a==undefined){a=null}if(!d.getAttribute){return a}var e=d.getAttribute(b);e=parseInt(e);if(isNaN(e)){e=a}return e};obips.ScrollingPivotTable.prototype.setHorizPos=function(d,f,g){var h;if(saw.isRToL()){var a=g.parentNode;var b=a._width;if(a==d.colHeader){b-=this.getColHeaderScrollbarWidth(d)}var e=g._width;h=b-e-f}else{h=f}g._horizPos=f;g._left=h;g.style.left=h+"px"};obips.ScrollingPivotTable.prototype.setCanvasPos=function(d,b,a){if(d==obips.ScrollingPivotTable.COLUMN_EDGE){this.setCanvasHorizPos(b,a)}else{a._canvasTop=b}};obips.ScrollingPivotTable.prototype.setCanvasHorizPos=function(b,a){a._canvasHorizPos=b};obips.ScrollingPivotTable.prototype.getScrollHorizPos=function(d,a){if(typeof(a)=="undefined"){a=d.databodyScroller}if(d.rightToLeft){var e=a.scrollLeft;var b=d.databody._width+1;return d._maxScrollHorizPos-e}else{return a.scrollLeft}};obips.ScrollingPivotTable.prototype.createBlockParameters=function(d,a,h,b,g,e){var f=new Object;f.startCol=d;f.startRow=a;f.includeColHeaderBlock=h;f.includeRowHeaderBlock=b;if(g!=null){f.numCols=g}if(e!=null){f.numRows=e}return f};obips.ScrollingPivotTable.prototype.createSizingParameter=function(f,e,b,d){var a=new Object;a.startSlice=b;a.isRowHeader=f;a.isWidth=e;a.sizes=d;return a};obips.ScrollingPivotTable.prototype._setCachedTop=function(a,b){a._top=b;a.style.top=b+"px"};obips.ScrollingPivotTable.prototype._setCachedLeft=function(a,b){a._left=b;a.style.left=b+"px"};obips.ScrollingPivotTable.prototype._setCachedWidth=function(a,b){a._width=b;a.style.width=b+"px"};obips.ScrollingPivotTable.prototype._setCachedHeight=function(b,a){b._height=a;b.style.height=a+"px"};obips.ScrollingPivotTable.prototype.moveExistingBlocksTop=function(d,l,g){var a=d.rowHeaderBuffer;var b=a.length;for(i=l;i<b;i++){var f=a[i];if(!f._placeholder&&!f._new){f._top=f._top+g;f._canvasTop=f._canvasTop+g;f.style.top=f._top+"px"}}var h=d.databodyBuffer;b=h.length;size=0;for(i=l;i<b;i++){var k=h[i];var e=k.length;for(j=0;j<e;j++){var f=k[j];if(f&&!f._new){f._top=f._top+g;f._canvasTop=f._canvasTop+g;f.style.top=f._top+"px"}}}};obips.ScrollingPivotTable.prototype._getChildById=function(a,e){var d=a+"_"+e;var b=document.getElementById(d);if(!b){}return b};obips.ScrollingPivotTable.prototype.setLastRequestInLocalQueue=function(a){this._lastRequestInLocalQueue=a};obips.ScrollingPivotTable.prototype.setLastRequestInFrameworkQueue=function(a){this._lastRequestInFrameworkQueue=a};obips.ScrollingPivotTable.prototype.requestsMatch=function(b,e){if(b._eventId!=e._eventId){return false}oldBlocks=b._blocks;newBlocks=e._blocks;var m=oldBlocks.length;if(b._fetchType!=e._fetchType){return false}if(m!=newBlocks.length){return false}for(var f=0;f<m;++f){var h=newBlocks[f];var l=h.startRow;var a=h.startCol;var k=false;for(var d=0;d<m;++d){var g=oldBlocks[d];if(g.startCol==a&&g.startRow==l){k=true;break}}if(!k){return false}}return true};obips.ScrollingPivotTable.prototype.requestMatchesResponse=function(b,e,m){var a;var o=0;if(b!=null){a=b._blocks;o=a.length}if(o==0){return true}if(m!=b._fetchType){return false}if(o!=e.length){return false}for(var g=0;g<o;++g){var l=e[g];var n=this.getIntAttribute(l,"_startRow");var d=this.getIntAttribute(l,"_startCol");var k=false;for(var f=0;f<o;++f){var h=a[f];if(h.startCol==d&&h.startRow==n){k=true;break}}if(!k){return false}}return true};obips.ScrollingPivotTable.RI_FUDGE=2;obips.ScrollingPivotTable.doResize=function(a){if(obips.ScrollingPivotTable.resizingViewModelId){var b=obips.ViewModel.getViewModelById(obips.ScrollingPivotTable.resizingViewModelId);b.doResize(a)}};obips.ScrollingPivotTable.doEndResize=function(a){if(obips.ScrollingPivotTable.resizingViewModelId){var b=obips.ViewModel.getViewModelById(obips.ScrollingPivotTable.resizingViewModelId);b.handleEndRowColResize(a)}};obips.ScrollingPivotTable.prototype.handleMouseMoveRowColResize=function(d,b,h,f){if(obips.PivotTable.ptCurrentEvent.eventType!=obips.ViewModel.EventType.NO_EVENT){return}var a=f.getElement();if(a.nodeName=="TABLE"){return}var g=this._resizeDragInfo;if(g==null){var e=this._getRowColResizeAction(d,b,h,f);var a=f.getElement();if(e.type!="resize"){a.style.cursor="default";return}if((e.data=="startCol")||(e.data=="endCol")){a.style.cursor="col-resize"}else{a.style.cursor="row-resize"}return}else{obips.ScrollingPivotTable.resizingViewModelId=this.getMasterClientID();saw.addEventListener(document.body,"mousemove",obips.ScrollingPivotTable.doResize);saw.addEventListener(document.body,"mouseup",obips.ScrollingPivotTable.doEndResize)}};obips.ScrollingPivotTable.prototype.doResize=function(b){var d=this._resizeDragInfo;if(d!=null){var a=this._childScrollInfo[d._currentScrollingPivotId];if(d._resizingRow){this._handleRowResizeDrag(a,b,0,b.clientY-d._resizeDragStartY-d._resizeDelta)}else{this._handleColResizeDrag(a,b,b.clientX-d._resizeDragStartX-d._resizeDelta,0)}}};obips.ScrollingPivotTable.prototype.handleStartRowColResize=function(f,e,b){var g=this._getRowColResizeAction(f,e,true,b);if(g.type!="resize"){return false}var d=new Object();this._resizeDragInfo=d;var a=(g.data=="startRow")||(g.data=="endRow");if(a){this._showRowResizeIndicator(g,b)}else{this._showColumnResizeIndicator(g,b)}b.getElement().style.cursor="default";this._resizeDragInfo._currentScrollingPivotId=b.getId();this._resizeDragInfo._resizeDelta=0;this._resizeDragInfo._resizingRow=a;this._resizeDragInfo._resizeDragStartX=f.clientX;this._resizeDragInfo._resizeDragStartY=f.clientY;return true};obips.ScrollingPivotTable.prototype.handleEndRowColResize=function(f){var g=this._resizeDragInfo;if(g){var d=g._currentScrollingPivotId;var b=this._childScrollInfo[d];var a=b._resizeIndicator;var e=a.style;e.display="none";if(g._resizingRow==true){this._resizeRow(b,g._resizedIsHeader,g._resizedBlockIndex,g._resizedCell,g._resizedIndex,g._resizeDelta,true)}else{this._resizeColumn(b,g._resizedIsHeader,g._resizedBlockIndex,g._resizedCell,g._resizedIndex,g._resizeDelta,true)}this._resizeDragInfo=null;obips.ScrollingPivotTable.resizingViewModelId=null;saw.removeEventListener(document.body,"mousemove",obips.ScrollingPivotTable.doResize);saw.removeEventListener(document.body,"mouseup",obips.ScrollingPivotTable.doEndResize)}};obips.ScrollingPivotTable.prototype._getRowColResizeAction=function(w,g,p,x){var u=new Object();if(p!=true){return u}var b=this._childScrollInfo[x.getId()];var l=this.getEdgeDefinition(x.getId());var m=x.getEdge();var d=x.getElement();var E=saw.isRToL();var s=E?document.body.clientWidth-w.clientX:w.clientX;var F=obips.PivotTable.resolveMouseX(s,d);var e=obips.PivotTable.resolveMouseY(w.clientY,d);var t=obips.PivotTable.getXCoord(d);var z=obips.PivotTable.getYCoord(d);var B=F-t;var A=e-z;var v=d.offsetWidth;var a=d.offsetHeight;var h=((m==obips.JSDataLayout.COLUMN_EDGE)&&(l.getLayerCount(obips.JSDataLayout.ROW_EDGE)==0));if(!h){if(m==obips.JSDataLayout.COLUMN_EDGE&&x.getSlice()==-1){return u}var D=false;var G=null;var q=Math.min(obips.ScrollingPivotTable.COLUMN_RESIZE_MARGIN,Math.ceil(v/2));if(v-B<=q){D=true;G="endCol"}else{if(B<=q){var o=false;var k=this.getAbsoluteColumnIndex(d);if(k==1){if(m==obips.JSDataLayout.ROW_EDGE){o=true}else{var n=this.getParentBlock(d);if(n==b.colHeaderBuffer[0]){o=true}}}if(!o){D=true;G="startCol"}}}}h=((m==obips.JSDataLayout.COLUMN_EDGE)&&(l.getLayerCount(obips.JSDataLayout.COLUMN_EDGE)==0));if(!D&&!h){if(x.getSlice()==-1){return u}if(A<=obips.JSDataLayout.ROW_RESIZE_MARGIN){var y=false;var f=this.getAbsoluteRowIndex(headerContext.cell);if(f==1){if(m==obips.JSDataLayout.COLUMN_EDGE){y=true}else{n=this.getParentBlock(d);if(n==b.rowHeaderBuffer[0]){y=true}}}if(!y){D=true;G="startRow"}}else{if(a-A<=obips.ScrollingPivotTable.ROW_RESIZE_MARGIN){D=true;G="endRow"}else{if((m==obips.JSDataLayout.COLUMN_EDGE)&&a-A<=(obips.ScrollingPivotTable.ROW_RESIZE_MARGIN+1)){var C=this.getAbsoluteRowIndex(d)+d.rowSpan-1;if(C==this._colLayerCount){D=true;G="endRow"}}else{if((m==obips.JSDataLayout.ROW_EDGE)&&a-A<=(obips.ScrollingPivotTable.ROW_RESIZE_MARGIN+1)){var C=this.getAbsoluteRowIndex(d)+d.rowSpan-1;var n=this.getParentBlock(d);if(C==n.getAttribute("_numSlices")&&n.getAttribute("_lastBlock")=="t"){D=true;G="endRow"}}}}}}if(D){u.type="resize";u.isRowHeader=(m==obips.JSDataLayout.ROW_EDGE);u.data=G}return u};obips.ScrollingPivotTable.prototype._showRowResizeIndicator=function(f,k){var d=this._childScrollInfo[k.getId()];var m=k.getElement();var q=m.parentNode;var e=this.getParentBlock(q);var n=0;var o;var g=(k.getEdge()==obips.JSDataLayout.ROW_EDGE);if(g){o=d.rowHeaderBuffer}else{o=d.colHeaderBuffer}if(!e){e=o[0]}n=this.getHeaderBlockIndex(o,e);if(n<0){return}var a=this.getAbsoluteRowIndex(m);if(f.data=="startRow"){a--;if(g){if(a==0){if(n==0){n--}a=o[n].children[0].rows.length-1}}}else{a+=m.rowSpan-1}var b=e.children[0].rows[a].cells[0];this._resizeDragInfo._resizedCell=b;this._resizeDragInfo._resizedIndex=a;this._resizeDragInfo._resizedBlockIndex=n;this._resizeDragInfo._resizedIsHeader=!g;var l=d._resizeIndicator;l.className=l.getAttribute("_rowClass");var p=l.style;p.display="block";p.zIndex=20;p.left="0px";p.height="0px";if(!(k.getEdge()==obips.JSDataLayout.ROW_EDGE)){var h=b.offsetTop+b.offsetHeight+obips.ScrollingPivotTable.RI_FUDGE;p.top=h-d.colHeader.scrollTop+"px";p.width=d.rowHeader._width+d.databody._width+"px"}else{var h=b.offsetTop+b.offsetHeight+obips.ScrollingPivotTable.RI_FUDGE;p.top=(d.colHeader._height+e._top+h)+"px";p.width=d.rowHeader._width+d.databody._width+"px"}};obips.ScrollingPivotTable.prototype._showColumnResizeIndicator=function(g,k){var d=this._childScrollInfo[k.getId()];var m=k.getElement();var q=m.parentNode;var f=this.getParentBlock(q);var o;var h=(k.getEdge()==obips.JSDataLayout.ROW_EDGE);if(h){o=d.rowHeaderBuffer}else{o=d.colHeaderBuffer}if(!f){f=o[0]}var n=this.getHeaderBlockIndex(o,f);var b=h?k.getLayer()+1:k.getSlice()+1;if(g.data=="startCol"){b--;if(b==0){n--;f=o[n];b=o[n].children[0].rows[0].cells.length-1}}else{b+=m.colSpan-1}var a=f.children[0].rows[0].cells[b];this._resizeDragInfo._resizedCell=a;this._resizeDragInfo._resizedIndex=b;this._resizeDragInfo._resizedBlockIndex=n;this._resizeDragInfo._resizedIsHeader=h;var l=d._resizeIndicator;l.className=l.getAttribute("_colClass");var p=l.style;p.display="block";p.zIndex=20;p.top="0px";p.width="0px";p.height=d.colHeader._height+d.databody._height+"px";var e=this._getColumnResizeIndicatorLeft(d,f,a,h,b);p.left=e+obips.ScrollingPivotTable.RI_FUDGE+"px"};obips.ScrollingPivotTable.prototype._getColumnResizeIndicatorLeft=function(d,f,a,k,b){var m;var n;var g;var h;var e;if(k){var l=d.rowHeader;m=l._left;n=-l.scrollLeft}else{m=d.colHeader._left;n=f._left}g=a.offsetLeft;h=(d.rightToLeft)?0:a.offsetWidth;e=(k||d.rightToLeft)?-1:0;if(k&&b==this._rowLayerCount){e=(d.rightToLeft)?-2:0}return m+n+g+h+e};obips.ScrollingPivotTable.prototype._handleRowResizeDrag=function(a,e,d,b){var g=a._resizeIndicator;var o=g.style;var f=parseInt(o.top);var n=this._resizeDragInfo;var k=n._resizedCell;var m=k.offsetHeight;var l=(n._resizedIsHeader)?obips.ScrollingPivotTable.MIN_COL_HEADER_HEIGHT:obips.ScrollingPivotTable.MIN_ROW_HEIGHT;l=Math.min(l,m);var h=n._resizeDelta+b;if(m+h>l){n._resizeDelta=h;o.top=f+b+"px"}};obips.ScrollingPivotTable.prototype._handleColResizeDrag=function(d,h,g,f){var k=d._resizeIndicator;var o=k.style;var e=parseInt(o.left);var n=this._resizeDragInfo;var m=n._resizedCell;var b=m.offsetWidth;var a=(n._resizedIsHeader)?obips.ScrollingPivotTable.MIN_ROW_HEADER_WIDTH:obips.ScrollingPivotTable.MIN_COLUMN_WIDTH;a=Math.min(a,b);var l=(d.rightToLeft)?n._resizeDelta-g:n._resizeDelta+g;if(b+l>a){n._resizeDelta=l;o.left=e+g+"px"}};obips.ScrollingPivotTable.prototype._resizeRow=function(d,y,B,u,h,H,e){var m=u.offsetHeight;var A=m+H;var x=saw.userAgent.is_ie;var w=saw.userAgent.is_ie8up;var v=saw.userAgent.is_webkit;if(y){var g=d.colHeaderBuffer[B];var a=g._height;var l=d.colHeaderBuffer;var n=l.length;for(var C=0;C<n;C++){var t=l[C];var E=t.children[0];if(!t._placeholder){var s=E.rows[h];if(s._minRH>A){A=s._minRH}}}H=A-m;var n=l.length;for(var C=0;C<n;C++){var t=l[C];if(!t._placeholder){var E=t.children[0];var s=E.rows[h];var k=(v||w)?s.cells[0]:s;if(x&&!w){k.style.height=(A-CELL_EXTRA_HEIGHT)+"px";this._changeBlockHeight(t,a,H,1)}else{k.style.height=A+"px";this._changeBlockHeight(t,a,H,0)}}}if(e==false){}}else{var D=u.parentNode;if(D._minRH>A){A=D._minRH}var q=d.databodyBuffer;var p=q[B];var f=p.length;var o=-1;for(var G=0;G<f;G++){var t=p[G];if(o==-1){o=this.getIntAttribute(t,"_startRow")}E=t.children[0];var s=E.rows[h];if(s._minRH>A){A=s._minRH}}var z=o+h-1;if(e==false){}H=A-m;var F=0;if(x&&!w){F=CELL_EXTRA_HEIGHT}var k=(v||w)?u:D;k.style.height=(A-F)+"px";var I=d.rowHeaderBuffer[B];var a=I._height;if(x&&!w){this._changeBlockHeight(I,a,H,1)}else{this._changeBlockHeight(I,a,H,0)}var q=d.databodyBuffer;var p=q[B];var f=p.length;for(var G=0;G<f;G++){var t=p[G];E=t.children[0];s=E.rows[h];k=(v||w)?s.cells[0]:s;k.style.height=(A-F)+"px";this._changeBlockHeight(t,a,H,0)}this.moveExistingBlocksTop(d,B+1,H)}this.sizePivotTable(d,d.maxWidth,d.maxHeight);this.scrollHTMLBlocks(d,null,null);this.fetchNearbyBlocks(d,true);return A};obips.ScrollingPivotTable.prototype.coordinateRowBlockSizes=function(b){var f=[];var a=b.rowHeaderBuffer;var e=a.length;for(var h=0;h<e;h++){var d=a[h];var g=b.databodyBuffer;this.coordinateHTMLBlockRowHeights(b,d,g[h],f,h)}};obips.ScrollingPivotTable.prototype.coordinateColumnBlockSizes=function(b){var g=[];var d=b.colHeaderBuffer;var f=d.length;for(var e=0;e<f;e++){var a=d[e];if(!a._placeholder){g.push(a)}}this.coordinateColumnHeaderRowHeights(b,g)};obips.ScrollingPivotTable.prototype._resizeColumn=function(a,s,u,m,h,x){var n=m.offsetWidth+x;if(s){var z=a.rowHeaderBuffer;var y=z[u];var e=y._width;var g=z.length;for(var v=0;v<g;v++){var l=z[v];if(!l._placeholder){var b=l.children[0].rows[0].cells[h];b.style.width=n+"px";this._changeBlockWidth(l,e,x);if(saw.userAgent.is_chrome){this._forceReflow(l)}}}var w=a.rowHeaderLabel.children[0];if(w){w.rows[0].cells[h].style.width=n+"px";w.style.width=e+x+"px";if(saw.userAgent.is_chrome){this._forceReflow(w)}}this.coordinateRowBlockSizes(a)}else{m.style.width=n+"px";var d=a.colHeaderBuffer[u];var e=d._width;this._changeBlockWidth(d,e,x);if(saw.userAgent.is_chrome){this._forceReflow(d)}var k=a.databodyBuffer;var p=k.length;var f=-1;for(var o=0;o<p;o++){var l=k[o][u];if(f==-1){f=this.getIntAttribute(l,"_startCol")}table=l.children[0];var b=table.rows[0].cells[h];var q=parseInt(b.style.width)+x;b.style.width=q+"px";this._changeBlockWidth(l,e,x);if(saw.userAgent.is_chrome){this._forceReflow(l)}}var t=f+h-1;this.moveBlocksHoriz(a,u+1,x);this.coordinateColumnBlockSizes(a)}this.sizePivotTable(a,a.maxWidth,a.maxHeight);this.scrollHTMLBlocks(a,null,null);this.fetchNearbyBlocks(a,true);return n};obips.ScrollingPivotTable.prototype._forceReflow=function(d){var b=d.parentNode,a=d.nextSibling;b.removeChild(d);b.insertBefore(d,a)};obips.ScrollingPivotTable.prototype.getParentBlock=function(d){var e=d;var b=null;while(!b&&e&&e.nodeType==1){var a=e.getAttribute("_startSlice");if(a){b=e}else{e=e.parentNode}}return b;var b=_rowHeaderBuffer[0];return b};obips.ScrollingPivotTable.prototype.getHeaderBlockIndex=function(a,f){var e=a.length;var b=-1;for(var d=0;d<e;d++){if(a[d].id==f.id){b=d}}return b};obips.ScrollingPivotTable.prototype._changeBlockWidth=function(d,f,e){var b=d.children[0];var a=f+e;b._width=d._width=a;b.style.width=d.style.width=a+"px"};obips.ScrollingPivotTable.prototype._changeBlockHeight=function(f,e,g,d){var b=f.children[0];var a=e+g;b._height=a+d;f._height=a;b.style.height=(a+d)+"px";f.style.height=a+"px"};obips.ScrollingPivotTable.prototype.moveBlocksHoriz=function(b,l,e){var h=b.colHeaderBuffer;var a=h.length;for(i=l;i<a;i++){var f=h[i];if(!f._placeholder){this.setHorizPos(b,f._horizPos+e,f);this.setCanvasHorizPos(f._canvasHorizPos+e,f)}}var g=b.databodyBuffer;a=g.length;for(i=0;i<a;i++){var k=g[i];var d=k.length;for(j=l;j<d;j++){var f=k[j];if(f){this.setHorizPos(b,f._horizPos+e,f);this.setCanvasHorizPos(f._canvasHorizPos+e,f)}}}};obips.ScrollingPivotTable.prototype.getAbsoluteColumnIndex=function(a){return this.getIntAttribute(a,"_iCol",0)+1};obips.ScrollingPivotTable.prototype.getAbsoluteRowIndex=function(a){return a.parentNode.rowIndex};obips.ScrollingPivotTable.prototype._displayStatus=function(a,e){var d=a._fetchStatus;d.innerHTML=e;var b=d.style;if(b.display==""||b.display=="none"){b.zIndex=5;b.display="block";var f=saw.getElementXY(a.container);b.top=(a.container.offsetHeight/2)-d.offsetHeight/2-16+"px";b.left=(a.container.offsetWidth/2)-d.offsetWidth/2-16+"px"}};obips.ScrollingPivotTable.prototype._hideStatus=function(a){a.style.display="none"};obips.ScrollingPivotTable.prototype.getCachedProperty=function(d,b){var a="_"+b;if(d[a]==undefined){d[a]=d[b]}return d[a]};obips.ScrollingPivotTable.prototype.setHighlightCorrespondingCellRange=function(g,a,e,k,f,h){var l=this.getEdgeDefinition(g);if(!l){return}var d=l.getStartSlice(a,e,k);var b=l.getEndSlice(a,e,f);if(obips.ViewModelBase.logEnabled){obips.ViewModelBase.log("setHighlightCorrespondingCellRange originalStart: %s originalEnd: %s newStart: %s newEnd: %s",k,f,d,b)}obips.ScrollingPivotTable.superClass.setHighlightCorrespondingCellRange.call(this,g,a,e,d,b,h)};obips.ScrollingPivotTable.prototype.highlightEdgeCell=function(m,b,g,s){var d=this._childScrollInfo[m];if(b==obips.JSDataLayout.SECTION_EDGE||b==obips.JSDataLayout.PAGE_EDGE){obips.ScrollingPivotTable.superClass.highlightEdgeCell.call(this,m,b,g,s);return}var t=this.getEdgeDefinition(m);if(!t){return}var a=t.getStartSlice(b,g,s);var p=t.getEndSlice(b,g,a);var k=(b==obips.JSDataLayout.ROW_EDGE)?d.rowHeaderBuffer:d.colHeaderBuffer;var h=k.length;for(var e=0;e<h;e++){var q=k[e];var f=this.getIntAttribute(q,"_startSlice");var o=this.getIntAttribute(q,"_numSlices");var n=false;var l=-1;if(a<=f&&f<=p){n=true;l=f;obips.ScrollingPivotTable.superClass.highlightEdgeCell.call(this,m,b,g,f)}else{if(f<=a&&a<=f+o){n=true;l=a;obips.ScrollingPivotTable.superClass.highlightEdgeCell.call(this,m,b,g,a)}}}};obips.ScrollingPivotTable.prototype.highlightNewBlocks=function(d){var t=d.pprTarget;var l=t.selectedEdgeCells;for(var f in l){var u=l[f];var s=obips.EdgeCoords.findCoords(u);if(!s){continue}var b=s.getEdge();var o=s.getSlice();var h=s.getLayer();this.highlightEdgeCell(s.getId(),b,h,o);var m=d.rowHeaderBuffer.length;var q=d.colHeaderBuffer.length;var n=d.databodyBuffer;length=n.length;for(r=0;r<m;r++){for(c=0;c<q;c++){var g=n[r][c];if(g&&g._new){var p=this.getIntAttribute(g,"_startRow");var a=this.getIntAttribute(g,"_startCol");var k=this.getIntAttribute(d.rowHeaderBuffer[r],"_numSlices");var e=this.getIntAttribute(d.colHeaderBuffer[c],"_numSlices");if(obips.ViewModelBase.logEnabled){obips.ViewModelBase.log("hnb startr: %s startc: %s numRows: %s numCols: %s slice: %s",p,a,k,e,o)}if(b==obips.JSDataLayout.ROW_EDGE){if(o<=p&&o<=p+k){this.highlightBodyCellRange(d.id,p,p+k,a,a+e)}}else{if(o>=a&&o<=a+e){this.highlightBodyCellRange(d.id,p,p+k,a,a+e)}}}}}}};obips.ScrollingPivotTable.registerStaticEvents=function(){if(obips.gridview&&obips.AnalysisEventManager){var b=new obips.Callback(null,obips.ScrollingPivotTable.fetchBlocksCallbk);var a=new obips.AnalysisEventListener(obips.gridview.FetchBlocksEvent.EVENT_TYPE,b);obips.AnalysisEventManager.getInstance().addEventListener(a)}};obips.ScrollingPivotTable.fetchBlocksCallbk=function(a){};obips.ScrollingPivotTable.registerStaticEvents();obips.ScrollingPivotTable.prototype._handleFetchBlocksResponse=function(h,m,q,l){var f=l.oCallback.childScrollingPivotId;var d=this._childScrollInfo[f];if(typeof(f)=="undefined"||f==""){return false}var s=obips.ViewModel.getViewModelById(f);if(obips.ViewModelBase.logEnabled){obips.ViewModelBase.log("_handleFetchBlocksResponse starting...")}s.unhighlightCellsAndClearSel(f);var g=this.getEdgeDefinition(f,false);var t=this.getBodyDefinition(f,false);var u=null;var o=null;if(g){u=g.getSelectedCells()}if(t){o=t.getSelectedCells()}obips.ViewModelBase.clearViewInstanceCache(f);var n=this.findContentForChildViewId(h,f);var k=obips.ViewModelBase.getDataLayoutDiv(f);if(k){k.parentNode.removeChild(k)}var v=d.pprTarget;var a=document.createElement("div");v.appendChild(a);a.innerHTML=n;var b=this._getChildById(f,"ScrollingAJAXResponse");if(!b){if(obips.ViewModelBase.logEnabled){obips.ViewModelBase.log("Response did not contain the ScrollingAJAXResponse, possibly a cursor searching condition.  Skipping scrolling response processing.")}return}var p=v.parentNode;p.replaceChild(b.children[0],v);var w=s._getChildById(f,"PPRTarget");d.pprTarget=w;w.selectedEdgeCells=u;w.selectedBodyCells=o;var e=w.getAttribute("_fetchtype");s.handleScrollResponse(d,e);if(obips.ViewModelBase.logEnabled){obips.ViewModelBase.log("_handleFetchBlocksResponse done: %s",obips.ScrollingPivotTable.getFetchTypeString(e))}obips.ScrollingPivotTable.viewsHandlingAjax[s.getViewID()]=true};obips.ScrollingPivotTable._handleAjax=function(b,e,a,d){if(typeof(obips.ScrollingPivotTable.viewsHandlingAjax[d])!="undefined"&&obips.ScrollingPivotTable.viewsHandlingAjax[d]==true){delete obips.ScrollingPivotTable.viewsHandlingAjax[d];return true}return false};obips.ScrollingPivotTable.prototype.HierCollapse=function(n,e,m,q,f){if(e==obips.JSDataLayout.PAGE_EDGE||e==obips.JSDataLayout.SECTION_EDGE){return obips.ScrollingPivotTable.superClass.HierCollapse.call(this,n,e,m,q,f)}var k=this.getPivotViewXML();if(!k){return}if(!this.supportsFeature(obips.ViewRightClickMenu.FEATURE_DRILL)){return}var l=obips.PivotTable.superClass.HierCollapse.call(this,n,e,m,q,f);var g=this._childScrollInfo[n];this._lastRequestInFrameworkQueue=null;var a=0;var h=0;var d=g.databodyScroller.scrollTop;var p=this.getScrollHorizPos(g,g.databodyScroller);var b=this.rangeOfBlocksOverlappingShiftedViewport(g,obips.ScrollingPivotTable.ROW_EDGE,a);var o=this.rangeOfBlocksOverlappingShiftedViewport(g,obips.ScrollingPivotTable.COLUMN_EDGE,h);this.longJump(g,a,h,b,o,d,p,obips.ScrollingPivotTable.FETCH_TYPE_HIER_DRILL_OR_COLLAPSE,false)};obips.ScrollingPivotTable.prototype.HierDrill=function(o,e,m,t,n,g,q){if(e==obips.JSDataLayout.PAGE_EDGE||e==obips.JSDataLayout.SECTION_EDGE){return obips.ScrollingPivotTable.superClass.HierDrill.call(this,o,e,m,t,n,g)}var l=this.getPivotViewXML();if(!l){return}if(!this.supportsFeature(obips.ViewRightClickMenu.FEATURE_DRILL)){return}var k=obips.PivotTable.superClass.HierDrill.call(this,o,e,m,t,n,g);this.removeInvalidDrillsIfHiddenLevelsExist(k,e,m);var f=this._childScrollInfo[o];this._lastRequestInFrameworkQueue=null;var a=0;var h=0;var d=f.databodyScroller.scrollTop;var s=this.getScrollHorizPos(f,f.databodyScroller);var b=this.rangeOfBlocksOverlappingShiftedViewport(f,obips.ScrollingPivotTable.ROW_EDGE,a);var p=this.rangeOfBlocksOverlappingShiftedViewport(f,obips.ScrollingPivotTable.COLUMN_EDGE,h);this.longJump(f,a,h,b,p,d,s,obips.ScrollingPivotTable.FETCH_TYPE_HIER_DRILL_OR_COLLAPSE,false)};PTMoreRows=function(d,b){saw.stopEventPropagation(b);var e=obips.ViewModel.getViewModelById(d.parentNode.parentNode.parentNode.id.slice(10));var a=e._childScrollInfo[d.parentNode.parentNode.parentNode.id.slice(10)];var f=(a.rowHeaderBuffer?a.rowHeaderBuffer.length:0);e.requestAllBlocksInRange(a,false,0,0,0,f,obips.ScrollingPivotTable.FETCH_TYPE_MORE_ROWS);e._hideMoreRows(a)};PTMoreCols=function(d,b){saw.stopEventPropagation(b);var e=obips.ViewModel.getViewModelById(d.parentNode.parentNode.parentNode.id.slice(10));var a=e._childScrollInfo[d.parentNode.parentNode.parentNode.id.slice(10)];var f=(a.colHeaderBuffer?a.colHeaderBuffer.length:0);e.requestAllBlocksInRange(a,false,0,f,0,0,obips.ScrollingPivotTable.FETCH_TYPE_MORE_COLS);e._hideMoreCols(a)};obips.ScrollingPivotTable.prototype._showMoreRows=function(d){var b=d.moreRows;var f=d.colHeader;var e=d.rowHeader;var a=d.databody;var k=this.getPivotViewXML();var g=obips.PivotTable.isTable(k);var h=0;if(!g){h=1}b.style.top=f.offsetHeight+a.offsetHeight-b.offsetHeight-h+"px";b.style.left="0px";b.style.width=e.offsetWidth+a.offsetWidth-5+"px";b.style.visibility="visible"};obips.ScrollingPivotTable.prototype._hideMoreRows=function(b){var a=b.moreRows;a.style.visibility="hidden"};obips.ScrollingPivotTable.prototype._showMoreCols=function(d){var b=d.moreCols;var f=d.colHeader;var e=d.rowHeader;var a=d.databody;b.style.top="0px";b.style.left=e.offsetWidth+a.offsetWidth-b.offsetWidth+"px";b.style.height=f.offsetHeight+a.offsetHeight-5+"px";b.style.visibility="visible"};obips.ScrollingPivotTable.prototype._hideMoreCols=function(b){var a=b.moreCols;a.style.visibility="hidden"};obips.ScrollingPivotTable.prototype.logBlockInfo=function(a,d){if(obips.ViewModelBase.logEnabled){obips.ViewModelBase.log("fetchBlocks: %s, %s blocks",a,d.length);for(var b=0;b<d.length;b++){obips.ViewModelBase.log("block %s: numRows %s, startRow %s; numCols %s, startCol %s",b,d[b].numRows,d[b].startRow,d[b].numCols,d[b].startCol)}}};obips.ScrollingPivotTable.prototype.sizeAndPositionRolloverDiv=function(e,z,B,h,A){if(h==obips.JSDataLayout.SECTION_EDGE||h==obips.JSDataLayout.PAGE_EDGE){obips.ScrollingPivotTable.superClass.sizeAndPositionRolloverDiv.call(this,e,z,B,h,A);return}var m=this._childScrollInfo[B].corner;if(h==obips.JSDataLayout.ROW_EDGE){obips.ScrollingPivotTable.superClass.sizeAndPositionRolloverDiv.call(this,e,z,B,h,A);var q=this._childScrollInfo[B].rowHeader.parentNode;var w=q.offsetLeft;var a=m.offsetWidth+q.offsetLeft;var y=e.offsetLeft;if(y<w){e.style.left=w+"px";var s=(e.children[0].offsetWidth-(w-y));e.children[0].style.width=s+"px"}if(e.offsetLeft+e.offsetWidth>a){e.children[0].style.width=(a-e.offsetLeft)+"px"}}else{if(h==obips.JSDataLayout.COLUMN_EDGE){var k=this.findFirstSliceAtSpecifiedLayer(B,h,A);var v="e_"+B+"_"+h+"_"+A+"_"+k;var x=document.getElementById(v);var t=obips.PivotTable.calcTopBetweenElements(x,z);var d=0;if(t<0){d=t-1;t=1}e.style.top=t+"px";var p=obips.PivotTable.calcLeftBetweenElements(m,z);var g=0;var u="hl_"+B+"_"+h+"_"+A;var b=document.getElementById(u);if(b){g=(p+m.offsetWidth)-(b.offsetWidth)}else{g=p+m.offsetWidth}if(g<-5){g=-5}e.style.left=g+"px";var q=this._childScrollInfo[B].colHeader.parentNode;var n=q.offsetTop;var o=m.offsetHeight+q.offsetTop;var f=e.offsetTop;if(f<n){e.style.top=n+"px";var l=(e.children[0].offsetHeight-(n-f));e.children[0].style.height=l+"px"}if(e.offsetTop+e.offsetHeight>o){e.children[0].style.height=(o-e.offsetTop)+"px"}}}};obips.ScrollingPivotTable.prototype.positionFloatingGrabHandle=function(p,k,l,a,f){obips.ScrollingPivotTable.superClass.positionFloatingGrabHandle.call(this,p,k,l,a,f);var m=this._childScrollInfo[l].corner;if(a==obips.JSDataLayout.COLUMN_EDGE){var e=obips.PivotTable.calcLeftBetweenElements(m,k);var b=0;if(this.isRolloverEnabledForEdge(a)){var g="hl_"+l+"_"+a+"_"+f;var n=document.getElementById(g);if(n){b=(e+m.offsetWidth)-(n.offsetWidth)}else{b=e+m.offsetWidth}}else{b=e+m.offsetWidth}if(b<-5){b=-5}b-=10;p.style.left=b+"px"}else{if(a==obips.JSDataLayout.ROW_EDGE){var o=this._childScrollInfo[l].rowHeader.parentNode;var d=o.offsetLeft;var h=m.offsetWidth+o.offsetLeft;if(p.offsetLeft+p.offsetWidth>h){p.style.width=h-p.offsetLeft+1+"px"}}}};obips.ScrollingPivotTable.prototype.getOpaqueDropLayerPosition=function(b,f,d,h,a,g){if(f==obips.JSDataLayout.COLUMN_EDGE){var e=this._childScrollInfo[b].colHeader;return obips.ScrollingPivotTable.superClass.getOpaqueDropLayerPosition.call(this,b,f,d,h,e,g)}else{if(f==obips.JSDataLayout.ROW_EDGE){var e=this._childScrollInfo[b].rowHeader;return obips.ScrollingPivotTable.superClass.getOpaqueDropLayerPosition.call(this,b,f,d,h,e,g)}else{return obips.ScrollingPivotTable.superClass.getOpaqueDropLayerPosition.call(this,b,f,d,h,a,g)}}};obips.ScrollingPivotTable.prototype.getSortIconPosition=function(h,d){var b=null;var a=this._childScrollInfo[d.getId()].databodyScroller;var g=0;if(d.getEdge()==obips.JSDataLayout.ROW_EDGE&&d.getSlice()==-1){b=this._childScrollInfo[d.getId()].rowHeaderLabel}else{if(d.getEdge()==obips.JSDataLayout.ROW_EDGE){b=this.findParentBlockForCell(h,"PTRowHdrBlk")}else{if(d.getEdge()==obips.JSDataLayout.COLUMN_EDGE){b=this.findParentBlockForCell(h,"PTColHdrBlk")}}}if(!b){obips.ViewModelBase.log("Unable to find an element to use to position the sort icons.");return{xPos:0,yPos:0}}var e=obips.PivotTable.calcTopBetweenElements(h,b);var f=obips.PivotTable.calcLeftBetweenElements(h,b);return{xPos:f,yPos:e}};obips.ScrollingPivotTable.prototype.findParentBlockForCell=function(d,b){var a=d;while(a&&a.parentNode){a=a.parentNode;if(a.className==b){return a;break}}return null}};